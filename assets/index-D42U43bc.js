var Kh=Object.defineProperty;var Yu=r=>{throw TypeError(r)};var Wh=(r,e,t)=>e in r?Kh(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ct=(r,e,t)=>Wh(r,typeof e!="symbol"?e+"":e,t),Xu=(r,e,t)=>e.has(r)||Yu("Cannot "+t);var Pa=(r,e,t)=>(Xu(r,e,"read from private field"),t?t.call(r):e.get(r)),Vu=(r,e,t)=>e.has(r)?Yu("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Qu=(r,e,t,n)=>(Xu(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function eo(r,e){let t=0,n=0;if(e===void 0)for(let i of r)i!=null&&(i=+i)>=i&&(++t,n+=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(a=+a)>=a&&(++t,n+=a)}if(t)return n/t}var Hh={value:()=>{}};function uo(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Va(t)}function Va(r){this._=r}function Yh(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Va.prototype=uo.prototype={constructor:Va,on:function(r,e){var t=this._,n=Yh(r+"",t),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(r=n[a]).type)&&(i=Xh(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(r=n[a]).type)t[i]=Zu(t[i],r.name,e);else if(e==null)for(i in t)t[i]=Zu(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Va(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,a;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(e,t)}};function Xh(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function Zu(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=Hh,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var du="http://www.w3.org/1999/xhtml";const Ju={svg:"http://www.w3.org/2000/svg",xhtml:du,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function co(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),Ju.hasOwnProperty(e)?{space:Ju[e],local:r}:r}function Vh(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===du&&e.documentElement.namespaceURI===du?e.createElement(r):e.createElementNS(t,r)}}function Qh(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Gd(r){var e=co(r);return(e.local?Qh:Vh)(e)}function Zh(){}function ku(r){return r==null?Zh:function(){return this.querySelector(r)}}function Jh(r){typeof r!="function"&&(r=ku(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=new Array(s),f,h,y=0;y<s;++y)(f=a[y])&&(h=r.call(f,f.__data__,y,a))&&("__data__"in f&&(h.__data__=f.__data__),d[y]=h);return new Yt(n,this._parents)}function ef(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function tf(){return[]}function qd(r){return r==null?tf:function(){return this.querySelectorAll(r)}}function nf(r){return function(){return ef(r.apply(this,arguments))}}function rf(r){typeof r=="function"?r=nf(r):r=qd(r);for(var e=this._groups,t=e.length,n=[],i=[],a=0;a<t;++a)for(var s=e[a],d=s.length,f,h=0;h<d;++h)(f=s[h])&&(n.push(r.call(f,f.__data__,h,s)),i.push(f));return new Yt(n,i)}function Fd(r){return function(){return this.matches(r)}}function jd(r){return function(e){return e.matches(r)}}var af=Array.prototype.find;function of(r){return function(){return af.call(this.children,r)}}function sf(){return this.firstElementChild}function uf(r){return this.select(r==null?sf:of(typeof r=="function"?r:jd(r)))}var cf=Array.prototype.filter;function lf(){return Array.from(this.children)}function df(r){return function(){return cf.call(this.children,r)}}function hf(r){return this.selectAll(r==null?lf:df(typeof r=="function"?r:jd(r)))}function ff(r){typeof r!="function"&&(r=Fd(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=[],f,h=0;h<s;++h)(f=a[h])&&r.call(f,f.__data__,h,a)&&d.push(f);return new Yt(n,this._parents)}function Bd(r){return new Array(r.length)}function pf(){return new Yt(this._enter||this._groups.map(Bd),this._parents)}function to(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}to.prototype={constructor:to,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function gf(r){return function(){return r}}function yf(r,e,t,n,i,a){for(var s=0,d,f=e.length,h=a.length;s<h;++s)(d=e[s])?(d.__data__=a[s],n[s]=d):t[s]=new to(r,a[s]);for(;s<f;++s)(d=e[s])&&(i[s]=d)}function vf(r,e,t,n,i,a,s){var d,f,h=new Map,y=e.length,v=a.length,w=new Array(y),_;for(d=0;d<y;++d)(f=e[d])&&(w[d]=_=s.call(f,f.__data__,d,e)+"",h.has(_)?i[d]=f:h.set(_,f));for(d=0;d<v;++d)_=s.call(r,a[d],d,a)+"",(f=h.get(_))?(n[d]=f,f.__data__=a[d],h.delete(_)):t[d]=new to(r,a[d]);for(d=0;d<y;++d)(f=e[d])&&h.get(w[d])===f&&(i[d]=f)}function mf(r){return r.__data__}function bf(r,e){if(!arguments.length)return Array.from(this,mf);var t=e?vf:yf,n=this._parents,i=this._groups;typeof r!="function"&&(r=gf(r));for(var a=i.length,s=new Array(a),d=new Array(a),f=new Array(a),h=0;h<a;++h){var y=n[h],v=i[h],w=v.length,_=wf(r.call(y,y&&y.__data__,h,n)),D=_.length,k=d[h]=new Array(D),N=s[h]=new Array(D),O=f[h]=new Array(w);t(y,v,k,N,O,_,e);for(var M=0,z=0,A,T;M<D;++M)if(A=k[M]){for(M>=z&&(z=M+1);!(T=N[z])&&++z<D;);A._next=T||null}}return s=new Yt(s,n),s._enter=d,s._exit=f,s}function wf(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function Ef(){return new Yt(this._exit||this._groups.map(Bd),this._parents)}function xf(r,e,t){var n=this.enter(),i=this,a=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?a.remove():t(a),n&&i?n.merge(i).order():i}function _f(r){for(var e=r.selection?r.selection():r,t=this._groups,n=e._groups,i=t.length,a=n.length,s=Math.min(i,a),d=new Array(i),f=0;f<s;++f)for(var h=t[f],y=n[f],v=h.length,w=d[f]=new Array(v),_,D=0;D<v;++D)(_=h[D]||y[D])&&(w[D]=_);for(;f<i;++f)d[f]=t[f];return new Yt(d,this._parents)}function Sf(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var n=r[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function Af(r){r||(r=kf);function e(v,w){return v&&w?r(v.__data__,w.__data__):!v-!w}for(var t=this._groups,n=t.length,i=new Array(n),a=0;a<n;++a){for(var s=t[a],d=s.length,f=i[a]=new Array(d),h,y=0;y<d;++y)(h=s[y])&&(f[y]=h);f.sort(e)}return new Yt(i,this._parents).order()}function kf(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function Cf(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function Df(){return Array.from(this)}function If(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function Mf(){let r=0;for(const e of this)++r;return r}function Pf(){return!this.node()}function Nf(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],a=0,s=i.length,d;a<s;++a)(d=i[a])&&r.call(d,d.__data__,a,i);return this}function Of(r){return function(){this.removeAttribute(r)}}function Tf(r){return function(){this.removeAttributeNS(r.space,r.local)}}function Rf(r,e){return function(){this.setAttribute(r,e)}}function Lf(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function zf(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function $f(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function Gf(r,e){var t=co(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?Tf:Of:typeof e=="function"?t.local?$f:zf:t.local?Lf:Rf)(t,e))}function Ud(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function qf(r){return function(){this.style.removeProperty(r)}}function Ff(r,e,t){return function(){this.style.setProperty(r,e,t)}}function jf(r,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function Bf(r,e,t){return arguments.length>1?this.each((e==null?qf:typeof e=="function"?jf:Ff)(r,e,t??"")):mi(this.node(),r)}function mi(r,e){return r.style.getPropertyValue(e)||Ud(r).getComputedStyle(r,null).getPropertyValue(e)}function Uf(r){return function(){delete this[r]}}function Kf(r,e){return function(){this[r]=e}}function Wf(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function Hf(r,e){return arguments.length>1?this.each((e==null?Uf:typeof e=="function"?Wf:Kf)(r,e)):this.node()[r]}function Kd(r){return r.trim().split(/^|\s+/)}function Cu(r){return r.classList||new Wd(r)}function Wd(r){this._node=r,this._names=Kd(r.getAttribute("class")||"")}Wd.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Hd(r,e){for(var t=Cu(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function Yd(r,e){for(var t=Cu(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function Yf(r){return function(){Hd(this,r)}}function Xf(r){return function(){Yd(this,r)}}function Vf(r,e){return function(){(e.apply(this,arguments)?Hd:Yd)(this,r)}}function Qf(r,e){var t=Kd(r+"");if(arguments.length<2){for(var n=Cu(this.node()),i=-1,a=t.length;++i<a;)if(!n.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?Vf:e?Yf:Xf)(t,e))}function Zf(){this.textContent=""}function Jf(r){return function(){this.textContent=r}}function ep(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function tp(r){return arguments.length?this.each(r==null?Zf:(typeof r=="function"?ep:Jf)(r)):this.node().textContent}function np(){this.innerHTML=""}function rp(r){return function(){this.innerHTML=r}}function ip(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function ap(r){return arguments.length?this.each(r==null?np:(typeof r=="function"?ip:rp)(r)):this.node().innerHTML}function op(){this.nextSibling&&this.parentNode.appendChild(this)}function sp(){return this.each(op)}function up(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cp(){return this.each(up)}function lp(r){var e=typeof r=="function"?r:Gd(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function dp(){return null}function hp(r,e){var t=typeof r=="function"?r:Gd(r),n=e==null?dp:typeof e=="function"?e:ku(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function fp(){var r=this.parentNode;r&&r.removeChild(this)}function pp(){return this.each(fp)}function gp(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function yp(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function vp(r){return this.select(r?yp:gp)}function mp(r){return arguments.length?this.property("__data__",r):this.node().__data__}function bp(r){return function(e){r.call(this,e,this.__data__)}}function wp(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function Ep(r){return function(){var e=this.__on;if(e){for(var t=0,n=-1,i=e.length,a;t<i;++t)a=e[t],(!r.type||a.type===r.type)&&a.name===r.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function xp(r,e,t){return function(){var n=this.__on,i,a=bp(e);if(n){for(var s=0,d=n.length;s<d;++s)if((i=n[s]).type===r.type&&i.name===r.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=t),i.value=e;return}}this.addEventListener(r.type,a,t),i={type:r.type,name:r.name,value:e,listener:a,options:t},n?n.push(i):this.__on=[i]}}function _p(r,e,t){var n=wp(r+""),i,a=n.length,s;if(arguments.length<2){var d=this.node().__on;if(d){for(var f=0,h=d.length,y;f<h;++f)for(i=0,y=d[f];i<a;++i)if((s=n[i]).type===y.type&&s.name===y.name)return y.value}return}for(d=e?xp:Ep,i=0;i<a;++i)this.each(d(n[i],e,t));return this}function Xd(r,e,t){var n=Ud(r),i=n.CustomEvent;typeof i=="function"?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function Sp(r,e){return function(){return Xd(this,r,e)}}function Ap(r,e){return function(){return Xd(this,r,e.apply(this,arguments))}}function kp(r,e){return this.each((typeof e=="function"?Ap:Sp)(r,e))}function*Cp(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var Vd=[null];function Yt(r,e){this._groups=r,this._parents=e}function oa(){return new Yt([[document.documentElement]],Vd)}function Dp(){return this}Yt.prototype=oa.prototype={constructor:Yt,select:Jh,selectAll:rf,selectChild:uf,selectChildren:hf,filter:ff,data:bf,enter:pf,exit:Ef,join:xf,merge:_f,selection:Dp,order:Sf,sort:Af,call:Cf,nodes:Df,node:If,size:Mf,empty:Pf,each:Nf,attr:Gf,style:Bf,property:Hf,classed:Qf,text:tp,html:ap,raise:sp,lower:cp,append:lp,insert:hp,remove:pp,clone:vp,datum:mp,on:_p,dispatch:kp,[Symbol.iterator]:Cp};function Lt(r){return typeof r=="string"?new Yt([[document.querySelector(r)]],[document.documentElement]):new Yt([[r]],Vd)}function Ip(r){let e;for(;e=r.sourceEvent;)r=e;return r}function tn(r,e){if(r=Ip(r),e===void 0&&(e=r.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=r.clientX,n.y=r.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[r.clientX-i.left-e.clientLeft,r.clientY-i.top-e.clientTop]}}return[r.pageX,r.pageY]}const Mp={passive:!1},ta={capture:!0,passive:!1};function Do(r){r.stopImmediatePropagation()}function yi(r){r.preventDefault(),r.stopImmediatePropagation()}function Pp(r){var e=r.document.documentElement,t=Lt(r).on("dragstart.drag",yi,ta);"onselectstart"in e?t.on("selectstart.drag",yi,ta):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Np(r,e){var t=r.document.documentElement,n=Lt(r).on("dragstart.drag",null);e&&(n.on("click.drag",yi,ta),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Na=r=>()=>r;function hu(r,{sourceEvent:e,subject:t,target:n,identifier:i,active:a,x:s,y:d,dx:f,dy:h,dispatch:y}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:y}})}hu.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function Op(r){return!r.ctrlKey&&!r.button}function Tp(){return this.parentNode}function Rp(r,e){return e??{x:r.x,y:r.y}}function Lp(){return navigator.maxTouchPoints||"ontouchstart"in this}function zp(){var r=Op,e=Tp,t=Rp,n=Lp,i={},a=uo("start","drag","end"),s=0,d,f,h,y,v=0;function w(A){A.on("mousedown.drag",_).filter(n).on("touchstart.drag",N).on("touchmove.drag",O,Mp).on("touchend.drag touchcancel.drag",M).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(A,T){if(!(y||!r.call(this,A,T))){var K=z(this,e.call(this,A,T),A,T,"mouse");K&&(Lt(A.view).on("mousemove.drag",D,ta).on("mouseup.drag",k,ta),Pp(A.view),Do(A),h=!1,d=A.clientX,f=A.clientY,K("start",A))}}function D(A){if(yi(A),!h){var T=A.clientX-d,K=A.clientY-f;h=T*T+K*K>v}i.mouse("drag",A)}function k(A){Lt(A.view).on("mousemove.drag mouseup.drag",null),Np(A.view,h),yi(A),i.mouse("end",A)}function N(A,T){if(r.call(this,A,T)){var K=A.changedTouches,S=e.call(this,A,T),G=K.length,q,F;for(q=0;q<G;++q)(F=z(this,S,A,T,K[q].identifier,K[q]))&&(Do(A),F("start",A,K[q]))}}function O(A){var T=A.changedTouches,K=T.length,S,G;for(S=0;S<K;++S)(G=i[T[S].identifier])&&(yi(A),G("drag",A,T[S]))}function M(A){var T=A.changedTouches,K=T.length,S,G;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),S=0;S<K;++S)(G=i[T[S].identifier])&&(Do(A),G("end",A,T[S]))}function z(A,T,K,S,G,q){var F=a.copy(),W=tn(q||K,T),Z,j,ve;if((ve=t.call(A,new hu("beforestart",{sourceEvent:K,target:w,identifier:G,active:s,x:W[0],y:W[1],dx:0,dy:0,dispatch:F}),S))!=null)return Z=ve.x-W[0]||0,j=ve.y-W[1]||0,function ge(X,P,ee){var ne=W,le;switch(X){case"start":i[G]=ge,le=s++;break;case"end":delete i[G],--s;case"drag":W=tn(ee||P,T),le=s;break}F.call(X,A,new hu(X,{sourceEvent:P,subject:ve,target:w,identifier:G,active:le,x:W[0]+Z,y:W[1]+j,dx:W[0]-ne[0],dy:W[1]-ne[1],dispatch:F}),S)}}return w.filter=function(A){return arguments.length?(r=typeof A=="function"?A:Na(!!A),w):r},w.container=function(A){return arguments.length?(e=typeof A=="function"?A:Na(A),w):e},w.subject=function(A){return arguments.length?(t=typeof A=="function"?A:Na(A),w):t},w.touchable=function(A){return arguments.length?(n=typeof A=="function"?A:Na(!!A),w):n},w.on=function(){var A=a.on.apply(a,arguments);return A===a?w:A},w.clickDistance=function(A){return arguments.length?(v=(A=+A)*A,w):Math.sqrt(v)},w}function Du(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function Qd(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function sa(){}var na=.7,no=1/na,vi="\\s*([+-]?\\d+)\\s*",ra="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ln="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$p=/^#([0-9a-f]{3,8})$/,Gp=new RegExp(`^rgb\\(${vi},${vi},${vi}\\)$`),qp=new RegExp(`^rgb\\(${Ln},${Ln},${Ln}\\)$`),Fp=new RegExp(`^rgba\\(${vi},${vi},${vi},${ra}\\)$`),jp=new RegExp(`^rgba\\(${Ln},${Ln},${Ln},${ra}\\)$`),Bp=new RegExp(`^hsl\\(${ra},${Ln},${Ln}\\)$`),Up=new RegExp(`^hsla\\(${ra},${Ln},${Ln},${ra}\\)$`),ec={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Du(sa,ia,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:tc,formatHex:tc,formatHex8:Kp,formatHsl:Wp,formatRgb:nc,toString:nc});function tc(){return this.rgb().formatHex()}function Kp(){return this.rgb().formatHex8()}function Wp(){return Zd(this).formatHsl()}function nc(){return this.rgb().formatRgb()}function ia(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=$p.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?rc(e):t===3?new jt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Oa(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Oa(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Gp.exec(r))?new jt(e[1],e[2],e[3],1):(e=qp.exec(r))?new jt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Fp.exec(r))?Oa(e[1],e[2],e[3],e[4]):(e=jp.exec(r))?Oa(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Bp.exec(r))?oc(e[1],e[2]/100,e[3]/100,1):(e=Up.exec(r))?oc(e[1],e[2]/100,e[3]/100,e[4]):ec.hasOwnProperty(r)?rc(ec[r]):r==="transparent"?new jt(NaN,NaN,NaN,0):null}function rc(r){return new jt(r>>16&255,r>>8&255,r&255,1)}function Oa(r,e,t,n){return n<=0&&(r=e=t=NaN),new jt(r,e,t,n)}function Hp(r){return r instanceof sa||(r=ia(r)),r?(r=r.rgb(),new jt(r.r,r.g,r.b,r.opacity)):new jt}function fu(r,e,t,n){return arguments.length===1?Hp(r):new jt(r,e,t,n??1)}function jt(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}Du(jt,fu,Qd(sa,{brighter(r){return r=r==null?no:Math.pow(no,r),new jt(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?na:Math.pow(na,r),new jt(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new jt($r(this.r),$r(this.g),$r(this.b),ro(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ic,formatHex:ic,formatHex8:Yp,formatRgb:ac,toString:ac}));function ic(){return`#${Lr(this.r)}${Lr(this.g)}${Lr(this.b)}`}function Yp(){return`#${Lr(this.r)}${Lr(this.g)}${Lr(this.b)}${Lr((isNaN(this.opacity)?1:this.opacity)*255)}`}function ac(){const r=ro(this.opacity);return`${r===1?"rgb(":"rgba("}${$r(this.r)}, ${$r(this.g)}, ${$r(this.b)}${r===1?")":`, ${r})`}`}function ro(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function $r(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Lr(r){return r=$r(r),(r<16?"0":"")+r.toString(16)}function oc(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new wn(r,e,t,n)}function Zd(r){if(r instanceof wn)return new wn(r.h,r.s,r.l,r.opacity);if(r instanceof sa||(r=ia(r)),!r)return new wn;if(r instanceof wn)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),a=Math.max(e,t,n),s=NaN,d=a-i,f=(a+i)/2;return d?(e===a?s=(t-n)/d+(t<n)*6:t===a?s=(n-e)/d+2:s=(e-t)/d+4,d/=f<.5?a+i:2-a-i,s*=60):d=f>0&&f<1?0:s,new wn(s,d,f,r.opacity)}function Xp(r,e,t,n){return arguments.length===1?Zd(r):new wn(r,e,t,n??1)}function wn(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}Du(wn,Xp,Qd(sa,{brighter(r){return r=r==null?no:Math.pow(no,r),new wn(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?na:Math.pow(na,r),new wn(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new jt(Io(r>=240?r-240:r+120,i,n),Io(r,i,n),Io(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new wn(sc(this.h),Ta(this.s),Ta(this.l),ro(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=ro(this.opacity);return`${r===1?"hsl(":"hsla("}${sc(this.h)}, ${Ta(this.s)*100}%, ${Ta(this.l)*100}%${r===1?")":`, ${r})`}`}}));function sc(r){return r=(r||0)%360,r<0?r+360:r}function Ta(r){return Math.max(0,Math.min(1,r||0))}function Io(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const Jd=r=>()=>r;function Vp(r,e){return function(t){return r+t*e}}function Qp(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function Zp(r){return(r=+r)==1?eh:function(e,t){return t-e?Qp(e,t,r):Jd(isNaN(e)?t:e)}}function eh(r,e){var t=e-r;return t?Vp(r,t):Jd(isNaN(r)?e:r)}const uc=function r(e){var t=Zp(e);function n(i,a){var s=t((i=fu(i)).r,(a=fu(a)).r),d=t(i.g,a.g),f=t(i.b,a.b),h=eh(i.opacity,a.opacity);return function(y){return i.r=s(y),i.g=d(y),i.b=f(y),i.opacity=h(y),i+""}}return n.gamma=r,n}(1);function lr(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var pu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mo=new RegExp(pu.source,"g");function Jp(r){return function(){return r}}function eg(r){return function(e){return r(e)+""}}function tg(r,e){var t=pu.lastIndex=Mo.lastIndex=0,n,i,a,s=-1,d=[],f=[];for(r=r+"",e=e+"";(n=pu.exec(r))&&(i=Mo.exec(e));)(a=i.index)>t&&(a=e.slice(t,a),d[s]?d[s]+=a:d[++s]=a),(n=n[0])===(i=i[0])?d[s]?d[s]+=i:d[++s]=i:(d[++s]=null,f.push({i:s,x:lr(n,i)})),t=Mo.lastIndex;return t<e.length&&(a=e.slice(t),d[s]?d[s]+=a:d[++s]=a),d.length<2?f[0]?eg(f[0].x):Jp(e):(e=f.length,function(h){for(var y=0,v;y<e;++y)d[(v=f[y]).i]=v.x(h);return d.join("")})}var cc=180/Math.PI,gu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function th(r,e,t,n,i,a){var s,d,f;return(s=Math.sqrt(r*r+e*e))&&(r/=s,e/=s),(f=r*t+e*n)&&(t-=r*f,n-=e*f),(d=Math.sqrt(t*t+n*n))&&(t/=d,n/=d,f/=d),r*n<e*t&&(r=-r,e=-e,f=-f,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,r)*cc,skewX:Math.atan(f)*cc,scaleX:s,scaleY:d}}var Ra;function ng(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?gu:th(e.a,e.b,e.c,e.d,e.e,e.f)}function rg(r){return r==null||(Ra||(Ra=document.createElementNS("http://www.w3.org/2000/svg","g")),Ra.setAttribute("transform",r),!(r=Ra.transform.baseVal.consolidate()))?gu:(r=r.matrix,th(r.a,r.b,r.c,r.d,r.e,r.f))}function nh(r,e,t,n){function i(h){return h.length?h.pop()+" ":""}function a(h,y,v,w,_,D){if(h!==v||y!==w){var k=_.push("translate(",null,e,null,t);D.push({i:k-4,x:lr(h,v)},{i:k-2,x:lr(y,w)})}else(v||w)&&_.push("translate("+v+e+w+t)}function s(h,y,v,w){h!==y?(h-y>180?y+=360:y-h>180&&(h+=360),w.push({i:v.push(i(v)+"rotate(",null,n)-2,x:lr(h,y)})):y&&v.push(i(v)+"rotate("+y+n)}function d(h,y,v,w){h!==y?w.push({i:v.push(i(v)+"skewX(",null,n)-2,x:lr(h,y)}):y&&v.push(i(v)+"skewX("+y+n)}function f(h,y,v,w,_,D){if(h!==v||y!==w){var k=_.push(i(_)+"scale(",null,",",null,")");D.push({i:k-4,x:lr(h,v)},{i:k-2,x:lr(y,w)})}else(v!==1||w!==1)&&_.push(i(_)+"scale("+v+","+w+")")}return function(h,y){var v=[],w=[];return h=r(h),y=r(y),a(h.translateX,h.translateY,y.translateX,y.translateY,v,w),s(h.rotate,y.rotate,v,w),d(h.skewX,y.skewX,v,w),f(h.scaleX,h.scaleY,y.scaleX,y.scaleY,v,w),h=y=null,function(_){for(var D=-1,k=w.length,N;++D<k;)v[(N=w[D]).i]=N.x(_);return v.join("")}}}var ig=nh(ng,"px, ","px)","deg)"),ag=nh(rg,", ",")",")"),bi=0,Vi=0,Bi=0,rh=1e3,io,Qi,ao=0,Gr=0,lo=0,aa=typeof performance=="object"&&performance.now?performance:Date,ih=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Iu(){return Gr||(ih(og),Gr=aa.now()+lo)}function og(){Gr=0}function oo(){this._call=this._time=this._next=null}oo.prototype=Mu.prototype={constructor:oo,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?Iu():+t)+(e==null?0:+e),!this._next&&Qi!==this&&(Qi?Qi._next=this:io=this,Qi=this),this._call=r,this._time=t,yu()},stop:function(){this._call&&(this._call=null,this._time=1/0,yu())}};function Mu(r,e,t){var n=new oo;return n.restart(r,e,t),n}function sg(){Iu(),++bi;for(var r=io,e;r;)(e=Gr-r._time)>=0&&r._call.call(void 0,e),r=r._next;--bi}function lc(){Gr=(ao=aa.now())+lo,bi=Vi=0;try{sg()}finally{bi=0,cg(),Gr=0}}function ug(){var r=aa.now(),e=r-ao;e>rh&&(lo-=e,ao=r)}function cg(){for(var r,e=io,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:io=t);Qi=r,yu(n)}function yu(r){if(!bi){Vi&&(Vi=clearTimeout(Vi));var e=r-Gr;e>24?(r<1/0&&(Vi=setTimeout(lc,r-aa.now()-lo)),Bi&&(Bi=clearInterval(Bi))):(Bi||(ao=aa.now(),Bi=setInterval(ug,rh)),bi=1,ih(lc))}}function dc(r,e,t){var n=new oo;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}var lg=uo("start","end","cancel","interrupt"),dg=[],ah=0,hc=1,vu=2,Qa=3,fc=4,mu=5,Za=6;function ho(r,e,t,n,i,a){var s=r.__transition;if(!s)r.__transition={};else if(t in s)return;hg(r,t,{name:e,index:n,group:i,on:lg,tween:dg,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:ah})}function Pu(r,e){var t=En(r,e);if(t.state>ah)throw new Error("too late; already scheduled");return t}function zn(r,e){var t=En(r,e);if(t.state>Qa)throw new Error("too late; already running");return t}function En(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function hg(r,e,t){var n=r.__transition,i;n[e]=t,t.timer=Mu(a,0,t.time);function a(h){t.state=hc,t.timer.restart(s,t.delay,t.time),t.delay<=h&&s(h-t.delay)}function s(h){var y,v,w,_;if(t.state!==hc)return f();for(y in n)if(_=n[y],_.name===t.name){if(_.state===Qa)return dc(s);_.state===fc?(_.state=Za,_.timer.stop(),_.on.call("interrupt",r,r.__data__,_.index,_.group),delete n[y]):+y<e&&(_.state=Za,_.timer.stop(),_.on.call("cancel",r,r.__data__,_.index,_.group),delete n[y])}if(dc(function(){t.state===Qa&&(t.state=fc,t.timer.restart(d,t.delay,t.time),d(h))}),t.state=vu,t.on.call("start",r,r.__data__,t.index,t.group),t.state===vu){for(t.state=Qa,i=new Array(w=t.tween.length),y=0,v=-1;y<w;++y)(_=t.tween[y].value.call(r,r.__data__,t.index,t.group))&&(i[++v]=_);i.length=v+1}}function d(h){for(var y=h<t.duration?t.ease.call(null,h/t.duration):(t.timer.restart(f),t.state=mu,1),v=-1,w=i.length;++v<w;)i[v].call(r,y);t.state===mu&&(t.on.call("end",r,r.__data__,t.index,t.group),f())}function f(){t.state=Za,t.timer.stop(),delete n[e];for(var h in n)return;delete r.__transition}}function fg(r,e){var t=r.__transition,n,i,a=!0,s;if(t){e=e==null?null:e+"";for(s in t){if((n=t[s]).name!==e){a=!1;continue}i=n.state>vu&&n.state<mu,n.state=Za,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[s]}a&&delete r.__transition}}function pg(r){return this.each(function(){fg(this,r)})}function gg(r,e){var t,n;return function(){var i=zn(this,r),a=i.tween;if(a!==t){n=t=a;for(var s=0,d=n.length;s<d;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function yg(r,e,t){var n,i;if(typeof t!="function")throw new Error;return function(){var a=zn(this,r),s=a.tween;if(s!==n){i=(n=s).slice();for(var d={name:e,value:t},f=0,h=i.length;f<h;++f)if(i[f].name===e){i[f]=d;break}f===h&&i.push(d)}a.tween=i}}function vg(r,e){var t=this._id;if(r+="",arguments.length<2){for(var n=En(this.node(),t).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===r)return s.value;return null}return this.each((e==null?gg:yg)(t,r,e))}function Nu(r,e,t){var n=r._id;return r.each(function(){var i=zn(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return En(i,n).value[e]}}function oh(r,e){var t;return(typeof e=="number"?lr:e instanceof ia?uc:(t=ia(e))?(e=t,uc):tg)(r,e)}function mg(r){return function(){this.removeAttribute(r)}}function bg(r){return function(){this.removeAttributeNS(r.space,r.local)}}function wg(r,e,t){var n,i=t+"",a;return function(){var s=this.getAttribute(r);return s===i?null:s===n?a:a=e(n=s,t)}}function Eg(r,e,t){var n,i=t+"",a;return function(){var s=this.getAttributeNS(r.space,r.local);return s===i?null:s===n?a:a=e(n=s,t)}}function xg(r,e,t){var n,i,a;return function(){var s,d=t(this),f;return d==null?void this.removeAttribute(r):(s=this.getAttribute(r),f=d+"",s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d)))}}function _g(r,e,t){var n,i,a;return function(){var s,d=t(this),f;return d==null?void this.removeAttributeNS(r.space,r.local):(s=this.getAttributeNS(r.space,r.local),f=d+"",s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d)))}}function Sg(r,e){var t=co(r),n=t==="transform"?ag:oh;return this.attrTween(r,typeof e=="function"?(t.local?_g:xg)(t,n,Nu(this,"attr."+r,e)):e==null?(t.local?bg:mg)(t):(t.local?Eg:wg)(t,n,e))}function Ag(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function kg(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function Cg(r,e){var t,n;function i(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&kg(r,a)),t}return i._value=e,i}function Dg(r,e){var t,n;function i(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Ag(r,a)),t}return i._value=e,i}function Ig(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var n=co(r);return this.tween(t,(n.local?Cg:Dg)(n,e))}function Mg(r,e){return function(){Pu(this,r).delay=+e.apply(this,arguments)}}function Pg(r,e){return e=+e,function(){Pu(this,r).delay=e}}function Ng(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Mg:Pg)(e,r)):En(this.node(),e).delay}function Og(r,e){return function(){zn(this,r).duration=+e.apply(this,arguments)}}function Tg(r,e){return e=+e,function(){zn(this,r).duration=e}}function Rg(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?Og:Tg)(e,r)):En(this.node(),e).duration}function Lg(r,e){if(typeof e!="function")throw new Error;return function(){zn(this,r).ease=e}}function zg(r){var e=this._id;return arguments.length?this.each(Lg(e,r)):En(this.node(),e).ease}function $g(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;zn(this,r).ease=t}}function Gg(r){if(typeof r!="function")throw new Error;return this.each($g(this._id,r))}function qg(r){typeof r!="function"&&(r=Fd(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=[],f,h=0;h<s;++h)(f=a[h])&&r.call(f,f.__data__,h,a)&&d.push(f);return new Yn(n,this._parents,this._name,this._id)}function Fg(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,i=t.length,a=Math.min(n,i),s=new Array(n),d=0;d<a;++d)for(var f=e[d],h=t[d],y=f.length,v=s[d]=new Array(y),w,_=0;_<y;++_)(w=f[_]||h[_])&&(v[_]=w);for(;d<n;++d)s[d]=e[d];return new Yn(s,this._parents,this._name,this._id)}function jg(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function Bg(r,e,t){var n,i,a=jg(e)?Pu:zn;return function(){var s=a(this,r),d=s.on;d!==n&&(i=(n=d).copy()).on(e,t),s.on=i}}function Ug(r,e){var t=this._id;return arguments.length<2?En(this.node(),t).on.on(r):this.each(Bg(t,r,e))}function Kg(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function Wg(){return this.on("end.remove",Kg(this._id))}function Hg(r){var e=this._name,t=this._id;typeof r!="function"&&(r=ku(r));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var d=n[s],f=d.length,h=a[s]=new Array(f),y,v,w=0;w<f;++w)(y=d[w])&&(v=r.call(y,y.__data__,w,d))&&("__data__"in y&&(v.__data__=y.__data__),h[w]=v,ho(h[w],e,t,w,h,En(y,t)));return new Yn(a,this._parents,e,t)}function Yg(r){var e=this._name,t=this._id;typeof r!="function"&&(r=qd(r));for(var n=this._groups,i=n.length,a=[],s=[],d=0;d<i;++d)for(var f=n[d],h=f.length,y,v=0;v<h;++v)if(y=f[v]){for(var w=r.call(y,y.__data__,v,f),_,D=En(y,t),k=0,N=w.length;k<N;++k)(_=w[k])&&ho(_,e,t,k,w,D);a.push(w),s.push(y)}return new Yn(a,s,e,t)}var Xg=oa.prototype.constructor;function Vg(){return new Xg(this._groups,this._parents)}function Qg(r,e){var t,n,i;return function(){var a=mi(this,r),s=(this.style.removeProperty(r),mi(this,r));return a===s?null:a===t&&s===n?i:i=e(t=a,n=s)}}function sh(r){return function(){this.style.removeProperty(r)}}function Zg(r,e,t){var n,i=t+"",a;return function(){var s=mi(this,r);return s===i?null:s===n?a:a=e(n=s,t)}}function Jg(r,e,t){var n,i,a;return function(){var s=mi(this,r),d=t(this),f=d+"";return d==null&&(f=d=(this.style.removeProperty(r),mi(this,r))),s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d))}}function ey(r,e){var t,n,i,a="style."+e,s="end."+a,d;return function(){var f=zn(this,r),h=f.on,y=f.value[a]==null?d||(d=sh(e)):void 0;(h!==t||i!==y)&&(n=(t=h).copy()).on(s,i=y),f.on=n}}function ty(r,e,t){var n=(r+="")=="transform"?ig:oh;return e==null?this.styleTween(r,Qg(r,n)).on("end.style."+r,sh(r)):typeof e=="function"?this.styleTween(r,Jg(r,n,Nu(this,"style."+r,e))).each(ey(this._id,r)):this.styleTween(r,Zg(r,n,e),t).on("end.style."+r,null)}function ny(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function ry(r,e,t){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&ny(r,s,t)),n}return a._value=e,a}function iy(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,ry(r,e,t??""))}function ay(r){return function(){this.textContent=r}}function oy(r){return function(){var e=r(this);this.textContent=e??""}}function sy(r){return this.tween("text",typeof r=="function"?oy(Nu(this,"text",r)):ay(r==null?"":r+""))}function uy(r){return function(e){this.textContent=r.call(this,e)}}function cy(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&uy(i)),e}return n._value=r,n}function ly(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,cy(r))}function dy(){for(var r=this._name,e=this._id,t=uh(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],d=s.length,f,h=0;h<d;++h)if(f=s[h]){var y=En(f,e);ho(f,r,t,h,s,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new Yn(n,this._parents,r,t)}function hy(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(a,s){var d={value:s},f={value:function(){--i===0&&a()}};t.each(function(){var h=zn(this,n),y=h.on;y!==r&&(e=(r=y).copy(),e._.cancel.push(d),e._.interrupt.push(d),e._.end.push(f)),h.on=e}),i===0&&a()})}var fy=0;function Yn(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function uh(){return++fy}var Bn=oa.prototype;Yn.prototype={constructor:Yn,select:Hg,selectAll:Yg,selectChild:Bn.selectChild,selectChildren:Bn.selectChildren,filter:qg,merge:Fg,selection:Vg,transition:dy,call:Bn.call,nodes:Bn.nodes,node:Bn.node,size:Bn.size,empty:Bn.empty,each:Bn.each,on:Ug,attr:Sg,attrTween:Ig,style:ty,styleTween:iy,text:sy,textTween:ly,remove:Wg,tween:vg,delay:Ng,duration:Rg,ease:zg,easeVarying:Gg,end:hy,[Symbol.iterator]:Bn[Symbol.iterator]};function py(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var gy={time:null,delay:0,duration:250,ease:py};function yy(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function vy(r){var e,t;r instanceof Yn?(e=r._id,r=r._name):(e=uh(),(t=gy).time=Iu(),r=r==null?null:r+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],d=s.length,f,h=0;h<d;++h)(f=s[h])&&ho(f,r,e,h,s,t||yy(f,e));return new Yn(n,this._parents,r,e)}oa.prototype.interrupt=pg;oa.prototype.transition=vy;function my(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var a,s=t.length,d,f=0,h=0;for(a=0;a<s;++a)d=t[a],f+=d.x,h+=d.y;for(f=(f/s-r)*n,h=(h/s-e)*n,a=0;a<s;++a)d=t[a],d.x-=f,d.y-=h}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function by(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return ch(this.cover(e,t),e,t,r)}function ch(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,a=r._root,s={data:n},d=r._x0,f=r._y0,h=r._x1,y=r._y1,v,w,_,D,k,N,O,M;if(!a)return r._root=s,r;for(;a.length;)if((k=e>=(v=(d+h)/2))?d=v:h=v,(N=t>=(w=(f+y)/2))?f=w:y=w,i=a,!(a=a[O=N<<1|k]))return i[O]=s,r;if(_=+r._x.call(null,a.data),D=+r._y.call(null,a.data),e===_&&t===D)return s.next=a,i?i[O]=s:r._root=s,r;do i=i?i[O]=new Array(4):r._root=new Array(4),(k=e>=(v=(d+h)/2))?d=v:h=v,(N=t>=(w=(f+y)/2))?f=w:y=w;while((O=N<<1|k)===(M=(D>=w)<<1|_>=v));return i[M]=a,i[O]=s,r}function wy(r){var e,t,n=r.length,i,a,s=new Array(n),d=new Array(n),f=1/0,h=1/0,y=-1/0,v=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,d[t]=a,i<f&&(f=i),i>y&&(y=i),a<h&&(h=a),a>v&&(v=a));if(f>y||h>v)return this;for(this.cover(f,h).cover(y,v),t=0;t<n;++t)ch(this,s[t],d[t],r[t]);return this}function Ey(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,a=(n=Math.floor(e))+1;else{for(var s=i-t||1,d=this._root,f,h;t>r||r>=i||n>e||e>=a;)switch(h=(e<n)<<1|r<t,f=new Array(4),f[h]=d,d=f,s*=2,h){case 0:i=t+s,a=n+s;break;case 1:t=i-s,a=n+s;break;case 2:i=t+s,n=a-s;break;case 3:t=i-s,n=a-s;break}this._root&&this._root.length&&(this._root=d)}return this._x0=t,this._y0=n,this._x1=i,this._y1=a,this}function xy(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function _y(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function zt(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function Sy(r,e,t){var n,i=this._x0,a=this._y0,s,d,f,h,y=this._x1,v=this._y1,w=[],_=this._root,D,k;for(_&&w.push(new zt(_,i,a,y,v)),t==null?t=1/0:(i=r-t,a=e-t,y=r+t,v=e+t,t*=t);D=w.pop();)if(!(!(_=D.node)||(s=D.x0)>y||(d=D.y0)>v||(f=D.x1)<i||(h=D.y1)<a))if(_.length){var N=(s+f)/2,O=(d+h)/2;w.push(new zt(_[3],N,O,f,h),new zt(_[2],s,O,N,h),new zt(_[1],N,d,f,O),new zt(_[0],s,d,N,O)),(k=(e>=O)<<1|r>=N)&&(D=w[w.length-1],w[w.length-1]=w[w.length-1-k],w[w.length-1-k]=D)}else{var M=r-+this._x.call(null,_.data),z=e-+this._y.call(null,_.data),A=M*M+z*z;if(A<t){var T=Math.sqrt(t=A);i=r-T,a=e-T,y=r+T,v=e+T,n=_.data}}return n}function Ay(r){if(isNaN(y=+this._x.call(null,r))||isNaN(v=+this._y.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,d=this._y0,f=this._x1,h=this._y1,y,v,w,_,D,k,N,O;if(!t)return this;if(t.length)for(;;){if((D=y>=(w=(s+f)/2))?s=w:f=w,(k=v>=(_=(d+h)/2))?d=_:h=_,e=t,!(t=t[N=k<<1|D]))return this;if(!t.length)break;(e[N+1&3]||e[N+2&3]||e[N+3&3])&&(n=e,O=N)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[N]=a:delete e[N],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[O]=t:this._root=t),this):(this._root=a,this)}function ky(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function Cy(){return this._root}function Dy(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function Iy(r){var e=[],t,n=this._root,i,a,s,d,f;for(n&&e.push(new zt(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,d=t.x1,f=t.y1)&&n.length){var h=(a+d)/2,y=(s+f)/2;(i=n[3])&&e.push(new zt(i,h,y,d,f)),(i=n[2])&&e.push(new zt(i,a,y,h,f)),(i=n[1])&&e.push(new zt(i,h,s,d,y)),(i=n[0])&&e.push(new zt(i,a,s,h,y))}return this}function My(r){var e=[],t=[],n;for(this._root&&e.push(new zt(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,d=n.y0,f=n.x1,h=n.y1,y=(s+f)/2,v=(d+h)/2;(a=i[0])&&e.push(new zt(a,s,d,y,v)),(a=i[1])&&e.push(new zt(a,y,d,f,v)),(a=i[2])&&e.push(new zt(a,s,v,y,h)),(a=i[3])&&e.push(new zt(a,y,v,f,h))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function Py(r){return r[0]}function Ny(r){return arguments.length?(this._x=r,this):this._x}function Oy(r){return r[1]}function Ty(r){return arguments.length?(this._y=r,this):this._y}function Ou(r,e,t){var n=new Tu(e??Py,t??Oy,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function Tu(r,e,t,n,i,a){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function pc(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Gt=Ou.prototype=Tu.prototype;Gt.copy=function(){var r=new Tu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=pc(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=pc(n));return r};Gt.add=by;Gt.addAll=wy;Gt.cover=Ey;Gt.data=xy;Gt.extent=_y;Gt.find=Sy;Gt.remove=Ay;Gt.removeAll=ky;Gt.root=Cy;Gt.size=Dy;Gt.visit=Iy;Gt.visitAfter=My;Gt.x=Ny;Gt.y=Ty;function $t(r){return function(){return r}}function dr(r){return(r()-.5)*1e-6}function Ry(r){return r.x+r.vx}function Ly(r){return r.y+r.vy}function zy(r){var e,t,n,i=1,a=1;typeof r!="function"&&(r=$t(r==null?1:+r));function s(){for(var h,y=e.length,v,w,_,D,k,N,O=0;O<a;++O)for(v=Ou(e,Ry,Ly).visitAfter(d),h=0;h<y;++h)w=e[h],k=t[w.index],N=k*k,_=w.x+w.vx,D=w.y+w.vy,v.visit(M);function M(z,A,T,K,S){var G=z.data,q=z.r,F=k+q;if(G){if(G.index>w.index){var W=_-G.x-G.vx,Z=D-G.y-G.vy,j=W*W+Z*Z;j<F*F&&(W===0&&(W=dr(n),j+=W*W),Z===0&&(Z=dr(n),j+=Z*Z),j=(F-(j=Math.sqrt(j)))/j*i,w.vx+=(W*=j)*(F=(q*=q)/(N+q)),w.vy+=(Z*=j)*F,G.vx-=W*(F=1-F),G.vy-=Z*F)}return}return A>_+F||K<_-F||T>D+F||S<D-F}}function d(h){if(h.data)return h.r=t[h.data.index];for(var y=h.r=0;y<4;++y)h[y]&&h[y].r>h.r&&(h.r=h[y].r)}function f(){if(e){var h,y=e.length,v;for(t=new Array(y),h=0;h<y;++h)v=e[h],t[v.index]=+r(v,h,e)}}return s.initialize=function(h,y){e=h,n=y,f()},s.iterations=function(h){return arguments.length?(a=+h,s):a},s.strength=function(h){return arguments.length?(i=+h,s):i},s.radius=function(h){return arguments.length?(r=typeof h=="function"?h:$t(+h),f(),s):r},s}function $y(r){return r.index}function gc(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function Gy(r){var e=$y,t=v,n,i=$t(30),a,s,d,f,h,y=1;r==null&&(r=[]);function v(N){return 1/Math.min(d[N.source.index],d[N.target.index])}function w(N){for(var O=0,M=r.length;O<y;++O)for(var z=0,A,T,K,S,G,q,F;z<M;++z)A=r[z],T=A.source,K=A.target,S=K.x+K.vx-T.x-T.vx||dr(h),G=K.y+K.vy-T.y-T.vy||dr(h),q=Math.sqrt(S*S+G*G),q=(q-a[z])/q*N*n[z],S*=q,G*=q,K.vx-=S*(F=f[z]),K.vy-=G*F,T.vx+=S*(F=1-F),T.vy+=G*F}function _(){if(s){var N,O=s.length,M=r.length,z=new Map(s.map((T,K)=>[e(T,K,s),T])),A;for(N=0,d=new Array(O);N<M;++N)A=r[N],A.index=N,typeof A.source!="object"&&(A.source=gc(z,A.source)),typeof A.target!="object"&&(A.target=gc(z,A.target)),d[A.source.index]=(d[A.source.index]||0)+1,d[A.target.index]=(d[A.target.index]||0)+1;for(N=0,f=new Array(M);N<M;++N)A=r[N],f[N]=d[A.source.index]/(d[A.source.index]+d[A.target.index]);n=new Array(M),D(),a=new Array(M),k()}}function D(){if(s)for(var N=0,O=r.length;N<O;++N)n[N]=+t(r[N],N,r)}function k(){if(s)for(var N=0,O=r.length;N<O;++N)a[N]=+i(r[N],N,r)}return w.initialize=function(N,O){s=N,h=O,_()},w.links=function(N){return arguments.length?(r=N,_(),w):r},w.id=function(N){return arguments.length?(e=N,w):e},w.iterations=function(N){return arguments.length?(y=+N,w):y},w.strength=function(N){return arguments.length?(t=typeof N=="function"?N:$t(+N),D(),w):t},w.distance=function(N){return arguments.length?(i=typeof N=="function"?N:$t(+N),k(),w):i},w}const qy=1664525,Fy=1013904223,yc=4294967296;function jy(){let r=1;return()=>(r=(qy*r+Fy)%yc)/yc}function By(r){return r.x}function Uy(r){return r.y}var Ky=10,Wy=Math.PI*(3-Math.sqrt(5));function Hy(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),a=0,s=.6,d=new Map,f=Mu(v),h=uo("tick","end"),y=jy();r==null&&(r=[]);function v(){w(),h.call("tick",e),t<n&&(f.stop(),h.call("end",e))}function w(k){var N,O=r.length,M;k===void 0&&(k=1);for(var z=0;z<k;++z)for(t+=(a-t)*i,d.forEach(function(A){A(t)}),N=0;N<O;++N)M=r[N],M.fx==null?M.x+=M.vx*=s:(M.x=M.fx,M.vx=0),M.fy==null?M.y+=M.vy*=s:(M.y=M.fy,M.vy=0);return e}function _(){for(var k=0,N=r.length,O;k<N;++k){if(O=r[k],O.index=k,O.fx!=null&&(O.x=O.fx),O.fy!=null&&(O.y=O.fy),isNaN(O.x)||isNaN(O.y)){var M=Ky*Math.sqrt(.5+k),z=k*Wy;O.x=M*Math.cos(z),O.y=M*Math.sin(z)}(isNaN(O.vx)||isNaN(O.vy))&&(O.vx=O.vy=0)}}function D(k){return k.initialize&&k.initialize(r,y),k}return _(),e={tick:w,restart:function(){return f.restart(v),e},stop:function(){return f.stop(),e},nodes:function(k){return arguments.length?(r=k,_(),d.forEach(D),e):r},alpha:function(k){return arguments.length?(t=+k,e):t},alphaMin:function(k){return arguments.length?(n=+k,e):n},alphaDecay:function(k){return arguments.length?(i=+k,e):+i},alphaTarget:function(k){return arguments.length?(a=+k,e):a},velocityDecay:function(k){return arguments.length?(s=1-k,e):1-s},randomSource:function(k){return arguments.length?(y=k,d.forEach(D),e):y},force:function(k,N){return arguments.length>1?(N==null?d.delete(k):d.set(k,D(N)),e):d.get(k)},find:function(k,N,O){var M=0,z=r.length,A,T,K,S,G;for(O==null?O=1/0:O*=O,M=0;M<z;++M)S=r[M],A=k-S.x,T=N-S.y,K=A*A+T*T,K<O&&(G=S,O=K);return G},on:function(k,N){return arguments.length>1?(h.on(k,N),e):h.on(k)}}}function Yy(){var r,e,t,n,i=$t(-30),a,s=1,d=1/0,f=.81;function h(_){var D,k=r.length,N=Ou(r,By,Uy).visitAfter(v);for(n=_,D=0;D<k;++D)e=r[D],N.visit(w)}function y(){if(r){var _,D=r.length,k;for(a=new Array(D),_=0;_<D;++_)k=r[_],a[k.index]=+i(k,_,r)}}function v(_){var D=0,k,N,O=0,M,z,A;if(_.length){for(M=z=A=0;A<4;++A)(k=_[A])&&(N=Math.abs(k.value))&&(D+=k.value,O+=N,M+=N*k.x,z+=N*k.y);_.x=M/O,_.y=z/O}else{k=_,k.x=k.data.x,k.y=k.data.y;do D+=a[k.data.index];while(k=k.next)}_.value=D}function w(_,D,k,N){if(!_.value)return!0;var O=_.x-e.x,M=_.y-e.y,z=N-D,A=O*O+M*M;if(z*z/f<A)return A<d&&(O===0&&(O=dr(t),A+=O*O),M===0&&(M=dr(t),A+=M*M),A<s&&(A=Math.sqrt(s*A)),e.vx+=O*_.value*n/A,e.vy+=M*_.value*n/A),!0;if(_.length||A>=d)return;(_.data!==e||_.next)&&(O===0&&(O=dr(t),A+=O*O),M===0&&(M=dr(t),A+=M*M),A<s&&(A=Math.sqrt(s*A)));do _.data!==e&&(z=a[_.data.index]*n/A,e.vx+=O*z,e.vy+=M*z);while(_=_.next)}return h.initialize=function(_,D){r=_,t=D,y()},h.strength=function(_){return arguments.length?(i=typeof _=="function"?_:$t(+_),y(),h):i},h.distanceMin=function(_){return arguments.length?(s=_*_,h):Math.sqrt(s)},h.distanceMax=function(_){return arguments.length?(d=_*_,h):Math.sqrt(d)},h.theta=function(_){return arguments.length?(f=_*_,h):Math.sqrt(f)},h}function Xy(r){var e=$t(.1),t,n,i;typeof r!="function"&&(r=$t(r==null?0:+r));function a(d){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vx+=(i[f]-y.x)*n[f]*d}function s(){if(t){var d,f=t.length;for(n=new Array(f),i=new Array(f),d=0;d<f;++d)n[d]=isNaN(i[d]=+r(t[d],d,t))?0:+e(t[d],d,t)}}return a.initialize=function(d){t=d,s()},a.strength=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),s(),a):e},a.x=function(d){return arguments.length?(r=typeof d=="function"?d:$t(+d),s(),a):r},a}function Vy(r){var e=$t(.1),t,n,i;typeof r!="function"&&(r=$t(r==null?0:+r));function a(d){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vy+=(i[f]-y.y)*n[f]*d}function s(){if(t){var d,f=t.length;for(n=new Array(f),i=new Array(f),d=0;d<f;++d)n[d]=isNaN(i[d]=+r(t[d],d,t))?0:+e(t[d],d,t)}}return a.initialize=function(d){t=d,s()},a.strength=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),s(),a):e},a.y=function(d){return arguments.length?(r=typeof d=="function"?d:$t(+d),s(),a):r},a}function Zi(r,e,t){this.k=r,this.x=e,this.y=t}Zi.prototype={constructor:Zi,scale:function(r){return r===1?this:new Zi(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Zi(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Zi.prototype;const Qy={listeners:new Map,emit(r,e={}){document.dispatchEvent(new CustomEvent(r,{detail:e}))},on(r,e){if(typeof e!="function"){console.warn(`EventBus: Tried to register a non-function listener for event: ${r}`);return}this.listeners.has(r)||this.listeners.set(r,new Set);const t=this.listeners.get(r);if(t.has(e)){console.warn(`EventBus: Listener for event "${r}" is already registered.`);return}document.addEventListener(r,e),t.add(e)},off(r,e){if(!this.listeners.has(r)){console.warn(`EventBus: Attempted to remove a listener from a non-existent event: ${r}`);return}const t=this.listeners.get(r);if(!t.has(e)){console.warn(`EventBus: Attempted to remove a non-existent listener from event: ${r}`);return}document.removeEventListener(r,e),t.delete(e),t.size===0&&this.listeners.delete(r)},removeAll(r){if(!this.listeners.has(r)){console.warn(`EventBus: Attempted to remove all listeners from a non-existent event: ${r}`);return}this.listeners.get(r).forEach(e=>{document.removeEventListener(r,e)}),this.listeners.delete(r)}};function Po(r){const e=new Set(r.map(Number));let t=0;for(;e.has(t);)t++;return t}function ea(r,e=3){const t="abcdefghijklmnopqrstuvwxyz",n=[];function i(s,d,f){if(f===0){n.push(s);return}for(let h=d;h<t.length;h++)if(i(s+t[h],h+1,f-1),n.length>r)return}let a=1;for(;n.length<=r&&a<=e;)i("",0,a),a++;return n[r]||null}function Zy(r,e,t,n,i,a){let s=r-t,d=e-n,f=i-t,h=a-n,y=s*f+d*h,v=f*f+h*h,w=v!==0?y/v:-1,_,D;w<0?(_=t,D=n):w>1?(_=i,D=a):(_=t+w*f,D=n+w*h);let k=r-_,N=e-D;return Math.sqrt(k*k+N*N)}function La(r,e){return(r%e+e)%e}class Jy{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.appSettings.settings,this._canvas={main:{canvas:Lt("#main-canvas").node(),ctx:Lt("#main-canvas").node().getContext("2d")},node:{canvas:Lt("#node-canvas").node(),ctx:Lt("#node-canvas").node().getContext("2d")},edge:{canvas:Lt("#edge-canvas").node(),ctx:Lt("#edge-canvas").node().getContext("2d")},face:{canvas:Lt("#face-canvas").node(),ctx:Lt("#face-canvas").node().getContext("2d")}},this.canvas=Lt("#main-canvas").node(),this.ctx=this.canvas.getContext("2d"),this.mouse={x:0,y:0,dragging:!1}}init(){this.updateCanvasSize(window.innerWidth,window.innerHeight),this.canvas.addEventListener("dblclick",this.handleDbclick.bind(this)),this.canvas.addEventListener("click",this.handleClick.bind(this));let e=0;this.canvas.addEventListener("touchend",t=>{const n=new Date().getTime(),i=n-e;i<300&&i>0&&this.handleDbclick(t),e=n}),Lt("#main-canvas").on("mousedown",t=>{this.mouse.dragging=!1,[this.mouse.x,this.mouse.y]=tn(t)}).on("mousemove",t=>{const[n,i]=tn(t);(Math.abs(n-this.mouse.x)>2||Math.abs(i-this.mouse.y)>2)&&(this.mouse.dragging=!0)}).on("mouseup",t=>{this.mouse.dragging||([this.mouse.x,this.mouse.y]=tn(t))}),Lt(this.canvas).call(zp().container(this.canvas).subject(this.dragsubject.bind(this)).filter(t=>!(this.settings.scale||this.settings.select)).on("start",this.dragstarted.bind(this)).on("drag",this.dragged.bind(this)).on("end",this.dragended.bind(this)))}updateCanvasSize(e,t){for(const n in this._canvas)this._canvas[n].canvas.width=e,this._canvas[n].canvas.height=t;this.app.graphManager.redraw()}addNodeAtEvent(e){e.preventDefault();const[t,n]=e.type=="touchend"?vc(e,this.canvas):tn(e,this.canvas),i=[...new Set(this.app.graphManager.graphs.all.flatMap(d=>d.nodes()))],a=Po(i),s=ea(a);this.app.graphManager.addNode(a,{x:t,y:n,color:this.settings.node_color,label:s})}addNodeConnectedToNode(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(s=>s.nodes()))],n=Po(t),i=ea(n),a={x:e.x+30,y:e.y+30,color:this.settings.node_color,label:i};this.app.graphManager.addNode(n,a),this.app.graphManager.graph.addEdge(e.id,n),this.app.graphManager.saveGraphState("tree-node")}dragsubject(e){let t={id:null},n=1/0;return this.app.nodes.forEach(i=>{const a=e.x-i.x,s=e.y-i.y,d=Math.sqrt(a*a+s*s);d<this.settings.node_radius*i.size&&d<n&&(n=d,t=i)}),t&&(this.settings.component?t.component=this.app.graphManager.metric.getComponent(t.id):t.component=this.app.graphManager.graph.getSelectedNodes()),this.settings.panning&&(t.component=this.app.graphManager.graph.nodes()),t}dragstarted(e){e.subject.fx=e.subject.x,e.subject.fy=e.subject.y,e.subject.__moved=!1,e.subject.id!==null&&(this.app.graphManager.update=!0,this.canvas.style.cursor="grab",!e.active&&this.settings.forceSimulation&&this.app.simulation.alphaTarget(.5).restart())}dragged(e){if(e.subject.fx=e.x,e.subject.fy=e.y,(e.dx!==0||e.dy!==0)&&(e.subject.__moved=!0),!this.settings.forceSimulation&&e.subject.component){for(let t of e.subject.component)this.app.graphManager.graph.updateNodeAttributes(t,n=>({...n,x:n.x+e.dx,y:n.y+e.dy})),this.settings.performance?this.app.graphManager.needsRedraw={node:!0,edge:!1,face:!1}:this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0};e.subject.id!==null&&(this.canvas.style.cursor="grabbing",this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y})),this.settings.performance?this.app.graphManager.needsRedraw={node:!0,edge:!1,face:!1}:this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0})}}dragended(e){e.active||this.app.simulation.alphaTarget(0),e.subject.fx=null,e.subject.fy=null,e.subject.x=e.x,e.subject.y=e.y,this.canvas.style.cursor="default",this.settings.forceSimulation||this.app.updateSimulation(),e.subject.__moved&&e.subject.id!==null&&!this.settings.forceSimulation&&(console.log(6),this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y}))),(e.subject.component&&e.subject.component.length||e.subject.id!==null)&&(this.settings.forceSimulation||this.app.graphManager.saveGraphState("update-position"))}findClickedNode(e,t){return this.app.nodes.find(n=>{let i=e-n.x,a=t-n.y;return Math.sqrt(i*i+a*a)<this.settings.node_radius*n.size})}findClickedEdge(e,t){let n=10;return this.app.links.find(i=>{let a=i.source,s=i.target;return Zy(e,t,a.x,a.y,s.x,s.y)<n})}insertNodeInEdge(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(d=>d.nodes()))],n=Po(t),i=ea(n);let a=(e.source.x+e.target.x)/2,s=(e.source.y+e.target.y)/2;this.app.graphManager.graph.addNode(n,{x:a,y:s,color:this.settings.color,label:i}),this.app.graphManager.graph.dropEdge(e.source.id,e.target.id),this.app.graphManager.graph.addEdge(e.source.id,n),this.app.graphManager.graph.addEdge(n,e.target.id),this.app.graphManager.saveGraphState("tree-edge")}handleDbclick(e){const[t,n]=e.type=="touchend"?vc(e,this.canvas):tn(e,this.canvas);let i=this.findClickedNode(t,n),a=this.findClickedEdge(t,n);i?this.settings.tree?this.addNodeConnectedToNode(i):this.app.graphManager.graph.toggleNodeSelection(i.id):a?this.settings.tree?this.insertNodeInEdge(a):this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s)}):this.addNodeAtEvent(e)}handleClick(e){if(this.mouse.dragging)return;let[t,n]=tn(e,this.canvas),i=this.findClickedNode(t,n),a=this.findClickedEdge(t,n);i?this.settings.select?(this.app.graphManager.graph.toggleNodeSelection(i.id),this.settings.forceSimulation||this.eventBus.emit("graph:updated",{type:"selected"})):(this.app.graphManager.metric.addNEFGInfo(i),this.settings.colorPicker&&(this.app.colorPicker.setColor("node",i.color),this.app.colorPicker.setColor("stroke",i.stroke),this.app.colorPicker.setColor("label",i.labelColor))):a?this.settings.select?this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s)}):(this.app.graphManager.metric.addNEFGInfo(a),this.settings.colorPicker&&(this.app.colorPicker.setColor("edge",a.color),this.app.colorPicker.setColor("label",a.labelColor))):(this.app.graphManager.deselectAll(),this.app.rect.scale.active=!1)}}function vc(r,e){const t=r.changedTouches[0],n=e.getBoundingClientRect();return[t.clientX-n.left,t.clientY-n.top]}var ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var za={exports:{}},mc;function tv(){if(mc)return za.exports;mc=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(T,K,S){return Function.prototype.apply.call(T,K,S)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function n(A){console&&console.warn&&console.warn(A)}var i=Number.isNaN||function(T){return T!==T};function a(){a.init.call(this)}za.exports=a,za.exports.once=O,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function d(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(A){if(typeof A!="number"||A<0||i(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");s=A}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||i(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function f(A){return A._maxListeners===void 0?a.defaultMaxListeners:A._maxListeners}a.prototype.getMaxListeners=function(){return f(this)},a.prototype.emit=function(T){for(var K=[],S=1;S<arguments.length;S++)K.push(arguments[S]);var G=T==="error",q=this._events;if(q!==void 0)G=G&&q.error===void 0;else if(!G)return!1;if(G){var F;if(K.length>0&&(F=K[0]),F instanceof Error)throw F;var W=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw W.context=F,W}var Z=q[T];if(Z===void 0)return!1;if(typeof Z=="function")e(Z,this,K);else for(var j=Z.length,ve=D(Z,j),S=0;S<j;++S)e(ve[S],this,K);return!0};function h(A,T,K,S){var G,q,F;if(d(K),q=A._events,q===void 0?(q=A._events=Object.create(null),A._eventsCount=0):(q.newListener!==void 0&&(A.emit("newListener",T,K.listener?K.listener:K),q=A._events),F=q[T]),F===void 0)F=q[T]=K,++A._eventsCount;else if(typeof F=="function"?F=q[T]=S?[K,F]:[F,K]:S?F.unshift(K):F.push(K),G=f(A),G>0&&F.length>G&&!F.warned){F.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(T)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=A,W.type=T,W.count=F.length,n(W)}return A}a.prototype.addListener=function(T,K){return h(this,T,K,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(T,K){return h(this,T,K,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(A,T,K){var S={fired:!1,wrapFn:void 0,target:A,type:T,listener:K},G=y.bind(S);return G.listener=K,S.wrapFn=G,G}a.prototype.once=function(T,K){return d(K),this.on(T,v(this,T,K)),this},a.prototype.prependOnceListener=function(T,K){return d(K),this.prependListener(T,v(this,T,K)),this},a.prototype.removeListener=function(T,K){var S,G,q,F,W;if(d(K),G=this._events,G===void 0)return this;if(S=G[T],S===void 0)return this;if(S===K||S.listener===K)--this._eventsCount===0?this._events=Object.create(null):(delete G[T],G.removeListener&&this.emit("removeListener",T,S.listener||K));else if(typeof S!="function"){for(q=-1,F=S.length-1;F>=0;F--)if(S[F]===K||S[F].listener===K){W=S[F].listener,q=F;break}if(q<0)return this;q===0?S.shift():k(S,q),S.length===1&&(G[T]=S[0]),G.removeListener!==void 0&&this.emit("removeListener",T,W||K)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(T){var K,S,G;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[T]),this;if(arguments.length===0){var q=Object.keys(S),F;for(G=0;G<q.length;++G)F=q[G],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(K=S[T],typeof K=="function")this.removeListener(T,K);else if(K!==void 0)for(G=K.length-1;G>=0;G--)this.removeListener(T,K[G]);return this};function w(A,T,K){var S=A._events;if(S===void 0)return[];var G=S[T];return G===void 0?[]:typeof G=="function"?K?[G.listener||G]:[G]:K?N(G):D(G,G.length)}a.prototype.listeners=function(T){return w(this,T,!0)},a.prototype.rawListeners=function(T){return w(this,T,!1)},a.listenerCount=function(A,T){return typeof A.listenerCount=="function"?A.listenerCount(T):_.call(A,T)},a.prototype.listenerCount=_;function _(A){var T=this._events;if(T!==void 0){var K=T[A];if(typeof K=="function")return 1;if(K!==void 0)return K.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function D(A,T){for(var K=new Array(T),S=0;S<T;++S)K[S]=A[S];return K}function k(A,T){for(;T+1<A.length;T++)A[T]=A[T+1];A.pop()}function N(A){for(var T=new Array(A.length),K=0;K<T.length;++K)T[K]=A[K].listener||A[K];return T}function O(A,T){return new Promise(function(K,S){function G(F){A.removeListener(T,q),S(F)}function q(){typeof A.removeListener=="function"&&A.removeListener("error",G),K([].slice.call(arguments))}z(A,T,q,{once:!0}),T!=="error"&&M(A,G,{once:!0})})}function M(A,T,K){typeof A.on=="function"&&z(A,"error",T,K)}function z(A,T,K,S){if(typeof A.on=="function")S.once?A.once(T,K):A.on(T,K);else if(typeof A.addEventListener=="function")A.addEventListener(T,function G(q){S.once&&A.removeEventListener(T,G),K(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return za.exports}var nv=tv(),No,bc;function qr(){if(bc)return No;bc=1;function r(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}return typeof Symbol<"u"&&(r.prototype[Symbol.iterator]=function(){return this}),r.of=function(){var e=arguments,t=e.length,n=0;return new r(function(){return n>=t?{done:!0}:{done:!1,value:e[n++]}})},r.empty=function(){var e=new r(function(){return{done:!0}});return e},r.fromSequence=function(e){var t=0,n=e.length;return new r(function(){return t>=n?{done:!0}:{done:!1,value:e[t++]}})},r.is=function(e){return e instanceof r?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"},No=r,No}var rv=qr();const rn=Mt(rv);var $a={},wc;function lh(){return wc||(wc=1,$a.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u",$a.SYMBOL_SUPPORT=typeof Symbol<"u"),$a}var Oo,Ec;function dh(){if(Ec)return Oo;Ec=1;var r=qr(),e=lh(),t=e.ARRAY_BUFFER_SUPPORT,n=e.SYMBOL_SUPPORT;function i(a){return typeof a=="string"||Array.isArray(a)||t&&ArrayBuffer.isView(a)?r.fromSequence(a):typeof a!="object"||a===null?null:n&&typeof a[Symbol.iterator]=="function"?a[Symbol.iterator]():typeof a.next=="function"?a:null}return Oo=function(s){var d=i(s);if(!d)throw new Error("obliterator: target is not iterable nor a valid iterator.");return d},Oo}var To,xc;function iv(){if(xc)return To;xc=1;var r=dh();return To=function(t,n){for(var i=arguments.length>1?n:1/0,a=i!==1/0?new Array(i):[],s,d=0,f=r(t);;){if(d===i)return a;if(s=f.next(),s.done)return d!==n&&(a.length=d),a;a[d++]=s.value}},To}var av=iv();const hh=Mt(av);var Ro,_c;function ov(){if(_c)return Ro;_c=1;var r=qr(),e=dh();return Ro=function(){var n=arguments,i=null,a=-1;return new r(function(){var d=null;do{if(i===null){if(a++,a>=n.length)return{done:!0};i=e(n[a])}if(d=i.next(),d.done===!0){i=null;continue}break}while(!0);return d})},Ro}var sv=ov();const Hn=Mt(sv);function uv(){const r=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const n in arguments[e])r[n]=arguments[e][n];return r}let pt=uv;typeof Object.assign=="function"&&(pt=Object.assign);function nn(r,e,t,n){const i=r._nodes.get(e);let a=null;return i&&(n==="mixed"?a=i.out&&i.out[t]||i.undirected&&i.undirected[t]:n==="directed"?a=i.out&&i.out[t]:a=i.undirected&&i.undirected[t]),a}function wt(r){return typeof r=="object"&&r!==null}function fh(r){let e;for(e in r)return!1;return!0}function Zt(r,e,t){Object.defineProperty(r,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function yn(r,e,t){const n={enumerable:!0,configurable:!0};typeof t=="function"?n.get=t:(n.value=t,n.writable=!1),Object.defineProperty(r,e,n)}function Sc(r){return!(!wt(r)||r.attributes&&!Array.isArray(r.attributes))}function cv(){let r=Math.floor(Math.random()*256)&255;return()=>r++}class Ru extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}let Ne=class ph extends Ru{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ph.prototype.constructor)}};class Ae extends Ru{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ae.prototype.constructor)}}class Fe extends Ru{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Fe.prototype.constructor)}}function gh(r,e){this.key=r,this.attributes=e,this.clear()}gh.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function yh(r,e){this.key=r,this.attributes=e,this.clear()}yh.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function vh(r,e){this.key=r,this.attributes=e,this.clear()}vh.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function wi(r,e,t,n,i){this.key=e,this.attributes=i,this.undirected=r,this.source=t,this.target=n}wi.prototype.attach=function(){let r="out",e="in";this.undirected&&(r=e="undirected");const t=this.source.key,n=this.target.key;this.source[r][n]=this,!(this.undirected&&t===n)&&(this.target[e][t]=this)};wi.prototype.attachMulti=function(){let r="out",e="in";const t=this.source.key,n=this.target.key;this.undirected&&(r=e="undirected");const i=this.source[r],a=i[n];if(typeof a>"u"){i[n]=this,this.undirected&&t===n||(this.target[e][t]=this);return}a.previous=this,this.next=a,i[n]=this,this.target[e][t]=this};wi.prototype.detach=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),delete this.source[t][e],delete this.target[n][r]};wi.prototype.detachMulti=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[n][r]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[n][r]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const mh=0,bh=1,lv=2,wh=3;function Xn(r,e,t,n,i,a,s){let d,f,h,y;if(n=""+n,t===mh){if(d=r._nodes.get(n),!d)throw new Ae(`Graph.${e}: could not find the "${n}" node in the graph.`);h=i,y=a}else if(t===wh){if(i=""+i,f=r._edges.get(i),!f)throw new Ae(`Graph.${e}: could not find the "${i}" edge in the graph.`);const v=f.source.key,w=f.target.key;if(n===v)d=f.target;else if(n===w)d=f.source;else throw new Ae(`Graph.${e}: the "${n}" node is not attached to the "${i}" edge (${v}, ${w}).`);h=a,y=s}else{if(f=r._edges.get(n),!f)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`);t===bh?d=f.source:d=f.target,h=i,y=a}return[d,h,y]}function dv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);return s.attributes[d]}}function hv(r,e,t){r.prototype[e]=function(n,i){const[a]=Xn(this,e,t,n,i);return a.attributes}}function fv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);return s.attributes.hasOwnProperty(d)}}function pv(r,e,t){r.prototype[e]=function(n,i,a,s){const[d,f,h]=Xn(this,e,t,n,i,a,s);return d.attributes[f]=h,this.emit("nodeAttributesUpdated",{key:d.key,type:"set",attributes:d.attributes,name:f}),this}}function gv(r,e,t){r.prototype[e]=function(n,i,a,s){const[d,f,h]=Xn(this,e,t,n,i,a,s);if(typeof h!="function")throw new Ne(`Graph.${e}: updater should be a function.`);const y=d.attributes,v=h(y[f]);return y[f]=v,this.emit("nodeAttributesUpdated",{key:d.key,type:"set",attributes:d.attributes,name:f}),this}}function yv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);return delete s.attributes[d],this.emit("nodeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:d}),this}}function vv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);if(!wt(d))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function mv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);if(!wt(d))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return pt(s.attributes,d),this.emit("nodeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:d}),this}}function bv(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Xn(this,e,t,n,i,a);if(typeof d!="function")throw new Ne(`Graph.${e}: provided updater is not a function.`);return s.attributes=d(s.attributes),this.emit("nodeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const wv=[{name:r=>`get${r}Attribute`,attacher:dv},{name:r=>`get${r}Attributes`,attacher:hv},{name:r=>`has${r}Attribute`,attacher:fv},{name:r=>`set${r}Attribute`,attacher:pv},{name:r=>`update${r}Attribute`,attacher:gv},{name:r=>`remove${r}Attribute`,attacher:yv},{name:r=>`replace${r}Attributes`,attacher:vv},{name:r=>`merge${r}Attributes`,attacher:mv},{name:r=>`update${r}Attributes`,attacher:bv}];function Ev(r){wv.forEach(function({name:e,attacher:t}){t(r,e("Node"),mh),t(r,e("Source"),bh),t(r,e("Target"),lv),t(r,e("Opposite"),wh)})}function xv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes[i]}}function _v(r,e,t){r.prototype[e]=function(n){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+arguments[1];if(i=nn(this,a,s,t),!i)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return i.attributes}}function Sv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes.hasOwnProperty(i)}}function Av(r,e,t){r.prototype[e]=function(n,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const d=""+n,f=""+i;if(i=arguments[2],a=arguments[3],s=nn(this,d,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${d}" - "${f}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return s.attributes[i]=a,this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function kv(r,e,t){r.prototype[e]=function(n,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const d=""+n,f=""+i;if(i=arguments[2],a=arguments[3],s=nn(this,d,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${d}" - "${f}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof a!="function")throw new Ne(`Graph.${e}: updater should be a function.`);return s.attributes[i]=a(s.attributes[i]),this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function Cv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return delete a.attributes[i],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:i}),this}}function Dv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!wt(i))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=i,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function Iv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!wt(i))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return pt(a.attributes,i),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:i}),this}}function Mv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof i!="function")throw new Ne(`Graph.${e}: provided updater is not a function.`);return a.attributes=i(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const Pv=[{name:r=>`get${r}Attribute`,attacher:xv},{name:r=>`get${r}Attributes`,attacher:_v},{name:r=>`has${r}Attribute`,attacher:Sv},{name:r=>`set${r}Attribute`,attacher:Av},{name:r=>`update${r}Attribute`,attacher:kv},{name:r=>`remove${r}Attribute`,attacher:Cv},{name:r=>`replace${r}Attributes`,attacher:Dv},{name:r=>`merge${r}Attributes`,attacher:Iv},{name:r=>`update${r}Attributes`,attacher:Mv}];function Nv(r){Pv.forEach(function({name:e,attacher:t}){t(r,e("Edge"),"mixed"),t(r,e("DirectedEdge"),"directed"),t(r,e("UndirectedEdge"),"undirected")})}const Ov=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Tv(r,e,t,n){let i=!1;for(const a in e){if(a===n)continue;const s=e[a];if(i=t(s.key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes,s.undirected),r&&i)return s.key}}function Rv(r,e,t,n){let i,a,s,d=!1;for(const f in e)if(f!==n){i=e[f];do{if(a=i.source,s=i.target,d=t(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected),r&&d)return i.key;i=i.next}while(i!==void 0)}}function Lo(r,e){const t=Object.keys(r),n=t.length;let i,a=0;return new rn(function(){do if(i)i=i.next;else{if(a>=n)return{done:!0};const d=t[a++];if(d===e){i=void 0;continue}i=r[d]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function Lv(r,e,t,n){const i=e[t];if(!i)return;const a=i.source,s=i.target;if(n(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected)&&r)return i.key}function zv(r,e,t,n){let i=e[t];if(!i)return;let a=!1;do{if(a=n(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),r&&a)return i.key;i=i.next}while(i!==void 0)}function zo(r,e){let t=r[e];return t.next!==void 0?new rn(function(){if(!t)return{done:!0};const n={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:n}}):rn.of({edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected})}function $v(r,e){if(r.size===0)return[];if(e==="mixed"||e===r.type)return typeof Array.from=="function"?Array.from(r._edges.keys()):hh(r._edges.keys(),r._edges.size);const t=e==="undirected"?r.undirectedSize:r.directedSize,n=new Array(t),i=e==="undirected",a=r._edges.values();let s=0,d,f;for(;d=a.next(),d.done!==!0;)f=d.value,f.undirected===i&&(n[s++]=f.key);return n}function Eh(r,e,t,n){if(e.size===0)return;const i=t!=="mixed"&&t!==e.type,a=t==="undirected";let s,d,f=!1;const h=e._edges.values();for(;s=h.next(),s.done!==!0;){if(d=s.value,i&&d.undirected!==a)continue;const{key:y,attributes:v,source:w,target:_}=d;if(f=n(y,v,w.key,_.key,w.attributes,_.attributes,d.undirected),r&&f)return y}}function Gv(r,e){if(r.size===0)return rn.empty();const t=e!=="mixed"&&e!==r.type,n=e==="undirected",i=r._edges.values();return new rn(function(){let s,d;for(;;){if(s=i.next(),s.done)return s;if(d=s.value,!(t&&d.undirected!==n))break}return{value:{edge:d.key,attributes:d.attributes,source:d.source.key,target:d.target.key,sourceAttributes:d.source.attributes,targetAttributes:d.target.attributes,undirected:d.undirected},done:!1}})}function Lu(r,e,t,n,i,a){const s=e?Rv:Tv;let d;if(t!=="undirected"&&(n!=="out"&&(d=s(r,i.in,a),r&&d)||n!=="in"&&(d=s(r,i.out,a,n?void 0:i.key),r&&d))||t!=="directed"&&(d=s(r,i.undirected,a),r&&d))return d}function qv(r,e,t,n){const i=[];return Lu(!1,r,e,t,n,function(a){i.push(a)}),i}function Fv(r,e,t){let n=rn.empty();return r!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(n=Hn(n,Lo(t.in))),e!=="in"&&typeof t.out<"u"&&(n=Hn(n,Lo(t.out,e?void 0:t.key)))),r!=="directed"&&typeof t.undirected<"u"&&(n=Hn(n,Lo(t.undirected))),n}function zu(r,e,t,n,i,a,s){const d=t?zv:Lv;let f;if(e!=="undirected"&&(typeof i.in<"u"&&n!=="out"&&(f=d(r,i.in,a,s),r&&f)||typeof i.out<"u"&&n!=="in"&&(n||i.key!==a)&&(f=d(r,i.out,a,s),r&&f))||e!=="directed"&&typeof i.undirected<"u"&&(f=d(r,i.undirected,a,s),r&&f))return f}function jv(r,e,t,n,i){const a=[];return zu(!1,r,e,t,n,i,function(s){a.push(s)}),a}function Bv(r,e,t,n){let i=rn.empty();return r!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&n in t.in&&(i=Hn(i,zo(t.in,n))),typeof t.out<"u"&&e!=="in"&&n in t.out&&(e||t.key!==n)&&(i=Hn(i,zo(t.out,n)))),r!=="directed"&&typeof t.undirected<"u"&&n in t.undirected&&(i=Hn(i,zo(t.undirected,n))),i}function Uv(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(a,s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return $v(this,n);if(arguments.length===1){a=""+a;const d=this._nodes.get(a);if(typeof d>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return qv(this.multi,n==="mixed"?this.type:n,i,d)}if(arguments.length===2){a=""+a,s=""+s;const d=this._nodes.get(a);if(!d)throw new Ae(`Graph.${t}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new Ae(`Graph.${t}:  could not find the "${s}" target node in the graph.`);return jv(n,this.multi,i,d,s)}throw new Ne(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Kv(r,e){const{name:t,type:n,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(h,y,v){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return v=h,Eh(!1,this,n,v);if(arguments.length===2){h=""+h,v=y;const w=this._nodes.get(h);if(typeof w>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);return Lu(!1,this.multi,n==="mixed"?this.type:n,i,w,v)}if(arguments.length===3){h=""+h,y=""+y;const w=this._nodes.get(h);if(!w)throw new Ae(`Graph.${a}:  could not find the "${h}" source node in the graph.`);if(!this._nodes.has(y))throw new Ae(`Graph.${a}:  could not find the "${y}" target node in the graph.`);return zu(!1,n,this.multi,i,w,y,v)}throw new Ne(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const s="map"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop();let v;if(h.length===0){let w=0;n!=="directed"&&(w+=this.undirectedSize),n!=="undirected"&&(w+=this.directedSize),v=new Array(w);let _=0;h.push((D,k,N,O,M,z,A)=>{v[_++]=y(D,k,N,O,M,z,A)})}else v=[],h.push((w,_,D,k,N,O,M)=>{v.push(y(w,_,D,k,N,O,M))});return this[a].apply(this,h),v};const d="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[d]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop(),v=[];return h.push((w,_,D,k,N,O,M)=>{y(w,_,D,k,N,O,M)&&v.push(w)}),this[a].apply(this,h),v};const f="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[f]=function(){let h=Array.prototype.slice.call(arguments);if(h.length<2||h.length>4)throw new Ne(`Graph.${f}: invalid number of arguments (expecting 2, 3 or 4 and got ${h.length}).`);if(typeof h[h.length-1]=="function"&&typeof h[h.length-2]!="function")throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let y,v;h.length===2?(y=h[0],v=h[1],h=[]):h.length===3?(y=h[1],v=h[2],h=[h[0]]):h.length===4&&(y=h[2],v=h[3],h=[h[0],h[1]]);let w=v;return h.push((_,D,k,N,O,M,z)=>{w=y(w,_,D,k,N,O,M,z)}),this[a].apply(this,h),w}}function Wv(r,e){const{name:t,type:n,direction:i}=e,a="find"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(f,h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return y=f,Eh(!0,this,n,y);if(arguments.length===2){f=""+f,y=h;const v=this._nodes.get(f);if(typeof v>"u")throw new Ae(`Graph.${a}: could not find the "${f}" node in the graph.`);return Lu(!0,this.multi,n==="mixed"?this.type:n,i,v,y)}if(arguments.length===3){f=""+f,h=""+h;const v=this._nodes.get(f);if(!v)throw new Ae(`Graph.${a}:  could not find the "${f}" source node in the graph.`);if(!this._nodes.has(h))throw new Ae(`Graph.${a}:  could not find the "${h}" target node in the graph.`);return zu(!0,n,this.multi,i,v,h,y)}throw new Ne(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const s="some"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((v,w,_,D,k,N,O)=>h(v,w,_,D,k,N,O)),!!this[a].apply(this,f)};const d="every"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[d]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((v,w,_,D,k,N,O)=>!h(v,w,_,D,k,N,O)),!this[a].apply(this,f)}}function Hv(r,e){const{name:t,type:n,direction:i}=e,a=t.slice(0,-1)+"Entries";r.prototype[a]=function(s,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rn.empty();if(!arguments.length)return Gv(this,n);if(arguments.length===1){s=""+s;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return Fv(n,i,f)}if(arguments.length===2){s=""+s,d=""+d;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(d))throw new Ae(`Graph.${a}:  could not find the "${d}" target node in the graph.`);return Bv(n,i,f,d)}throw new Ne(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Yv(r){Ov.forEach(e=>{Uv(r,e),Kv(r,e),Wv(r,e),Hv(r,e)})}const Xv=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function fo(){this.A=null,this.B=null}fo.prototype.wrap=function(r){this.A===null?this.A=r:this.B===null&&(this.B=r)};fo.prototype.has=function(r){return this.A!==null&&r in this.A||this.B!==null&&r in this.B};function Ui(r,e,t,n,i){for(const a in n){const s=n[a],d=s.source,f=s.target,h=d===t?f:d;if(e&&e.has(h.key))continue;const y=i(h.key,h.attributes);if(r&&y)return h.key}}function $u(r,e,t,n,i){if(e!=="mixed"){if(e==="undirected")return Ui(r,null,n,n.undirected,i);if(typeof t=="string")return Ui(r,null,n,n[t],i)}const a=new fo;let s;if(e!=="undirected"){if(t!=="out"){if(s=Ui(r,null,n,n.in,i),r&&s)return s;a.wrap(n.in)}if(t!=="in"){if(s=Ui(r,a,n,n.out,i),r&&s)return s;a.wrap(n.out)}}if(e!=="directed"&&(s=Ui(r,a,n,n.undirected,i),r&&s))return s}function Vv(r,e,t){if(r!=="mixed"){if(r==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const n=[];return $u(!1,r,e,t,function(i){n.push(i)}),n}function Ki(r,e,t){const n=Object.keys(t),i=n.length;let a=0;return new rn(function(){let d=null;do{if(a>=i)return r&&r.wrap(t),{done:!0};const f=t[n[a++]],h=f.source,y=f.target;if(d=h===e?y:h,r&&r.has(d.key)){d=null;continue}}while(d===null);return{done:!1,value:{neighbor:d.key,attributes:d.attributes}}})}function Qv(r,e,t){if(r!=="mixed"){if(r==="undirected")return Ki(null,t,t.undirected);if(typeof e=="string")return Ki(null,t,t[e])}let n=rn.empty();const i=new fo;return r!=="undirected"&&(e!=="out"&&(n=Hn(n,Ki(i,t,t.in))),e!=="in"&&(n=Hn(n,Ki(i,t,t.out)))),r!=="directed"&&(n=Hn(n,Ki(i,t,t.undirected))),n}function Zv(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return Vv(n==="mixed"?this.type:n,i,s)}}function Jv(r,e){const{name:t,type:n,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;h=""+h;const v=this._nodes.get(h);if(typeof v>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);$u(!1,n==="mixed"?this.type:n,i,v,y)};const s="map"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(h,y){const v=[];return this[a](h,(w,_)=>{v.push(y(w,_))}),v};const d="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[d]=function(h,y){const v=[];return this[a](h,(w,_)=>{y(w,_)&&v.push(w)}),v};const f="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[f]=function(h,y,v){if(arguments.length<3)throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let w=v;return this[a](h,(_,D)=>{w=y(w,_,D)}),w}}function em(r,e){const{name:t,type:n,direction:i}=e,a=t[0].toUpperCase()+t.slice(1,-1),s="find"+a;r.prototype[s]=function(h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;h=""+h;const v=this._nodes.get(h);if(typeof v>"u")throw new Ae(`Graph.${s}: could not find the "${h}" node in the graph.`);return $u(!0,n==="mixed"?this.type:n,i,v,y)};const d="some"+a;r.prototype[d]=function(h,y){return!!this[s](h,y)};const f="every"+a;r.prototype[f]=function(h,y){return!this[s](h,(w,_)=>!y(w,_))}}function tm(r,e){const{name:t,type:n,direction:i}=e,a=t.slice(0,-1)+"Entries";r.prototype[a]=function(s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rn.empty();s=""+s;const d=this._nodes.get(s);if(typeof d>"u")throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return Qv(n==="mixed"?this.type:n,i,d)}}function nm(r){Xv.forEach(e=>{Zv(r,e),Jv(r,e),em(r,e),tm(r,e)})}function Ga(r,e,t,n,i){const a=n._nodes.values(),s=n.type;let d,f,h,y,v,w;for(;d=a.next(),d.done!==!0;){let _=!1;if(f=d.value,s!=="undirected"){y=f.out;for(h in y){v=y[h];do w=v.target,_=!0,i(f.key,w.key,f.attributes,w.attributes,v.key,v.attributes,v.undirected),v=v.next;while(v)}}if(s!=="directed"){y=f.undirected;for(h in y)if(!(e&&f.key>h)){v=y[h];do w=v.target,w.key!==h&&(w=v.source),_=!0,i(f.key,w.key,f.attributes,w.attributes,v.key,v.attributes,v.undirected),v=v.next;while(v)}}t&&!_&&i(f.key,null,f.attributes,null,null,null,null)}}function rm(r,e){const t={key:r};return fh(e.attributes)||(t.attributes=pt({},e.attributes)),t}function im(r,e,t){const n={key:e,source:t.source.key,target:t.target.key};return fh(t.attributes)||(n.attributes=pt({},t.attributes)),r==="mixed"&&t.undirected&&(n.undirected=!0),n}function am(r){if(!wt(r))throw new Ne('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in r))throw new Ne("Graph.import: serialized node is missing its key.");if("attributes"in r&&(!wt(r.attributes)||r.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function om(r){if(!wt(r))throw new Ne('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in r))throw new Ne("Graph.import: serialized edge is missing its source.");if(!("target"in r))throw new Ne("Graph.import: serialized edge is missing its target.");if("attributes"in r&&(!wt(r.attributes)||r.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in r&&typeof r.undirected!="boolean")throw new Ne("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const sm=cv(),um=new Set(["directed","undirected","mixed"]),Ac=new Set(["domain","_events","_eventsCount","_maxListeners"]),cm=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],lm={allowSelfLoops:!0,multi:!1,type:"mixed"};function dm(r,e,t){if(t&&!wt(t))throw new Ne(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},r._nodes.has(e))throw new Fe(`Graph.addNode: the "${e}" node already exist in the graph.`);const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function kc(r,e,t){const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function xh(r,e,t,n,i,a,s,d){if(!n&&r.type==="undirected")throw new Fe(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new Fe(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(d&&!wt(d))throw new Ne(`Graph.${e}: invalid attributes. Expecting an object but got "${d}"`);if(a=""+a,s=""+s,d=d||{},!r.allowSelfLoops&&a===s)throw new Fe(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const f=r._nodes.get(a),h=r._nodes.get(s);if(!f)throw new Ae(`Graph.${e}: source node "${a}" not found.`);if(!h)throw new Ae(`Graph.${e}: target node "${s}" not found.`);const y={key:null,undirected:n,source:a,target:s,attributes:d};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new Fe(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!r.multi&&(n?typeof f.undirected[s]<"u":typeof f.out[s]<"u"))throw new Fe(`Graph.${e}: an edge linking "${a}" to "${s}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const v=new wi(n,i,f,h,d);r._edges.set(i,v);const w=a===s;return n?(f.undirectedDegree++,h.undirectedDegree++,w&&(f.undirectedLoops++,r._undirectedSelfLoopCount++)):(f.outDegree++,h.inDegree++,w&&(f.directedLoops++,r._directedSelfLoopCount++)),r.multi?v.attachMulti():v.attach(),n?r._undirectedSize++:r._directedSize++,y.key=i,r.emit("edgeAdded",y),i}function hm(r,e,t,n,i,a,s,d,f){if(!n&&r.type==="undirected")throw new Fe(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new Fe(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(d){if(f){if(typeof d!="function")throw new Ne(`Graph.${e}: invalid updater function. Expecting a function but got "${d}"`)}else if(!wt(d))throw new Ne(`Graph.${e}: invalid attributes. Expecting an object but got "${d}"`)}a=""+a,s=""+s;let h;if(f&&(h=d,d=void 0),!r.allowSelfLoops&&a===s)throw new Fe(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let y=r._nodes.get(a),v=r._nodes.get(s),w,_;if(!t&&(w=r._edges.get(i),w)){if((w.source.key!==a||w.target.key!==s)&&(!n||w.source.key!==s||w.target.key!==a))throw new Fe(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${a}" source & "${s}" target vs. ("${w.source.key}", "${w.target.key}").`);_=w}if(!_&&!r.multi&&y&&(_=n?y.undirected[s]:y.out[s]),_){const M=[_.key,!1,!1,!1];if(f?!h:!d)return M;if(f){const z=_.attributes;_.attributes=h(z),r.emit("edgeAttributesUpdated",{type:"replace",key:_.key,attributes:_.attributes})}else pt(_.attributes,d),r.emit("edgeAttributesUpdated",{type:"merge",key:_.key,attributes:_.attributes,data:d});return M}d=d||{},f&&h&&(d=h(d));const D={key:null,undirected:n,source:a,target:s,attributes:d};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new Fe(`Graph.${e}: the "${i}" edge already exists in the graph.`);let k=!1,N=!1;y||(y=kc(r,a,{}),k=!0,a===s&&(v=y,N=!0)),v||(v=kc(r,s,{}),N=!0),w=new wi(n,i,y,v,d),r._edges.set(i,w);const O=a===s;return n?(y.undirectedDegree++,v.undirectedDegree++,O&&(y.undirectedLoops++,r._undirectedSelfLoopCount++)):(y.outDegree++,v.inDegree++,O&&(y.directedLoops++,r._directedSelfLoopCount++)),r.multi?w.attachMulti():w.attach(),n?r._undirectedSize++:r._directedSize++,D.key=i,r.emit("edgeAdded",D),[i,!0,k,N]}function ai(r,e){r._edges.delete(e.key);const{source:t,target:n,attributes:i}=e,a=e.undirected,s=t===n;a?(t.undirectedDegree--,n.undirectedDegree--,s&&(t.undirectedLoops--,r._undirectedSelfLoopCount--)):(t.outDegree--,n.inDegree--,s&&(t.directedLoops--,r._directedSelfLoopCount--)),r.multi?e.detachMulti():e.detach(),a?r._undirectedSize--:r._directedSize--,r.emit("edgeDropped",{key:e.key,attributes:i,source:t.key,target:n.key,undirected:a})}class Qe extends nv.EventEmitter{constructor(e){if(super(),e=pt({},lm,e),typeof e.multi!="boolean")throw new Ne(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!um.has(e.type))throw new Ne(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new Ne(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?gh:e.type==="directed"?yh:vh;Zt(this,"NodeDataClass",t);const n="geid_"+sm()+"_";let i=0;const a=()=>{let s;do s=n+i++;while(this._edges.has(s));return s};Zt(this,"_attributes",{}),Zt(this,"_nodes",new Map),Zt(this,"_edges",new Map),Zt(this,"_directedSize",0),Zt(this,"_undirectedSize",0),Zt(this,"_directedSelfLoopCount",0),Zt(this,"_undirectedSelfLoopCount",0),Zt(this,"_edgeKeyGenerator",a),Zt(this,"_options",e),Ac.forEach(s=>Zt(this,s,this[s])),yn(this,"order",()=>this._nodes.size),yn(this,"size",()=>this._edges.size),yn(this,"directedSize",()=>this._directedSize),yn(this,"undirectedSize",()=>this._undirectedSize),yn(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),yn(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),yn(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),yn(this,"multi",this._options.multi),yn(this,"type",this._options.type),yn(this,"allowSelfLoops",this._options.allowSelfLoops),yn(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.out.hasOwnProperty(t):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.undirected.hasOwnProperty(t):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const n=""+e;return this._edges.has(n)}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?typeof n.out<"u"&&n.out.hasOwnProperty(t)||typeof n.undirected<"u"&&n.undirected.hasOwnProperty(t):!1}throw new Ne(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new Fe("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||void 0;if(i)return i.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new Fe("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const i=n.undirected&&n.undirected[t]||void 0;if(i)return i.key}edge(e,t){if(this.multi)throw new Fe("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.edge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in||t in n.out}areOutNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.out}areInNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in n.undirected}areNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in n.in||t in n.out)||this.type!=="directed"&&t in n.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.in||this.type!=="directed"&&t in n.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.out||this.type!=="directed"&&t in n.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree),n}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.outDegree),n}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree),n}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree,i+=t.directedLoops),n-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.outDegree,i+=t.directedLoops),n-i}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree,i+=t.directedLoops*2),n-i}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const n=this._edges.get(t);if(!n)throw new Ae(`Graph.opposite: could not find the "${t}" edge in the graph.`);const i=n.source.key,a=n.target.key;if(e===i)return a;if(e===a)return i;throw new Ae(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${i}, ${a}).`)}hasExtremity(e,t){e=""+e,t=""+t;const n=this._edges.get(e);if(!n)throw new Ae(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return n.source.key===t||n.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return dm(this,e,t).key}mergeNode(e,t){if(t&&!wt(t))throw new Ne(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let n=this._nodes.get(e);return n?(t&&(pt(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new Ne(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let n=this._nodes.get(e);if(n){if(t){const a=n.attributes;n.attributes=t(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}const i=t?t({}):{};return n=new this.NodeDataClass(e,i),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.dropNode: could not find the "${e}" node in the graph.`);let n;if(this.type!=="undirected"){for(const i in t.out){n=t.out[i];do ai(this,n),n=n.next;while(n)}for(const i in t.in){n=t.in[i];do ai(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(const i in t.undirected){n=t.undirected[i];do ai(this,n),n=n.next;while(n)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const n=""+arguments[0],i=""+arguments[1];if(t=nn(this,n,i,this.type),!t)throw new Ae(`Graph.dropEdge: could not find the "${n}" -> "${i}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new Ae(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return ai(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new Fe("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Fe("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const n=nn(this,e,t,"directed");if(!n)throw new Ae(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return ai(this,n),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new Fe("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Fe("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const n=nn(this,e,t,"undirected");if(!n)throw new Ae(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return ai(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new Ne("Graph.updateAttribute: updater should be a function.");const n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!wt(e))throw new Ne("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!wt(e))throw new Ne("Graph.mergeAttributes: provided attributes are not a plain object.");return pt(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new Ne("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new Ne("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!Sc(t))throw new Ne("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._nodes.values();let i,a;for(;i=n.next(),i.done!==!0;)a=i.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new Ne("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!Sc(t))throw new Ne("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._edges.values();let i,a,s,d;for(;i=n.next(),i.done!==!0;)a=i.value,s=a.source,d=a.target,a.attributes=e(a.key,a.attributes,s.key,d.key,s.attributes,d.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new Ne("Graph.forEachAdjacencyEntry: expecting a callback.");Ga(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ne("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Ga(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Ga(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Ga(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):hh(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new Ne("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new Ne("Graph.findNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new Ne("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let n,i;const a=new Array(this.order);let s=0;for(;n=t.next(),n.done!==!0;)i=n.value,a[s++]=e(i.key,i.attributes);return a}someNode(e){if(typeof e!="function")throw new Ne("Graph.someNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new Ne("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new Ne("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let n,i;const a=[];for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)&&a.push(i.key);return a}reduceNodes(e,t){if(typeof e!="function")throw new Ne("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Ne("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=t;const i=this._nodes.values();let a,s;for(;a=i.next(),a.done!==!0;)s=a.value,n=e(n,s.key,s.attributes);return n}nodeEntries(){const e=this._nodes.values();return new rn(()=>{const t=e.next();if(t.done)return t;const n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((i,a)=>{e[t++]=rm(a,i)});const n=new Array(this._edges.size);return t=0,this._edges.forEach((i,a)=>{n[t++]=im(this.type,a,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:n}}import(e,t=!1){if(e instanceof Qe)return e.forEachNode((f,h)=>{t?this.mergeNode(f,h):this.addNode(f,h)}),e.forEachEdge((f,h,y,v,w,_,D)=>{t?D?this.mergeUndirectedEdgeWithKey(f,y,v,h):this.mergeDirectedEdgeWithKey(f,y,v,h):D?this.addUndirectedEdgeWithKey(f,y,v,h):this.addDirectedEdgeWithKey(f,y,v,h)}),this;if(!wt(e))throw new Ne("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!wt(e.attributes))throw new Ne("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let n,i,a,s,d;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new Ne("Graph.import: invalid nodes. Expecting an array.");for(n=0,i=a.length;n<i;n++){s=a[n],am(s);const{key:f,attributes:h}=s;t?this.mergeNode(f,h):this.addNode(f,h)}}if(e.edges){let f=!1;if(this.type==="undirected"&&(f=!0),a=e.edges,!Array.isArray(a))throw new Ne("Graph.import: invalid edges. Expecting an array.");for(n=0,i=a.length;n<i;n++){d=a[n],om(d);const{source:h,target:y,attributes:v,undirected:w=f}=d;let _;"key"in d?(_=t?w?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:w?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,_.call(this,d.key,h,y,v)):(_=t?w?this.mergeUndirectedEdge:this.mergeDirectedEdge:w?this.addUndirectedEdge:this.addDirectedEdge,_.call(this,h,y,v))}}return this}nullCopy(e){const t=new Qe(pt({},this._options,e));return t.replaceAttributes(pt({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((n,i)=>{const a=pt({},n.attributes);n=new t.NodeDataClass(i,a),t._nodes.set(i,n)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Fe(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Fe("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Fe("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),n=this._edges.values();let i,a;for(;i=n.next(),i.done!==!0;)a=i.value,xh(t,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,pt({},a.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,s)=>{e[s]=a.attributes});const t={},n={};this._edges.forEach((a,s)=>{const d=a.undirected?"--":"->";let f="",h=a.source.key,y=a.target.key,v;a.undirected&&h>y&&(v=h,h=y,y=v);const w=`(${h})${d}(${y})`;s.startsWith("geid_")?this.multi&&(typeof n[w]>"u"?n[w]=0:n[w]++,f+=`${n[w]}. `):f+=`[${s}]: `,f+=w,t[f]=a.attributes});const i={};for(const a in this)this.hasOwnProperty(a)&&!Ac.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(i[a]=this[a]);return i.attributes=this._attributes,i.nodes=e,i.edges=t,Zt(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Qe.prototype[Symbol.for("nodejs.util.inspect.custom")]=Qe.prototype.inspect);cm.forEach(r=>{["add","merge","update"].forEach(e=>{const t=r.name(e),n=e==="add"?xh:hm;r.generateKey?Qe.prototype[t]=function(i,a,s){return n(this,t,!0,(r.type||this.type)==="undirected",null,i,a,s,e==="update")}:Qe.prototype[t]=function(i,a,s,d){return n(this,t,!1,(r.type||this.type)==="undirected",i,a,s,d,e==="update")}})});Ev(Qe);Nv(Qe);Yv(Qe);nm(Qe);let _h=class extends Qe{constructor(e){const t=pt({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new Ne("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new Ne('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},Sh=class extends Qe{constructor(e){const t=pt({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new Ne("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new Ne('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}};class Ah extends Qe{constructor(e){const t=pt({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class kh extends Qe{constructor(e){const t=pt({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new Ne('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Ch extends Qe{constructor(e){const t=pt({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new Ne('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function Ei(r){r.from=function(e,t){const n=pt({},e.options,t),i=new r(n);return i.import(e),i}}Ei(Qe);Ei(_h);Ei(Sh);Ei(Ah);Ei(kh);Ei(Ch);Qe.Graph=Qe;Qe.DirectedGraph=_h;Qe.UndirectedGraph=Sh;Qe.MultiGraph=Ah;Qe.MultiDirectedGraph=kh;Qe.MultiUndirectedGraph=Ch;Qe.InvalidArgumentsGraphError=Ne;Qe.NotFoundGraphError=Ae;Qe.UsageGraphError=Fe;var vn={},$o,Cc;function je(){return Cc||(Cc=1,$o=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"}),$o}var Go={},Dc;function Gu(){return Dc||(Dc=1,Go.copyNode=function(r,e,t){return t=Object.assign({},t),r.addNode(e,t)}),Go}var oi={},Ic;function Vn(){return Ic||(Ic=1,oi.addEdge=function(e,t,n,i,a,s){return t?n==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(n,i,a,s):n==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(n,i,a,s)},oi.copyEdge=function(e,t,n,i,a,s){return s=Object.assign({},s),t?n==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(n,i,a,s):n==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(n,i,a,s)},oi.mergeEdge=function(e,t,n,i,a,s){return t?n==null?e.mergeUndirectedEdge(i,a,s):e.mergeUndirectedEdgeWithKey(n,i,a,s):n==null?e.mergeDirectedEdge(i,a,s):e.mergeDirectedEdgeWithKey(n,i,a,s)},oi.updateEdge=function(e,t,n,i,a,s){return t?n==null?e.updateUndirectedEdge(i,a,s):e.updateUndirectedEdgeWithKey(n,i,a,s):n==null?e.updateDirectedEdge(i,a,s):e.updateDirectedEdgeWithKey(n,i,a,s)}),oi}var qo,Mc;function fm(){if(Mc)return qo;Mc=1;var r=je(),e=Gu().copyNode,t=Vn().copyEdge;return qo=function(i,a){if(!r(i)||!r(a))throw new Error("graphology-operators/disjoint-union: invalid graph.");if(i.multi!==a.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");var s=i.nullCopy();s.mergeAttributes(i.getAttributes());var d={},f={},h=0;return i.forEachNode(function(y,v){d[y]=h,e(s,h,v),h++}),a.forEachNode(function(y,v){f[y]=h,e(s,h,v),h++}),h=0,i.forEachEdge(function(y,v,w,_,D,k,N){t(s,N,h++,d[w],d[_],_,v)}),a.forEachEdge(function(y,v,w,_,D,k,N){t(s,N,h++,f[w],f[_],_,v)}),s},qo}var Fo,Pc;function pm(){if(Pc)return Fo;Pc=1;var r=je(),e=Vn().copyEdge;return Fo=function(n){if(!r(n))throw new Error("graphology-operators/reverse: invalid graph.");var i=n.emptyCopy();return n.forEachEdge(function(a,s,d,f,h,y,v){v?e(i,!0,a,d,f,s):e(i,!1,a,f,d,s)}),i},Fo}var jo,Nc;function gm(){if(Nc)return jo;Nc=1;var r=je(),e=Gu().copyNode,t=Vn().copyEdge;return jo=function(i,a){if(!r(i))throw new Error("graphology-operators/subgraph: invalid graph instance.");var s=i.nullCopy(),d=a;if(Array.isArray(a)){if(a.length===0)return s;a=new Set(a)}if(a instanceof Set){if(a.size===0)return s;d=function(h){return a.has(h)};var f=a;a=new Set,f.forEach(function(h){a.add(""+h)})}if(typeof d!="function")throw new Error("graphology-operators/subgraph: invalid nodes. Expecting an array or a set or a filtering function.");if(typeof a=="function"){if(i.forEachNode(function(h,y){d(h,y)&&e(s,h,y)}),s.order===0)return s}else a.forEach(function(h){if(!i.hasNode(h))throw new Error('graphology-operators/subgraph: the "'+h+'" node was not found in the graph.');e(s,h,i.getNodeAttributes(h))});return i.forEachEdge(function(h,y,v,w,_,D,k){d(v,_)&&(w!==v&&!d(w,D)||t(s,k,h,v,w,y))}),s},jo}var Bo,Oc;function ym(){if(Oc)return Bo;Oc=1;var r=je(),e=Vn().copyEdge;return Bo=function(n,i){if(!r(n))throw new Error("graphology-operators/to-directed: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(n.type==="directed")return n.copy();var s=n.emptyCopy({type:"directed"});return n.forEachDirectedEdge(function(d,f,h,y){e(s,!1,d,h,y,f)}),n.forEachUndirectedEdge(function(d,f,h,y){var v=!n.multi&&n.type==="mixed"&&s.edge(h,y),w=!n.multi&&n.type==="mixed"&&s.edge(y,h);v?s.replaceEdgeAttributes(v,a(s.getEdgeAttributes(v),f)):e(s,!1,null,h,y,f),h!==y&&(w?s.replaceEdgeAttributes(w,a(s.getEdgeAttributes(w),f)):e(s,!1,null,y,h,f))}),s},Bo}var Uo,Tc;function vm(){if(Tc)return Uo;Tc=1;var r=je();return Uo=function(t){if(!r(t))throw new Error("graphology-operators/to-mixed: expecting a valid graphology instance.");return t.copy({type:"mixed"})},Uo}var Ko,Rc;function mm(){if(Rc)return Ko;Rc=1;var r=je();return Ko=function(t){if(!r(t))throw new Error("graphology-operators/to-multi: expecting a valid graphology instance.");return t.copy({multi:!0})},Ko}var Wo,Lc;function bm(){if(Lc)return Wo;Lc=1;var r=je(),e=Vn().copyEdge;return Wo=function(n,i){if(!r(n))throw new Error("graphology-operators/to-simple: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(!n.multi)return n.copy();var s=n.emptyCopy({multi:!1});return n.forEachEdge(function(d,f,h,y,v,w,_){var D=_?s.undirectedEdge(h,y):s.directedEdge(h,y);if(D){a&&s.replaceEdgeAttributes(D,a(s.getEdgeAttributes(D),f));return}e(s,_,d,h,y,f)}),s},Wo}var Ho,zc;function wm(){if(zc)return Ho;zc=1;var r=je(),e=Vn().copyEdge;return Ho=function(n,i){if(!r(n))throw new Error("graphology-operators/to-undirected: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(n.type==="undirected")return n.copy();var s=n.emptyCopy({type:"undirected"});return n.forEachUndirectedEdge(function(d,f,h,y){e(s,!0,d,h,y,f)}),n.forEachDirectedEdge(function(d,f,h,y){if(!n.multi){var v=s.edge(h,y);if(v){a&&s.replaceEdgeAttributes(v,a(s.getEdgeAttributes(v),f));return}}e(s,!0,null,h,y,f)}),s},Ho}var Yo,$c;function Em(){if($c)return Yo;$c=1;var r=je();return Yo=function(t,n){if(!r(t)||!r(n))throw new Error("graphology-operators/union: invalid graph.");if(t.multi!==n.multi)throw new Error("graphology-operators/union: both graph should be simple or multi.");var i=t.copy();return i.import(n,!0),i},Yo}var Gc;function xm(){return Gc||(Gc=1,vn.disjointUnion=fm(),vn.reverse=pm(),vn.subgraph=gm(),vn.toDirected=ym(),vn.toMixed=vm(),vn.toMulti=mm(),vn.toSimple=bm(),vn.toUndirected=wm(),vn.union=Em()),vn}var Rr=xm();function _m(r){r.prototype.updateSelectedNodesName=function(e){this.updateSelectedNodesAttributes({label:e})},r.prototype.updateSelectedNodesInfo=function(e){this.updateSelectedNodesAttributes({desc:e})},r.prototype.setDefaultNodeWeight=function(e=1){this.updateEachNodeAttributes((t,n)=>({...n,weight:e}))},r.prototype.getNodesForD3=function(){return this.nodes().map(e=>({...this.getNodeAttributes(e),id:Number(e)}))},r.prototype.selectNode=function(e){this.setNodeAttribute(e,"selected",!0)},r.prototype.deselectNode=function(e){this.setNodeAttribute(e,"selected",!1)},r.prototype.toggleNodeSelection=function(e){if((this.getNodeAttribute(e,"selected")||0)>0)this.setNodeAttribute(e,"selected",0);else{let n=0;this.forEachNode((i,a)=>{a.selected>n&&(n=a.selected)}),this.setNodeAttribute(e,"selected",n+1)}},r.prototype.getSelectedNodes=function(){return this.filterNodes((e,t)=>t.selected>0).sort((e,t)=>this.getNodeAttribute(e,"selected")-this.getNodeAttribute(t,"selected"))},r.prototype.updateSelectedNodesColor=function(e,t,n){!e||!t||!n?e?this.updateSelectedNodesAttributes({color:e}):t?this.updateSelectedNodesAttributes({stroke:t}):n&&this.updateSelectedNodesAttributes({labelColor:n}):this.updateSelectedNodesAttributes({color:e,stroke:t,labelColor:n})},r.prototype.updateSelectedNodesAttributes=function(e){this.getSelectedNodes().forEach(t=>{this.mergeNodeAttributes(t,e)})},r.prototype.connectSelectedNodes=function(e,t="directed"){const n=this.getSelectedNodes();if(!(n.length<1)){if(n.length>1)for(let i=0;i<n.length;i++)for(let a=i+1;a<n.length;a++){const s=n[i],d=n[a],f={color:e,selected:!1};this.type==="mixed"?t==="undirected"?this.mergeUndirectedEdge(s,d,f):this.mergeDirectedEdge(s,d,f):this.mergeEdge(s,d,f)}else if(this.allowSelfLoops){const i=n[0],a={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(i,i,a):this.mergeDirectedEdge(i,i,a)}}},r.prototype.connectSelectedNodesInOrder=function(e,t="directed"){const n=this.getSelectedNodes();for(let i=0;i<n.length-1;i++){const a=n[i],s=n[i+1],d={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(a,s,d):this.mergeDirectedEdge(a,s,d)}}}function Sm(r){r.prototype.setDefaultEdgeWeight=function(e=1){this.updateEachEdgeAttributes((t,n)=>({...n,weight:e}))},r.prototype.getEdgeSourceTarget=function(e){return[this.source(e),this.target(e)]},r.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},r.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})},r.prototype.getEdgesForD3=function(){return this.edges().map(e=>{const{source:t,target:n,...i}=this.getEdgeAttributes(e);return{source:Number(t),target:Number(n),...i}})},r.prototype.selectEdge=function(e){this.setEdgeAttribute(e,"selected",!0)},r.prototype.deselectEdge=function(e){this.setEdgeAttribute(e,"selected",!1)},r.prototype.toggleEdgeSelection=function(e){if((this.getEdgeAttribute(e,"selected")||0)>0)this.setEdgeAttribute(e,"selected",0);else{let n=0;this.forEachEdge((i,a)=>{a.selected>n&&(n=a.selected)}),this.setEdgeAttribute(e,"selected",n+1)}},r.prototype.getSelectedEdges=function(){return this.filterEdges((e,t)=>t.selected>0).sort((e,t)=>this.getEdgeAttribute(e,"selected")-this.getEdgeAttribute(t,"selected"))},r.prototype.updateSelectedEdgesAttributes=function(e){this.getSelectedEdges().forEach(t=>{this.mergeEdgeAttributes(t,e)})},r.prototype.updateSelectedEdgesColor=function(e,t){const n={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedEdgesAttributes(n)},r.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},r.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})}}function Am(r){r.prototype.addFace=function(e,t){const n=e.join("_");t={...t,key:n,id:this._faces.size,nodes:e,color:this.colors.face_color,labelColor:this.colors.label_color};var i=new km(n,e,t);this._faces.set(n,i)},r.prototype.faces=function(){return Array.from(this._faces.keys())},r.prototype.findFace=function(e){return e.sort(),e.join("_")},r.prototype.dropFace=function(e){this._faces.has(e)&&this._faces.delete(e)},r.prototype.hasFace=function(e){return this._faces.has(e)},r.prototype.faceNodeNeighbors=function(e){const t=[];return this.forEachFace((n,i)=>{i.nodes.includes(e)&&t.push(n)}),t},r.prototype.faceEdgeNeighbors=function(e){const{source:t,target:n}=this.getEdgeAttributes(e),i=[];return this.forEachFace((a,s)=>{s.nodes.includes(""+t)&&s.nodes.includes(""+n)&&i.push(a)}),i},r.prototype.forEachFace=function(e){for(const t of this._faces.values())e(t.key,t.attributes)},r.prototype.setFaceAttribute=function(e,t,n){this._faces.get(e).attributes[t]=n},r.prototype.getFaceAttribute=function(e,t){return this._faces.get(e).attributes[t]},r.prototype.getFaceAttributes=function(e){return this._faces.get(e).attributes},r.prototype.selectFace=function(e){this.setFaceAttribute(e,"selected",!0)},r.prototype.deselectFace=function(e){this.setFaceAttribute(e,"selected",!1)},r.prototype.toggleFaceSelection=function(e){if((this.getFaceAttribute(e,"selected")||0)>0)this.setFaceAttribute(e,"selected",0);else{let n=0;this.forEachFace((i,a)=>{a.selected>n&&(n=a.selected)}),this.setFaceAttribute(e,"selected",n+1)}},r.prototype.getSelectedFaces=function(){return this.faces().filter(e=>this.getFaceAttributes(e).selected>0).sort((e,t)=>this.getFaceAttribute(e,"selected")-this.getFaceAttribute(t,"selected"))},r.prototype.updateSelectedFacesAttributes=function(e){this.getSelectedFaces().forEach(t=>{const n=this.getFaceAttributes(t);this._faces.get(t).attributes={...n,...e}})},r.prototype.updateSelectedFacesColor=function(e,t){const n={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedFacesAttributes(n)},r.prototype.updateSelectedFacesName=function(e){this.updateSelectedFacesAttributes({label:e})},r.prototype.updateSelectedFacesInfo=function(e){this.updateSelectedFacesAttributes({desc:e})},r.prototype.updateSelectedFacesWeight=function(e){this.updateSelectedFacesAttributes({weight:e})},r.prototype.deleteSelectedFaces=function(){this.getSelectedFaces().forEach(e=>this.dropFace(e))}}class km{constructor(e,t,n){this.key=e,this.attributes=n,this.nodes=t}}class hr extends Qe{constructor(e){super(e),this.isCustom=!0,this.defaultColors={edge_color:"#4682b4",label_color:"#000000",node_color:"#ffffff",face_color:"#4682b455",stroke_color:"#4682b4"},this.colors=this.defaultColors,this._faces=new Map,this.events()}events(){this.on("nodeAdded",({key:e})=>{const t=this.getNodeAttributes(e);t.id||this.setNodeAttribute(e,"id",+e),t.label===void 0&&this.setNodeAttribute(e,"label",ea(t.id)),t.weight===void 0&&this.setNodeAttribute(e,"weight",void 0),t.color===void 0&&this.setNodeAttribute(e,"color",this.colors.node_color),t.stroke===void 0&&this.setNodeAttribute(e,"stroke",this.colors.stroke_color),t.labelColor===void 0&&this.setNodeAttribute(e,"labelColor",this.colors.label_color),t.selected===void 0&&this.setNodeAttribute(e,"selected",!1),t.size===void 0&&this.setNodeAttribute(e,"size",.25),t.magnitude===void 0&&this.setNodeAttribute(e,"magnitude",1),t.desc===void 0&&this.setNodeAttribute(e,"desc",{})}),this.on("edgeAdded",({key:e,source:t,target:n})=>{const i=this.getEdgeAttributes(e);i.id||this.setEdgeAttribute(e,"id",this.size-1),i.label===void 0&&this.setEdgeAttribute(e,"label",ea(i.id)),i.weight===void 0&&this.setEdgeAttribute(e,"weight",void 0),i.color===void 0&&this.setEdgeAttribute(e,"color",this.colors.edge_color),i.labelColor===void 0&&this.setEdgeAttribute(e,"labelColor",this.colors.label_color),i.source||this.setEdgeAttribute(e,"source",Number(t)),i.target||this.setEdgeAttribute(e,"target",Number(n)),i.selected===void 0&&this.setEdgeAttribute(e,"selected",!1),i.desc===void 0&&this.setEdgeAttribute(e,"desc",{})})}validateSettings(e={}){return Object.fromEntries(Object.keys(this.defaultColors).map(t=>[t,t in e?e[t]:this.defaultColors[t]]))}nullCopy(e){var t=new hr(so({},this._options,e));return t.replaceAttributes(so({},this.getAttributes())),t}deselectAll(){this.updateEachNodeAttributes((e,t)=>({...t,selected:0})),this.updateEachEdgeAttributes((e,t)=>({...t,selected:!1}))}deleteSelected(){this.getSelectedEdges().forEach(e=>this.dropEdge(e)),this.getSelectedNodes().forEach(e=>this.dropNode(e))}updateSelectedName(e){this.updateSelectedNodesAttributes({label:e}),this.updateSelectedEdgesAttributes({label:e}),this.updateSelectedFacesAttributes({label:e})}updateSelectedInfo(e){this.updateSelectedNodesAttributes({desc:e}),this.updateSelectedEdgesAttributes({desc:e}),this.updateSelectedFacesAttributes({desc:e})}updateSelectedWeight(e){this.updateSelectedNodesAttributes({weight:e}),this.updateSelectedEdgesAttributes({weight:e}),this.updateSelectedFacesAttributes({weight:e})}selectPath(e){this.deselectAll(),e.forEach(t=>{this.hasNode(t)&&this.selectNode(t)});for(let t=0;t<e.length-1;t++){const n=e[t],i=e[t+1];if(this.hasEdge(n,i)){const a=this.edge(n,i);this.selectEdge(a)}}}copySubgraph(){const e=this.getSelectedNodes();return e.length===0?null:this.subgraph(e)}cutSubgraph(){const e=this.copySubgraph();return e&&this.deleteSelected(),e}pasteSubgraph(e,t=!1,n={x:0,y:0}){if(!e)return;e.forEachNode((a,s)=>{const d={...s};"x"in d&&(d.x+=n.x),"y"in d&&(d.y+=n.y),e.replaceNodeAttributes(a,d)}),this.deselectAll();let i;return t?(i=Rr.union(this,e),this.clear(),this.import(i.export())):this.disjointUnion(this,e),e}replace(e){this.clear(),this.import(e.export())}dropNode(e){const t=this.faceNodeNeighbors(e);t.length&&t.map(n=>{this.dropFace(n)}),super.dropNode(e)}dropEdge(e){var t;if(arguments.length>1){var n=""+arguments[0],i=""+arguments[1];this.findEdge(n,i,s=>{t=s})}else t=e;const a=this.faceEdgeNeighbors(t);a.length&&a.map(s=>{this.dropFace(s)}),super.dropEdge(t)}export(){const e=super.export();e.attributes.selected=!1;var t=new Array(this._faces.size),n=0;return this._faces.forEach(function(i,a){t[n++]=Dm(a,i)}),e.faces=t,e}import(e){const t=super.import(e);if(typeof e.faces=="function")e.forEachFace((n,i)=>{t.addFace(i.nodes,i)});else for(const n of e.faces)t.addFace(n.nodes,n.attributes);return t}subgraph(e){const t=this.nullCopy();if(!e||Array.isArray(e)&&e.length===0||e instanceof Set&&e.size===0)return t;const n=new Set(e);for(const i of n)t.addNode(i,this.getNodeAttributes(i));return this.forEachEdge((i,a,s,d,f,h,y)=>{n.has(s)&&n.has(d)&&(y?t.addUndirectedEdgeWithKey(i,s,d,a):t.addDirectedEdgeWithKey(i,s,d,a))}),this.forEachFace((i,a)=>{(a.nodes||[]).every(d=>n.has(d))&&t.addFace(a.nodes,a)}),t}disjointUnion(e,t){if(e.multi!==t.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");e.mergeAttributes(e.getAttributes());var n={},i=Math.max(...e.nodes())+1;return t.forEachNode(function(a,s){n[a]=i,e.addNode(i++,s)}),i=Math.max(...e.edges())+1,t.forEachEdge(function(a,s,d,f,h,y,v){v?e.addUndirectedEdge(n[d],n[f],{...s,id:i++}):e.addDirectedEdge(n[d],n[f],{...s,id:i++})}),i=Math.max(...e.faces())+1,t.forEachFace((a,s)=>{e.addFace(s.nodes.map(d=>n[d]),{...s,id:i++})}),e}clear(){this._faces.clear(),this._edges.clear(),this._nodes.clear()}}function Cm(){for(var r=arguments[0],e=1,t=arguments.length;e<t;e++)if(arguments[e])for(var n in arguments[e])r[n]=arguments[e][n];return r}var so=Cm;typeof Object.assign=="function"&&(so=Object.assign);function Dm(r,e){var t={key:r,nodes:e.nodes};return Object.keys(e.attributes).length&&(t.attributes=so({},e.attributes)),t}_m(hr);Sm(hr);Am(hr);class Im extends hr{constructor(e={}){const t=Object.assign({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new InvalidArgumentsGraphError(`DirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}class Mm extends hr{constructor(e={}){const t=Object.assign({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new InvalidArgumentsGraphError(`UndirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}var si={},Xo,qc;function xn(){return qc||(qc=1,Xo=function(e){return e!==null&&typeof e=="function"&&typeof e.prototype=="object"&&typeof e.prototype.addUndirectedEdgeWithKey=="function"&&typeof e.prototype.dropNode=="function"}),Xo}var Vo,Fc;function Pm(){if(Fc)return Vo;Fc=1;var r=xn();return Vo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/complete: invalid Graph constructor.");var i=new t,a,s;for(a=0;a<n;a++)i.addNode(a);for(a=0;a<n;a++)for(s=a+1;s<n;s++)i.type!=="directed"&&i.addUndirectedEdge(a,s),i.type!=="undirected"&&(i.addDirectedEdge(a,s),i.addDirectedEdge(s,a));return i},Vo}var Qo,jc;function qu(){if(jc)return Qo;jc=1;var r=xn();return Qo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/empty: invalid Graph constructor.");var i=new t,a;for(a=0;a<n;a++)i.addNode(a);return i},Qo}var Zo,Bc;function Nm(){if(Bc)return Zo;Bc=1;var r=xn();return Zo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/ladder: invalid Graph constructor.");var i=new t,a;for(a=0;a<n-1;a++)i.mergeEdge(a,a+1);for(a=n;a<n*2-1;a++)i.mergeEdge(a,a+1);for(a=0;a<n;a++)i.addEdge(a,a+n);return i},Zo}var Jo,Uc;function Om(){if(Uc)return Jo;Uc=1;var r=xn();return Jo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/path: invalid Graph constructor.");for(var i=new t,a=0;a<n-1;a++)i.mergeEdge(a,a+1);return i},Jo}var Kc;function Tm(){return Kc||(Kc=1,si.complete=Pm(),si.empty=qu(),si.ladder=Nm(),si.path=Om()),si}var Wn=Tm(),mn={},es,Wc;function Rm(){if(Wc)return es;Wc=1;function r(e){this.graph=e,this.stack=new Array(e.order),this.seen=new Set,this.size=0}return r.prototype.hasAlreadySeenEverything=function(){return this.seen.size===this.graph.order},r.prototype.countUnseenNodes=function(){return this.graph.order-this.seen.size},r.prototype.forEachNodeYetUnseen=function(e){var t=this.seen,n=this.graph;n.someNode(function(i,a){if(t.size===n.order)return!0;if(t.has(i))return!1;var s=e(i,a);return!!s})},r.prototype.has=function(e){return this.seen.has(e)},r.prototype.push=function(e){var t=this.seen.size;return this.seen.add(e),t===this.seen.size?!1:(this.stack[this.size++]=e,!0)},r.prototype.pushWith=function(e,t){var n=this.seen.size;return this.seen.add(e),n===this.seen.size?!1:(this.stack[this.size++]=t,!0)},r.prototype.pop=function(){if(this.size!==0)return this.stack[--this.size]},es=r,es}var Hc;function Lm(){if(Hc)return mn;Hc=1;var r=je(),e=Gu().copyNode,t=Vn().copyEdge,n=Rm();function i(_,D){if(!r(_))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(_.order){var k=new n(_),N=k.push.bind(k);k.forEachNodeYetUnseen(function(O){var M=[];k.push(O);for(var z;k.size!==0;)z=k.pop(),M.push(z),_.forEachNeighbor(z,N);D(M)})}}function a(_,D){if(!r(_))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(_.order){var k=new n(_),N=k.push.bind(k);k.forEachNodeYetUnseen(function(O){var M=0;k.push(O);for(var z;k.size!==0;)z=k.pop(),M++,_.forEachNeighbor(z,N);D(M)})}}function s(_,D,k){if(!r(_))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!_.order)return;var N=new n(_),O;function M(z,A,T,K,S,G,q){O===K&&(K=T),D(z,A,T,K,S,G,q)&&N.push(K)}N.forEachNodeYetUnseen(function(z){var A=0;for(N.push(z);N.size!==0;)O=N.pop(),A++,_.forEachEdge(O,M);k(A)})}function d(_){var D=0;return a(_,function(){D++}),D}function f(_){var D=[];return i(_,function(k){D.push(k)}),D}function h(_){if(!r(_))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!_.order)return[];var D=new n(_),k=D.push.bind(D),N=[],O;return D.forEachNodeYetUnseen(function(M){O=[],D.push(M);for(var z;D.size!==0;)z=D.pop(),O.push(z),_.forEachNeighbor(z,k);return O.length>N.length&&(N=O),N.length>D.countUnseenNodes()}),N}function y(_){var D=h(_),k=_.nullCopy();return D.forEach(function(N){e(k,N,_.getNodeAttributes(N))}),_.forEachEdge(function(N,O,M,z,A,T,K){k.hasNode(M)&&t(k,K,N,M,z,O)}),k}function v(_){var D=new Set(h(_));_.forEachNode(function(k){D.has(k)||_.dropNode(k)})}function w(_){if(!r(_))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!_.order)return[];if(_.type==="undirected")throw new Error("graphology-components: the given graph is undirected");var D=_.nodes(),k=[],N,O;if(!_.size){for(N=0,O=D.length;N<O;N++)k.push([D[N]]);return k}var M=1,z=[],A=[],T=new Map,K=new Set,S,G,q,F=function(W){var Z,j=_.outboundNeighbors(W),ve;T.set(W,M++),z.push(W),A.push(W);for(var ge=0,X=j.length;ge<X;ge++)if(Z=j[ge],T.has(Z)){if(ve=T.get(Z),!K.has(Z))for(;T.get(z[z.length-1])>ve;)z.pop()}else F(Z);if(T.get(z[z.length-1])===T.get(W)){S=[];do G=A.pop(),S.push(G),K.add(G);while(G!==W);k.push(S),z.pop()}};for(N=0,O=D.length;N<O;N++)q=D[N],K.has(q)||F(q);return k}return mn.forEachConnectedComponent=i,mn.forEachConnectedComponentOrder=a,mn.forEachConnectedComponentOrderWithEdgeFilter=s,mn.countConnectedComponents=d,mn.connectedComponents=f,mn.largestConnectedComponent=h,mn.largestConnectedComponentSubgraph=y,mn.cropToLargestConnectedComponent=v,mn.stronglyConnectedComponents=w,mn}var qa=Lm(),Pn={},Nr={},ts,Yc;function Fu(){if(Yc)return ts;Yc=1;var r=lh(),e=r.ARRAY_BUFFER_SUPPORT,t=r.SYMBOL_SUPPORT;return ts=function(i,a){var s,d,f,h,y;if(!i)throw new Error("obliterator/forEach: invalid iterable.");if(typeof a!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(i)||e&&ArrayBuffer.isView(i)||typeof i=="string"||i.toString()==="[object Arguments]"){for(f=0,h=i.length;f<h;f++)a(i[f],f);return}if(typeof i.forEach=="function"){i.forEach(a);return}if(t&&Symbol.iterator in i&&typeof i.next!="function"&&(i=i[Symbol.iterator]()),typeof i.next=="function"){for(s=i,f=0;y=s.next(),y.done!==!0;)a(y.value,f),f++;return}for(d in i)i.hasOwnProperty(d)&&a(i[d],d)},ts}var ns,Xc;function zm(){if(Xc)return ns;Xc=1;var r=qr(),e=Fu();function t(){this.clear()}return t.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},t.prototype.enqueue=function(n){return this.items.push(n),++this.size},t.prototype.dequeue=function(){if(this.size){var n=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,n}},t.prototype.peek=function(){if(this.size)return this.items[this.offset]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=this.offset,s=0,d=this.items.length;a<d;a++,s++)n.call(i,this.items[a],s,this)},t.prototype.toArray=function(){return this.items.slice(this.offset)},t.prototype.values=function(){var n=this.items,i=this.offset;return new r(function(){if(i>=n.length)return{done:!0};var a=n[i];return i++,{value:a,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.offset,a=0;return new r(function(){if(i>=n.length)return{done:!0};var s=n[i];return i++,{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var n=this.toArray();return Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n){var i=new t;return e(n,function(a){i.enqueue(a)}),i},t.of=function(){return t.from(arguments)},ns=t,ns}var rs,Vc;function $m(){return Vc||(Vc=1,rs=function(e,t){var n=t.length;if(n!==0){var i=e.length;e.length+=n;for(var a=0;a<n;a++)e[i+a]=t[a]}}),rs}var Qc;function ju(){if(Qc)return Nr;Qc=1;var r=je(),e=zm(),t=$m();function n(h,y,v){if(!r(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');if(!h.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" target node does not exist in the given graph.');if(y=""+y,v=""+v,y===v)return[y];var w=h.inboundNeighbors.bind(h),_=h.outboundNeighbors.bind(h),D={},k={};D[y]=null,k[v]=null;var N=[y],O=[v],M,z,A,T,K,S,G,q,F=!1;e:for(;N.length&&O.length;)if(N.length<=O.length){for(M=N,N=[],K=0,G=M.length;K<G;K++)for(z=M[K],A=_(z),S=0,q=A.length;S<q;S++)if(T=A[S],T in D||(N.push(T),D[T]=z),T in k){F=!0;break e}}else for(M=O,O=[],K=0,G=M.length;K<G;K++)for(z=M[K],A=w(z),S=0,q=A.length;S<q;S++)if(T=A[S],T in k||(O.push(T),k[T]=z),T in D){F=!0;break e}if(!F)return null;for(var W=[];T;)W.unshift(T),T=D[T];for(T=k[W[W.length-1]];T;)W.push(T),T=k[T];return W.length?W:null}function i(h,y){if(!r(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');y=""+y;var v={},w={},_,D,k,N,O,M;for(v[y]=!0,w[y]=[y];Object.keys(v).length;){_=v,v={};for(k in _)for(D=h.outboundNeighbors(k),O=0,M=D.length;O<M;O++)N=D[O],w[N]||(w[N]=w[k].concat(N),v[N]=!0)}return w}function a(h,y,v){if(!r(y))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!y.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" source node does not exist in the given graph.');v=""+v;var w=new Set,_={},D=0;_[v]=0;for(var k=[v],N,O,M;k.length!==0;){var z=[];for(N=0,O=k.length;N<O;N++)M=k[N],!w.has(M)&&(w.add(M),t(z,y[h](M)),_[M]=D);D++,k=z}return _}var s=a.bind(null,"outboundNeighbors"),d=a.bind(null,"neighbors");function f(h,y){y=""+y;var v=[],w={},_={},D=h.nodes(),k,N,O,M,z,A,T,K,S;for(A=0,K=D.length;A<K;A++)M=D[A],w[M]=[],_[M]=0;var G={};_[y]=1,G[y]=0;for(var q=e.of(y);q.size;)for(M=q.dequeue(),v.push(M),k=G[M],N=_[M],O=h.outboundNeighbors(M),T=0,S=O.length;T<S;T++)z=O[T],z in G||(q.enqueue(z),G[z]=k+1),G[z]===k+1&&(_[z]+=N,w[z].push(M));return[v,w,_]}return Nr.bidirectional=n,Nr.singleSource=i,Nr.singleSourceLength=s,Nr.undirectedSingleSourceLength=d,Nr.brandes=f,Nr}var is={},Zc;function Gm(){if(Zc)return is;Zc=1;var r=function(){return!0};return is.edgePathFromNodePath=function(e,t){var n=t.length,i,a,s,d;if(n<2)return a=t[0],d=e.multi?e.findEdge(a,a,r):e.edge(a,a),d?[d]:[];n--;var f=new Array(n);for(i=0;i<n;i++){if(a=t[i],s=t[i+1],d=e.multi?e.findOutboundEdge(a,s,r):e.edge(a,s),d===void 0)throw new Error("graphology-shortest-path: given path is impossible in given graph.");f[i]=d}return f},is}var Wi={},Hi={},Jc;function Fr(){if(Jc)return Hi;Jc=1;function r(n){return typeof n!="number"||isNaN(n)?1:n}function e(n,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var d=function(h){return s(h[n])},f=function(){return s(void 0)};return typeof n=="string"?(a.fromAttributes=d,a.fromGraph=function(h,y){return d(h.getNodeAttributes(y))},a.fromEntry=function(h,y){return d(y)}):typeof n=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){return s(n(y,h.getNodeAttributes(y)))},a.fromEntry=function(h,y){return s(n(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f),a}function t(n,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var d=function(h){return s(h[n])},f=function(){return s(void 0)};return typeof n=="string"?(a.fromAttributes=d,a.fromGraph=function(h,y){return d(h.getEdgeAttributes(y))},a.fromEntry=function(h,y){return d(y)},a.fromPartialEntry=a.fromEntry,a.fromMinimalEntry=a.fromEntry):typeof n=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){var v=h.extremities(y);return s(n(y,h.getEdgeAttributes(y),v[0],v[1],h.getNodeAttributes(v[0]),h.getNodeAttributes(v[1]),h.isUndirected(y)))},a.fromEntry=function(h,y,v,w,_,D,k){return s(n(h,y,v,w,_,D,k))},a.fromPartialEntry=function(h,y,v,w){return s(n(h,y,v,w))},a.fromMinimalEntry=function(h,y){return s(n(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f,a.fromMinimalEntry=f),a}return Hi.createNodeValueGetter=e,Hi.createEdgeValueGetter=t,Hi.createEdgeWeightGetter=function(n){return t(n,r)},Hi}var ui={},el;function Bu(){if(el)return ui;el=1;var r=function(i,a){return i<a?-1:i>a?1:0},e=function(i,a){return i<a?1:i>a?-1:0};function t(i){return function(a,s){return i(s,a)}}function n(i){return i===2?function(a,s){return a[0]<s[0]?-1:a[0]>s[0]?1:a[1]<s[1]?-1:a[1]>s[1]?1:0}:function(a,s){for(var d=0;d<i;){if(a[d]<s[d])return-1;if(a[d]>s[d])return 1;d++}return 0}}return ui.DEFAULT_COMPARATOR=r,ui.DEFAULT_REVERSE_COMPARATOR=e,ui.reverseComparator=t,ui.createTupleComparator=n,ui}var ci={},as={},tl;function ua(){return tl||(tl=1,function(r){var e=Math.pow(2,8)-1,t=Math.pow(2,16)-1,n=Math.pow(2,32)-1,i=Math.pow(2,7)-1,a=Math.pow(2,15)-1,s=Math.pow(2,31)-1;r.getPointerArray=function(f){var h=f-1;if(h<=e)return Uint8Array;if(h<=t)return Uint16Array;if(h<=n)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},r.getSignedPointerArray=function(f){var h=f-1;return h<=i?Int8Array:h<=a?Int16Array:h<=s?Int32Array:Float64Array},r.getNumberType=function(f){return f===(f|0)?Math.sign(f)===-1?f<=127&&f>=-128?Int8Array:f<=32767&&f>=-32768?Int16Array:Int32Array:f<=255?Uint8Array:f<=65535?Uint16Array:Uint32Array:Float64Array};var d={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};r.getMinimalRepresentation=function(f,h){var y=null,v=0,w,_,D,k,N;for(k=0,N=f.length;k<N;k++)D=h?h(f[k]):f[k],_=r.getNumberType(D),w=d[_.name],w>v&&(v=w,y=_);return y},r.isTypedArray=function(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(f)},r.concat=function(){var f=0,h,y,v;for(h=0,v=arguments.length;h<v;h++)f+=arguments[h].length;var w=new arguments[0].constructor(f);for(h=0,y=0;h<v;h++)w.set(arguments[h],y),y+=arguments[h].length;return w},r.indices=function(f){for(var h=r.getPointerArray(f),y=new h(f),v=0;v<f;v++)y[v]=v;return y}}(as)),as}var nl;function po(){if(nl)return ci;nl=1;var r=Fu(),e=ua();function t(s){return Array.isArray(s)||e.isTypedArray(s)}function n(s){if(typeof s.length=="number")return s.length;if(typeof s.size=="number")return s.size}function i(s){var d=n(s),f=typeof d=="number"?new Array(d):[],h=0;return r(s,function(y){f[h++]=y}),f}function a(s){var d=n(s),f=typeof d=="number"?e.getPointerArray(d):Array,h=typeof d=="number"?new Array(d):[],y=typeof d=="number"?new f(d):[],v=0;return r(s,function(w){h[v]=w,y[v]=v++}),[h,y]}return ci.isArrayLike=t,ci.guessLength=n,ci.toArray=i,ci.toArrayWithIndices=a,ci}var os,rl;function Uu(){if(rl)return os;rl=1;var r=Fu(),e=Bu(),t=po(),n=e.DEFAULT_COMPARATOR,i=e.reverseComparator;function a(O,M,z,A){for(var T=M[A],K,S;A>z;){if(K=A-1>>1,S=M[K],O(T,S)<0){M[A]=S,A=K;continue}break}M[A]=T}function s(O,M,z){for(var A=M.length,T=z,K=M[z],S=2*z+1,G;S<A;)G=S+1,G<A&&O(M[S],M[G])>=0&&(S=G),M[z]=M[S],z=S,S=2*z+1;M[z]=K,a(O,M,T,z)}function d(O,M,z){M.push(z),a(O,M,0,M.length-1)}function f(O,M){var z=M.pop();if(M.length!==0){var A=M[0];return M[0]=z,s(O,M,0),A}return z}function h(O,M,z){if(M.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var A=M[0];return M[0]=z,s(O,M,0),A}function y(O,M,z){var A;return M.length!==0&&O(M[0],z)<0&&(A=M[0],M[0]=z,z=A,s(O,M,0)),z}function v(O,M){for(var z=M.length,A=z>>1,T=A;--T>=0;)s(O,M,T)}function w(O,M){for(var z=M.length,A=0,T=new Array(z);A<z;)T[A++]=f(O,M);return T}function _(O,M,z){arguments.length===2&&(z=M,M=O,O=n);var A=i(O),T,K,S,G=1/0,q;if(M===1){if(t.isArrayLike(z)){for(T=0,K=z.length;T<K;T++)S=z[T],(G===1/0||O(S,G)<0)&&(G=S);return q=new z.constructor(1),q[0]=G,q}return r(z,function(W){(G===1/0||O(W,G)<0)&&(G=W)}),[G]}if(t.isArrayLike(z)){if(M>=z.length)return z.slice().sort(O);for(q=z.slice(0,M),v(A,q),T=M,K=z.length;T<K;T++)A(z[T],q[0])>0&&h(A,q,z[T]);return q.sort(O)}var F=t.guessLength(z);return F!==null&&F<M&&(M=F),q=new Array(M),T=0,r(z,function(W){T<M?q[T]=W:(T===M&&v(A,q),A(W,q[0])>0&&h(A,q,W)),T++}),q.length>T&&(q.length=T),q.sort(O)}function D(O,M,z){arguments.length===2&&(z=M,M=O,O=n);var A=i(O),T,K,S,G=-1/0,q;if(M===1){if(t.isArrayLike(z)){for(T=0,K=z.length;T<K;T++)S=z[T],(G===-1/0||O(S,G)>0)&&(G=S);return q=new z.constructor(1),q[0]=G,q}return r(z,function(W){(G===-1/0||O(W,G)>0)&&(G=W)}),[G]}if(t.isArrayLike(z)){if(M>=z.length)return z.slice().sort(A);for(q=z.slice(0,M),v(O,q),T=M,K=z.length;T<K;T++)O(z[T],q[0])>0&&h(O,q,z[T]);return q.sort(A)}var F=t.guessLength(z);return F!==null&&F<M&&(M=F),q=new Array(M),T=0,r(z,function(W){T<M?q[T]=W:(T===M&&v(O,q),O(W,q[0])>0&&h(O,q,W)),T++}),q.length>T&&(q.length=T),q.sort(A)}function k(O){if(this.clear(),this.comparator=O||n,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}k.prototype.clear=function(){this.items=[],this.size=0},k.prototype.push=function(O){return d(this.comparator,this.items,O),++this.size},k.prototype.peek=function(){return this.items[0]},k.prototype.pop=function(){return this.size!==0&&this.size--,f(this.comparator,this.items)},k.prototype.replace=function(O){return h(this.comparator,this.items,O)},k.prototype.pushpop=function(O){return y(this.comparator,this.items,O)},k.prototype.consume=function(){return this.size=0,w(this.comparator,this.items)},k.prototype.toArray=function(){return w(this.comparator,this.items.slice())},k.prototype.inspect=function(){var O=this.toArray();return Object.defineProperty(O,"constructor",{value:k,enumerable:!1}),O},typeof Symbol<"u"&&(k.prototype[Symbol.for("nodejs.util.inspect.custom")]=k.prototype.inspect);function N(O){if(this.clear(),this.comparator=O||n,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=i(this.comparator)}return N.prototype=k.prototype,k.from=function(O,M){var z=new k(M),A;return t.isArrayLike(O)?A=O.slice():A=t.toArray(O),v(z.comparator,A),z.items=A,z.size=A.length,z},N.from=function(O,M){var z=new N(M),A;return t.isArrayLike(O)?A=O.slice():A=t.toArray(O),v(z.comparator,A),z.items=A,z.size=A.length,z},k.siftUp=s,k.siftDown=a,k.push=d,k.pop=f,k.replace=h,k.pushpop=y,k.heapify=v,k.consume=w,k.nsmallest=_,k.nlargest=D,k.MinHeap=k,k.MaxHeap=N,os=k,os}var il;function qm(){if(il)return Wi;il=1;var r=je(),e=Fr().createEdgeWeightGetter,t=Uu(),n="weight";function i(v,w){return v[0]>w[0]?1:v[0]<w[0]?-1:v[1]>w[1]?1:v[1]<w[1]?-1:v[2]>w[2]?1:v[2]<w[2]?-1:0}function a(v,w){return v[0]>w[0]?1:v[0]<w[0]?-1:v[1]>w[1]?1:v[1]<w[1]?-1:v[2]>w[2]?1:v[2]<w[2]?-1:v[3]>w[3]?1:v[3]<w[3]?-1:0}function s(v,w,_,D){if(w=""+w,_=""+_,!r(v))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(w&&!v.hasNode(w))throw new Error('graphology-shortest-path/dijkstra: the "'+w+'" source node does not exist in the given graph.');if(_&&!v.hasNode(_))throw new Error('graphology-shortest-path/dijkstra: the "'+_+'" target node does not exist in the given graph.');if(D=e(D||n).fromMinimalEntry,w===_)return[0,[w]];var k=[{},{}],N=[{},{}],O=[new t(i),new t(i)],M=[{},{}];N[0][w]=[w],N[1][_]=[_],M[0][w]=0,M[1][_]=0;var z=[],A=1/0,T=0,K=1,S,G,q,F,W,Z,j,ve,ge;for(O[0].push([0,T++,w]),O[1].push([0,T++,_]);O[0].size&&O[1].size;)if(K=1-K,S=O[K].pop(),F=S[0],W=S[2],!(W in k[K])){if(k[K][W]=F,W in k[1-K])return[A,z];for(G=K===1?v.inboundEdges(W):v.outboundEdges(W),ve=0,ge=G.length;ve<ge;ve++){if(j=G[ve],Z=v.opposite(W,j),q=k[K][W]+D(j,v.getEdgeAttributes(j)),Z in k[K]&&q<k[K][Z])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(Z in M[K])||q<M[K][Z])&&(M[K][Z]=q,O[K].push([q,T++,Z]),N[K][Z]=N[K][W].concat(Z),Z in M[0]&&Z in M[1]&&(F=M[0][Z]+M[1][Z],(z.length===0||A>F)&&(A=F,z=N[0][Z].concat(N[1][Z].slice(0,-1).reverse()))))}}return[1/0,null]}function d(v,w,_,D,k,N){if(!r(v))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");_=e(_||n).fromMinimalEntry;var O={},M={},z=new t(i),A=0,T,K,S,G,q,F,W,Z,j,ve,ge;for(Z=0,ve=w.length;Z<ve;Z++)G=w[Z],M[G]=0,z.push([0,A++,G]),N[G]=[G];for(;z.size;)if(K=z.pop(),W=K[0],G=K[2],!(G in O)){if(O[G]=W,G===k)break;for(T=v.outboundEdges(G),j=0,ge=T.length;j<ge;j++){if(F=T[j],q=v.opposite(G,F),S=_(F,v.getEdgeAttributes(F))+O[G],q in O&&S<O[q])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(q in M)||S<M[q])&&(M[q]=S,z.push([S,A++,q]),N[q]=N[G].concat(q))}}return O}function f(v,w,_){var D={};return d(v,[w],_,0,null,D),D}function h(v,w,_,D){return s(v,w,_,D)[1]}function y(v,w,_){w=""+w,_=e(_||n).fromMinimalEntry;var D=[],k={},N={},O=v.nodes(),M,z,A,T,K,S,G,q,F,W;for(F=0,W=O.length;F<W;F++)S=O[F],k[S]=[],N[S]=0;var Z={};N[w]=1;var j={};j[w]=0;var ve=0,ge=new t(a);for(ge.push([0,ve++,w,w]);ge.size;)if(z=ge.pop(),T=z[0],A=z[2],S=z[3],!(S in Z))for(N[S]+=N[A],D.push(S),Z[S]=T,M=v.outboundEdges(S),F=0,W=M.length;F<W;F++)q=M[F],G=v.opposite(S,q),K=T+_(q,v.getEdgeAttributes(q)),!(G in Z)&&(!(G in j)||K<j[G])?(j[G]=K,ge.push([K,ve++,S,G]),N[G]=0,k[G]=[S]):K===j[G]&&(N[G]+=N[S],k[G].push(S));return[D,k,N]}return Wi.bidirectional=h,Wi.singleSource=f,Wi.brandes=y,Wi}var al;function Fm(){if(al)return Pn;al=1;var r=ju(),e=Gm();return Pn.unweighted=r,Pn.dijkstra=qm(),Pn.bidirectional=r.bidirectional,Pn.singleSource=r.singleSource,Pn.singleSourceLength=r.singleSourceLength,Pn.undirectedSingleSourceLength=r.undirectedSingleSourceLength,Pn.brandes=r.brandes,Pn.edgePathFromNodePath=e.edgePathFromNodePath,Pn}var ol=Fm(),Dt={},Nn={},ss,sl;function Dh(){if(sl)return ss;sl=1;var r=je();return ss=function(t){if(!r(t))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!t.multi)return t.size;var n=0,i=0;function a(){n++}function s(){i++}return t.forEachNode(function(d){t.type!=="directed"&&t.forEachUndirectedNeighbor(d,a),t.type!=="undirected"&&t.forEachOutNeighbor(d,s)}),n/2+i},ss}var ul;function Ih(){if(ul)return Nn;ul=1;var r=je(),e=Dh();function t(s,d){return 2*d/(s*(s-1))}function n(s,d){return d/(s*(s-1))}function i(s,d){var f=s*(s-1);return d/(f+f/2)}function a(s,d,f){var h,y;if(arguments.length>3){if(h=f,y=arguments[3],typeof h!="number"||h<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof y!="number"||y<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!r(f))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");h=f.order,y=f.size,f.multi&&d===!1&&(y=e(f))}if(h<2)return 0;s===null&&(s=f.type),d===null&&(d=f.multi);var v;return s==="undirected"?v=t:s==="directed"?v=n:v=i,v(h,y)}return Nn.abstractDensity=a,Nn.density=a.bind(null,null,null),Nn.directedDensity=a.bind(null,"directed",!1),Nn.undirectedDensity=a.bind(null,"undirected",!1),Nn.mixedDensity=a.bind(null,"mixed",!1),Nn.multiDirectedDensity=a.bind(null,"directed",!0),Nn.multiUndirectedDensity=a.bind(null,"undirected",!0),Nn.multiMixedDensity=a.bind(null,"mixed",!0),Nn}var Fa={},cl;function jm(){if(cl)return Fa;cl=1;var r=je();function e(n,i){if(!r(n))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,d,f,h={};for(f=0;f<a.length;f++)d=a[f],h[d]=[1/0,-1/0];return n.forEachNode(function(y,v){for(f=0;f<a.length;f++)d=a[f],s=v[d],s<h[d][0]&&(h[d][0]=s),s>h[d][1]&&(h[d][1]=s)}),typeof i=="string"?h[i]:h}function t(n,i){if(!r(n))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,d,f,h={};for(f=0;f<a.length;f++)d=a[f],h[d]=[1/0,-1/0];return n.forEachEdge(function(y,v){for(f=0;f<a.length;f++)d=a[f],s=v[d],s<h[d][0]&&(h[d][0]=s),s>h[d][1]&&(h[d][1]=s)}),typeof i=="string"?h[i]:h}return Fa.nodeExtent=e,Fa.edgeExtent=t,Fa}var us,ll;function Ku(){if(ll)return us;ll=1;var r=je(),e=ju().singleSourceLength;return us=function(n,i){if(!r(n))throw new Error("graphology-metrics/eccentricity: given graph is not a valid graphology instance.");if(n.size===0)return 1/0;var a=-1/0,s=e(n,i),d,f,h=0;for(d in s)f=s[d],f>a&&(a=f),h++;return h<n.order?1/0:a},us}var cs,dl;function Bm(){if(dl)return cs;dl=1;var r=je(),e=Ku();return cs=function(n){if(!r(n))throw new Error("graphology-metrics/diameter: given graph is not a valid graphology instance.");if(n.size===0)return 1/0;var i=-1/0;return n.someNode(function(a){var s=e(n,a);return s>i&&(i=s),i===1/0}),i},cs}var ls,hl;function an(){if(hl)return ls;hl=1;function r(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function e(t,n){t=t||{};var i={};for(var a in n){var s=t[a],d=n[a];if(!r(d)){i[a]=e(s,d);continue}s===void 0?i[a]=d:i[a]=s}return i}return ls=e,ls}var ds,fl;function Wu(){if(fl)return ds;fl=1;var r=je();return ds=function(t){if(!r(t))throw new Error("graphology-utils/infer-type: expecting a valid graphology instance.");var n=t.type;return n!=="mixed"?n:t.directedSize===0&&t.undirectedSize===0||t.directedSize>0&&t.undirectedSize>0?"mixed":t.directedSize>0?"directed":"undirected"},ds}var hs,pl;function Um(){if(pl)return hs;pl=1;var r=an(),e=je(),t=Wu(),n=Fr(),i={getNodeCommunity:"community",getEdgeWeight:"weight",resolution:1};function a(M,z){var A=new Array(M.order),T=new Float64Array(M.order),K={},S=0,G=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry,q=n.createNodeValueGetter(z.getNodeCommunity).fromEntry,F=0,W={};return M.forEachNode(function(Z,j){W[Z]=F,A[F++]=q(Z,j)}),M.forEachUndirectedEdge(function(Z,j,ve,ge,X,P,ee){var ne=G(Z,j,ve,ge,X,P,ee);S+=ne,K[Z]=ne,T[W[ve]]+=ne,ve!==ge&&(T[W[ge]]+=ne)}),{weights:K,communities:A,weightedDegrees:T,M:S}}function s(M,z){var A=new Array(M.order),T=new Float64Array(M.order),K=new Float64Array(M.order),S={},G=0,q=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry,F=n.createNodeValueGetter(z.getNodeCommunity).fromEntry,W=0,Z={};return M.forEachNode(function(j,ve){Z[j]=W,A[W++]=F(j,ve)}),M.forEachDirectedEdge(function(j,ve,ge,X,P,ee,ne){var le=q(j,ve,ge,X,P,ee,ne);G+=le,S[j]=le,K[Z[ge]]+=le,T[Z[X]]+=le}),{weights:S,communities:A,weightedInDegrees:T,weightedOutDegrees:K,M:G}}function d(M,z){var A=z.resolution,T=a(M,z),K=T.communities,S=T.weightedDegrees,G=T.M,q=M.nodes(),F,W,Z,j,ve,ge,X=0,P=G*2;for(F=0,Z=M.order;F<Z;F++)for(W=0;W<Z;W++)K[F]===K[W]&&(ge=M.undirectedEdge(q[F],q[W]),j=T.weights[ge]||0,ve=S[F]*S[W],F===W&&typeof ge<"u"?X+=(j-ve/P*A)*2:X+=j-ve/P*A);return X/P}function f(M,z){var A=z.resolution,T=s(M,z),K=T.communities,S=T.weightedInDegrees,G=T.weightedOutDegrees,q=T.M,F=M.nodes(),W,Z,j,ve,ge,X,P=0;for(W=0,j=M.order;W<j;W++)for(Z=0;Z<j;Z++)K[W]===K[Z]&&(X=M.directedEdge(F[W],F[Z]),ve=T.weights[X]||0,ge=S[W]*G[Z],P+=ve-ge/q*A);return P/q}function h(M,z){var A={},T={},K={},S=n.createNodeValueGetter(z.getNodeCommunity).fromEntry;return M.forEachNode(function(G,q){var F=S(G,q);if(A[G]=F,typeof F>"u")throw new Error('graphology-metrics/modularity: the "'+G+'" node is not in the partition.');T[F]=0,K[F]=0}),{communities:A,totalWeights:T,internalWeights:K}}function y(M,z){var A={},T={},K={},S={},G=n.createNodeValueGetter(z.getNodeCommunity).fromEntry;return M.forEachNode(function(q,F){var W=G(q,F);if(A[q]=W,typeof W>"u")throw new Error('graphology-metrics/modularity: the "'+q+'" node is not in the partition.');T[W]=0,K[W]=0,S[W]=0}),{communities:A,totalInWeights:T,totalOutWeights:K,internalWeights:S}}function v(M,z){var A=z.resolution,T=h(M,z),K=0,S=T.totalWeights,G=T.internalWeights,q=T.communities,F=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry;M.forEachUndirectedEdge(function(ve,ge,X,P,ee,ne,le){var oe=F(ve,ge,X,P,ee,ne,le);K+=oe;var he=q[X],ue=q[P];S[he]+=oe,S[ue]+=oe,he===ue&&(G[he]+=oe*2)});var W=0,Z=K*2;for(var j in G)W+=G[j]/Z-Math.pow(S[j]/Z,2)*A;return W}function w(M,z){var A=z.resolution,T=y(M,z),K=0,S=T.totalInWeights,G=T.totalOutWeights,q=T.internalWeights,F=T.communities,W=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry;M.forEachDirectedEdge(function(ve,ge,X,P,ee,ne,le){var oe=W(ve,ge,X,P,ee,ne,le);K+=oe;var he=F[X],ue=F[P];G[he]+=oe,S[ue]+=oe,he===ue&&(q[he]+=oe)});var Z=0;for(var j in q)Z+=q[j]/K-S[j]*G[j]/Math.pow(K,2)*A;return Z}function _(M,z,A,T){return T/(2*M)-z*A/(2*(M*M))}function D(M,z,A,T,K,S){return S/M-(K*z+T*A)/(M*M)}function k(M,z){if(!e(M))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(M.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(M.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var A=t(M);if(A==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return z=r(z,i),A==="directed"?f(M,z):d(M,z)}function N(M,z){if(!e(M))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(M.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(M.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var A=t(M);if(A==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return z=r(z,i),A==="directed"?w(M,z):v(M,z)}var O=N;return O.sparse=N,O.dense=k,O.undirectedDelta=_,O.directedDelta=D,hs=O,hs}var fs,gl;function Km(){if(gl)return fs;gl=1;var r=je(),e=Fr().createEdgeWeightGetter,t="weight";return fs=function(i,a){if(!r(i))throw new Error("graphology-metrics/weighted-size: the given graph is not a valid graphology instance.");a=e(a||t).fromEntry;var s=0;return i.forEachEdge(function(d,f,h,y,v,w,_){s+=a(d,f,h,y,v,w,_)}),s},fs}var yl;function Mh(){if(yl)return Dt;yl=1;var r=Ih(),e=jm();return Dt.diameter=Bm(),Dt.modularity=Um(),Dt.simpleSize=Dh(),Dt.weightedSize=Km(),Dt.abstractDensity=r.abstractDensity,Dt.density=r.density,Dt.directedDensity=r.directedDensity,Dt.undirectedDensity=r.undirectedDensity,Dt.mixedDensity=r.mixedDensity,Dt.multiDirectedDensity=r.multiDirectedDensity,Dt.multiUndirectedDensity=r.multiUndirectedDensity,Dt.multiMixedDensity=r.multiMixedDensity,Dt.nodeExtent=e.nodeExtent,Dt.edgeExtent=e.edgeExtent,Dt}var vl=Mh(),ja={},ps,ml;function Ph(){if(ml)return ps;ml=1;var r=je(),e=Wu(),t=an(),n=Fr().createEdgeWeightGetter,i={edgeDisparityAttribute:"disparity",getEdgeWeight:"weight"};function a(d,f,h){if(!r(f))throw new Error("graphology-metrics/edge/disparity: the given graph is not a valid graphology instance.");if(f.multi||e(f)==="mixed")throw new Error("graphology-metrics/edge/disparity: not defined for multi nor mixed graphs.");h=t(h,i);var y=n(h.getEdgeWeight).fromEntry,v={};f.forEachNode(function(N){v[N]=0}),f.forEachEdge(function(N,O,M,z,A,T,K){var S=y(N,O,M,z,A,T,K);v[M]+=S,v[z]+=S});var w,_,D,k={};if(f.forEachAssymetricAdjacencyEntry(function(N,O,M,z,A,T,K){var S=y(A,T,N,O,M,z,K);w!==N&&(w=N,_=f.degree(N),D=v[N]);var G=f.degree(O),q=v[O],F=S/D,W=S/q,Z=Math.pow(1-F,_-1),j=Math.pow(1-W,G-1);k[A]=Math.min(Z,j)}),d){f.updateEachEdgeAttributes(function(N,O){return O[h.edgeDisparityAttribute]=k[N],O},{attributes:[h.edgeDisparityAttribute]});return}return k}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),ps=s,ps}var gs={},bl;function Nh(){return bl||(bl=1,function(r){r.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var e=new Set,t=1/0,n=null,i,a,s=arguments.length;for(a=0;a<s;a++){if(i=arguments[a],i.size===0)return e;i.size<t&&(t=i.size,n=i)}for(var d=n.values(),f,h,y,v;f=d.next(),!f.done;){for(h=f.value,y=!0,a=0;a<s;a++)if(v=arguments[a],v!==n&&!v.has(h)){y=!1;break}y&&e.add(h)}return e},r.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var e=new Set,t,n=arguments.length,i,a;for(t=0;t<n;t++)for(i=arguments[t].values();a=i.next(),!a.done;)e.add(a.value);return e},r.difference=function(e,t){if(!e.size)return new Set;if(!t.size)return new Set(e);for(var n=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||n.add(a.value);return n},r.symmetricDifference=function(e,t){for(var n=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||n.add(a.value);for(i=t.values();a=i.next(),!a.done;)e.has(a.value)||n.add(a.value);return n},r.isSubset=function(e,t){var n=e.values(),i;if(e===t)return!0;if(e.size>t.size)return!1;for(;i=n.next(),!i.done;)if(!t.has(i.value))return!1;return!0},r.isSuperset=function(e,t){return r.isSubset(t,e)},r.add=function(e,t){for(var n=t.values(),i;i=n.next(),!i.done;)e.add(i.value)},r.subtract=function(e,t){for(var n=t.values(),i;i=n.next(),!i.done;)e.delete(i.value)},r.intersect=function(e,t){for(var n=e.values(),i;i=n.next(),!i.done;)t.has(i.value)||e.delete(i.value)},r.disjunct=function(e,t){for(var n=e.values(),i,a=[];i=n.next(),!i.done;)t.has(i.value)&&a.push(i.value);for(n=t.values();i=n.next(),!i.done;)e.has(i.value)||e.add(i.value);for(var s=0,d=a.length;s<d;s++)e.delete(a[s])},r.intersectionSize=function(e,t){var n;if(e.size>t.size&&(n=e,e=t,t=n),e.size===0)return 0;if(e===t)return e.size;for(var i=e.values(),a,s=0;a=i.next(),!a.done;)t.has(a.value)&&s++;return s},r.unionSize=function(e,t){var n=r.intersectionSize(e,t);return e.size+t.size-n},r.jaccard=function(e,t){var n=r.intersectionSize(e,t);if(n===0)return 0;var i=e.size+t.size-n;return n/i},r.overlap=function(e,t){var n=r.intersectionSize(e,t);return n===0?0:n/Math.min(e.size,t.size)}}(gs)),gs}var ys,wl;function Wm(){if(wl)return ys;wl=1;var r=je(),e=Nh().intersectionSize;function t(i,a){if(!r(a))throw new Error("graphology-metrics/simmelian-strength: given graph is not a valid graphology instance.");var s={};if(a.forEachNode(function(f){s[f]=new Set(a.neighbors(f))}),!i){var d={};return a.forEachEdge(function(f,h,y,v){d[f]=e(s[y],s[v])}),d}a.updateEachEdgeAttributes(function(f,h,y,v){return h.simmelianStrength=e(s[y],s[v]),h},{attributes:["simmelianStrength"]})}var n=t.bind(null,!1);return n.assign=t.bind(null,!0),ys=n,ys}var El;function Oh(){return El||(El=1,ja.disparity=Ph(),ja.simmelianStrength=Wm()),ja}var Hm=Oh(),vs,xl;function Th(){if(xl)return vs;xl=1;var r=po(),e=qr();function t(n,i){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=n,this.capacity=i,this.items=new n(this.capacity),this.clear()}return t.prototype.clear=function(){this.start=0,this.size=0},t.prototype.push=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var i=this.start+this.size;return i>=this.capacity&&(i-=this.capacity),this.items[i]=n,++this.size},t.prototype.unshift=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var i=this.start-1;return this.start===0&&(i=this.capacity-1),this.items[i]=n,this.start=i,++this.size},t.prototype.pop=function(){if(this.size!==0){this.size--;var n=this.start+this.size;return n>=this.capacity&&(n-=this.capacity),this.items[n]}},t.prototype.shift=function(){if(this.size!==0){var n=this.start;return this.size--,this.start++,this.start===this.capacity&&(this.start=0),this.items[n]}},t.prototype.peekFirst=function(){if(this.size!==0)return this.items[this.start]},t.prototype.peekLast=function(){if(this.size!==0){var n=this.start+this.size-1;return n>=this.capacity&&(n-=this.capacity),this.items[n]}},t.prototype.get=function(n){if(!(this.size===0||n>=this.capacity))return n=this.start+n,n>=this.capacity&&(n-=this.capacity),this.items[n]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=this.capacity,s=this.size,d=this.start,f=0;f<s;)n.call(i,this.items[d],f,this),d++,f++,d===a&&(d=0)},t.prototype.toArray=function(){var n=this.start+this.size;if(n<this.capacity)return this.items.slice(this.start,n);for(var i=new this.ArrayClass(this.size),a=this.capacity,s=this.size,d=this.start,f=0;f<s;)i[f]=this.items[d],d++,f++,d===a&&(d=0);return i},t.prototype.values=function(){var n=this.items,i=this.capacity,a=this.size,s=this.start,d=0;return new e(function(){if(d>=a)return{done:!0};var f=n[s];return s++,d++,s===i&&(s=0),{value:f,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.capacity,a=this.size,s=this.start,d=0;return new e(function(){if(d>=a)return{done:!0};var f=n[s];return s++,s===i&&(s=0),{value:[d++,f],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){var n=this.toArray();return n.type=this.ArrayClass.name,n.capacity=this.capacity,Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n,i,a){if(arguments.length<3&&(a=r.guessLength(n),typeof a!="number"))throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(r.isArrayLike(n)){var d,f;for(d=0,f=n.length;d<f;d++)s.items[d]=n[d];return s.size=f,s}return r.forEach(n,function(h){s.push(h)}),s},vs=t,vs}var ms,_l;function Ym(){if(_l)return ms;_l=1;var r=qr(),e=ua().getPointerArray;function t(n){var i=e(n);this.size=0,this.length=n,this.dense=new i(n),this.sparse=new i(n)}return t.prototype.clear=function(){this.size=0},t.prototype.has=function(n){var i=this.sparse[n];return i<this.size&&this.dense[i]===n},t.prototype.add=function(n){var i=this.sparse[n];return i<this.size&&this.dense[i]===n?this:(this.dense[this.size]=n,this.sparse[n]=this.size,this.size++,this)},t.prototype.delete=function(n){var i=this.sparse[n];return i>=this.size||this.dense[i]!==n?!1:(i=this.dense[this.size-1],this.dense[this.sparse[n]]=i,this.sparse[i]=this.sparse[n],this.size--,!0)},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a,s=0;s<this.size;s++)a=this.dense[s],n.call(i,a,a)},t.prototype.values=function(){var n=this.size,i=this.dense,a=0;return new r(function(){if(a<n){var s=i[a];return a++,{value:s}}return{done:!0}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){for(var n=new Set,i=0;i<this.size;i++)n.add(this.dense[i]);return Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n.length=this.length,n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),ms=t,ms}var Ba={},Sl;function go(){if(Sl)return Ba;Sl=1;var r=ua(),e=Fr().createEdgeWeightGetter;function t(a,s){return a==="outbound"||a==="inbound"?s.directedSize+s.undirectedSize*2:a==="in"||a==="out"||a==="directed"?s.directedSize:s.undirectedSize*2}function n(a,s){s=s||"outbound";var d=a[s+"Neighbors"].bind(a),f=t(s,a),h=r.getPointerArray(f),y=r.getPointerArray(a.order);this.graph=a,this.neighborhood=new y(f),this.starts=new h(a.order+1),this.nodes=a.nodes();var v={},w,_,D,k,N,O,M=0;for(w=0,_=a.order;w<_;w++)v[this.nodes[w]]=w;for(w=0,_=a.order;w<_;w++)for(N=this.nodes[w],O=d(N),this.starts[w]=M,D=0,k=O.length;D<k;D++)this.neighborhood[M++]=v[O[D]];this.starts[w]=f}n.prototype.bounds=function(a){return[this.starts[a],this.starts[a+1]]},n.prototype.project=function(){var a=this,s={};return a.nodes.forEach(function(d,f){s[d]=Array.from(a.neighborhood.slice(a.starts[f],a.starts[f+1])).map(function(h){return a.nodes[h]})}),s},n.prototype.collect=function(a){var s,d,f={};for(s=0,d=a.length;s<d;s++)f[this.nodes[s]]=a[s];return f},n.prototype.assign=function(a,s){var d=0;this.graph.updateEachNodeAttributes(function(f,h){return h[a]=s[d++],h},{attributes:[a]})},Ba.NeighborhoodIndex=n;function i(a,s,d){d=d||"outbound";var f=a[d+"Edges"].bind(a),h=t(d,a),y=r.getPointerArray(h),v=r.getPointerArray(a.order),w=e(s).fromMinimalEntry;this.graph=a,this.neighborhood=new v(h),this.weights=new Float64Array(h),this.outDegrees=new Float64Array(a.order),this.starts=new y(a.order+1),this.nodes=a.nodes();var _={},D,k,N,O,M,z,A,T,K,S=0;for(D=0,k=a.order;D<k;D++)_[this.nodes[D]]=D;for(D=0,k=a.order;D<k;D++)for(M=this.nodes[D],A=f(M),this.starts[D]=S,N=0,O=A.length;N<O;N++)T=A[N],z=a.opposite(M,T),K=w(T,a.getEdgeAttributes(T)),this.neighborhood[S]=_[z],this.weights[S++]=K,this.outDegrees[D]+=K;this.starts[D]=h}return i.prototype.bounds=n.prototype.bounds,i.prototype.project=n.prototype.project,i.prototype.collect=n.prototype.collect,i.prototype.assign=n.prototype.assign,Ba.WeightedNeighborhoodIndex=i,Ba}var bs,Al;function Rh(){if(Al)return bs;Al=1;var r=je(),e=an(),t=Th(),n=Ym(),i=go().NeighborhoodIndex,a={nodeCentralityAttribute:"closenessCentrality",wassermanFaust:!1};function s(h){this.index=new i(h,"inbound"),this.queue=new t(Array,h.order),this.seen=new n(h.order)}s.prototype.fromNode=function(h){var y=this.index,v=this.queue,w=this.seen;w.clear(),v.clear(),w.add(h),v.push([h,0]);for(var _,D,k,N,O,M,z=0,A=0;v.size!==0;)for(_=v.shift(),D=_[0],k=_[1],k!==0&&(z+=k,A+=1),O=y.starts[D+1],N=y.starts[D];N<O;N++)M=y.neighborhood[N],!w.has(M)&&(w.add(M),v.push([M,k+1]));return[A,z]};function d(h,y,v){if(!r(y))throw new Error("graphology-metrics/centrality/closeness: the given graph is not a valid graphology instance.");v=e(v,a);var w=v.wassermanFaust,_=new s(y),D=y.order,k,N,O,M,z,A=new Float64Array(D);for(k=0;k<D;k++)N=_.fromNode(k),O=N[0],M=N[1],z=0,M>0&&D>1&&(z=O/M,w&&(z*=O/(D-1))),A[k]=z;return h?_.index.assign(v.nodeCentralityAttribute,A):_.index.collect(A)}var f=d.bind(null,!1);return f.assign=d.bind(null,!0),bs=f,bs}var Xm=Rh();const Vm=Mt(Xm);var Yi={},kl;function Lh(){if(kl)return Yi;kl=1;var r=je();function e(a,s,d,f){var h=s+"Centrality";if(!r(d))throw new Error("graphology-centrality/"+h+": the given graph is not a valid graphology instance.");if(s!=="degree"&&d.type==="undirected")throw new Error("graphology-centrality/"+h+": cannot compute "+s+" centrality on an undirected graph.");f=f||{};var y=f.nodeCentralityAttribute||h,v=d.order-1,w=d[s].bind(d);if(a){d.updateEachNodeAttributes(function(D,k){return k[y]=w(D)/v,k},{attributes:[y]});return}var _={};return d.forEachNode(function(D){_[D]=w(D)/v}),_}var t=e.bind(null,!1,"degree"),n=e.bind(null,!1,"inDegree"),i=e.bind(null,!1,"outDegree");return t.assign=e.bind(null,!0,"degree"),n.assign=e.bind(null,!0,"inDegree"),i.assign=e.bind(null,!0,"outDegree"),Yi.degreeCentrality=t,Yi.inDegreeCentrality=n,Yi.outDegreeCentrality=i,Yi}var Qm=Lh(),Ua={},ws,Cl;function Zm(){if(Cl)return ws;Cl=1;var r=qr(),e=po();function t(n,i){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=i,this.ArrayClass=n,this.items=new this.ArrayClass(this.capacity),this.clear()}return t.prototype.clear=function(){this.size=0},t.prototype.push=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=n,this.size},t.prototype.pop=function(){if(this.size!==0)return this.items[--this.size]},t.prototype.peek=function(){return this.items[this.size-1]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=0,s=this.items.length;a<s;a++)n.call(i,this.items[s-a-1],a,this)},t.prototype.toArray=function(){for(var n=new this.ArrayClass(this.size),i=this.size-1,a=this.size;a--;)n[a]=this.items[i-a];return n},t.prototype.values=function(){var n=this.items,i=this.size,a=0;return new r(function(){if(a>=i)return{done:!0};var s=n[i-a-1];return a++,{value:s,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.size,a=0;return new r(function(){if(a>=i)return{done:!0};var s=n[i-a-1];return{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var n=this.toArray();return n.type=this.ArrayClass.name,n.capacity=this.capacity,Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n,i,a){if(arguments.length<3&&(a=e.guessLength(n),typeof a!="number"))throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(e.isArrayLike(n)){var d,f;for(d=0,f=n.length;d<f;d++)s.items[d]=n[d];return s.size=f,s}return e.forEach(n,function(h){s.push(h)}),s},ws=t,ws}var Dl;function zh(){if(Dl)return Ua;Dl=1;var r=Th(),e=Zm(),t=Uu(),n=ua(),i=go(),a=i.NeighborhoodIndex,s=i.WeightedNeighborhoodIndex;Ua.createUnweightedIndexedBrandes=function(h){var y=new a(h),v=y.neighborhood,w=y.starts,_=h.order,D=new e(n.getPointerArray(_),_),k=new Uint32Array(_),N=new Array(_),O=new Int32Array(_),M=new r(Uint32Array,_),z=function(A){var T,K,S,G,q,F,W;for(F=0;F<_;F++)N[F]=[],k[F]=0,O[F]=-1;for(k[A]=1,O[A]=0,M.push(A);M.size!==0;)for(F=M.shift(),D.push(F),T=O[F],K=k[F],S=w[F],G=w[F+1],q=S;q<G;q++)W=v[q],O[W]===-1&&(M.push(W),O[W]=T+1),O[W]===T+1&&(k[W]+=K,N[W].push(F));return[D,N,k]};return z.index=y,z};function d(f,h){return f[0]>h[0]?1:f[0]<h[0]?-1:f[1]>h[1]?1:f[1]<h[1]?-1:f[2]>h[2]?1:f[2]<h[2]?-1:f[3]>h[3]?1:f[3]<h[3]?-1:0}return Ua.createDijkstraIndexedBrandes=function(h,y){var v=new s(h,y||"weight"),w=v.neighborhood,_=v.weights,D=v.starts,k=h.order,N=new e(n.getPointerArray(k),k),O=new Uint32Array(k),M=new Array(k),z=new Float64Array(k),A=new Float64Array(k),T=new t(d),K=function(S){var G,q,F,W,Z,j,ve,ge,X,P=0;for(ge=0;ge<k;ge++)M[ge]=[],O[ge]=0,z[ge]=-1,A[ge]=-1;for(O[S]=1,A[S]=0,T.push([0,P++,S,S]);T.size!==0;)if(F=T.pop(),W=F[0],Z=F[2],ge=F[3],z[ge]===-1)for(N.push(ge),z[ge]=W,O[ge]+=O[Z],G=D[ge],q=D[ge+1],ve=G;ve<q;ve++)X=w[ve],j=W+_[ve],z[X]===-1&&(A[X]===-1||j<A[X])?(A[X]=j,T.push([j,P++,ge,X]),O[X]=0,M[X]=[ge]):j===A[X]&&(O[X]+=O[ge],M[X].push(ge));return[N,M,O]};return K.index=v,K},Ua}var Es,Il;function $h(){if(Il)return Es;Il=1;var r=je(),e=zh(),t=an(),n=e.createUnweightedIndexedBrandes,i=e.createDijkstraIndexedBrandes,a={nodeCentralityAttribute:"betweennessCentrality",getEdgeWeight:"weight",normalized:!0};function s(f,h,y){if(!r(h))throw new Error("graphology-centrality/beetweenness-centrality: the given graph is not a valid graphology instance.");y=t(y,a);var v=y.nodeCentralityAttribute,w=y.normalized,_=y.getEdgeWeight?i(h,y.getEdgeWeight):n(h),D=h.order,k,N,O,M,z,A,T,K,S,G,q=new Float64Array(D),F=new Float64Array(D);for(A=0;A<D;A++){for(k=_(A),N=k[0],O=k[1],M=k[2],T=N.size;T--;)q[N.items[N.size-T]]=0;for(;N.size!==0;){for(G=N.pop(),z=(1+q[G])/M[G],T=0,K=O[G].length;T<K;T++)S=O[G][T],q[S]+=M[S]*z;G!==A&&(F[G]+=q[G])}}var W=null;if(w?W=D<=2?null:1/((D-1)*(D-2)):W=h.type==="undirected"?.5:null,W!==null)for(A=0;A<D;A++)F[A]*=W;return f?_.index.assign(v,F):_.index.collect(F)}var d=s.bind(null,!1);return d.assign=s.bind(null,!0),Es=d,Es}var Jm=$h();const e0=Mt(Jm);var xs,Ml;function Gh(){if(Ml)return xs;Ml=1;var r=je(),e=an(),t=go().WeightedNeighborhoodIndex,n={nodeCentralityAttribute:"eigenvectorCentrality",getEdgeWeight:"weight",maxIterations:100,tolerance:1e-6};function i(d){for(var f=0,h=0,y=0,v=d.length;y<v;y++){var w=Math.abs(d[y]);w>f&&(h*=f/w*(f/w),f=w),h+=w===0&&f===0?0:w/f*(w/f)}return f===1/0?1:f*Math.sqrt(h)}function a(d,f,h){if(!r(f))throw new Error("graphology-metrics/centrality/eigenvector: the given graph is not a valid graphology instance.");h=e(h,n);var y=h.maxIterations,v=h.tolerance,w=f.order,_=new t(f,h.getEdgeWeight),D,k,N,O,M=new Float64Array(f.order);for(D=0;D<w;D++)M[D]=1/w;for(var z=0,A=0,T,K,S,G=!1;z<y;){for(K=M,M=new Float64Array(K),D=0;D<w;D++)for(N=_.starts[D+1],k=_.starts[D];k<N;k++)T=_.neighborhood[k],O=_.weights[k],M[T]+=K[D]*O;for(S=i(M),D=0;D<w;D++)M[D]/=S;for(A=0,D=0;D<w;D++)A+=Math.abs(M[D]-K[D]);if(A<w*v){G=!0;break}z++}if(!G)throw Error("graphology-metrics/centrality/eigenvector: failed to converge.");if(d){_.assign(h.nodeCentralityAttribute,M);return}return _.collect(M)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),xs=s,xs}var t0=Gh();const n0=Mt(t0);var li={},_s,Pl;function r0(){if(Pl)return _s;Pl=1;var r=je();function e(n,i){if(n.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.max: not enough values!");for(var a=void 0,s,d=1,f=n.length;d<f;d++)s=n[d],i!==void 0&&(s=i(s)),(a===void 0||s>a)&&(a=s);return a}function t(n,i){if(n.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.min: not enough values!");for(var a=void 0,s,d=1,f=n.length;d<f;d++)s=n[d],i!==void 0&&(s=i(s)),(a===void 0||s<a)&&(a=s);return a}return _s=function(i,a){if(!r(i))throw new Error("graphology-metrics/layout-quality/connected-closeness: given graph is not a valid graphology instance.");if(i.size<2)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:z.C};a=a||{},a.epsilon=a.epsilon||.03,a.gridSize=a.gridSize||10;var s=a.rng||Math.random,d=T(),f=i.edges().map(function(S){var G=i.getNodeAttributes(i.source(S)),q=i.getNodeAttributes(i.target(S)),F=Math.sqrt(Math.pow(G.x-q.x,2)+Math.pow(G.y-q.y,2));return F}),h=[0,Math.max(e(d),e(f)||0)],y=0,v={},w,_,D,k,N,O=-1;do{for(k=0;k<=a.gridSize;k++)w=h[0]+(h[1]-h[0])*k/a.gridSize,v[w]===void 0&&(v[w]=A(w,i,d,f));_=y,y=0,N=Object.values(v),N.forEach(function(S,G){D=S.C,D>y&&(y=D,O=G)}),h=[N[Math.max(0,O-1)].Delta,N[Math.min(N.length-1,O+1)].Delta]}while((y-_)/y>=a.epsilon/10);var M=K(N,a.epsilon),z=A(M,i,d,f);if(z.C<.1)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:z.C};return{deltaMax:M,ePercentOfDeltaMax:z.ePercent,pPercentOfDeltaMax:z.pPercent,pEdgeOfDeltaMax:z.pEdge,cMax:z.C};function A(S,G,q,F){var W=F.filter(function(le){return le<=S}),Z=q.filter(function(le){return le<=S}),j=W.length,ve=j/F.length,ge=Z.length,X=ge/q.length,P=ve-X,ee=G.undirected?1:2,ne=j/(ee*ge*(G.order*(G.order-1))/q.length);return{Delta:S,ePercent:ve,pPercent:X,pEdge:ne,C:P}}function T(){if(i.order<2)return[];var S=[],G,q,F,W,Z,j=i.size;if(j<1)return[];for(var ve=0;ve<j;ve++){G=i.nodes()[Math.floor(s()*i.order)];do q=i.nodes()[Math.floor(s()*i.order)];while(G===q);F=i.getNodeAttributes(G),W=i.getNodeAttributes(q),Z=Math.sqrt(Math.pow(F.x-W.x,2)+Math.pow(F.y-W.y,2)),S.push(Z)}return S}function K(S,G){var q=e(S,function(W){return W.C}),F=t(S.filter(function(W){return W.C>=(1-G)*q}),function(W){return W.Delta});return F}},_s}var Ss,Nl;function i0(){if(Nl)return Ss;Nl=1;var r=je();function e(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}return Ss=function(n){if(!r(n))throw new Error("graphology-metrics/layout-quality/edge-uniformity: given graph is not a valid graphology instance.");if(n.size===0)return 0;var i=0,a=0,s,d=new Float64Array(n.size);n.forEachEdge(function(v,w,_,D,k,N){var O=e(k,N);d[a++]=O,i+=O});var f=i/n.size,h=0;for(a=0,s=n.size;a<s;a++)h+=Math.pow(f-d[a],2);var y=h/(n.size*Math.pow(f,2));return Math.sqrt(y)},Ss}var As,Ol;function a0(){if(Ol)return As;Ol=1;var r=Bu(),e=Uu(),t=r.DEFAULT_COMPARATOR,n=r.reverseComparator;function i(d,f,h,y){for(var v=h,w=y,_=f[y],D=2*y+1,k;D<v;)k=D+1,k<v&&d(f[D],f[k])>=0&&(D=k),f[y]=f[D],y=D,D=2*y+1;f[y]=_,e.siftDown(d,f,w,y)}function a(d,f,h,y){for(var v=y,w=v,_=new d(y),D,k;w>0;)D=h[--w],w!==0&&(k=h[0],h[0]=D,i(f,h,--y,0),D=k),_[w]=D;return _}function s(d,f,h){if(arguments.length===2&&(h=f,f=null),this.ArrayClass=d,this.capacity=h,this.items=new d(h),this.clear(),this.comparator=f||t,typeof h!="number"&&h<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=n(this.comparator)}return s.prototype.clear=function(){this.size=0},s.prototype.push=function(d){return this.size<this.capacity?(this.items[this.size]=d,e.siftDown(this.comparator,this.items,0,this.size),this.size++):this.comparator(d,this.items[0])>0&&e.replace(this.comparator,this.items,d),this.size},s.prototype.peek=function(){return this.items[0]},s.prototype.consume=function(){var d=a(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,d},s.prototype.toArray=function(){return a(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)},s.prototype.inspect=function(){var d=this.toArray();return Object.defineProperty(d,"constructor",{value:s,enumerable:!1}),d},typeof Symbol<"u"&&(s.prototype[Symbol.for("nodejs.util.inspect.custom")]=s.prototype.inspect),As=s,As}var Ka={},Tl;function o0(){if(Tl)return Ka;Tl=1;var r=new Float64Array(64),e=new Float64Array(64);function t(i,a,s){var d,f,h,y,v;for(r[0]=a,e[0]=s,f=0;f>=0;)if(h=r[f],y=e[f]-1,h<y){for(d=i[h];h<y;){for(;i[y]>=d&&h<y;)y--;for(h<y&&(i[h++]=i[y]);i[h]<=d&&h<y;)h++;h<y&&(i[y--]=i[h])}i[h]=d,r[f+1]=h+1,e[f+1]=e[f],e[f++]=h,e[f]-r[f]>e[f-1]-r[f-1]&&(v=r[f],r[f]=r[f-1],r[f-1]=v,v=e[f],e[f]=e[f-1],e[f-1]=v)}else f--;return i}Ka.inplaceQuickSort=t;function n(i,a,s,d){var f,h,y,v,w,_;for(r[0]=s,e[0]=d,h=0;h>=0;)if(y=r[h],v=e[h]-1,y<v){for(w=a[y],f=i[w];y<v;){for(;i[a[v]]>=f&&y<v;)v--;for(y<v&&(a[y++]=a[v]);i[a[y]]<=f&&y<v;)y++;y<v&&(a[v--]=a[y])}a[y]=w,r[h+1]=y+1,e[h+1]=e[h],e[h++]=y,e[h]-r[h]>e[h-1]-r[h-1]&&(_=r[h],r[h]=r[h-1],r[h-1]=_,_=e[h],e[h]=e[h-1],e[h-1]=_)}else h--;return a}return Ka.inplaceQuickSortIndices=n,Ka}var ks,Rl;function s0(){if(Rl)return ks;Rl=1;var r=po(),e=ua(),t=Bu().createTupleComparator,n=a0(),i=o0().inplaceQuickSortIndices;function a(v,w,_,D){var k,N=0,O;for(k=0;k<v;k++)O=w[k][_]-D[k],N+=O*O;return N}function s(v,w){var _=w.length,D=new Array(v),k=new Array(_),N,O=e.getPointerArray(_),M=new O(_),z,A,T,K=!0;for(z=0;z<v;z++){for(N=new Float64Array(_),A=0;A<_;A++)T=w[A],N[A]=T[1][z],K&&(k[A]=T[0],M[A]=A);K=!1,D[z]=N}return{axes:D,ids:M,labels:k}}function d(v,w,_,D){for(var k=D.length,N=e.getPointerArray(k+1),O=new N(k),M=new N(k),z=new N(k),A=[[0,0,_.length,-1,0]],T,K,S,G,q,F,W,Z,j=0;A.length!==0;)T=A.pop(),Z=T[0],F=T[1],W=T[2],K=T[3],S=T[4],i(w[Z],_,F,W),k=W-F,G=F+(k>>>1),q=_[G],O[j]=q,K>-1&&(S===0?M[K]=j+1:z[K]=j+1),Z=(Z+1)%v,G!==F&&G!==W-1&&A.push([Z,G+1,W,j,1]),G!==F&&A.push([Z,F,G,j,0]),j++;return{axes:w,labels:D,pivots:O,lefts:M,rights:z}}function f(v,w){this.dimensions=v,this.visited=0,this.axes=w.axes,this.labels=w.labels,this.pivots=w.pivots,this.lefts=w.lefts,this.rights=w.rights,this.size=this.labels.length}f.prototype.nearestNeighbor=function(v){var w=1/0,_=null,D=this.dimensions,k=this.axes,N=this.pivots,O=this.lefts,M=this.rights,z=0;function A(T,K){z++;var S=O[K],G=M[K],q=N[K],F=a(D,k,q,v);if(!(F<w&&(_=q,w=F,F===0))){var W=k[T][q]-v[T];T=(T+1)%D,W>0?S!==0&&A(T,S-1):G!==0&&A(T,G-1),W*W<w&&(W>0?G!==0&&A(T,G-1):S!==0&&A(T,S-1))}}return A(0,0),this.visited=z,this.labels[_]};var h=t(3),y=t(2);return f.prototype.kNearestNeighbors=function(v,w){if(v<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if(v=Math.min(v,this.size),v===1)return[this.nearestNeighbor(w)];var _=new n(Array,h,v),D=this.dimensions,k=this.axes,N=this.pivots,O=this.lefts,M=this.rights,z=0;function A(S,G){var q=O[G],F=M[G],W=N[G],Z=a(D,k,W,w);_.push([Z,z++,W]);var j=w[S],ve=k[S][W],ge=j-ve;S=(S+1)%D,j<ve?q!==0&&A(S,q-1):F!==0&&A(S,F-1),(ge*ge<_.peek()[0]||_.size<v)&&(j<ve?F!==0&&A(S,F-1):q!==0&&A(S,q-1))}A(0,0),this.visited=z;for(var T=_.consume(),K=0;K<T.length;K++)T[K]=this.labels[T[K][2]];return T},f.prototype.linearKNearestNeighbors=function(v,w){if(v<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");v=Math.min(v,this.size);var _=new n(Array,y,v),D,k,N;for(D=0,k=this.size;D<k;D++)N=a(this.dimensions,this.axes,this.pivots[D],w),_.push([N,D]);var O=_.consume();for(D=0;D<O.length;D++)O[D]=this.labels[this.pivots[O[D][1]]];return O},f.prototype.inspect=function(){var v=new Map;v.dimensions=this.dimensions,Object.defineProperty(v,"constructor",{value:f,enumerable:!1});var w,_,D;for(w=0;w<this.size;w++){for(D=new Array(this.dimensions),_=0;_<this.dimensions;_++)D[_]=this.axes[_][w];v.set(this.labels[w],D)}return v},typeof Symbol<"u"&&(f.prototype[Symbol.for("nodejs.util.inspect.custom")]=f.prototype.inspect),f.from=function(v,w){var _=r.toArray(v),D=s(w,_),k=d(w,D.axes,D.ids,D.labels);return new f(w,k)},f.fromAxes=function(v,w){w||(w=e.indices(v[0].length));var _=v.length,D=d(v.length,v,e.indices(w.length),w);return new f(_,D)},ks=f,ks}var Cs,Ll;function qh(){if(Ll)return Cs;Ll=1;var r=je(),e=s0(),t=Nh().intersectionSize;return Cs=function(i){if(!r(i))throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: cannot compute stress for a null graph.");if(i.size===0)return 0;var a=[new Float64Array(i.order),new Float64Array(i.order)],s=0;i.forEachNode(function(h,y){a[0][s]=y.x,a[1][s++]=y.y});var d=e.fromAxes(a,i.nodes()),f=0;return i.forEachNode(function(h,y){var v=new Set(i.neighbors(h));if(v.size===0||v.size===i.order-1){f+=1;return}var w=d.kNearestNeighbors(v.size+1,[y.x,y.y]);w=new Set(w.slice(1));var _=t(v,w);f+=_/w.size}),f/i.order},Cs}var Ds,zl;function Fh(){if(zl)return Ds;zl=1;var r=je(),e=ju().undirectedSingleSourceLength;function t(n,i){return Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2))}return Ds=function(i){if(!r(i))throw new Error("graphology-metrics/layout-quality/stress: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/stress: cannot compute stress for a null graph.");var a=new Array(i.order),s=new Array(i.order),d=0,f=i.order*4;i.forEachNode(function(M,z){a[d]=M,s[d++]=z});var h,y,v,w,_,D,k,N,O=0;for(d=0,y=i.order;d<y;d++)for(_=e(i,a[d]),v=s[d],h=d+1;h<y;h++)w=s[h],D=_[a[h]],typeof D>"u"&&(D=f),N=t(v,w),k=1/(D*D),O+=k*Math.pow(N-D,2);return O},Ds}var $l;function jh(){return $l||($l=1,li.connectedCloseness=r0(),li.edgeUniformity=i0(),li.neighborhoodPreservation=qh(),li.stress=Fh()),li}var u0=jh(),c0=Fh();const l0=Mt(c0);var d0=Ku();const h0=Mt(d0);var Is,Gl;function Bh(){if(Gl)return Is;Gl=1;var r=je(),e=an(),t=go().WeightedNeighborhoodIndex,n={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function i(s,d,f){if(!r(d))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");f=e(f,n);var h=f.alpha,y=f.maxIterations,v=f.tolerance,w=f.nodePagerankAttribute,_=d.order,D=1/_,k=new t(d,f.getEdgeWeight),N,O,M,z,A=new Float64Array(d.order),T=new Float64Array(k.weights.length),K=[];for(N=0;N<_;N++)for(A[N]=D,M=k.starts[N+1],z=k.outDegrees[N],z===0&&K.push(N),O=k.starts[N];O<M;O++)T[O]=k.weights[O]/z;for(var S=0,G=0,q,F,W,Z=!1;S<y;){for(W=A,A=new Float64Array(d.order),q=0,N=0,M=K.length;N<M;N++)q+=W[K[N]];for(q*=h,N=0;N<_;N++){for(M=k.starts[N+1],O=k.starts[N];O<M;O++)F=k.neighborhood[O],A[F]+=h*W[N]*T[O];A[N]+=q*D+(1-h)*D}for(G=0,N=0;N<_;N++)G+=Math.abs(A[N]-W[N]);if(G<_*v){Z=!0;break}S++}if(!Z)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(s){k.assign(w,A);return}return k.collect(A)}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),Is=a,Is}var f0=Bh();const p0=Mt(f0);var g0=qh();const y0=Mt(g0);var v0=Ph();const m0=Mt(v0),Wa=document;class Uh{constructor(e){this.graphManager=e,this.pannel=Wa.querySelector("#floating-panel .body-info")}addHeader(e){const t=Wa.createElement("h4");t.textContent=e,this.pannel.appendChild(t),console.log(e)}addInfo(e){const t=Wa.createElement("div");t.insertAdjacentHTML("beforeend",e),this.pannel.appendChild(t),console.log(e)}addLine(){const e=Wa.createElement("hr");this.pannel.appendChild(e),this.pannel.scrollTop=this.pannel.scrollHeight}addNEFGInfo(e){if(e.desc&&Object.keys(e.desc).length!=0||e.weight){this.addHeader(`${e.label}:`);for(let t in e.desc)this.addInfo(`${t}: ${e.desc[t]}`);e.weight&&this.addInfo(`weight: ${e.weight}`),this.addLine()}}allNodeInfo(){for(let e of this.graphManager.graph.getSelectedNodes()){const t=this.graphManager.graph.getNodeAttributes(e);this.addNEFGInfo(t)}}allEdgeInfo(){for(let e of this.graphManager.graph.getSelectedEdges()){const t=this.graphManager.graph.getEdgeAttributes(e);this.addNEFGInfo(t)}}allFaceInfo(){for(let e of this.graphManager.graph.getSelectedFaces()){const t=this.graphManager.graph.getFaceAttributes(e);this.addNEFGInfo(t)}}allGraphInfo(){for(let e of this.graphManager.graphs.all.filter(t=>t.getAttribute("selected"))){const t=e.getAttributes();this.addNEFGInfo(t)}}getComponent(e){const t=this.graphManager.graph,n=qa.connectedComponents(t);for(let i of n)if(i.includes(String(e)))return i;return null}basicInfo(){const e=this.graphManager.graph;this.addHeader("Basic Informattion"),this.addInfo(`|V|: ${e.order}`),this.addInfo(`|E|: ${e.size}`),this.addInfo(`|F|: ${e._faces.size}`);const t=e.someEdge((n,i)=>i.weight);this.addInfo(t?`Type: ${e.type}, weighted`:`Type: ${e.type}`),this.addLine()}degreeSequesnce(){this.addHeader("Degree Sequence");const e=this.graphManager.graph,n=`(${e.mapNodes((i,a)=>e.degree(i)).join(", ")})`;this.addInfo(n),this.addLine()}countComponents(){const e=this.graphManager.graph;this.addHeader("Connected Components");const t=qa.countConnectedComponents(e);this.addInfo(`Count: ${t}`),qa.forEachConnectedComponent(e,n=>{this.addInfo(n.map(i=>e.getNodeAttribute(i,"label")).join(", "))}),this.addLine()}neighbors(){const e=this.graphManager.graph;this.addHeader("Neighbors");const t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[n]=t,i=e.neighbors(n);this.addInfo(i.map(a=>e.getNodeAttribute(a,"label")).join(", ")),this.addLine()}shortestPath(){this.addHeader("Shortest Path");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==2){this.addInfo("Select two nodes"),this.addLine();return}const[n,i]=t,a=ol.bidirectional(e,n,i);a?(this.addInfo(a.map(s=>e.getNodeAttribute(s,"label")).join(" -> ")),this.addLine(),e.selectPath(a)):(this.addInfo("They are not connected"),this.addLine())}density(){this.addHeader("Density");const e=this.graphManager.graph,t=vl.density(e);this.addInfo(t),this.addLine()}diameter(){this.addHeader("Diameter");const e=this.graphManager.graph,t=vl.diameter(e);this.addInfo(t),this.addLine()}eccentricity(){this.addHeader("Eccentricity");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[n]=t,i=h0(e,n);this.addInfo(i),this.addLine()}simmelianStrength(){this.addHeader("Simmelian strength");const e=this.graphManager.graph,t=Hm.simmelianStrength(e);for(const n in t){const{source:i,target:a}=e.getEdgeAttributes(n);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[n]}`)}this.addLine()}betweennessCentrality(){this.addHeader("Betweenness centrality");const e=this.graphManager.graph,t=e0(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}closenessCentrality(){this.addHeader("Closeness centrality");const e=this.graphManager.graph,t=Vm(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}degreeCentrality(){this.addHeader("Degree centrality");const e=this.graphManager.graph,t=Qm.degreeCentrality(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}eigenvectorCentrality(){this.addHeader("Eigenvector centrality");const e=this.graphManager.graph,t=n0(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}pagerank(){this.addHeader("Pagerank");const e=this.graphManager.graph,t=p0(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}edgeUniformity(){this.addHeader("Edge Uniformity");const e=this.graphManager.graph,t=u0.edgeUniformity(e);this.addInfo(t),this.addLine()}neighborhoodPreservation(){this.addHeader("Neighborhood preservation");const e=this.graphManager.graph,t=y0(e);this.addInfo(t),this.addLine()}stress(){this.addHeader("Stress");const e=this.graphManager.graph,t=l0(e);this.addInfo(t),this.addLine()}disparity(){this.addHeader("Disparity");const e=this.graphManager.graph,t=m0(e);for(const n in t){const{source:i,target:a}=e.getEdgeAttributes(n);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[n]}`)}this.addLine()}_isCycle(e){if(e.order==e.size&&qa.countConnectedComponents(e)==1){const t=e.edges()[0],{source:n,target:i}=e.getEdgeAttributes(t);return e.dropEdge(t),ol.bidirectional(e,i,n)}return!1}liesOnCycle(){this.addHeader("Lies on cycle");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length<3){this.addInfo("Select at least 3 nodes"),this.addLine();return}const n=Rr.subgraph(e,t);this.addInfo(!!this._isCycle(n)),this.addLine()}}var Ha={},Ms,ql;function b0(){if(ql)return Ms;ql=1;var r=xn(),e=qu();return Ms=function(n,i,a){if(!r(n))throw new Error("graphology-generators/community/caveman: invalid Graph constructor.");var s=i*a,d=e(n,s);if(a<2)return d;var f,h,y;for(f=0;f<s;f+=a)for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)d.addEdge(h,y);return d},Ms}var Ps,Fl;function w0(){if(Fl)return Ps;Fl=1;var r=xn(),e=qu();return Ps=function(n,i,a){if(!r(n))throw new Error("graphology-generators/community/connected-caveman: invalid Graph constructor.");var s=i*a,d=e(n,s);if(a<2)return d;var f,h,y;for(f=0;f<s;f+=a){for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)(h!==f||h!==y-1)&&d.addEdge(h,y);f>0&&d.addEdge(f,(f-1)%s)}return d.addEdge(0,s-1),d},Ps}var jl;function E0(){return jl||(jl=1,Ha.caveman=b0(),Ha.connectedCaveman=w0()),Ha}var Bl=E0(),Xi={},Ns,Ul;function x0(){if(Ul)return Ns;Ul=1;var r=xn();return Ns=function(e,t){if(!r(e))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");t=t||{};var n="clusterDensity"in t?t.clusterDensity:.5,i=t.rng||Math.random,a=t.order,s=t.size,d=t.clusters;if(typeof n!="number"||n>1||n<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof i!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof a!="number"||a<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof s!="number"||s<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof d!="number"||d<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var f=new e;if(!a)return f;var h=new Array(d),y,v,w;for(w=0;w<d;w++)h[w]=[];for(w=0;w<a;w++)y=i()*d|0,f.addNode(w,{cluster:y}),h[y].push(w);if(!s)return f;var _,D,k;for(w=0;w<s;w++){if(i()<1-n){_=i()*a|0;do D=i()*a|0;while(_===D)}else{if(y=i()*d|0,v=h[y],k=v.length,!k||k<2)continue;_=v[i()*k|0];do D=v[i()*k|0];while(_===D)}f.multi?f.addEdge(_,D):f.mergeEdge(_,D)}return f},Ns}var Os,Kl;function _0(){if(Kl)return Os;Kl=1;var r=xn(),e=Ih().abstractDensity;function t(i,a){if(!r(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,d=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(d=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var y,v;for(y=0;y<s;y++)h.addNode(y);if(d<=0)return h;for(y=0;y<s;y++)for(v=y+1;v<s;v++)h.type!=="directed"&&f()<d&&h.addUndirectedEdge(y,v),h.type!=="undirected"&&(f()<d&&h.addDirectedEdge(y,v),f()<d&&h.addDirectedEdge(v,y));return h}function n(i,a){if(!r(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,d=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(d=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var y=0;y<s;y++)h.addNode(y);if(d<=0)return h;var v=-1,w=Math.log(1-d),_,D;if(h.type!=="undirected")for(D=0;D<s;){for(_=Math.log(1-f()),v+=1+(_/w|0),D===v&&v++;D<s&&s<=v;)v-=s,D++,D===v&&v++;D<s&&h.addDirectedEdge(D,v)}if(v=-1,h.type!=="directed")for(D=1;D<s;){for(_=Math.log(1-f()),v+=1+(_/w|0);v>=D&&D<s;)v-=D,D++;D<s&&h.addUndirectedEdge(D,v)}return h}return t.sparse=n,Os=t,Os}var Ts,Wl;function S0(){if(Wl)return Ts;Wl=1;var r=xn();return Ts=function(t,n){if(!r(t))throw new Error("graphology-generators/random/girvan-newman: invalid Graph constructor.");var i=n.zOut,a=n.rng||Math.random;if(typeof i!="number")throw new Error("graphology-generators/random/girvan-newman: invalid `zOut`. Should be a number.");if(typeof a!="function")throw new Error("graphology-generators/random/girvan-newman: invalid `rng`. Should be a function.");var s=i/96,d=(16-s*96)/31,f=new t,h,y,v;for(y=0;y<128;y++)f.addNode(y);for(y=0;y<128;y++)for(v=y+1;v<128;v++)h=a(),y%4===v%4?h<d&&f.addEdge(y,v):h<s&&f.addEdge(y,v);return f},Ts}var Hl;function A0(){return Hl||(Hl=1,Xi.clusters=x0(),Xi.erdosRenyi=_0(),Xi.girvanNewman=S0()),Xi}var Rs=A0(),On={},Ls,Yl;function k0(){return Yl||(Yl=1,Ls=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,i,a;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!r(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!r(i[1],t.get(i[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[i]))return!1;for(i=n;i--!==0;){var s=a[i];if(!r(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}),Ls}var Xl;function C0(){if(Xl)return On;Xl=1;var r=k0(),e=Symbol("size");function t(y,v){var w=y.length,_=v.length;if(w!==_)return!1;var D,k,N,O,M=new Set;e:for(N=0;N<w;N++){for(D=y[N],O=0;O<_;O++)if(!M.has(O)&&(k=v[O],r(D,k))){M.add(O);continue e}return!1}return!0}function n(y,v){if(y[e]!==v[e])return!1;for(var w in y)if(!t(y[w],v[w]))return!1;return!0}function i(y,v){var w={},_;return y.forEachOutEdge(v,function(D,k,N,O){_=w[O]||0,_++,w[O]=_}),w}function a(y,v){var w={},_;return y.forEachUndirectedEdge(v,function(D,k,N,O){O=v===N?O:N,!(v>O)&&(_=w[O]||0,_++,w[O]=_)}),w}function s(y,v){var w={};w[e]=0;var _;return y.forEachOutEdge(v,function(D,k,N,O){_=w[O],_||(_=[],w[e]+=1,w[O]=_),_.push(k)}),w}function d(y,v){var w={};w[e]=0;var _;return y.forEachUndirectedEdge(v,function(D,k,N,O){O=v===N?O:N,!(v>O)&&(_=w[O],_||(_=[],w[e]+=1,w[O]=_),_.push(k))}),w}function f(y,v,w){return v===w?!0:v.order!==w.order?!1:v.everyNode(function(_,D){return w.hasNode(_)?y?r(D,w.getNodeAttributes(_)):!0:!1})}function h(y,v,w,_){if(w===_)return!0;if(v){if(w.type==="directed"&&_.type==="undirected"||w.type==="undirected"&&_.type==="directed")return!1}else if(w.type!==_.type||w.allowSelfLoops!==_.allowSelfLoops||w.multi!==_.multi)return!1;if(w.directedSize!==_.directedSize||w.undirectedSize!==_.undirectedSize||!f(y,w,_))return!1;var D=!1,k=!1;if(!w.multi&&!_.multi){if(D=w.everyDirectedEdge(function(M,z,A,T){return _.hasDirectedEdge(A,T)?y?r(w.getDirectedEdgeAttributes(A,T),_.getDirectedEdgeAttributes(A,T)):!0:!1}),!D||(k=w.everyUndirectedEdge(function(M,z,A,T){return _.hasUndirectedEdge(A,T)?y?r(w.getUndirectedEdgeAttributes(A,T),_.getUndirectedEdgeAttributes(A,T)):!0:!1}),!k))return!1}else{var N=y?s:i,O=y?n:r;if(D=w.everyNode(function(M){var z=N(w,M),A=N(_,M);return O(z,A)}),!D||(N=y?d:a,k=w.everyNode(function(M){var z=N(w,M),A=N(_,M);return O(z,A)}),!k))return!1}return!0}return On.isGraph=je(),On.isGraphConstructor=xn(),On.haveSameNodes=f.bind(null,!1),On.haveSameNodesDeep=f.bind(null,!0),On.areSameGraphs=h.bind(null,!1,!1),On.areSameGraphsDeep=h.bind(null,!0,!1),On.haveSameEdges=h.bind(null,!1,!0),On.haveSameEdgesDeep=h.bind(null,!0,!0),On}var zs,Vl;function D0(){return Vl||(Vl=1,zs=C0()),zs}var Hu=D0(),Ql=["0111111110111100010101000000000100","1011000100000100010101000000001000","1101000111000100000000000001100010","1110000100001100000000000000000000","1000001000100000000000000000000000","1000001000100000100000000000000000","1000110000000000100000000000000000","1111000000000000000000000000000000","1010000000000000000000000000001011","0010000000000000000000000000000001","1000110000000000000000000000000000","1000000000000000000000000000000000","1001000000000000000000000000000000","1111000000000000000000000000000001","0000000000000000000000000000000011","0000000000000000000000000000000011","0000011000000000000000000000000000","1100000000000000000000000000000000","0000000000000000000000000000000011","1100000000000000000000000000000001","0000000000000000000000000000000011","1100000000000000000000000000000000","0000000000000000000000000000000011","0000000000000000000000000101010011","0000000000000000000000000101000100","0000000000000000000000011000000100","0000000000000000000000000000010001","0010000000000000000000011000000001","0010000000000000000000000000000101","0000000000000000000000010010000011","0100000010000000000000000000000011","1000000000000000000000001100100011","0010000010000011001010110000011101","0000000011000111001110110011111110"],I0=new Set([0,1,2,3,4,5,6,7,8,10,11,12,13,16,17,19,21]);function M0(r,e={}){if(!Hu.isGraphConstructor(r))throw new Error("graphology-generators/social/karate: invalid Graph constructor.");for(var t=new r(e),n,i=0;i<34;i++)n=I0.has(i)?"Mr. Hi":"Officer",t.addNode(i,{club:n});var a,s,d,f,h,y;for(d=0,h=Ql.length;d<h;d++)for(a=Ql[d].split(""),f=d+1,y=a.length;f<y;f++)s=+a[f],s&&t.addEdgeWithKey(d+"->"+f,d,f);return t}var $s=[[0,1],[2,3],[2,4],[2,5],[1,5],[1,6],[1,7],[1,8],[1,9],[9,10],[3,4],[3,11],[4,6],[4,11],[6,7],[7,12],[8,13],[8,12],[11,12],[12,14]];function P0(r,e={}){if(!Hu.isGraphConstructor(r))throw new Error("graphology-generators/social/florentine-families: invalid Graph constructor.");var t=new r(e),n,i;for(n=0,i=$s.length;n<i;n++)t.mergeEdge($s[n][0],$s[n][1]);return t}var Jt={},Gs,Zl;function N0(){if(Zl)return Gs;Zl=1;var r=je();return Gs=function(t){if(!r(t))throw new Error("graphology-utils/infer-multi: expecting a valid graphology instance.");if(!t.multi||t.order===0||t.size<2)return!1;var n=!1,i,a,s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,_,D){if(!n){if(D&&f>h&&(d=h,h=f,f=d),f===i&&h===a&&D===s){n=!0;return}i=f,a=h,s=D}}),n},Gs}var qs,Jl;function O0(){return Jl||(Jl=1,qs=function(e,t){if(t.length!==0){var n,i,a,s,d;for(a=0,d=t.length;a<d;a++)for(n=t[a],s=a+1;s<d;s++)i=t[s],e.mergeEdge(n,i)}}),qs}var Fs,ed;function T0(){return ed||(ed=1,Fs=function(e,t){if(t.length!==0){var n,i,a,s;if(e.mergeNode(t[0]),t.length!==1){for(a=1,s=t.length;a<s;a++)n=t[a-1],i=t[a],e.mergeEdge(n,i);e.mergeEdge(i,t[0])}}}),Fs}var js,td;function R0(){return td||(td=1,js=function(e,t){if(t.length!==0){var n,i,a,s;for(e.mergeNode(t[0]),a=1,s=t.length;a<s;a++)n=t[a-1],i=t[a],e.mergeEdge(n,i)}}),js}var Bs,nd;function L0(){return nd||(nd=1,Bs=function(e,t){if(t.length!==0){var n,i,a,s=t[0];for(e.mergeNode(s),i=1,a=t.length;i<a;i++)n=t[i],e.mergeEdge(s,n)}}),Bs}var Us,rd;function z0(){if(rd)return Us;rd=1;var r=Vn().copyEdge;return Us=function(t,n,i){typeof n>"u"&&(n={}),typeof i>"u"&&(i={});var a=t.nullCopy();t.forEachNode(function(f,h){var y=n[f];typeof y>"u"&&(y=f),a.addNode(y,h)});var s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,_,D){f!==s&&(s=f,d=n[f],typeof d>"u"&&(d=f));var k=n[h];typeof k>"u"&&(k=h);var N=i[w];typeof N>"u"&&(N=w),r(a,D,N,d,k,_)}),a},Us}var Ks,id;function $0(){if(id)return Ks;id=1;var r=Vn().copyEdge;return Ks=function(t,n,i){var a=t.nullCopy();t.forEachNode(function(f,h){var y=n?n(f,h):f;a.addNode(y,h)});var s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,_,D){f!==s&&(s=f,d=n?n(f,y):f);var k=n?n(h,v):h,N=i?i(w,_,f,h,y,v,D):w;r(a,D,N,d,k,_)}),a},Ks}var ad;function G0(){return ad||(ad=1,Jt.inferMulti=N0(),Jt.inferType=Wu(),Jt.isGraph=je(),Jt.isGraphConstructor=xn(),Jt.mergeClique=O0(),Jt.mergeCycle=T0(),Jt.mergePath=R0(),Jt.mergeStar=L0(),Jt.renameGraphKeys=z0(),Jt.updateGraphKeys=$0()),Jt}var Ws,od;function q0(){return od||(od=1,Ws=G0()),Ws}var F0=q0(),sd=[[0,1,2,3,4],[1,0,5,6],[2,0,3,4],[3,0,1,2,5,4,6],[5,1,3,6],[4,0,2,3,6,7],[6,1,3,5,4,7],[7,4,6,8],[8,7,9],[9,8]];function j0(r,e={}){if(!Hu.isGraphConstructor(r))throw new Error("invalid Graph constructor.");var t=new r(e),n,i;for(n=0,i=sd.length;n<i;n++)F0.mergeStar(t,sd[n]);return t}const B0={stars:[{id:0,label:"Hamal",ra:"02 08 34.7",dec:"23 34 50.5",magnitude:2.17},{id:1,label:"Sheratan",ra:"01 56 01.0",dec:"20 55 48.5",magnitude:2.7},{id:2,label:"Gamma",ra:"01 54 53.8",dec:"19 24 58.7",magnitude:3.84},{id:3,label:"41 Arietis",ra:"02 51 27.2",dec:"27 21 50.6",magnitude:3.58}],edges:[[0,1],[1,2],[0,3]]},U0={stars:[{id:0,label:"Aldebaran",ra:"04 37 21.6",dec:"16 33 34.5",magnitude:1},{id:1,label:"Elnath",ra:"05 26 17.5",dec:"28 36 27.0",magnitude:1.65},{id:2,label:"Zeta",ra:"05 37 38.7",dec:"21 08 33.0",magnitude:2.97},{id:3,label:"Theta2",ra:"04 30 05.6",dec:"15 55 34.7",magnitude:3.45},{id:4,label:"Lambda",ra:"04 02 04.1",dec:"12 33 38.8",magnitude:3.38},{id:5,label:"Omicron",ra:"03 26 09.5",dec:"09 06 59.4",magnitude:3.77},{id:6,label:"Gamma",ra:"04 21 13.2",dec:"15 41 16.8",magnitude:3.8},{id:7,label:"Delta",ra:"04 24 22.8",dec:"17 36 04.5",magnitude:3.92},{id:8,label:"Delta3",ra:"04 26 56.4",dec:"17 59 06.4",magnitude:4.31},{id:9,label:"Ain",ra:"04 30 04.9",dec:"19 14 09.9",magnitude:3.69},{id:10,label:"Tau",ra:"04 43 45.1",dec:"23 00 19.2",magnitude:4.22},{id:11,label:"Atlas",ra:"03 50 39.0",dec:"24 07 49.6",magnitude:4.22}],edges:[[0,3],[0,2],[6,4],[4,5],[3,6],[6,7],[8,7],[8,9],[9,0],[9,10],[1,10],[11,7]]},K0={stars:[{id:0,label:"Castor",ra:"07 36 12.8",dec:"31 50 01.2",magnitude:1.58},{id:1,label:"Pollux",ra:"07 46 52.0",dec:"27 57 57.2",magnitude:1.29},{id:2,label:"Kappa",ra:"07 45 58.6",dec:"24 20 15.9",magnitude:3.72},{id:3,label:"Upsilon",ra:"07 37 29.0",dec:"26 50 24.6",magnitude:4.16},{id:4,label:"Iota",ra:"07 27 17.9",dec:"27 44 54.9",magnitude:3.94},{id:5,label:"Tau",ra:"07 12 44.9",dec:"30 12 16.7",magnitude:4.53},{id:6,label:"Theta",ra:"06 54 27.2",dec:"33 55 55.1",magnitude:3.63},{id:7,label:"Wasat",ra:"07 21 38.1",dec:"21 56 09.7",magnitude:3.59},{id:8,label:"Mekbuda",ra:"07 05 36.5",dec:"20 32 00.0",magnitude:4.16},{id:9,label:"Alhena",ra:"06 39 10.1",dec:"16 22 38.5",magnitude:1.92},{id:10,label:"Lambda",ra:"07 19 32.8",dec:"16 29 40.3",magnitude:3.61},{id:11,label:"Xi",ra:"06 46 42.4",dec:"12 52 04.2",magnitude:3.44},{id:12,label:"Mebsuta",ra:"06 45 29.1",dec:"25 06 23.7",magnitude:3.19},{id:13,label:"Nu",ra:"06 30 27.6",dec:"20 11 46.3",magnitude:4.09},{id:14,label:"Tejat",ra:"06 24 29.2",dec:"22 30 03.1",magnitude:2.91},{id:15,label:"Propus",ra:"06 16 24.0",dec:"22 29 58.9",magnitude:3.28},{id:16,label:"1",ra:"06 05 39.1",dec:"23 15 43.8",magnitude:4.31}],edges:[[0,5],[1,3],[3,2],[3,4],[4,5],[5,6],[3,7],[7,8],[7,10],[8,9],[10,11],[5,12],[12,13],[12,14],[14,15],[15,16]]},W0={stars:[{id:0,label:"Acubens",ra:"08 59 52.7",dec:"11 45 32.4",magnitude:4.28},{id:1,label:"Beta",ra:"08 17 53.5",dec:"09 06 24.1",magnitude:3.66},{id:2,label:"Asellus Australis",ra:"08 46 07.7",dec:"18 03 39.9",magnitude:4.09},{id:3,label:"Asellus Borealis",ra:"08 44 45.4",dec:"21 22 39.2",magnitude:4.66},{id:4,label:"Chi",ra:"08 21 36.4",dec:"27 08 10.9",magnitude:5.22},{id:5,label:"Iota",ra:"08 48 14.1",dec:"28 40 04.4",magnitude:4.19}],edges:[[0,2],[1,2],[2,3],[3,4],[3,5]]},H0={stars:[{id:0,label:"Regulus",ra:"10 09 44.0",dec:"11 50 33.1",magnitude:1.32},{id:1,label:"Algieba",ra:"10 21 22.9",dec:"19 42 46.3",magnitude:2.16},{id:2,label:"Zosma",ra:"11 15 28.3",dec:"20 23 02.6",magnitude:2.58},{id:3,label:"Adhafera",ra:"10 18 06.7",dec:"23 17 27.1",magnitude:3.5},{id:4,label:"Denebola",ra:"11 50 22.2",dec:"14 25 44.7",magnitude:2.16},{id:5,label:"Chertan",ra:"11 15 35.1",dec:"15 17 24.1",magnitude:3.33},{id:6,label:"Eta",ra:"10 08 43.5",dec:"16 38 18.8",magnitude:3.5},{id:7,label:"Rasalas",ra:"09 54 12.9",dec:"25 53 16.1",magnitude:4.03},{id:8,label:"Epsilon",ra:"09 47 18.0",dec:"23 39 27.6",magnitude:3.11}],edges:[[1,3],[2,5],[5,4],[1,6],[2,1],[6,0],[0,5],[3,7],[7,8],[2,4]]},Y0={stars:[{id:0,label:"Nu",ra:"11 47 10.7",dec:"06 23 09.0",magnitude:4.13},{id:1,label:"Zaniah",ra:"12 21 13.2",dec:"-00 48 34.3",magnitude:3.89},{id:2,label:"Porrima",ra:"12 42 57.7",dec:"-01 35 23.7",magnitude:2.81},{id:3,label:"Spica",ra:"13 26 32.8",dec:"-11 17 43.6",magnitude:.89},{id:4,label:"Kappa",ra:"14 14 15.9",dec:"-10 23 36.5",magnitude:4.31},{id:5,label:"Syrma",ra:"14 17 21.6",dec:"-06 07 24.0",magnitude:4.16},{id:6,label:"Mu",ra:"14 44 24.8",dec:"-05 46 13.4",magnitude:3.95},{id:7,label:"109",ra:"14 47 32.8",dec:"01 47 01.4",magnitude:3.73},{id:8,label:"Tau",ra:"14 02 57.3",dec:"01 25 10.9",magnitude:4.25},{id:9,label:"Heze",ra:"13 36 00.2",dec:"-00 43 38.6",magnitude:3.41},{id:10,label:"Delta",ra:"12 56 53.9",dec:"03 15 28.1",magnitude:3.44},{id:11,label:"Vindemiatrix",ra:"13 03 27.4",dec:"10 49 15.5",magnitude:2.98}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[7,8],[8,9],[9,10],[10,11],[2,10],[3,9]]},X0={stars:[{id:0,label:"Zubenelgenubi II",ra:"14 52 17.9",dec:"-16 08 54.7",magnitude:2.78},{id:1,label:"Sigma",ra:"15 05 34.3",dec:"-25 22 56.3",magnitude:3.3},{id:2,label:"Zubeneschamali",ra:"15 18 23.1",dec:"-09 28 41.6",magnitude:2.56},{id:3,label:"Gamma",ra:"15 36 57.5",dec:"-14 52 31.6",magnitude:4.06},{id:4,label:"Theta",ra:"15 55 16.9",dec:"-16 48 17.5",magnitude:4.28},{id:5,label:"Upsilon",ra:"15 38 34.7",dec:"-28 13 09.8",magnitude:3.73}],edges:[[0,1],[0,2],[2,3],[3,4],[2,1],[1,5]]},V0={stars:[{id:0,label:"Acrab",ra:"16 06 55.3",dec:"-19 52 32.6",magnitude:2.59},{id:1,label:"Dschubba",ra:"16 01 50.6",dec:"-22 41 40.4",magnitude:2.25},{id:2,label:"Pi",ra:"16 00 23.8",dec:"-26 11 14.7",magnitude:2.81},{id:3,label:"Antares",ra:"16 30 58.3",dec:"-26 29 18.3",magnitude:.97},{id:4,label:"Tau",ra:"16 37 28.1",dec:"-28 16 06.8",magnitude:2.73},{id:5,label:"Epsilon",ra:"16 51 48.9",dec:"-34 20 18.8",magnitude:2.45},{id:6,label:"Mu1",ra:"16 53 35.8",dec:"-38 05 23.0",magnitude:2.92},{id:7,label:"Zeta2",ra:"16 56 22.6",dec:"-42 24 11.1",magnitude:3.75},{id:8,label:"Eta",ra:"17 13 58.6",dec:"-43 16 14.8",magnitude:3.41},{id:9,label:"Sargas",ra:"17 39 08.6",dec:"-43 00 43.4",magnitude:1.92},{id:10,label:"Iota1",ra:"17 49 21.5",dec:"-40 08 06.6",magnitude:3.09},{id:11,label:"Kappa",ra:"17 44 14.6",dec:"-39 02 29.6",magnitude:2.31},{id:12,label:"Shaula",ra:"17 35 19.9",dec:"-37 07 15.9",magnitude:1.52},{id:13,label:"Lesath",ra:"17 32 29.4",dec:"-37 18 53.3",magnitude:2.59}],edges:[[0,3],[1,3],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12]]},Q0={stars:[{id:0,label:"51",ra:"17 22 58.0",dec:"-23 58 57.0",magnitude:4.78},{id:1,label:"Sabik",ra:"17 11 50.2",dec:"-15 45 26.7",magnitude:2.44},{id:2,label:"Zeta",ra:"16 38 33.8",dec:"-10 37 12.4",magnitude:2.56},{id:3,label:"Yed",ra:"16 19 40.3",dec:"-04 45 23.3",magnitude:3.38},{id:4,label:"Kappa",ra:"16 58 52.5",dec:"09 19 55.5",magnitude:3.36},{id:5,label:"Resalhague",ra:"17 36 06.9",dec:"12 32 15.6",magnitude:2.13},{id:6,label:"Cabalrai",ra:"17 44 43.7",dec:"04 33 12.4",magnitude:2.92},{id:7,label:"Gaia DR2",ra:"15 50 57.4",dec:"-03 30 35.9",magnitude:3.33},{id:8,label:"Epsilon",ra:"15 52 05.6",dec:"04 23 55.1",magnitude:3.75},{id:9,label:"Unukalhai",ra:"15 45 31.8",dec:"06 20 34.7",magnitude:2.8},{id:10,label:"Delta A",ra:"15 36 01.6",dec:"10 27 03.7",magnitude:3.86},{id:11,label:"Beta",ra:"15 47 22.3",dec:"15 20 20.6",magnitude:3.67},{id:12,label:"Gamma",ra:"15 57 38.2",dec:"15 34 31.3",magnitude:3.94},{id:13,label:"Kappa",ra:"15 49 53.7",dec:"18 03 34.6",magnitude:4.19},{id:14,label:"Nu",ra:"17 22 15.5",dec:"-12 52 26.5",magnitude:4.34},{id:15,label:"Xi",ra:"17 39 02.5",dec:"-15 24 56.5",magnitude:3.59},{id:16,label:"Omicron",ra:"17 42 50.5",dec:"-12 53 25.2",magnitude:4.25},{id:17,label:"Eta",ra:"18 22 37.2",dec:"-02 53 41.5",magnitude:3.39},{id:18,label:"Alya",ra:"18 57 28.5",dec:"04 13 59.3",magnitude:4.66}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,1],[14,15],[15,16],[16,17],[17,18],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,11]]},Z0={stars:[{id:0,label:"Beta2",ra:"19 25 02.3",dec:"-44 45 00.2",magnitude:4.34},{id:1,label:"Rukbat",ra:"19 25 37.9",dec:"-40 34 00.1",magnitude:3.92},{id:2,label:"Iota",ra:"19 56 59.7",dec:"-41 48 00.9",magnitude:4.25},{id:3,label:"Theta1",ra:"20 01 22.3",dec:"-35 12 25.3",magnitude:4.28},{id:4,label:"62",ra:"20 04 12.2",dec:"-27 38 22.1",magnitude:4.44},{id:5,label:"h2",ra:"19 38 14.3",dec:"-24 49 40.7",magnitude:4.56},{id:6,label:"Tau",ra:"19 08 30.9",dec:"-27 37 59.7",magnitude:3.47},{id:7,label:"Nunki",ra:"18 56 49.9",dec:"-26 15 54.9",magnitude:2},{id:8,label:"Xi2",ra:"18 59 14.2",dec:"-21 04 26.3",magnitude:3.69},{id:9,label:"Omicron",ra:"19 06 11.7",dec:"-21 42 17.7",magnitude:3.91},{id:10,label:"43",ra:"19 19 06.6",dec:"-18 54 31.3",magnitude:5.03},{id:11,label:"Rho1",ra:"19 23 08.0",dec:"-17 48 01.9",magnitude:3.98},{id:12,label:"Eta",ra:"18 19 20.5",dec:"-36 45 10.2",magnitude:3.14},{id:13,label:"Kaus Australis",ra:"18 25 51.1",dec:"-34 22 17.9",magnitude:1.8},{id:14,label:"Ascella",ra:"19 04 13.1",dec:"-29 50 36.0",magnitude:2.61},{id:15,label:"Phi",ra:"18 47 14.1",dec:"-26 57 52.7",magnitude:3.13},{id:16,label:"Kaus Media",ra:"18 22 36.8",dec:"-29 49 00.8",magnitude:2.86},{id:17,label:"Alnsal",ra:"18 07 26.2",dec:"-30 25 23.7",magnitude:3.13},{id:18,label:"3",ra:"17 49 09.4",dec:"-27 50 24.9",magnitude:4.66},{id:19,label:"Kaus Borealis",ra:"18 29 32.0",dec:"-25 24 28.0",magnitude:2.97},{id:20,label:"Mu",ra:"18 15 16.7",dec:"-21 03 09.9",magnitude:3.86},{id:21,label:"HD 180885",ra:"19 21 20.2",dec:"-35 22 27.8",magnitude:5.53},{id:22,label:"V4089",ra:"19 35 52.0",dec:"-39 58 43.5",magnitude:5.91}],edges:[[0,1],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[12,13],[16,17],[17,18],[19,20],[7,15],[6,14],[15,19],[16,19],[14,21],[5,21],[2,22],[1,21],[21,22],[13,16],[13,17],[15,14],[15,16]]},J0={stars:[{id:0,label:"Algedi",ra:"20 19 26.8",dec:"-12 28 05.0",magnitude:3.73},{id:1,label:"Dabih",ra:"20 22 25.3",dec:"-14 42 10.1",magnitude:3.2},{id:2,label:"Psi",ra:"20 47 34.8",dec:"-25 10 49.4",magnitude:4.22},{id:3,label:"Omega",ra:"20 53 18.9",dec:"-26 49 29.2",magnitude:4.22},{id:4,label:"Theta",ra:"21 07 21.2",dec:"-17 08 01.0",magnitude:4.06},{id:5,label:"Zeta",ra:"21 28 05.7",dec:"-22 18 09.6",magnitude:3.92},{id:6,label:"Iota",ra:"21 23 38.3",dec:"-16 43 41.4",magnitude:4.44},{id:7,label:"Nashira",ra:"21 41 28.5",dec:"-16 32 58.0",magnitude:3.77},{id:8,label:"Deneb",ra:"21 48 25.1",dec:"-16 00 50.3",magnitude:2.94},{id:9,label:"Nu",ra:"20 22 03.4",dec:"-12 40 51.8",magnitude:4.72},{id:10,label:"Sigma",ra:"20 20 50.5",dec:"-19 02 25.9",magnitude:5.41}],edges:[[0,1],[1,2],[3,4],[4,1],[4,5],[5,6],[4,6],[6,7],[7,8],[1,9],[1,10]]},eb={stars:[{id:0,label:"c2",ra:"23 10 46.4",dec:"-21 02 11.8",magnitude:3.84},{id:1,label:"Skat",ra:"22 55 58.3",dec:"-15 41 17.0",magnitude:3.28},{id:2,label:"Tua",ra:"22 50 54.6",dec:"-13 27 39.6",magnitude:4.13},{id:3,label:"Sigma",ra:"22 31 57.9",dec:"-10 33 01.7",magnitude:4.81},{id:4,label:"Ancha",ra:"22 18 09.0",dec:"-07 39 34.2",magnitude:4.31},{id:5,label:"Sadalmelik",ra:"22 07 03.9",dec:"-00 11 58.6",magnitude:3.09},{id:6,label:"Sadachbia",ra:"22 22 56.6",dec:"-01 15 44.7",magnitude:3.83},{id:7,label:"Zeta",ra:"22 30 06.8",dec:"00 06 25.3",magnitude:3.73},{id:8,label:"Eta",ra:"22 36 38.2",dec:"00 00 37.0",magnitude:4},{id:9,label:"Lambda",ra:"22 53 54.9",dec:"-07 26 50.0",magnitude:3.8},{id:10,label:"Psi1",ra:"23 17 11.7",dec:"-08 57 07.4",magnitude:4.41},{id:11,label:"b1",ra:"23 24 16.6",dec:"-19 57 51.0",magnitude:4.09},{id:12,label:"Iota",ra:"22 07 47.0",dec:"-13 44 55.3",magnitude:4.25},{id:13,label:"Sadalsuud",ra:"21 32 52.4",dec:"-05 27 43.9",magnitude:3.03},{id:14,label:"Albali",ra:"20 49 01.9",dec:"-09 24 18.4",magnitude:3.78}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[4,12],[13,14],[5,13]]},tb={stars:[{id:0,label:"Upsilon",ra:"25 20 50.0",dec:"27 23 43.0",magnitude:4.75},{id:1,label:"Sigma",ra:"25 04 10.7",dec:"31 56 17.7",magnitude:5.47},{id:2,label:"Phi",ra:"25 15 06.0",dec:"24 42 57.1",magnitude:4.81},{id:3,label:"Eta",ra:"25 32 49.0",dec:"15 28 27.7",magnitude:3.78},{id:4,label:"Omicron",ra:"25 46 42.6",dec:"09 16 58.9",magnitude:4.41},{id:5,label:"Alrescha",ra:"26 03 20.2",dec:"02 53 02.2",magnitude:3.81},{id:6,label:"Xi",ra:"25 54 50.8",dec:"03 18 37.5",magnitude:4.75},{id:7,label:"Nu",ra:"25 42 43.7",dec:"05 36 49.0",magnitude:4.56},{id:8,label:"Mu",ra:"25 31 29.4",dec:"06 16 19.8",magnitude:4.97},{id:9,label:"Epsilon",ra:"25 04 14.1",dec:"08 01 26.9",magnitude:4.41},{id:10,label:"Delta",ra:"24 49 58.4",dec:"07 43 13.8",magnitude:4.53},{id:11,label:"41",ra:"24 21 52.7",dec:"08 19 42.0",magnitude:5.53},{id:12,label:"Omega",ra:"24 00 35.3",dec:"07 00 03.0",magnitude:4.09},{id:13,label:"Iota",ra:"23 41 13.8",dec:"05 45 38.8",magnitude:4.22},{id:14,label:"Theta",ra:"23 29 13.8",dec:"06 30 54.9",magnitude:4.44},{id:15,label:"Gamma",ra:"23 18 27.4",dec:"03 25 04.4",magnitude:3.84},{id:16,label:"Kappa",ra:"23 28 12.5",dec:"01 23 29.7",magnitude:4.94},{id:17,label:"Lambda",ra:"23 43 18.9",dec:"01 55 00.3",magnitude:4.53}],edges:[[0,1],[1,2],[0,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,14],[14,15],[15,16],[16,17],[17,13]]},nb={aries:B0,taurus:U0,gemini:K0,cancer:W0,leo:H0,virgo:Y0,libra:X0,scorpius:V0,ophiuchus:Q0,sagittarius:Z0,capricornus:J0,aquarius:eb,pisces:tb};class rb{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout}load(e){const t=nb[e.toLowerCase()];t?(this.graphManager.graph=sb(e,t.stars,t.edges,this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("rotate180")):console.warn(`Constellation "${e}" not found.`)}aries(){this.load("aries")}taurus(){this.load("taurus")}gemini(){this.load("gemini")}cancer(){this.load("cancer")}leo(){this.load("leo")}virgo(){this.load("virgo")}libra(){this.load("libra")}scorpius(){this.load("scorpius")}ophiuchus(){this.load("ophiuchus")}sagittarius(){this.load("sagittarius")}capricornus(){this.load("capricornus")}aquarius(){this.load("aquarius")}pisces(){this.load("pisces")}orion(){this.load("orion")}}function ib(r=3){return Math.pow(.8,r)}function ab(r){const[e,t,n]=r.split(" ").map(parseFloat);return(e+t/60+n/3600)*15}function ob(r){const e=r.trim().startsWith("-")?-1:1,t=r.trim().replace("+","").replace("-","").split(" ").map(parseFloat),[n,i,a]=t;return e*(n+i/60+a/3600)}function sb(r,e,t,n){const i=new n;return e.forEach(a=>{const s=ab(a.ra),d=ob(a.dec);i.addNode(a.id,{label:a.label,x:s,y:d,magnitude:a.magnitude,size:ib(a.magnitude),desc:{name:a.label,magnitude:a.magnitude,RA:ub(a.ra),DEC:a.dec}})}),t.forEach(([a,s])=>{i.mergeEdge(a,s)}),i}function ub(r){let[e=0,t=0,n=0]=r.split(" ").map(Number);n=n%60,t=t%60,e=e%24;const i=String(e).padStart(2,"0"),a=String(t).padStart(2,"0"),s=n.toFixed(1).padStart(4,"0");return[i,a,s].join(" ")}class cb{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout,this.zodiac=new rb(e)}empty(e){this.graphManager.graph=Wn.empty(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("circle")}complete(e){this.graphManager.graph=Wn.complete(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("circle")}ladder(e){this.graphManager.graph=Wn.ladder(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}completeBipartite(e,t){this.graphManager.graph=Wn.empty(this.graphManager.graphClass[this.settings.type],+e+ +t);for(let n=0;n<+e;n++)for(let i=+e;i<Number(e)+ +t;i++)this.graphManager.graph.addEdge(n,i);this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}cycle(e){this.graphManager.graph=Wn.path(this.graphManager.graphClass[this.settings.type],+e),this.graphManager.graph.addEdge(0,+e-1),this.layout.applyLayout("circle")}path(e){this.graphManager.graph=Wn.path(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("oneLine")}caveman(e,t){this.graphManager.graph=Bl.caveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.layout.applyLayout("circle")}connectedCaveman(e,t){this.graphManager.graph=Bl.connectedCaveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.layout.applyLayout("circle")}clusters(e,t,n){this.graphManager.graph=Rs.clusters(this.graphManager.graphClass[this.settings.type],{order:+e<2?2:+e,size:+t<2?2:+t,clusters:+n<2?2:+n}),this.layout.applyLayout("random")}erdosRenyi(e,t){this.graphManager.graph=Rs.erdosRenyi(this.graphManager.graphClass[this.settings.type],{order:+e,probability:+t>1?1:+t}),this.layout.applyLayout("circle")}girvanNewman(e){this.graphManager.graph=Rs.girvanNewman(this.graphManager.graphClass[this.settings.type],{zOut:4}),this.layout.applyLayout("circle")}krackhardtkite(){this.graphManager.graph=j0(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("oneLine")}florentineFamilies(){this.graphManager.graph=P0(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("circle")}karateClub(){this.graphManager.graph=M0(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("circle")}}const ud=document;class lb{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.panel=ud.querySelector("widgets #graphs-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(n=>n.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph;this.index=e.split("-")[1];const n=t.getAttributes();if(this.selectLi(this.index),this.graphManager.metric.addNEFGInfo(n),this.graphManager.facePanel.updateFacePanel(),this.app.keyHandler.isCtrlHold()){let i=this.lis().map(a=>this.graphManager.graphs.all[a].nodes());i=new Set(i.flat()),this.graphManager.selectAllNode(i),this.graphManager.redraw({node:!0})}}selectLi(e){this.app.keyHandler.isCtrlHold()||(this.graphManager.graphs.index=this.index,this.deselectLis()),this.graphManager.graph.updateAttribute("selected",n=>!0);const t=this.ul.querySelector(`#graphs-${e}`);t&&t.classList.toggle("select")}updateGraphsPanel(){this.ul.innerHTML="",this.graphManager.graphs.all.forEach((e,t)=>{e.getAttribute("id")===void 0&&e.setAttribute("id",t),e.getAttribute("selected")||e.setAttribute("selected",!1),e.getAttribute("label")||e.setAttribute("label",`graph ${t}`);const n=ud.createElement("li");n.id=`graphs-${e.getAttribute("id")}`,n.setAttribute("name","graphs"),n.textContent=e.getAttribute("label"),this.ul.appendChild(n)})}listeners(){this.panel.addEventListener("click",e=>{e.target.id=="graphs-panel"&&this.deselectLis()})}deselectLis(){this.lis("node").forEach(e=>e.classList.remove("select")),this.graphManager.deselectAll()}}const cd=document;class db{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.settings=e.settings,this.panel=cd.querySelector("widgets #face-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners(),this.events()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(n=>n.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph,n=e.split("-")[1],i=t.getFaceAttributes(n);this.selectLi(n),this.graphManager.metric.addNEFGInfo(i);let a=this.lis().map(s=>t.getFaceAttribute(s,"nodes"));a=new Set(a.flat()),this.app.keyHandler.isCtrlHold()&&(this.graphManager.selectAllNode(a),this.graphManager.redraw({face:!0,node:!0}))}selectLi(e){this.app.keyHandler.isCtrlHold()||this.deselectLis(),this.graphManager.graph.selectFace(e);const t=this.ul.querySelector(`#face-${e}`);if(t&&t.classList.toggle("select"),this.settings.colorPicker){const n=this.graphManager.graph.getFaceAttribute(e,"color"),i=this.graphManager.graph.getFaceAttribute(e,"labelColor");this.app.colorPicker.setColor("face",n),this.app.colorPicker.setColor("label",i)}}updateFacePanel(){this.ul.innerHTML="";const e=this.graphManager.graph;let t=0;e.forEachFace((n,i)=>{t++,e.getFaceAttribute(n,"id")===void 0&&e.setFaceAttribute(n,"id",index),e.getFaceAttribute(n,"label")||e.setFaceAttribute(n,"label",`face ${t}`);const a=cd.createElement("li");a.id=`face-${n}`,a.setAttribute("name","faces"),a.setAttribute("key",n),a.textContent=e.getFaceAttribute(n,"label"),this.ul.appendChild(a)})}listeners(){this.panel.addEventListener("click",e=>{e.target.id=="face-panel"&&this.deselectLis()})}events(){this.eventBus.on("key:down",e=>{[...e.detail.key].join("")})}deselectLis(){this.lis("node").forEach(e=>e.classList.remove("select")),this.graphManager.deselectAll()}}var Ja={exports:{}},hb=Ja.exports,ld;function fb(){return ld||(ld=1,function(r,e){(function(t,n){r.exports=n()})(hb,function(){var t=function(o,u){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,b){g.__proto__=b}||function(g,b){for(var x in b)Object.prototype.hasOwnProperty.call(b,x)&&(g[x]=b[x])})(o,u)},n=function(){return(n=Object.assign||function(o){for(var u,g=1,b=arguments.length;g<b;g++)for(var x in u=arguments[g])Object.prototype.hasOwnProperty.call(u,x)&&(o[x]=u[x]);return o}).apply(this,arguments)};function i(o,u,g){for(var b,x=0,C=u.length;x<C;x++)!b&&x in u||((b=b||Array.prototype.slice.call(u,0,x))[x]=u[x]);return o.concat(b||Array.prototype.slice.call(u))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ev,s=Object.keys,d=Array.isArray;function f(o,u){return typeof u!="object"||s(u).forEach(function(g){o[g]=u[g]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function v(o,u){return y.call(o,u)}function w(o,u){typeof u=="function"&&(u=u(h(o))),(typeof Reflect>"u"?s:Reflect.ownKeys)(u).forEach(function(g){D(o,g,u[g])})}var _=Object.defineProperty;function D(o,u,g,b){_(o,u,f(g&&v(g,"get")&&typeof g.get=="function"?{get:g.get,set:g.set,configurable:!0}:{value:g,configurable:!0,writable:!0},b))}function k(o){return{from:function(u){return o.prototype=Object.create(u.prototype),D(o.prototype,"constructor",o),{extend:w.bind(null,o.prototype)}}}}var N=Object.getOwnPropertyDescriptor,O=[].slice;function M(o,u,g){return O.call(o,u,g)}function z(o,u){return u(o)}function A(o){if(!o)throw new Error("Assertion Failed")}function T(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function K(o,u){if(typeof u=="string"&&v(o,u))return o[u];if(!u)return o;if(typeof u!="string"){for(var g=[],b=0,x=u.length;b<x;++b){var C=K(o,u[b]);g.push(C)}return g}var L=u.indexOf(".");if(L!==-1){var B=o[u.substr(0,L)];return B==null?void 0:K(B,u.substr(L+1))}}function S(o,u,g){if(o&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof u!="string"&&"length"in u){A(typeof g!="string"&&"length"in g);for(var b=0,x=u.length;b<x;++b)S(o,u[b],g[b])}else{var C,L,B=u.indexOf(".");B!==-1?(C=u.substr(0,B),(L=u.substr(B+1))===""?g===void 0?d(o)&&!isNaN(parseInt(C))?o.splice(C,1):delete o[C]:o[C]=g:S(B=!(B=o[C])||!v(o,C)?o[C]={}:B,L,g)):g===void 0?d(o)&&!isNaN(parseInt(u))?o.splice(u,1):delete o[u]:o[u]=g}}function G(o){var u,g={};for(u in o)v(o,u)&&(g[u]=o[u]);return g}var q=[].concat;function F(o){return q.apply([],o)}var st="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(F([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(u){return u+o+"Array"})}))).filter(function(o){return a[o]}),W=new Set(st.map(function(o){return a[o]})),Z=null;function j(o){return Z=new WeakMap,o=function u(g){if(!g||typeof g!="object")return g;var b=Z.get(g);if(b)return b;if(d(g)){b=[],Z.set(g,b);for(var x=0,C=g.length;x<C;++x)b.push(u(g[x]))}else if(W.has(g.constructor))b=g;else{var L,B=h(g);for(L in b=B===Object.prototype?{}:Object.create(B),Z.set(g,b),g)v(g,L)&&(b[L]=u(g[L]))}return b}(o),Z=null,o}var ve={}.toString;function ge(o){return ve.call(o).slice(8,-1)}var X=typeof Symbol<"u"?Symbol.iterator:"@@iterator",P=typeof X=="symbol"?function(o){var u;return o!=null&&(u=o[X])&&u.apply(o)}:function(){return null};function ee(o,u){return u=o.indexOf(u),0<=u&&o.splice(u,1),0<=u}var ne={};function le(o){var u,g,b,x;if(arguments.length===1){if(d(o))return o.slice();if(this===ne&&typeof o=="string")return[o];if(x=P(o)){for(g=[];!(b=x.next()).done;)g.push(b.value);return g}if(o==null)return[o];if(typeof(u=o.length)!="number")return[o];for(g=new Array(u);u--;)g[u]=o[u];return g}for(u=arguments.length,g=new Array(u);u--;)g[u]=arguments[u];return g}var oe=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},xt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],l=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(xt),he={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ue(o,u){this.name=o,this.message=u}function me(o,u){return o+". Errors: "+Object.keys(u).map(function(g){return u[g].toString()}).filter(function(g,b,x){return x.indexOf(g)===b}).join(`
`)}function _e(o,u,g,b){this.failures=u,this.failedKeys=b,this.successCount=g,this.message=me(o,u)}function Me(o,u){this.name="BulkError",this.failures=Object.keys(u).map(function(g){return u[g]}),this.failuresByPos=u,this.message=me(o,this.failures)}k(ue).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(_e).from(ue),k(Me).from(ue);var Oe=l.reduce(function(o,u){return o[u]=u+"Error",o},{}),qe=ue,ce=l.reduce(function(o,u){var g=u+"Error";function b(x,C){this.name=g,x?typeof x=="string"?(this.message="".concat(x).concat(C?`
 `+C:""),this.inner=C||null):typeof x=="object"&&(this.message="".concat(x.name," ").concat(x.message),this.inner=x):(this.message=he[u]||g,this.inner=null)}return k(b).from(qe),o[u]=b,o},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var Pe=xt.reduce(function(o,u){return o[u+"Error"]=ce[u],o},{}),Re=l.reduce(function(o,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(o[u+"Error"]=ce[u]),o},{});function ke(){}function Ke(o){return o}function Le(o,u){return o==null||o===Ke?u:function(g){return u(o(g))}}function Ee(o,u){return function(){o.apply(this,arguments),u.apply(this,arguments)}}function fe(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);g!==void 0&&(arguments[0]=g);var b=this.onsuccess,x=this.onerror;this.onsuccess=null,this.onerror=null;var C=u.apply(this,arguments);return b&&(this.onsuccess=this.onsuccess?Ee(b,this.onsuccess):b),x&&(this.onerror=this.onerror?Ee(x,this.onerror):x),C!==void 0?C:g}}function vt(o,u){return o===ke?u:function(){o.apply(this,arguments);var g=this.onsuccess,b=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),g&&(this.onsuccess=this.onsuccess?Ee(g,this.onsuccess):g),b&&(this.onerror=this.onerror?Ee(b,this.onerror):b)}}function it(o,u){return o===ke?u:function(g){var b=o.apply(this,arguments);f(g,b);var x=this.onsuccess,C=this.onerror;return this.onsuccess=null,this.onerror=null,g=u.apply(this,arguments),x&&(this.onsuccess=this.onsuccess?Ee(x,this.onsuccess):x),C&&(this.onerror=this.onerror?Ee(C,this.onerror):C),b===void 0?g===void 0?void 0:g:f(b,g)}}function Et(o,u){return o===ke?u:function(){return u.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function at(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);if(g&&typeof g.then=="function"){for(var b=this,x=arguments.length,C=new Array(x);x--;)C[x]=arguments[x];return g.then(function(){return u.apply(b,C)})}return u.apply(this,arguments)}}Re.ModifyError=_e,Re.DexieError=ue,Re.BulkError=Me;var Ve=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ht(o){Ve=o}var ot={},gt=100,st=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,h(o),o];var u=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[u,h(u),o]}(),xt=st[0],l=st[1],st=st[2],l=l&&l.then,ut=xt&&xt.constructor,ft=!!st,nt=function(o,u){_n.push([o,u]),mt&&(queueMicrotask(la),mt=!1)},_t=!0,mt=!0,Pt=[],on=[],Qn=Ke,Nt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},ze=Nt,_n=[],bt=0,St=[];function Se(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=ze;if(typeof o!="function"){if(o!==ot)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Zn(this,this._value))}this._state=null,this._value=null,++u.ref,function g(b,x){try{x(function(C){if(b._state===null){if(C===b)throw new TypeError("A promise cannot be resolved with itself.");var L=b._lib&&er();C&&typeof C.then=="function"?g(b,function(B,H){C instanceof Se?C._then(B,H):C.then(B,H)}):(b._state=!0,b._value=C,Jn(b)),L&&Sn()}},Zn.bind(null,b))}catch(C){Zn(b,C)}}(this,o)}var sn={get:function(){var o=ze,u=Br;function g(b,x){var C=this,L=!o.global&&(o!==ze||u!==Br),B=L&&!$e(),H=new Se(function(V,J){fr(C,new $n(Ur(b,o,L,B),Ur(x,o,L,B),V,J,o))});return this._consoleTask&&(H._consoleTask=this._consoleTask),H}return g.prototype=ot,g},set:function(o){D(this,"then",o&&o.prototype===ot?sn:{get:function(){return o},set:sn.set})}};function $n(o,u,g,b,x){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof u=="function"?u:null,this.resolve=g,this.reject=b,this.psd=x}function Zn(o,u){var g,b;on.push(u),o._state===null&&(g=o._lib&&er(),u=Qn(u),o._state=!1,o._value=u,b=o,Pt.some(function(x){return x._value===b._value})||Pt.push(b),Jn(o),g&&Sn())}function Jn(o){var u=o._listeners;o._listeners=[];for(var g=0,b=u.length;g<b;++g)fr(o,u[g]);var x=o._PSD;--x.ref||x.finalize(),bt===0&&(++bt,nt(function(){--bt==0&&pr()},[]))}function fr(o,u){if(o._state!==null){var g=o._state?u.onFulfilled:u.onRejected;if(g===null)return(o._state?u.resolve:u.reject)(o._value);++u.psd.ref,++bt,nt(ca,[g,o,u])}else o._listeners.push(u)}function ca(o,u,g){try{var b,x=u._value;!u._state&&on.length&&(on=[]),b=Ve&&u._consoleTask?u._consoleTask.run(function(){return o(x)}):o(x),u._state||on.indexOf(x)!==-1||function(C){for(var L=Pt.length;L;)if(Pt[--L]._value===C._value)return Pt.splice(L,1)}(u),g.resolve(b)}catch(C){g.reject(C)}finally{--bt==0&&pr(),--g.psd.ref||g.psd.finalize()}}function la(){Bt(Nt,function(){er()&&Sn()})}function er(){var o=_t;return mt=_t=!1,o}function Sn(){var o,u,g;do for(;0<_n.length;)for(o=_n,_n=[],g=o.length,u=0;u<g;++u){var b=o[u];b[0].apply(null,b[1])}while(0<_n.length);mt=_t=!0}function pr(){var o=Pt;Pt=[],o.forEach(function(b){b._PSD.onunhandled.call(null,b._value,b)});for(var u=St.slice(0),g=u.length;g;)u[--g]()}function jr(o){return new Se(ot,!1,o)}function Je(o,u){var g=ze;return function(){var b=er(),x=ze;try{return An(g,!0),o.apply(this,arguments)}catch(C){u&&u(C)}finally{An(x,!1),b&&Sn()}}}w(Se.prototype,{then:sn,_then:function(o,u){fr(this,new $n(null,null,o,u,ze))},catch:function(o){if(arguments.length===1)return this.then(null,o);var u=o,g=arguments[1];return typeof u=="function"?this.then(null,function(b){return(b instanceof u?g:jr)(b)}):this.then(null,function(b){return(b&&b.name===u?g:jr)(b)})},finally:function(o){return this.then(function(u){return Se.resolve(o()).then(function(){return u})},function(u){return Se.resolve(o()).then(function(){return jr(u)})})},timeout:function(o,u){var g=this;return o<1/0?new Se(function(b,x){var C=setTimeout(function(){return x(new ce.Timeout(u))},o);g.then(b,x).finally(clearTimeout.bind(null,C))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&D(Se.prototype,Symbol.toStringTag,"Dexie.Promise"),Nt.env=ha(),w(Se,{all:function(){var o=le.apply(null,arguments).map(gr);return new Se(function(u,g){o.length===0&&u([]);var b=o.length;o.forEach(function(x,C){return Se.resolve(x).then(function(L){o[C]=L,--b||u(o)},g)})})},resolve:function(o){return o instanceof Se?o:o&&typeof o.then=="function"?new Se(function(u,g){o.then(u,g)}):new Se(ot,!0,o)},reject:jr,race:function(){var o=le.apply(null,arguments).map(gr);return new Se(function(u,g){o.map(function(b){return Se.resolve(b).then(u,g)})})},PSD:{get:function(){return ze},set:function(o){return ze=o}},totalEchoes:{get:function(){return Br}},newPSD:cn,usePSD:Bt,scheduler:{get:function(){return nt},set:function(o){nt=o}},rejectionMapper:{get:function(){return Qn},set:function(o){Qn=o}},follow:function(o,u){return new Se(function(g,b){return cn(function(x,C){var L=ze;L.unhandleds=[],L.onunhandled=C,L.finalize=Ee(function(){var B,H=this;B=function(){H.unhandleds.length===0?x():C(H.unhandleds[0])},St.push(function V(){B(),St.splice(St.indexOf(V),1)}),++bt,nt(function(){--bt==0&&pr()},[])},L.finalize),o()},u,g,b)})}}),ut&&(ut.allSettled&&D(Se,"allSettled",function(){var o=le.apply(null,arguments).map(gr);return new Se(function(u){o.length===0&&u([]);var g=o.length,b=new Array(g);o.forEach(function(x,C){return Se.resolve(x).then(function(L){return b[C]={status:"fulfilled",value:L}},function(L){return b[C]={status:"rejected",reason:L}}).then(function(){return--g||u(b)})})})}),ut.any&&typeof AggregateError<"u"&&D(Se,"any",function(){var o=le.apply(null,arguments).map(gr);return new Se(function(u,g){o.length===0&&g(new AggregateError([]));var b=o.length,x=new Array(b);o.forEach(function(C,L){return Se.resolve(C).then(function(B){return u(B)},function(B){x[L]=B,--b||g(new AggregateError(x))})})})}),ut.withResolvers&&(Se.withResolvers=ut.withResolvers));var ct={awaits:0,echoes:0,id:0},un=0,Xt=[],qt=0,Br=0,yo=0;function cn(o,u,g,b){var x=ze,C=Object.create(x);return C.parent=x,C.ref=0,C.global=!1,C.id=++yo,Nt.env,C.env=ft?{Promise:Se,PromiseProp:{value:Se,configurable:!0,writable:!0},all:Se.all,race:Se.race,allSettled:Se.allSettled,any:Se.any,resolve:Se.resolve,reject:Se.reject}:{},u&&f(C,u),++x.ref,C.finalize=function(){--this.parent.ref||this.parent.finalize()},b=Bt(C,o,g,b),C.ref===0&&C.finalize(),b}function Ot(){return ct.id||(ct.id=++un),++ct.awaits,ct.echoes+=gt,ct.id}function $e(){return!!ct.awaits&&(--ct.awaits==0&&(ct.id=0),ct.echoes=ct.awaits*gt,!0)}function gr(o){return ct.echoes&&o&&o.constructor===ut?(Ot(),o.then(function(u){return $e(),u},function(u){return $e(),et(u)})):o}function da(){var o=Xt[Xt.length-1];Xt.pop(),An(o,!1)}function An(o,u){var g,b=ze;(u?!ct.echoes||qt++&&o===ze:!qt||--qt&&o===ze)||queueMicrotask(u?(function(x){++Br,ct.echoes&&--ct.echoes!=0||(ct.echoes=ct.awaits=ct.id=0),Xt.push(ze),An(x,!0)}).bind(null,o):da),o!==ze&&(ze=o,b===Nt&&(Nt.env=ha()),ft&&(g=Nt.env.Promise,u=o.env,(b.global||o.global)&&(Object.defineProperty(a,"Promise",u.PromiseProp),g.all=u.all,g.race=u.race,g.resolve=u.resolve,g.reject=u.reject,u.allSettled&&(g.allSettled=u.allSettled),u.any&&(g.any=u.any))))}function ha(){var o=a.Promise;return ft?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Bt(o,u,g,b,x){var C=ze;try{return An(o,!0),u(g,b,x)}finally{An(C,!1)}}function Ur(o,u,g,b){return typeof o!="function"?o:function(){var x=ze;g&&Ot(),An(u,!0);try{return o.apply(this,arguments)}finally{An(x,!1),b&&queueMicrotask($e)}}}function xi(o){Promise===ut&&ct.echoes===0?qt===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+l).indexOf("[native code]")===-1&&(Ot=$e=ke);var et=Se.reject,Gn="",Vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",fa="String expected.",qn=[],yr="__dbnames",tr="readonly",Kr="readwrite";function ln(o,u){return o?u?function(){return o.apply(this,arguments)&&u.apply(this,arguments)}:o:u}var _i={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Wr(o){return typeof o!="string"||/\./.test(o)?function(u){return u}:function(u){return u[o]===void 0&&o in u&&delete(u=j(u))[o],u}}function Hr(){throw ce.Type()}function Ye(o,u){try{var g=Yr(o),b=Yr(u);if(g!==b)return g==="Array"?1:b==="Array"?-1:g==="binary"?1:b==="binary"?-1:g==="string"?1:b==="string"?-1:g==="Date"?1:b!=="Date"?NaN:-1;switch(g){case"number":case"Date":case"string":return u<o?1:o<u?-1:0;case"binary":return function(x,C){for(var L=x.length,B=C.length,H=L<B?L:B,V=0;V<H;++V)if(x[V]!==C[V])return x[V]<C[V]?-1:1;return L===B?0:L<B?-1:1}(pa(o),pa(u));case"Array":return function(x,C){for(var L=x.length,B=C.length,H=L<B?L:B,V=0;V<H;++V){var J=Ye(x[V],C[V]);if(J!==0)return J}return L===B?0:L<B?-1:1}(o,u)}}catch{}return NaN}function Yr(o){var u=typeof o;return u!="object"?u:ArrayBuffer.isView(o)?"binary":(o=ge(o),o==="ArrayBuffer"?"binary":o)}function pa(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var ga=(Ze.prototype._trans=function(o,u,g){var b=this._tx||ze.trans,x=this.name,C=Ve&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function L(V,J,Y){if(!Y.schema[x])throw new ce.NotFound("Table "+x+" not part of transaction");return u(Y.idbtrans,Y)}var B=er();try{var H=b&&b.db._novip===this.db._novip?b===ze.trans?b._promise(o,L,g):cn(function(){return b._promise(o,L,g)},{trans:b,transless:ze.transless||ze}):function V(J,Y,te,Q){if(J.idbdb&&(J._state.openComplete||ze.letThrough||J._vip)){var ie=J._createTransaction(Y,te,J._dbSchema);try{ie.create(),J._state.PR1398_maxLoop=3}catch(ae){return ae.name===Oe.InvalidState&&J.isOpen()&&0<--J._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),J.close({disableAutoOpen:!1}),J.open().then(function(){return V(J,Y,te,Q)})):et(ae)}return ie._promise(Y,function(ae,re){return cn(function(){return ze.trans=ie,Q(ae,re,ie)})}).then(function(ae){if(Y==="readwrite")try{ie.idbtrans.commit()}catch{}return Y==="readonly"?ae:ie._completion.then(function(){return ae})})}if(J._state.openComplete)return et(new ce.DatabaseClosed(J._state.dbOpenError));if(!J._state.isBeingOpened){if(!J._state.autoOpen)return et(new ce.DatabaseClosed);J.open().catch(ke)}return J._state.dbReadyPromise.then(function(){return V(J,Y,te,Q)})}(this.db,o,[this.name],L);return C&&(H._consoleTask=C,H=H.catch(function(V){return console.trace(V),et(V)})),H}finally{B&&Sn()}},Ze.prototype.get=function(o,u){var g=this;return o&&o.constructor===Object?this.where(o).first(u):o==null?et(new ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(b){return g.core.get({trans:b,key:o}).then(function(x){return g.hook.reading.fire(x)})}).then(u)},Ze.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(d(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var u=s(o);if(u.length===1)return this.where(u[0]).equals(o[u[0]]);var g=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&u.every(function(V){return 0<=B.keyPath.indexOf(V)})){for(var H=0;H<u.length;++H)if(u.indexOf(B.keyPath[H])===-1)return!1;return!0}return!1}).sort(function(B,H){return B.keyPath.length-H.keyPath.length})[0];if(g&&this.db._maxKey!==Gn){var C=g.keyPath.slice(0,u.length);return this.where(C).equals(C.map(function(H){return o[H]}))}!g&&Ve&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var b=this.schema.idxByName;function x(B,H){return Ye(B,H)===0}var L=u.reduce(function(Y,H){var V=Y[0],J=Y[1],Y=b[H],te=o[H];return[V||Y,V||!Y?ln(J,Y&&Y.multi?function(Q){return Q=K(Q,H),d(Q)&&Q.some(function(ie){return x(te,ie)})}:function(Q){return x(te,K(Q,H))}):J]},[null,null]),C=L[0],L=L[1];return C?this.where(C.name).equals(o[C.keyPath]).filter(L):g?this.filter(L):this.where(u).equals("")},Ze.prototype.filter=function(o){return this.toCollection().and(o)},Ze.prototype.count=function(o){return this.toCollection().count(o)},Ze.prototype.offset=function(o){return this.toCollection().offset(o)},Ze.prototype.limit=function(o){return this.toCollection().limit(o)},Ze.prototype.each=function(o){return this.toCollection().each(o)},Ze.prototype.toArray=function(o){return this.toCollection().toArray(o)},Ze.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ze.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,d(o)?"[".concat(o.join("+"),"]"):o))},Ze.prototype.reverse=function(){return this.toCollection().reverse()},Ze.prototype.mapToClass=function(o){var u,g=this.db,b=this.name;function x(){return u!==null&&u.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof Hr&&(function(H,V){if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");function J(){this.constructor=H}t(H,V),H.prototype=V===null?Object.create(V):(J.prototype=V.prototype,new J)}(x,u=o),Object.defineProperty(x.prototype,"db",{get:function(){return g},enumerable:!1,configurable:!0}),x.prototype.table=function(){return b},o=x);for(var C=new Set,L=o.prototype;L;L=h(L))Object.getOwnPropertyNames(L).forEach(function(H){return C.add(H)});function B(H){if(!H)return H;var V,J=Object.create(o.prototype);for(V in H)if(!C.has(V))try{J[V]=H[V]}catch{}return J}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=B,this.hook("reading",B),o},Ze.prototype.defineClass=function(){return this.mapToClass(function(o){f(this,o)})},Ze.prototype.add=function(o,u){var g=this,b=this.schema.primKey,x=b.auto,C=b.keyPath,L=o;return C&&x&&(L=Wr(C)(o)),this._trans("readwrite",function(B){return g.core.mutate({trans:B,type:"add",keys:u!=null?[u]:null,values:[L]})}).then(function(B){return B.numFailures?Se.reject(B.failures[0]):B.lastResult}).then(function(B){if(C)try{S(o,C,B)}catch{}return B})},Ze.prototype.update=function(o,u){return typeof o!="object"||d(o)?this.where(":id").equals(o).modify(u):(o=K(o,this.schema.primKey.keyPath),o===void 0?et(new ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(u))},Ze.prototype.put=function(o,u){var g=this,b=this.schema.primKey,x=b.auto,C=b.keyPath,L=o;return C&&x&&(L=Wr(C)(o)),this._trans("readwrite",function(B){return g.core.mutate({trans:B,type:"put",values:[L],keys:u!=null?[u]:null})}).then(function(B){return B.numFailures?Se.reject(B.failures[0]):B.lastResult}).then(function(B){if(C)try{S(o,C,B)}catch{}return B})},Ze.prototype.delete=function(o){var u=this;return this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"delete",keys:[o]})}).then(function(g){return g.numFailures?Se.reject(g.failures[0]):void 0})},Ze.prototype.clear=function(){var o=this;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"deleteRange",range:_i})}).then(function(u){return u.numFailures?Se.reject(u.failures[0]):void 0})},Ze.prototype.bulkGet=function(o){var u=this;return this._trans("readonly",function(g){return u.core.getMany({keys:o,trans:g}).then(function(b){return b.map(function(x){return u.hook.reading.fire(x)})})})},Ze.prototype.bulkAdd=function(o,u,g){var b=this,x=Array.isArray(u)?u:void 0,C=(g=g||(x?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function(L){var V=b.schema.primKey,B=V.auto,V=V.keyPath;if(V&&x)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(x&&x.length!==o.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,V=V&&B?o.map(Wr(V)):o;return b.core.mutate({trans:L,type:"add",keys:x,values:V,wantResults:C}).then(function(ie){var Y=ie.numFailures,te=ie.results,Q=ie.lastResult,ie=ie.failures;if(Y===0)return C?te:Q;throw new Me("".concat(b.name,".bulkAdd(): ").concat(Y," of ").concat(H," operations failed"),ie)})})},Ze.prototype.bulkPut=function(o,u,g){var b=this,x=Array.isArray(u)?u:void 0,C=(g=g||(x?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function(L){var V=b.schema.primKey,B=V.auto,V=V.keyPath;if(V&&x)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(x&&x.length!==o.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,V=V&&B?o.map(Wr(V)):o;return b.core.mutate({trans:L,type:"put",keys:x,values:V,wantResults:C}).then(function(ie){var Y=ie.numFailures,te=ie.results,Q=ie.lastResult,ie=ie.failures;if(Y===0)return C?te:Q;throw new Me("".concat(b.name,".bulkPut(): ").concat(Y," of ").concat(H," operations failed"),ie)})})},Ze.prototype.bulkUpdate=function(o){var u=this,g=this.core,b=o.map(function(L){return L.key}),x=o.map(function(L){return L.changes}),C=[];return this._trans("readwrite",function(L){return g.getMany({trans:L,keys:b,cache:"clone"}).then(function(B){var H=[],V=[];o.forEach(function(Y,te){var Q=Y.key,ie=Y.changes,ae=B[te];if(ae){for(var re=0,se=Object.keys(ie);re<se.length;re++){var de=se[re],pe=ie[de];if(de===u.schema.primKey.keyPath){if(Ye(pe,Q)!==0)throw new ce.Constraint("Cannot update primary key in bulkUpdate()")}else S(ae,de,pe)}C.push(te),H.push(Q),V.push(ae)}});var J=H.length;return g.mutate({trans:L,type:"put",keys:H,values:V,updates:{keys:b,changeSpecs:x}}).then(function(Y){var te=Y.numFailures,Q=Y.failures;if(te===0)return J;for(var ie=0,ae=Object.keys(Q);ie<ae.length;ie++){var re,se=ae[ie],de=C[Number(se)];de!=null&&(re=Q[se],delete Q[se],Q[de]=re)}throw new Me("".concat(u.name,".bulkUpdate(): ").concat(te," of ").concat(J," operations failed"),Q)})})})},Ze.prototype.bulkDelete=function(o){var u=this,g=o.length;return this._trans("readwrite",function(b){return u.core.mutate({trans:b,type:"delete",keys:o})}).then(function(L){var x=L.numFailures,C=L.lastResult,L=L.failures;if(x===0)return C;throw new Me("".concat(u.name,".bulkDelete(): ").concat(x," of ").concat(g," operations failed"),L)})},Ze);function Ze(){}function vr(o){function u(L,B){if(B){for(var H=arguments.length,V=new Array(H-1);--H;)V[H-1]=arguments[H];return g[L].subscribe.apply(null,V),o}if(typeof L=="string")return g[L]}var g={};u.addEventType=C;for(var b=1,x=arguments.length;b<x;++b)C(arguments[b]);return u;function C(L,B,H){if(typeof L!="object"){var V;B=B||Et;var J={subscribers:[],fire:H=H||ke,subscribe:function(Y){J.subscribers.indexOf(Y)===-1&&(J.subscribers.push(Y),J.fire=B(J.fire,Y))},unsubscribe:function(Y){J.subscribers=J.subscribers.filter(function(te){return te!==Y}),J.fire=J.subscribers.reduce(B,H)}};return g[L]=u[L]=J}s(V=L).forEach(function(Y){var te=V[Y];if(d(te))C(Y,V[Y][0],V[Y][1]);else{if(te!=="asap")throw new ce.InvalidArgument("Invalid event config");var Q=C(Y,Ke,function(){for(var ie=arguments.length,ae=new Array(ie);ie--;)ae[ie]=arguments[ie];Q.subscribers.forEach(function(re){T(function(){re.apply(null,ae)})})})}})}}function mr(o,u){return k(u).from({prototype:o}),u}function Fn(o,u){return!(o.filter||o.algorithm||o.or)&&(u?o.justLimit:!o.replayFilter)}function nr(o,u){o.filter=ln(o.filter,u)}function kn(o,u,g){var b=o.replayFilter;o.replayFilter=b?function(){return ln(b(),u())}:u,o.justLimit=g&&!b}function rr(o,u){if(o.isPrimKey)return u.primaryKey;var g=u.getIndexByKeyPath(o.index);if(!g)throw new ce.Schema("KeyPath "+o.index+" on object store "+u.name+" is not indexed");return g}function br(o,u,g){var b=rr(o,u.schema);return u.openCursor({trans:g,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:b,range:o.range}})}function Ut(o,u,g,b){var x=o.replayFilter?ln(o.filter,o.replayFilter()):o.filter;if(o.or){var C={},L=function(B,H,V){var J,Y;x&&!x(H,V,function(te){return H.stop(te)},function(te){return H.fail(te)})||((Y=""+(J=H.primaryKey))=="[object ArrayBuffer]"&&(Y=""+new Uint8Array(J)),v(C,Y)||(C[Y]=!0,u(B,H,V)))};return Promise.all([o.or._iterate(L,g),ir(br(o,b,g),o.algorithm,L,!o.keysOnly&&o.valueMapper)])}return ir(br(o,b,g),ln(o.algorithm,x),u,!o.keysOnly&&o.valueMapper)}function ir(o,u,g,b){var x=Je(b?function(C,L,B){return g(b(C),L,B)}:g);return o.then(function(C){if(C)return C.start(function(){var L=function(){return C.continue()};u&&!u(C,function(B){return L=B},function(B){C.stop(B),L=ke},function(B){C.fail(B),L=ke})||x(C.value,C,function(B){return L=B}),L()})})}var wr=(Si.prototype.execute=function(o){var u=this["@@propmod"];if(u.add!==void 0){var g=u.add;if(d(g))return i(i([],d(o)?o:[],!0),g).sort();if(typeof g=="number")return(Number(o)||0)+g;if(typeof g=="bigint")try{return BigInt(o)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(u.remove!==void 0){var b=u.remove;if(d(b))return d(o)?o.filter(function(x){return!b.includes(x)}).sort():[];if(typeof b=="number")return Number(o)-b;if(typeof b=="bigint")try{return BigInt(o)-b}catch{return BigInt(0)-b}throw new TypeError("Invalid subtrahend ".concat(b))}return g=(g=u.replacePrefix)===null||g===void 0?void 0:g[0],g&&typeof o=="string"&&o.startsWith(g)?u.replacePrefix[1]+o.substring(g.length):o},Si);function Si(o){this["@@propmod"]=o}var ya=(Xe.prototype._read=function(o,u){var g=this._ctx;return g.error?g.table._trans(null,et.bind(null,g.error)):g.table._trans("readonly",o).then(u)},Xe.prototype._write=function(o){var u=this._ctx;return u.error?u.table._trans(null,et.bind(null,u.error)):u.table._trans("readwrite",o,"locked")},Xe.prototype._addAlgorithm=function(o){var u=this._ctx;u.algorithm=ln(u.algorithm,o)},Xe.prototype._iterate=function(o,u){return Ut(this._ctx,o,u,this._ctx.table.core)},Xe.prototype.clone=function(o){var u=Object.create(this.constructor.prototype),g=Object.create(this._ctx);return o&&f(g,o),u._ctx=g,u},Xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Xe.prototype.each=function(o){var u=this._ctx;return this._read(function(g){return Ut(u,o,g,u.table.core)})},Xe.prototype.count=function(o){var u=this;return this._read(function(g){var b=u._ctx,x=b.table.core;if(Fn(b,!0))return x.count({trans:g,query:{index:rr(b,x.schema),range:b.range}}).then(function(L){return Math.min(L,b.limit)});var C=0;return Ut(b,function(){return++C,!1},g,x).then(function(){return C})}).then(o)},Xe.prototype.sortBy=function(o,u){var g=o.split(".").reverse(),b=g[0],x=g.length-1;function C(H,V){return V?C(H[g[V]],V-1):H[b]}var L=this._ctx.dir==="next"?1:-1;function B(H,V){return Ye(C(H,x),C(V,x))*L}return this.toArray(function(H){return H.sort(B)}).then(u)},Xe.prototype.toArray=function(o){var u=this;return this._read(function(g){var b=u._ctx;if(b.dir==="next"&&Fn(b,!0)&&0<b.limit){var x=b.valueMapper,C=rr(b,b.table.core.schema);return b.table.core.query({trans:g,limit:b.limit,values:!0,query:{index:C,range:b.range}}).then(function(B){return B=B.result,x?B.map(x):B})}var L=[];return Ut(b,function(B){return L.push(B)},g,b.table.core).then(function(){return L})},o)},Xe.prototype.offset=function(o){var u=this._ctx;return o<=0||(u.offset+=o,Fn(u)?kn(u,function(){var g=o;return function(b,x){return g===0||(g===1?--g:x(function(){b.advance(g),g=0}),!1)}}):kn(u,function(){var g=o;return function(){return--g<0}})),this},Xe.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),kn(this._ctx,function(){var u=o;return function(g,b,x){return--u<=0&&b(x),0<=u}},!0),this},Xe.prototype.until=function(o,u){return nr(this._ctx,function(g,b,x){return!o(g.value)||(b(x),u)}),this},Xe.prototype.first=function(o){return this.limit(1).toArray(function(u){return u[0]}).then(o)},Xe.prototype.last=function(o){return this.reverse().first(o)},Xe.prototype.filter=function(o){var u;return nr(this._ctx,function(g){return o(g.value)}),(u=this._ctx).isMatch=ln(u.isMatch,o),this},Xe.prototype.and=function(o){return this.filter(o)},Xe.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Xe.prototype.desc=function(){return this.reverse()},Xe.prototype.eachKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,b){o(b.key,b)})},Xe.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Xe.prototype.eachPrimaryKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,b){o(b.primaryKey,b)})},Xe.prototype.keys=function(o){var u=this._ctx;u.keysOnly=!u.isMatch;var g=[];return this.each(function(b,x){g.push(x.key)}).then(function(){return g}).then(o)},Xe.prototype.primaryKeys=function(o){var u=this._ctx;if(u.dir==="next"&&Fn(u,!0)&&0<u.limit)return this._read(function(b){var x=rr(u,u.table.core.schema);return u.table.core.query({trans:b,values:!1,limit:u.limit,query:{index:x,range:u.range}})}).then(function(b){return b.result}).then(o);u.keysOnly=!u.isMatch;var g=[];return this.each(function(b,x){g.push(x.primaryKey)}).then(function(){return g}).then(o)},Xe.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Xe.prototype.firstKey=function(o){return this.limit(1).keys(function(u){return u[0]}).then(o)},Xe.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Xe.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var u={};return nr(this._ctx,function(x){var b=x.primaryKey.toString(),x=v(u,b);return u[b]=!0,!x}),this},Xe.prototype.modify=function(o){var u=this,g=this._ctx;return this._write(function(b){var x,C,L;L=typeof o=="function"?o:(x=s(o),C=x.length,function(re){for(var se=!1,de=0;de<C;++de){var pe=x[de],ye=o[pe],be=K(re,pe);ye instanceof wr?(S(re,pe,ye.execute(be)),se=!0):be!==ye&&(S(re,pe,ye),se=!0)}return se});var B=g.table.core,Y=B.schema.primaryKey,H=Y.outbound,V=Y.extractKey,J=200,Y=u.db._options.modifyChunkSize;Y&&(J=typeof Y=="object"?Y[B.name]||Y["*"]||200:Y);function te(re,pe){var de=pe.failures,pe=pe.numFailures;ie+=re-pe;for(var ye=0,be=s(de);ye<be.length;ye++){var De=be[ye];Q.push(de[De])}}var Q=[],ie=0,ae=[];return u.clone().primaryKeys().then(function(re){function se(pe){var ye=Math.min(J,re.length-pe);return B.getMany({trans:b,keys:re.slice(pe,pe+ye),cache:"immutable"}).then(function(be){for(var De=[],we=[],xe=H?[]:null,Ie=[],Ce=0;Ce<ye;++Ce){var Te=be[Ce],Ue={value:j(Te),primKey:re[pe+Ce]};L.call(Ue,Ue.value,Ue)!==!1&&(Ue.value==null?Ie.push(re[pe+Ce]):H||Ye(V(Te),V(Ue.value))===0?(we.push(Ue.value),H&&xe.push(re[pe+Ce])):(Ie.push(re[pe+Ce]),De.push(Ue.value)))}return Promise.resolve(0<De.length&&B.mutate({trans:b,type:"add",values:De}).then(function(We){for(var He in We.failures)Ie.splice(parseInt(He),1);te(De.length,We)})).then(function(){return(0<we.length||de&&typeof o=="object")&&B.mutate({trans:b,type:"put",keys:xe,values:we,criteria:de,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<pe}).then(function(We){return te(we.length,We)})}).then(function(){return(0<Ie.length||de&&o===Ai)&&B.mutate({trans:b,type:"delete",keys:Ie,criteria:de,isAdditionalChunk:0<pe}).then(function(We){return te(Ie.length,We)})}).then(function(){return re.length>pe+ye&&se(pe+J)})})}var de=Fn(g)&&g.limit===1/0&&(typeof o!="function"||o===Ai)&&{index:g.index,range:g.range};return se(0).then(function(){if(0<Q.length)throw new _e("Error modifying one or more objects",Q,ie,ae);return re.length})})})},Xe.prototype.delete=function(){var o=this._ctx,u=o.range;return Fn(o)&&(o.isPrimKey||u.type===3)?this._write(function(g){var b=o.table.core.schema.primaryKey,x=u;return o.table.core.count({trans:g,query:{index:b,range:x}}).then(function(C){return o.table.core.mutate({trans:g,type:"deleteRange",range:x}).then(function(L){var B=L.failures;if(L.lastResult,L.results,L=L.numFailures,L)throw new _e("Could not delete some values",Object.keys(B).map(function(H){return B[H]}),C-L);return C-L})})}):this.modify(Ai)},Xe);function Xe(){}var Ai=function(o,u){return u.value=null};function vo(o,u){return o<u?-1:o===u?0:1}function va(o,u){return u<o?-1:o===u?0:1}function Tt(o,u,g){return o=o instanceof Xr?new o.Collection(o):o,o._ctx.error=new(g||TypeError)(u),o}function ar(o){return new o.Collection(o,function(){return ma("")}).limit(0)}function Er(o,u,g,b){var x,C,L,B,H,V,J,Y=g.length;if(!g.every(function(ie){return typeof ie=="string"}))return Tt(o,fa);function te(ie){x=ie==="next"?function(re){return re.toUpperCase()}:function(re){return re.toLowerCase()},C=ie==="next"?function(re){return re.toLowerCase()}:function(re){return re.toUpperCase()},L=ie==="next"?vo:va;var ae=g.map(function(re){return{lower:C(re),upper:x(re)}}).sort(function(re,se){return L(re.lower,se.lower)});B=ae.map(function(re){return re.upper}),H=ae.map(function(re){return re.lower}),J=(V=ie)==="next"?"":b}te("next"),o=new o.Collection(o,function(){return dn(B[0],H[Y-1]+b)}),o._ondirectionchange=function(ie){te(ie)};var Q=0;return o._addAlgorithm(function(ie,ae,re){var se=ie.key;if(typeof se!="string")return!1;var de=C(se);if(u(de,H,Q))return!0;for(var pe=null,ye=Q;ye<Y;++ye){var be=function(De,we,xe,Ie,Ce,Te){for(var Ue=Math.min(De.length,Ie.length),We=-1,He=0;He<Ue;++He){var Ht=we[He];if(Ht!==Ie[He])return Ce(De[He],xe[He])<0?De.substr(0,He)+xe[He]+xe.substr(He+1):Ce(De[He],Ie[He])<0?De.substr(0,He)+Ie[He]+xe.substr(He+1):0<=We?De.substr(0,We)+we[We]+xe.substr(We+1):null;Ce(De[He],Ht)<0&&(We=He)}return Ue<Ie.length&&Te==="next"?De+xe.substr(De.length):Ue<De.length&&Te==="prev"?De.substr(0,xe.length):We<0?null:De.substr(0,We)+Ie[We]+xe.substr(We+1)}(se,de,B[ye],H[ye],L,V);be===null&&pe===null?Q=ye+1:(pe===null||0<L(pe,be))&&(pe=be)}return ae(pe!==null?function(){ie.continue(pe+J)}:re),!1}),o}function dn(o,u,g,b){return{type:2,lower:o,upper:u,lowerOpen:g,upperOpen:b}}function ma(o){return{type:1,lower:o,upper:o}}var Xr=(Object.defineProperty(lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),lt.prototype.between=function(o,u,g,b){g=g!==!1,b=b===!0;try{return 0<this._cmp(o,u)||this._cmp(o,u)===0&&(g||b)&&(!g||!b)?ar(this):new this.Collection(this,function(){return dn(o,u,!g,!b)})}catch{return Tt(this,Vt)}},lt.prototype.equals=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return ma(o)})},lt.prototype.above=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return dn(o,void 0,!0)})},lt.prototype.aboveOrEqual=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return dn(o,void 0,!1)})},lt.prototype.below=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return dn(void 0,o,!1,!0)})},lt.prototype.belowOrEqual=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return dn(void 0,o)})},lt.prototype.startsWith=function(o){return typeof o!="string"?Tt(this,fa):this.between(o,o+Gn,!0,!0)},lt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):Er(this,function(u,g){return u.indexOf(g[0])===0},[o],Gn)},lt.prototype.equalsIgnoreCase=function(o){return Er(this,function(u,g){return u===g[0]},[o],"")},lt.prototype.anyOfIgnoreCase=function(){var o=le.apply(ne,arguments);return o.length===0?ar(this):Er(this,function(u,g){return g.indexOf(u)!==-1},o,"")},lt.prototype.startsWithAnyOfIgnoreCase=function(){var o=le.apply(ne,arguments);return o.length===0?ar(this):Er(this,function(u,g){return g.some(function(b){return u.indexOf(b)===0})},o,Gn)},lt.prototype.anyOf=function(){var o=this,u=le.apply(ne,arguments),g=this._cmp;try{u.sort(g)}catch{return Tt(this,Vt)}if(u.length===0)return ar(this);var b=new this.Collection(this,function(){return dn(u[0],u[u.length-1])});b._ondirectionchange=function(C){g=C==="next"?o._ascending:o._descending,u.sort(g)};var x=0;return b._addAlgorithm(function(C,L,B){for(var H=C.key;0<g(H,u[x]);)if(++x===u.length)return L(B),!1;return g(H,u[x])===0||(L(function(){C.continue(u[x])}),!1)}),b},lt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},lt.prototype.noneOf=function(){var o=le.apply(ne,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Tt(this,Vt)}var u=o.reduce(function(g,b){return g?g.concat([[g[g.length-1][1],b]]):[[-1/0,b]]},null);return u.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},lt.prototype.inAnyRange=function(se,u){var g=this,b=this._cmp,x=this._ascending,C=this._descending,L=this._min,B=this._max;if(se.length===0)return ar(this);if(!se.every(function(de){return de[0]!==void 0&&de[1]!==void 0&&x(de[0],de[1])<=0}))return Tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);var H=!u||u.includeLowers!==!1,V=u&&u.includeUppers===!0,J,Y=x;function te(de,pe){return Y(de[0],pe[0])}try{(J=se.reduce(function(de,pe){for(var ye=0,be=de.length;ye<be;++ye){var De=de[ye];if(b(pe[0],De[1])<0&&0<b(pe[1],De[0])){De[0]=L(De[0],pe[0]),De[1]=B(De[1],pe[1]);break}}return ye===be&&de.push(pe),de},[])).sort(te)}catch{return Tt(this,Vt)}var Q=0,ie=V?function(de){return 0<x(de,J[Q][1])}:function(de){return 0<=x(de,J[Q][1])},ae=H?function(de){return 0<C(de,J[Q][0])}:function(de){return 0<=C(de,J[Q][0])},re=ie,se=new this.Collection(this,function(){return dn(J[0][0],J[J.length-1][1],!H,!V)});return se._ondirectionchange=function(de){Y=de==="next"?(re=ie,x):(re=ae,C),J.sort(te)},se._addAlgorithm(function(de,pe,ye){for(var be,De=de.key;re(De);)if(++Q===J.length)return pe(ye),!1;return!ie(be=De)&&!ae(be)||(g._cmp(De,J[Q][1])===0||g._cmp(De,J[Q][0])===0||pe(function(){Y===x?de.continue(J[Q][0]):de.continue(J[Q][1])}),!1)}),se},lt.prototype.startsWithAnyOf=function(){var o=le.apply(ne,arguments);return o.every(function(u){return typeof u=="string"})?o.length===0?ar(this):this.inAnyRange(o.map(function(u){return[u,u+Gn]})):Tt(this,"startsWithAnyOf() only works with strings")},lt);function lt(){}function Kt(o){return Je(function(u){return xr(u),o(u.target.error),!1})}function xr(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var Cn="storagemutated",ki="x-storagemutated-1",hn=vr(null,Cn),ba=(Qt.prototype._lock=function(){return A(!ze.global),++this._reculock,this._reculock!==1||ze.global||(ze.lockOwnerFor=this),this},Qt.prototype._unlock=function(){if(A(!ze.global),--this._reculock==0)for(ze.global||(ze.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Bt(o[1],o[0])}catch{}}return this},Qt.prototype._locked=function(){return this._reculock&&ze.lockOwnerFor!==this},Qt.prototype.create=function(o){var u=this;if(!this.mode)return this;var g=this.db.idbdb,b=this.db._state.dbOpenError;if(A(!this.idbtrans),!o&&!g)switch(b&&b.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(b);case"MissingAPIError":throw new ce.MissingAPI(b.message,b);default:throw new ce.OpenFailed(b)}if(!this.active)throw new ce.TransactionInactive;return A(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||g).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Je(function(x){xr(x),u._reject(o.error)}),o.onabort=Je(function(x){xr(x),u.active&&u._reject(new ce.Abort(o.error)),u.active=!1,u.on("abort").fire(x)}),o.oncomplete=Je(function(){u.active=!1,u._resolve(),"mutatedParts"in o&&hn.storagemutated.fire(o.mutatedParts)}),this},Qt.prototype._promise=function(o,u,g){var b=this;if(o==="readwrite"&&this.mode!=="readwrite")return et(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return et(new ce.TransactionInactive);if(this._locked())return new Se(function(C,L){b._blockedFuncs.push([function(){b._promise(o,u,g).then(C,L)},ze])});if(g)return cn(function(){var C=new Se(function(L,B){b._lock();var H=u(L,B,b);H&&H.then&&H.then(L,B)});return C.finally(function(){return b._unlock()}),C._lib=!0,C});var x=new Se(function(C,L){var B=u(C,L,b);B&&B.then&&B.then(C,L)});return x._lib=!0,x},Qt.prototype._root=function(){return this.parent?this.parent._root():this},Qt.prototype.waitFor=function(o){var u,g=this._root(),b=Se.resolve(o);g._waitingFor?g._waitingFor=g._waitingFor.then(function(){return b}):(g._waitingFor=b,g._waitingQueue=[],u=g.idbtrans.objectStore(g.storeNames[0]),function C(){for(++g._spinCount;g._waitingQueue.length;)g._waitingQueue.shift()();g._waitingFor&&(u.get(-1/0).onsuccess=C)}());var x=g._waitingFor;return new Se(function(C,L){b.then(function(B){return g._waitingQueue.push(Je(C.bind(null,B)))},function(B){return g._waitingQueue.push(Je(L.bind(null,B)))}).finally(function(){g._waitingFor===x&&(g._waitingFor=null)})})},Qt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))},Qt.prototype.table=function(o){var u=this._memoizedTables||(this._memoizedTables={});if(v(u,o))return u[o];var g=this.schema[o];if(!g)throw new ce.NotFound("Table "+o+" not part of transaction");return g=new this.db.Table(o,g,this),g.core=this.db.core.table(o),u[o]=g},Qt);function Qt(){}function Vr(o,u,g,b,x,C,L){return{name:o,keyPath:u,unique:g,multi:b,auto:x,compound:C,src:(g&&!L?"&":"")+(b?"*":"")+(x?"++":"")+Ci(u)}}function Ci(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Di(o,u,g){return{name:o,primKey:u,indexes:g,mappedClass:null,idxByName:(b=function(x){return[x.name,x]},g.reduce(function(x,C,L){return L=b(C,L),L&&(x[L[0]]=L[1]),x},{}))};var b}var fn=function(o){try{return o.only([[]]),fn=function(){return[[]]},[[]]}catch{return fn=function(){return Gn},Gn}};function or(o){return o==null?function(){}:typeof o=="string"?(u=o).split(".").length===1?function(g){return g[u]}:function(g){return K(g,u)}:function(g){return K(g,o)};var u}function wa(o){return[].slice.call(o)}var Ii=0;function sr(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function mo(o,u,H){function b(re){if(re.type===3)return null;if(re.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Q=re.lower,ie=re.upper,ae=re.lowerOpen,re=re.upperOpen;return Q===void 0?ie===void 0?null:u.upperBound(ie,!!re):ie===void 0?u.lowerBound(Q,!!ae):u.bound(Q,ie,!!ae,!!re)}function x(te){var Q,ie=te.name;return{name:ie,schema:te,mutate:function(ae){var re=ae.trans,se=ae.type,de=ae.keys,pe=ae.values,ye=ae.range;return new Promise(function(be,De){be=Je(be);var we=re.objectStore(ie),xe=we.keyPath==null,Ie=se==="put"||se==="add";if(!Ie&&se!=="delete"&&se!=="deleteRange")throw new Error("Invalid operation type: "+se);var Ce,Te=(de||pe||{length:1}).length;if(de&&pe&&de.length!==pe.length)throw new Error("Given keys array must have same length as given values array.");if(Te===0)return be({numFailures:0,failures:{},results:[],lastResult:void 0});function Ue(Rt){++Ht,xr(Rt)}var We=[],He=[],Ht=0;if(se==="deleteRange"){if(ye.type===4)return be({numFailures:Ht,failures:He,results:[],lastResult:void 0});ye.type===3?We.push(Ce=we.clear()):We.push(Ce=we.delete(b(ye)))}else{var xe=Ie?xe?[pe,de]:[pe,null]:[de,null],Be=xe[0],At=xe[1];if(Ie)for(var kt=0;kt<Te;++kt)We.push(Ce=At&&At[kt]!==void 0?we[se](Be[kt],At[kt]):we[se](Be[kt])),Ce.onerror=Ue;else for(kt=0;kt<Te;++kt)We.push(Ce=we[se](Be[kt])),Ce.onerror=Ue}function Ma(Rt){Rt=Rt.target.result,We.forEach(function(Pr,Co){return Pr.error!=null&&(He[Co]=Pr.error)}),be({numFailures:Ht,failures:He,results:se==="delete"?de:We.map(function(Pr){return Pr.result}),lastResult:Rt})}Ce.onerror=function(Rt){Ue(Rt),Ma(Rt)},Ce.onsuccess=Ma})},getMany:function(ae){var re=ae.trans,se=ae.keys;return new Promise(function(de,pe){de=Je(de);for(var ye,be=re.objectStore(ie),De=se.length,we=new Array(De),xe=0,Ie=0,Ce=function(We){We=We.target,we[We._pos]=We.result,++Ie===xe&&de(we)},Te=Kt(pe),Ue=0;Ue<De;++Ue)se[Ue]!=null&&((ye=be.get(se[Ue]))._pos=Ue,ye.onsuccess=Ce,ye.onerror=Te,++xe);xe===0&&de(we)})},get:function(ae){var re=ae.trans,se=ae.key;return new Promise(function(de,pe){de=Je(de);var ye=re.objectStore(ie).get(se);ye.onsuccess=function(be){return de(be.target.result)},ye.onerror=Kt(pe)})},query:(Q=V,function(ae){return new Promise(function(re,se){re=Je(re);var de,pe,ye,xe=ae.trans,be=ae.values,De=ae.limit,Ce=ae.query,we=De===1/0?void 0:De,Ie=Ce.index,Ce=Ce.range,xe=xe.objectStore(ie),Ie=Ie.isPrimaryKey?xe:xe.index(Ie.name),Ce=b(Ce);if(De===0)return re({result:[]});Q?((we=be?Ie.getAll(Ce,we):Ie.getAllKeys(Ce,we)).onsuccess=function(Te){return re({result:Te.target.result})},we.onerror=Kt(se)):(de=0,pe=!be&&"openKeyCursor"in Ie?Ie.openKeyCursor(Ce):Ie.openCursor(Ce),ye=[],pe.onsuccess=function(Te){var Ue=pe.result;return Ue?(ye.push(be?Ue.value:Ue.primaryKey),++de===De?re({result:ye}):void Ue.continue()):re({result:ye})},pe.onerror=Kt(se))})}),openCursor:function(ae){var re=ae.trans,se=ae.values,de=ae.query,pe=ae.reverse,ye=ae.unique;return new Promise(function(be,De){be=Je(be);var Ie=de.index,we=de.range,xe=re.objectStore(ie),xe=Ie.isPrimaryKey?xe:xe.index(Ie.name),Ie=pe?ye?"prevunique":"prev":ye?"nextunique":"next",Ce=!se&&"openKeyCursor"in xe?xe.openKeyCursor(b(we),Ie):xe.openCursor(b(we),Ie);Ce.onerror=Kt(De),Ce.onsuccess=Je(function(Te){var Ue,We,He,Ht,Be=Ce.result;Be?(Be.___id=++Ii,Be.done=!1,Ue=Be.continue.bind(Be),We=(We=Be.continuePrimaryKey)&&We.bind(Be),He=Be.advance.bind(Be),Ht=function(){throw new Error("Cursor not stopped")},Be.trans=re,Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=function(){throw new Error("Cursor not started")},Be.fail=Je(De),Be.next=function(){var At=this,kt=1;return this.start(function(){return kt--?At.continue():At.stop()}).then(function(){return At})},Be.start=function(At){function kt(){if(Ce.result)try{At()}catch(Rt){Be.fail(Rt)}else Be.done=!0,Be.start=function(){throw new Error("Cursor behind last entry")},Be.stop()}var Ma=new Promise(function(Rt,Pr){Rt=Je(Rt),Ce.onerror=Kt(Pr),Be.fail=Pr,Be.stop=function(Co){Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=Ht,Rt(Co)}});return Ce.onsuccess=Je(function(Rt){Ce.onsuccess=kt,kt()}),Be.continue=Ue,Be.continuePrimaryKey=We,Be.advance=He,kt(),Ma},be(Be)):be(null)},De)})},count:function(ae){var re=ae.query,se=ae.trans,de=re.index,pe=re.range;return new Promise(function(ye,be){var De=se.objectStore(ie),we=de.isPrimaryKey?De:De.index(de.name),De=b(pe),we=De?we.count(De):we.count();we.onsuccess=Je(function(xe){return ye(xe.target.result)}),we.onerror=Kt(be)})}}}var C,L,B,J=(L=H,B=wa((C=o).objectStoreNames),{schema:{name:C.name,tables:B.map(function(te){return L.objectStore(te)}).map(function(te){var Q=te.keyPath,re=te.autoIncrement,ie=d(Q),ae={},re={name:te.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Q==null,compound:ie,keyPath:Q,autoIncrement:re,unique:!0,extractKey:or(Q)},indexes:wa(te.indexNames).map(function(se){return te.index(se)}).map(function(ye){var de=ye.name,pe=ye.unique,be=ye.multiEntry,ye=ye.keyPath,be={name:de,compound:d(ye),keyPath:ye,unique:pe,multiEntry:be,extractKey:or(ye)};return ae[sr(ye)]=be}),getIndexByKeyPath:function(se){return ae[sr(se)]}};return ae[":id"]=re.primaryKey,Q!=null&&(ae[sr(Q)]=re.primaryKey),re})},hasGetAll:0<B.length&&"getAll"in L.objectStore(B[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),H=J.schema,V=J.hasGetAll,J=H.tables.map(x),Y={};return J.forEach(function(te){return Y[te.name]=te}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(te){if(!Y[te])throw new Error("Table '".concat(te,"' not found"));return Y[te]},MIN_KEY:-1/0,MAX_KEY:fn(u),schema:H}}function Mi(o,u,g,b){var x=g.IDBKeyRange;return g.indexedDB,{dbcore:(b=mo(u,x,b),o.dbcore.reduce(function(C,L){return L=L.create,n(n({},C),L(C))},b))}}function _r(o,b){var g=b.db,b=Mi(o._middlewares,g,o._deps,b);o.core=b.dbcore,o.tables.forEach(function(x){var C=x.name;o.core.schema.tables.some(function(L){return L.name===C})&&(x.core=o.core.table(C),o[C]instanceof o.Table&&(o[C].core=x.core))})}function Sr(o,u,g,b){g.forEach(function(x){var C=b[x];u.forEach(function(L){var B=function H(V,J){return N(V,J)||(V=h(V))&&H(V,J)}(L,x);(!B||"value"in B&&B.value===void 0)&&(L===o.Transaction.prototype||L instanceof o.Transaction?D(L,x,{get:function(){return this.table(x)},set:function(H){_(this,x,{value:H,writable:!0,configurable:!0,enumerable:!0})}}):L[x]=new o.Table(x,C))})})}function Ar(o,u){u.forEach(function(g){for(var b in g)g[b]instanceof o.Table&&delete g[b]})}function bo(o,u){return o._cfg.version-u._cfg.version}function wo(o,u,g,b){var x=o._dbSchema;g.objectStoreNames.contains("$meta")&&!x.$meta&&(x.$meta=Di("$meta",xa("")[0],[]),o._storeNames.push("$meta"));var C=o._createTransaction("readwrite",o._storeNames,x);C.create(g),C._completion.catch(b);var L=C._reject.bind(C),B=ze.transless||ze;cn(function(){return ze.trans=C,ze.transless=B,u!==0?(_r(o,g),V=u,((H=C).storeNames.includes("$meta")?H.table("$meta").get("version").then(function(J){return J??V}):Se.resolve(V)).then(function(J){return te=J,Q=C,ie=g,ae=[],J=(Y=o)._versions,re=Y._dbSchema=Cr(0,Y.idbdb,ie),(J=J.filter(function(se){return se._cfg.version>=te})).length!==0?(J.forEach(function(se){ae.push(function(){var de=re,pe=se._cfg.dbschema;dt(Y,de,ie),dt(Y,pe,ie),re=Y._dbSchema=pe;var ye=Pi(de,pe);ye.add.forEach(function(Ie){Ni(ie,Ie[0],Ie[1].primKey,Ie[1].indexes)}),ye.change.forEach(function(Ie){if(Ie.recreate)throw new ce.Upgrade("Not yet support for changing primary key");var Ce=ie.objectStore(Ie.name);Ie.add.forEach(function(Te){return kr(Ce,Te)}),Ie.change.forEach(function(Te){Ce.deleteIndex(Te.name),kr(Ce,Te)}),Ie.del.forEach(function(Te){return Ce.deleteIndex(Te)})});var be=se._cfg.contentUpgrade;if(be&&se._cfg.version>te){_r(Y,ie),Q._memoizedTables={};var De=G(pe);ye.del.forEach(function(Ie){De[Ie]=de[Ie]}),Ar(Y,[Y.Transaction.prototype]),Sr(Y,[Y.Transaction.prototype],s(De),De),Q.schema=De;var we,xe=oe(be);return xe&&Ot(),ye=Se.follow(function(){var Ie;(we=be(Q))&&xe&&(Ie=$e.bind(null,null),we.then(Ie,Ie))}),we&&typeof we.then=="function"?Se.resolve(we):ye.then(function(){return we})}}),ae.push(function(de){var pe,ye,be=se._cfg.dbschema;pe=be,ye=de,[].slice.call(ye.db.objectStoreNames).forEach(function(De){return pe[De]==null&&ye.db.deleteObjectStore(De)}),Ar(Y,[Y.Transaction.prototype]),Sr(Y,[Y.Transaction.prototype],Y._storeNames,Y._dbSchema),Q.schema=Y._dbSchema}),ae.push(function(de){Y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Y.idbdb.version/10)===se._cfg.version?(Y.idbdb.deleteObjectStore("$meta"),delete Y._dbSchema.$meta,Y._storeNames=Y._storeNames.filter(function(pe){return pe!=="$meta"})):de.objectStore("$meta").put(se._cfg.version,"version"))})}),function se(){return ae.length?Se.resolve(ae.shift()(Q.idbtrans)).then(se):Se.resolve()}().then(function(){Ea(re,ie)})):Se.resolve();var Y,te,Q,ie,ae,re}).catch(L)):(s(x).forEach(function(J){Ni(g,J,x[J].primKey,x[J].indexes)}),_r(o,g),void Se.follow(function(){return o.on.populate.fire(C)}).catch(L));var H,V})}function Dn(o,u){Ea(o._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var g=Cr(0,o.idbdb,u);dt(o,o._dbSchema,u);for(var b=0,x=Pi(g,o._dbSchema).change;b<x.length;b++){var C=function(L){if(L.change.length||L.recreate)return console.warn("Unable to patch indexes of table ".concat(L.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=u.objectStore(L.name);L.add.forEach(function(H){Ve&&console.debug("Dexie upgrade patch: Creating missing index ".concat(L.name,".").concat(H.src)),kr(B,H)})}(x[b]);if(typeof C=="object")return C.value}}function Pi(o,u){var g,b={del:[],add:[],change:[]};for(g in o)u[g]||b.del.push(g);for(g in u){var x=o[g],C=u[g];if(x){var L={name:g,def:C,recreate:!1,del:[],add:[],change:[]};if(""+(x.primKey.keyPath||"")!=""+(C.primKey.keyPath||"")||x.primKey.auto!==C.primKey.auto)L.recreate=!0,b.change.push(L);else{var B=x.idxByName,H=C.idxByName,V=void 0;for(V in B)H[V]||L.del.push(V);for(V in H){var J=B[V],Y=H[V];J?J.src!==Y.src&&L.change.push(Y):L.add.push(Y)}(0<L.del.length||0<L.add.length||0<L.change.length)&&b.change.push(L)}}else b.add.push([g,C])}return b}function Ni(o,u,g,b){var x=o.db.createObjectStore(u,g.keyPath?{keyPath:g.keyPath,autoIncrement:g.auto}:{autoIncrement:g.auto});return b.forEach(function(C){return kr(x,C)}),x}function Ea(o,u){s(o).forEach(function(g){u.db.objectStoreNames.contains(g)||(Ve&&console.debug("Dexie: Creating missing table",g),Ni(u,g,o[g].primKey,o[g].indexes))})}function kr(o,u){o.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function Cr(o,u,g){var b={};return M(u.objectStoreNames,0).forEach(function(x){for(var C=g.objectStore(x),L=Vr(Ci(V=C.keyPath),V||"",!0,!1,!!C.autoIncrement,V&&typeof V!="string",!0),B=[],H=0;H<C.indexNames.length;++H){var J=C.index(C.indexNames[H]),V=J.keyPath,J=Vr(J.name,V,!!J.unique,!!J.multiEntry,!1,V&&typeof V!="string",!1);B.push(J)}b[x]=Di(x,L,B)}),b}function dt(o,u,g){for(var b=g.db.objectStoreNames,x=0;x<b.length;++x){var C=b[x],L=g.objectStore(C);o._hasGetAll="getAll"in L;for(var B=0;B<L.indexNames.length;++B){var H=L.indexNames[B],V=L.index(H).keyPath,J=typeof V=="string"?V:"["+M(V).join("+")+"]";!u[C]||(V=u[C].idxByName[J])&&(V.name=H,delete u[C].idxByName[J],u[C].idxByName[H]=V)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function xa(o){return o.split(",").map(function(u,g){var b=(u=u.trim()).replace(/([&*]|\+\+)/g,""),x=/^\[/.test(b)?b.match(/^\[(.*)\]$/)[1].split("+"):b;return Vr(b,x||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),d(x),g===0)})}var Eo=(Qr.prototype._parseStoresSpec=function(o,u){s(o).forEach(function(g){if(o[g]!==null){var b=xa(o[g]),x=b.shift();if(x.unique=!0,x.multi)throw new ce.Schema("Primary key cannot be multi-valued");b.forEach(function(C){if(C.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!C.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),u[g]=Di(g,x,b)}})},Qr.prototype.stores=function(g){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,g):g;var g=u._versions,b={},x={};return g.forEach(function(C){f(b,C._cfg.storesSource),x=C._cfg.dbschema={},C._parseStoresSpec(b,x)}),u._dbSchema=x,Ar(u,[u._allTables,u,u.Transaction.prototype]),Sr(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],s(x),x),u._storeNames=s(x),this},Qr.prototype.upgrade=function(o){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||ke,o),this},Qr);function Qr(){}function Oi(o,u){var g=o._dbNamesDB;return g||(g=o._dbNamesDB=new gn(yr,{addons:[],indexedDB:o,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),g.table("dbnames")}function Ti(o){return o&&typeof o.databases=="function"}function Ri(o){return cn(function(){return ze.letThrough=!0,o()})}function Li(o){return!("from"in o)}var yt=function(o,u){if(!this){var g=new yt;return o&&"d"in o&&f(g,o),g}f(this,arguments.length?{d:1,from:o,to:1<arguments.length?u:o}:{d:0})};function ur(o,u,g){var b=Ye(u,g);if(!isNaN(b)){if(0<b)throw RangeError();if(Li(o))return f(o,{from:u,to:g,d:1});var x=o.l,b=o.r;if(Ye(g,o.from)<0)return x?ur(x,u,g):o.l={from:u,to:g,d:1,l:null,r:null},_a(o);if(0<Ye(u,o.to))return b?ur(b,u,g):o.r={from:u,to:g,d:1,l:null,r:null},_a(o);Ye(u,o.from)<0&&(o.from=u,o.l=null,o.d=b?b.d+1:1),0<Ye(g,o.to)&&(o.to=g,o.r=null,o.d=o.l?o.l.d+1:1),g=!o.r,x&&!o.l&&In(o,x),b&&g&&In(o,b)}}function In(o,u){Li(u)||function g(b,H){var C=H.from,L=H.to,B=H.l,H=H.r;ur(b,C,L),B&&g(b,B),H&&g(b,H)}(o,u)}function Mn(o,u){var g=jn(u),b=g.next();if(b.done)return!1;for(var x=b.value,C=jn(o),L=C.next(x.from),B=L.value;!b.done&&!L.done;){if(Ye(B.from,x.to)<=0&&0<=Ye(B.to,x.from))return!0;Ye(x.from,B.from)<0?x=(b=g.next(B.from)).value:B=(L=C.next(x.from)).value}return!1}function jn(o){var u=Li(o)?null:{s:0,n:o};return{next:function(g){for(var b=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,b)for(;u.n.l&&Ye(g,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!b||Ye(g,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function _a(o){var u,g,b=(((u=o.r)===null||u===void 0?void 0:u.d)||0)-(((g=o.l)===null||g===void 0?void 0:g.d)||0),x=1<b?"r":b<-1?"l":"";x&&(u=x=="r"?"l":"r",g=n({},o),b=o[x],o.from=b.from,o.to=b.to,o[x]=b[x],g[x]=b[u],(o[u]=g).d=zi(g)),o.d=zi(o)}function zi(g){var u=g.r,g=g.l;return(u?g?Math.max(u.d,g.d):u.d:g?g.d:0)+1}function Dr(o,u){return s(u).forEach(function(g){o[g]?In(o[g],u[g]):o[g]=function b(x){var C,L,B={};for(C in x)v(x,C)&&(L=x[C],B[C]=!L||typeof L!="object"||W.has(L.constructor)?L:b(L));return B}(u[g])}),o}function Zr(o,u){return o.all||u.all||Object.keys(o).some(function(g){return u[g]&&Mn(u[g],o[g])})}w(yt.prototype,((l={add:function(o){return In(this,o),this},addKey:function(o){return ur(this,o,o),this},addKeys:function(o){var u=this;return o.forEach(function(g){return ur(u,g,g)}),this},hasKey:function(o){var u=jn(this).next(o).value;return u&&Ye(u.from,o)<=0&&0<=Ye(u.to,o)}})[X]=function(){return jn(this)},l));var Wt={},$i={},Gi=!1;function Jr(o){Dr($i,o),Gi||(Gi=!0,setTimeout(function(){Gi=!1,qi($i,!($i={}))},0))}function qi(o,u){u===void 0&&(u=!1);var g=new Set;if(o.all)for(var b=0,x=Object.values(Wt);b<x.length;b++)Sa(L=x[b],o,g,u);else for(var C in o){var L,B=/^idb\:\/\/(.*)\/(.*)\//.exec(C);B&&(C=B[1],B=B[2],(L=Wt["idb://".concat(C,"/").concat(B)])&&Sa(L,o,g,u))}g.forEach(function(H){return H()})}function Sa(o,u,g,b){for(var x=[],C=0,L=Object.entries(o.queries.query);C<L.length;C++){for(var B=L[C],H=B[0],V=[],J=0,Y=B[1];J<Y.length;J++){var te=Y[J];Zr(u,te.obsSet)?te.subscribers.forEach(function(re){return g.add(re)}):b&&V.push(te)}b&&x.push([H,V])}if(b)for(var Q=0,ie=x;Q<ie.length;Q++){var ae=ie[Q],H=ae[0],V=ae[1];o.queries.query[H]=V}}function xo(o){var u=o._state,g=o._deps.indexedDB;if(u.isBeingOpened||o.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?et(u.dbOpenError):o});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var b=u.openCanceller,x=Math.round(10*o.verno),C=!1;function L(){if(u.openCanceller!==b)throw new ce.DatabaseClosed("db.open() was cancelled")}function B(){return new Se(function(te,Q){if(L(),!g)throw new ce.MissingAPI;var ie=o.name,ae=u.autoSchema||!x?g.open(ie):g.open(ie,x);if(!ae)throw new ce.MissingAPI;ae.onerror=Kt(Q),ae.onblocked=Je(o._fireOnBlocked),ae.onupgradeneeded=Je(function(re){var se;J=ae.transaction,u.autoSchema&&!o._options.allowEmptyDB?(ae.onerror=xr,J.abort(),ae.result.close(),(se=g.deleteDatabase(ie)).onsuccess=se.onerror=Je(function(){Q(new ce.NoSuchDatabase("Database ".concat(ie," doesnt exist")))})):(J.onerror=Kt(Q),re=re.oldVersion>Math.pow(2,62)?0:re.oldVersion,Y=re<1,o.idbdb=ae.result,C&&Dn(o,J),wo(o,re/10,J,Q))},Q),ae.onsuccess=Je(function(){J=null;var re,se,de,pe,ye,be=o.idbdb=ae.result,De=M(be.objectStoreNames);if(0<De.length)try{var we=be.transaction((pe=De).length===1?pe[0]:pe,"readonly");if(u.autoSchema)se=be,de=we,(re=o).verno=se.version/10,de=re._dbSchema=Cr(0,se,de),re._storeNames=M(se.objectStoreNames,0),Sr(re,[re._allTables],s(de),de);else if(dt(o,o._dbSchema,we),((ye=Pi(Cr(0,(ye=o).idbdb,we),ye._dbSchema)).add.length||ye.change.some(function(xe){return xe.add.length||xe.change.length}))&&!C)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),be.close(),x=be.version+1,C=!0,te(B());_r(o,we)}catch{}qn.push(o),be.onversionchange=Je(function(xe){u.vcFired=!0,o.on("versionchange").fire(xe)}),be.onclose=Je(function(xe){o.on("close").fire(xe)}),Y&&(ye=o._deps,we=ie,be=ye.indexedDB,ye=ye.IDBKeyRange,Ti(be)||we===yr||Oi(be,ye).put({name:we}).catch(ke)),te()},Q)}).catch(function(te){switch(te==null?void 0:te.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<x)return x=0,B()}return Se.reject(te)})}var H,V=u.dbReadyResolve,J=null,Y=!1;return Se.race([b,(typeof navigator>"u"?Se.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(te){function Q(){return indexedDB.databases().finally(te)}H=setInterval(Q,100),Q()}).finally(function(){return clearInterval(H)}):Promise.resolve()).then(B)]).then(function(){return L(),u.onReadyBeingFired=[],Se.resolve(Ri(function(){return o.on.ready.fire(o.vip)})).then(function te(){if(0<u.onReadyBeingFired.length){var Q=u.onReadyBeingFired.reduce(at,ke);return u.onReadyBeingFired=[],Se.resolve(Ri(function(){return Q(o.vip)})).then(te)}})}).finally(function(){u.openCanceller===b&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(te){u.dbOpenError=te;try{J&&J.abort()}catch{}return b===u.openCanceller&&o._close(),et(te)}).finally(function(){u.openComplete=!0,V()}).then(function(){var te;return Y&&(te={},o.tables.forEach(function(Q){Q.schema.indexes.forEach(function(ie){ie.name&&(te["idb://".concat(o.name,"/").concat(Q.name,"/").concat(ie.name)]=new yt(-1/0,[[[]]]))}),te["idb://".concat(o.name,"/").concat(Q.name,"/")]=te["idb://".concat(o.name,"/").concat(Q.name,"/:dels")]=new yt(-1/0,[[[]]])}),hn(Cn).fire(te),qi(te,!0)),o})}function Ir(o){function u(C){return o.next(C)}var g=x(u),b=x(function(C){return o.throw(C)});function x(C){return function(H){var B=C(H),H=B.value;return B.done?H:H&&typeof H.then=="function"?H.then(g,b):d(H)?Promise.all(H).then(g,b):g(H)}}return x(u)()}function ei(o,u,g){for(var b=d(o)?o.slice():[o],x=0;x<g;++x)b.push(u);return b}var ti={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return n(n({},o),{table:function(u){var g=o.table(u),b=g.schema,x={},C=[];function L(Y,te,Q){var ie=sr(Y),ae=x[ie]=x[ie]||[],re=Y==null?0:typeof Y=="string"?1:Y.length,se=0<te,se=n(n({},Q),{name:se?"".concat(ie,"(virtual-from:").concat(Q.name,")"):Q.name,lowLevelIndex:Q,isVirtual:se,keyTail:te,keyLength:re,extractKey:or(Y),unique:!se&&Q.unique});return ae.push(se),se.isPrimaryKey||C.push(se),1<re&&L(re===2?Y[0]:Y.slice(0,re-1),te+1,Q),ae.sort(function(de,pe){return de.keyTail-pe.keyTail}),se}u=L(b.primaryKey.keyPath,0,b.primaryKey),x[":id"]=[u];for(var B=0,H=b.indexes;B<H.length;B++){var V=H[B];L(V.keyPath,0,V)}function J(Y){var te,Q=Y.query.index;return Q.isVirtual?n(n({},Y),{query:{index:Q.lowLevelIndex,range:(te=Y.query.range,Q=Q.keyTail,{type:te.type===1?2:te.type,lower:ei(te.lower,te.lowerOpen?o.MAX_KEY:o.MIN_KEY,Q),lowerOpen:!0,upper:ei(te.upper,te.upperOpen?o.MIN_KEY:o.MAX_KEY,Q),upperOpen:!0})}}):Y}return n(n({},g),{schema:n(n({},b),{primaryKey:u,indexes:C,getIndexByKeyPath:function(Y){return(Y=x[sr(Y)])&&Y[0]}}),count:function(Y){return g.count(J(Y))},query:function(Y){return g.query(J(Y))},openCursor:function(Y){var te=Y.query.index,Q=te.keyTail,ie=te.isVirtual,ae=te.keyLength;return ie?g.openCursor(J(Y)).then(function(se){return se&&re(se)}):g.openCursor(Y);function re(se){return Object.create(se,{continue:{value:function(de){de!=null?se.continue(ei(de,Y.reverse?o.MAX_KEY:o.MIN_KEY,Q)):Y.unique?se.continue(se.key.slice(0,ae).concat(Y.reverse?o.MIN_KEY:o.MAX_KEY,Q)):se.continue()}},continuePrimaryKey:{value:function(de,pe){se.continuePrimaryKey(ei(de,o.MAX_KEY,Q),pe)}},primaryKey:{get:function(){return se.primaryKey}},key:{get:function(){var de=se.key;return ae===1?de[0]:de.slice(0,ae)}},value:{get:function(){return se.value}}})}}})}})}};function Fi(o,u,g,b){return g=g||{},b=b||"",s(o).forEach(function(x){var C,L,B;v(u,x)?(C=o[x],L=u[x],typeof C=="object"&&typeof L=="object"&&C&&L?(B=ge(C))!==ge(L)?g[b+x]=u[x]:B==="Object"?Fi(C,L,g,b+x+"."):C!==L&&(g[b+x]=u[x]):C!==L&&(g[b+x]=u[x])):g[b+x]=void 0}),s(u).forEach(function(x){v(o,x)||(g[b+x]=u[x])}),g}function Mr(o,u){return u.type==="delete"?u.keys:u.keys||u.values.map(o.extractKey)}var _o={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return n(n({},o),{table:function(u){var g=o.table(u),b=g.schema.primaryKey;return n(n({},g),{mutate:function(x){var C=ze.trans,L=C.table(u).hook,B=L.deleting,H=L.creating,V=L.updating;switch(x.type){case"add":if(H.fire===ke)break;return C._promise("readwrite",function(){return J(x)},!0);case"put":if(H.fire===ke&&V.fire===ke)break;return C._promise("readwrite",function(){return J(x)},!0);case"delete":if(B.fire===ke)break;return C._promise("readwrite",function(){return J(x)},!0);case"deleteRange":if(B.fire===ke)break;return C._promise("readwrite",function(){return function Y(te,Q,ie){return g.query({trans:te,values:!1,query:{index:b,range:Q},limit:ie}).then(function(ae){var re=ae.result;return J({type:"delete",keys:re,trans:te}).then(function(se){return 0<se.numFailures?Promise.reject(se.failures[0]):re.length<ie?{failures:[],numFailures:0,lastResult:void 0}:Y(te,n(n({},Q),{lower:re[re.length-1],lowerOpen:!0}),ie)})})}(x.trans,x.range,1e4)},!0)}return g.mutate(x);function J(Y){var te,Q,ie,ae=ze.trans,re=Y.keys||Mr(b,Y);if(!re)throw new Error("Keys missing");return(Y=Y.type==="add"||Y.type==="put"?n(n({},Y),{keys:re}):n({},Y)).type!=="delete"&&(Y.values=i([],Y.values)),Y.keys&&(Y.keys=i([],Y.keys)),te=g,ie=re,((Q=Y).type==="add"?Promise.resolve([]):te.getMany({trans:Q.trans,keys:ie,cache:"immutable"})).then(function(se){var de=re.map(function(pe,ye){var be,De,we,xe=se[ye],Ie={onerror:null,onsuccess:null};return Y.type==="delete"?B.fire.call(Ie,pe,xe,ae):Y.type==="add"||xe===void 0?(be=H.fire.call(Ie,pe,Y.values[ye],ae),pe==null&&be!=null&&(Y.keys[ye]=pe=be,b.outbound||S(Y.values[ye],b.keyPath,pe))):(be=Fi(xe,Y.values[ye]),(De=V.fire.call(Ie,be,pe,xe,ae))&&(we=Y.values[ye],Object.keys(De).forEach(function(Ce){v(we,Ce)?we[Ce]=De[Ce]:S(we,Ce,De[Ce])}))),Ie});return g.mutate(Y).then(function(pe){for(var ye=pe.failures,be=pe.results,De=pe.numFailures,pe=pe.lastResult,we=0;we<re.length;++we){var xe=(be||re)[we],Ie=de[we];xe==null?Ie.onerror&&Ie.onerror(ye[we]):Ie.onsuccess&&Ie.onsuccess(Y.type==="put"&&se[we]?Y.values[we]:xe)}return{failures:ye,results:be,numFailures:De,lastResult:pe}}).catch(function(pe){return de.forEach(function(ye){return ye.onerror&&ye.onerror(pe)}),Promise.reject(pe)})})}}})}})}};function Aa(o,u,g){try{if(!u||u.keys.length<o.length)return null;for(var b=[],x=0,C=0;x<u.keys.length&&C<o.length;++x)Ye(u.keys[x],o[C])===0&&(b.push(g?j(u.values[x]):u.values[x]),++C);return b.length===o.length?b:null}catch{return null}}var ka={stack:"dbcore",level:-1,create:function(o){return{table:function(u){var g=o.table(u);return n(n({},g),{getMany:function(b){if(!b.cache)return g.getMany(b);var x=Aa(b.keys,b.trans._cache,b.cache==="clone");return x?Se.resolve(x):g.getMany(b).then(function(C){return b.trans._cache={keys:b.keys,values:b.cache==="clone"?j(C):C},C})},mutate:function(b){return b.type!=="add"&&(b.trans._cache=null),g.mutate(b)}})}}}};function cr(o,u){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function pn(o,u){switch(o){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ca={stack:"dbcore",level:0,name:"Observability",create:function(o){var u=o.schema.name,g=new yt(o.MIN_KEY,o.MAX_KEY);return n(n({},o),{transaction:function(b,x,C){if(ze.subscr&&x!=="readonly")throw new ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ze.querier));return o.transaction(b,x,C)},table:function(b){var x=o.table(b),C=x.schema,L=C.primaryKey,Y=C.indexes,B=L.extractKey,H=L.outbound,V=L.autoIncrement&&Y.filter(function(Q){return Q.compound&&Q.keyPath.includes(L.keyPath)}),J=n(n({},x),{mutate:function(Q){function ie(Ce){return Ce="idb://".concat(u,"/").concat(b,"/").concat(Ce),pe[Ce]||(pe[Ce]=new yt)}var ae,re,se,de=Q.trans,pe=Q.mutatedParts||(Q.mutatedParts={}),ye=ie(""),be=ie(":dels"),De=Q.type,Ie=Q.type==="deleteRange"?[Q.range]:Q.type==="delete"?[Q.keys]:Q.values.length<50?[Mr(L,Q).filter(function(Ce){return Ce}),Q.values]:[],we=Ie[0],xe=Ie[1],Ie=Q.trans._cache;return d(we)?(ye.addKeys(we),(Ie=De==="delete"||we.length===xe.length?Aa(we,Ie):null)||be.addKeys(we),(Ie||xe)&&(ae=ie,re=Ie,se=xe,C.indexes.forEach(function(Ce){var Te=ae(Ce.name||"");function Ue(He){return He!=null?Ce.extractKey(He):null}function We(He){return Ce.multiEntry&&d(He)?He.forEach(function(Ht){return Te.addKey(Ht)}):Te.addKey(He)}(re||se).forEach(function(He,At){var Be=re&&Ue(re[At]),At=se&&Ue(se[At]);Ye(Be,At)!==0&&(Be!=null&&We(Be),At!=null&&We(At))})}))):we?(xe={from:(xe=we.lower)!==null&&xe!==void 0?xe:o.MIN_KEY,to:(xe=we.upper)!==null&&xe!==void 0?xe:o.MAX_KEY},be.add(xe),ye.add(xe)):(ye.add(g),be.add(g),C.indexes.forEach(function(Ce){return ie(Ce.name).add(g)})),x.mutate(Q).then(function(Ce){return!we||Q.type!=="add"&&Q.type!=="put"||(ye.addKeys(Ce.results),V&&V.forEach(function(Te){for(var Ue=Q.values.map(function(Be){return Te.extractKey(Be)}),We=Te.keyPath.findIndex(function(Be){return Be===L.keyPath}),He=0,Ht=Ce.results.length;He<Ht;++He)Ue[He][We]=Ce.results[He];ie(Te.name).addKeys(Ue)})),de.mutatedParts=Dr(de.mutatedParts||{},pe),Ce})}}),Y=function(ie){var ae=ie.query,ie=ae.index,ae=ae.range;return[ie,new yt((ie=ae.lower)!==null&&ie!==void 0?ie:o.MIN_KEY,(ae=ae.upper)!==null&&ae!==void 0?ae:o.MAX_KEY)]},te={get:function(Q){return[L,new yt(Q.key)]},getMany:function(Q){return[L,new yt().addKeys(Q.keys)]},count:Y,query:Y,openCursor:Y};return s(te).forEach(function(Q){J[Q]=function(ie){var ae=ze.subscr,re=!!ae,se=cr(ze,x)&&pn(Q,ie)?ie.obsSet={}:ae;if(re){var de=function(xe){return xe="idb://".concat(u,"/").concat(b,"/").concat(xe),se[xe]||(se[xe]=new yt)},pe=de(""),ye=de(":dels"),ae=te[Q](ie),re=ae[0],ae=ae[1];if((Q==="query"&&re.isPrimaryKey&&!ie.values?ye:de(re.name||"")).add(ae),!re.isPrimaryKey){if(Q!=="count"){var be=Q==="query"&&H&&ie.values&&x.query(n(n({},ie),{values:!1}));return x[Q].apply(this,arguments).then(function(xe){if(Q==="query"){if(H&&ie.values)return be.then(function(Ue){return Ue=Ue.result,pe.addKeys(Ue),xe});var Ie=ie.values?xe.result.map(B):xe.result;(ie.values?pe:ye).addKeys(Ie)}else if(Q==="openCursor"){var Ce=xe,Te=ie.values;return Ce&&Object.create(Ce,{key:{get:function(){return ye.addKey(Ce.primaryKey),Ce.key}},primaryKey:{get:function(){var Ue=Ce.primaryKey;return ye.addKey(Ue),Ue}},value:{get:function(){return Te&&pe.addKey(Ce.primaryKey),Ce.value}}})}return xe})}ye.add(g)}}return x[Q].apply(this,arguments)}}),J}})}};function ni(o,u,g){if(g.numFailures===0)return u;if(u.type==="deleteRange")return null;var b=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1;return g.numFailures===b?null:(u=n({},u),d(u.keys)&&(u.keys=u.keys.filter(function(x,C){return!(C in g.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(x,C){return!(C in g.failures)})),u)}function ji(o,u){return g=o,((b=u).lower===void 0||(b.lowerOpen?0<Ye(g,b.lower):0<=Ye(g,b.lower)))&&(o=o,(u=u).upper===void 0||(u.upperOpen?Ye(o,u.upper)<0:Ye(o,u.upper)<=0));var g,b}function Da(o,u,te,b,x,C){if(!te||te.length===0)return o;var L=u.query.index,B=L.multiEntry,H=u.query.range,V=b.schema.primaryKey.extractKey,J=L.extractKey,Y=(L.lowLevelIndex||L).extractKey,te=te.reduce(function(Q,ie){var ae=Q,re=[];if(ie.type==="add"||ie.type==="put")for(var se=new yt,de=ie.values.length-1;0<=de;--de){var pe,ye=ie.values[de],be=V(ye);se.hasKey(be)||(pe=J(ye),(B&&d(pe)?pe.some(function(Ce){return ji(Ce,H)}):ji(pe,H))&&(se.addKey(be),re.push(ye)))}switch(ie.type){case"add":var De=new yt().addKeys(u.values?Q.map(function(Te){return V(Te)}):Q),ae=Q.concat(u.values?re.filter(function(Te){return Te=V(Te),!De.hasKey(Te)&&(De.addKey(Te),!0)}):re.map(function(Te){return V(Te)}).filter(function(Te){return!De.hasKey(Te)&&(De.addKey(Te),!0)}));break;case"put":var we=new yt().addKeys(ie.values.map(function(Te){return V(Te)}));ae=Q.filter(function(Te){return!we.hasKey(u.values?V(Te):Te)}).concat(u.values?re:re.map(function(Te){return V(Te)}));break;case"delete":var xe=new yt().addKeys(ie.keys);ae=Q.filter(function(Te){return!xe.hasKey(u.values?V(Te):Te)});break;case"deleteRange":var Ie=ie.range;ae=Q.filter(function(Te){return!ji(V(Te),Ie)})}return ae},o);return te===o?o:(te.sort(function(Q,ie){return Ye(Y(Q),Y(ie))||Ye(V(Q),V(ie))}),u.limit&&u.limit<1/0&&(te.length>u.limit?te.length=u.limit:o.length===u.limit&&te.length<u.limit&&(x.dirty=!0)),C?Object.freeze(te):te)}function Ia(o,u){return Ye(o.lower,u.lower)===0&&Ye(o.upper,u.upper)===0&&!!o.lowerOpen==!!u.lowerOpen&&!!o.upperOpen==!!u.upperOpen}function So(o,u){return function(g,b,x,C){if(g===void 0)return b!==void 0?-1:0;if(b===void 0)return 1;if((b=Ye(g,b))===0){if(x&&C)return 0;if(x)return 1;if(C)return-1}return b}(o.lower,u.lower,o.lowerOpen,u.lowerOpen)<=0&&0<=function(g,b,x,C){if(g===void 0)return b!==void 0?1:0;if(b===void 0)return-1;if((b=Ye(g,b))===0){if(x&&C)return 0;if(x)return-1;if(C)return 1}return b}(o.upper,u.upper,o.upperOpen,u.upperOpen)}function Ao(o,u,g,b){o.subscribers.add(g),b.addEventListener("abort",function(){var x,C;o.subscribers.delete(g),o.subscribers.size===0&&(x=o,C=u,setTimeout(function(){x.subscribers.size===0&&ee(C,x)},3e3))})}var ko={stack:"dbcore",level:0,name:"Cache",create:function(o){var u=o.schema.name;return n(n({},o),{transaction:function(g,b,x){var C,L,B=o.transaction(g,b,x);return b==="readwrite"&&(L=(C=new AbortController).signal,x=function(H){return function(){if(C.abort(),b==="readwrite"){for(var V=new Set,J=0,Y=g;J<Y.length;J++){var te=Y[J],Q=Wt["idb://".concat(u,"/").concat(te)];if(Q){var ie=o.table(te),ae=Q.optimisticOps.filter(function(Te){return Te.trans===B});if(B._explicit&&H&&B.mutatedParts)for(var re=0,se=Object.values(Q.queries.query);re<se.length;re++)for(var de=0,pe=(De=se[re]).slice();de<pe.length;de++)Zr((we=pe[de]).obsSet,B.mutatedParts)&&(ee(De,we),we.subscribers.forEach(function(Te){return V.add(Te)}));else if(0<ae.length){Q.optimisticOps=Q.optimisticOps.filter(function(Te){return Te.trans!==B});for(var ye=0,be=Object.values(Q.queries.query);ye<be.length;ye++)for(var De,we,xe,Ie=0,Ce=(De=be[ye]).slice();Ie<Ce.length;Ie++)(we=Ce[Ie]).res!=null&&B.mutatedParts&&(H&&!we.dirty?(xe=Object.isFrozen(we.res),xe=Da(we.res,we.req,ae,ie,we,xe),we.dirty?(ee(De,we),we.subscribers.forEach(function(Te){return V.add(Te)})):xe!==we.res&&(we.res=xe,we.promise=Se.resolve({result:xe}))):(we.dirty&&ee(De,we),we.subscribers.forEach(function(Te){return V.add(Te)})))}}}V.forEach(function(Te){return Te()})}}},B.addEventListener("abort",x(!1),{signal:L}),B.addEventListener("error",x(!1),{signal:L}),B.addEventListener("complete",x(!0),{signal:L})),B},table:function(g){var b=o.table(g),x=b.schema.primaryKey;return n(n({},b),{mutate:function(C){var L=ze.trans;if(x.outbound||L.db._options.cache==="disabled"||L.explicit||L.idbtrans.mode!=="readwrite")return b.mutate(C);var B=Wt["idb://".concat(u,"/").concat(g)];return B?(L=b.mutate(C),C.type!=="add"&&C.type!=="put"||!(50<=C.values.length||Mr(x,C).some(function(H){return H==null}))?(B.optimisticOps.push(C),C.mutatedParts&&Jr(C.mutatedParts),L.then(function(H){0<H.numFailures&&(ee(B.optimisticOps,C),(H=ni(0,C,H))&&B.optimisticOps.push(H),C.mutatedParts&&Jr(C.mutatedParts))}),L.catch(function(){ee(B.optimisticOps,C),C.mutatedParts&&Jr(C.mutatedParts)})):L.then(function(H){var V=ni(0,n(n({},C),{values:C.values.map(function(J,Y){var te;return H.failures[Y]?J:(J=(te=x.keyPath)!==null&&te!==void 0&&te.includes(".")?j(J):n({},J),S(J,x.keyPath,H.results[Y]),J)})}),H);B.optimisticOps.push(V),queueMicrotask(function(){return C.mutatedParts&&Jr(C.mutatedParts)})}),L):b.mutate(C)},query:function(C){if(!cr(ze,b)||!pn("query",C))return b.query(C);var L=((V=ze.trans)===null||V===void 0?void 0:V.db._options.cache)==="immutable",Y=ze,B=Y.requery,H=Y.signal,V=function(ie,ae,re,se){var de=Wt["idb://".concat(ie,"/").concat(ae)];if(!de)return[];if(!(ae=de.queries[re]))return[null,!1,de,null];var pe=ae[(se.query?se.query.index.name:null)||""];if(!pe)return[null,!1,de,null];switch(re){case"query":var ye=pe.find(function(be){return be.req.limit===se.limit&&be.req.values===se.values&&Ia(be.req.query.range,se.query.range)});return ye?[ye,!0,de,pe]:[pe.find(function(be){return("limit"in be.req?be.req.limit:1/0)>=se.limit&&(!se.values||be.req.values)&&So(be.req.query.range,se.query.range)}),!1,de,pe];case"count":return ye=pe.find(function(be){return Ia(be.req.query.range,se.query.range)}),[ye,!!ye,de,pe]}}(u,g,"query",C),J=V[0],Y=V[1],te=V[2],Q=V[3];return J&&Y?J.obsSet=C.obsSet:(Y=b.query(C).then(function(ie){var ae=ie.result;if(J&&(J.res=ae),L){for(var re=0,se=ae.length;re<se;++re)Object.freeze(ae[re]);Object.freeze(ae)}else ie.result=j(ae);return ie}).catch(function(ie){return Q&&J&&ee(Q,J),Promise.reject(ie)}),J={obsSet:C.obsSet,promise:Y,subscribers:new Set,type:"query",req:C,dirty:!1},Q?Q.push(J):(Q=[J],(te=te||(Wt["idb://".concat(u,"/").concat(g)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[C.query.index.name||""]=Q)),Ao(J,Q,B,H),J.promise.then(function(ie){return{result:Da(ie.result,C,te==null?void 0:te.optimisticOps,b,J,L)}})}})}})}};function ri(o,u){return new Proxy(o,{get:function(g,b,x){return b==="db"?u:Reflect.get(g,b,x)}})}var gn=(tt.prototype.version=function(o){if(isNaN(o)||o<.1)throw new ce.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var u=this._versions,g=u.filter(function(b){return b._cfg.version===o})[0];return g||(g=new this.Version(o),u.push(g),u.sort(bo),g.stores({}),this._state.autoSchema=!1,g)},tt.prototype._whenReady=function(o){var u=this;return this.idbdb&&(this._state.openComplete||ze.letThrough||this._vip)?o():new Se(function(g,b){if(u._state.openComplete)return b(new ce.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void b(new ce.DatabaseClosed);u.open().catch(ke)}u._state.dbReadyPromise.then(g,b)}).then(o)},tt.prototype.use=function(o){var u=o.stack,g=o.create,b=o.level,x=o.name;return x&&this.unuse({stack:u,name:x}),o=this._middlewares[u]||(this._middlewares[u]=[]),o.push({stack:u,create:g,level:b??10,name:x}),o.sort(function(C,L){return C.level-L.level}),this},tt.prototype.unuse=function(o){var u=o.stack,g=o.name,b=o.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(x){return b?x.create!==b:!!g&&x.name!==g})),this},tt.prototype.open=function(){var o=this;return Bt(Nt,function(){return xo(o)})},tt.prototype._close=function(){var o=this._state,u=qn.indexOf(this);if(0<=u&&qn.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new Se(function(g){o.dbReadyResolve=g}),o.openCanceller=new Se(function(g,b){o.cancelOpen=b}))},tt.prototype.close=function(g){var u=(g===void 0?{disableAutoOpen:!0}:g).disableAutoOpen,g=this._state;u?(g.isBeingOpened&&g.cancelOpen(new ce.DatabaseClosed),this._close(),g.autoOpen=!1,g.dbOpenError=new ce.DatabaseClosed):(this._close(),g.autoOpen=this._options.autoOpen||g.isBeingOpened,g.openComplete=!1,g.dbOpenError=null)},tt.prototype.delete=function(o){var u=this;o===void 0&&(o={disableAutoOpen:!0});var g=0<arguments.length&&typeof arguments[0]!="object",b=this._state;return new Se(function(x,C){function L(){u.close(o);var B=u._deps.indexedDB.deleteDatabase(u.name);B.onsuccess=Je(function(){var H,V,J;H=u._deps,V=u.name,J=H.indexedDB,H=H.IDBKeyRange,Ti(J)||V===yr||Oi(J,H).delete(V).catch(ke),x()}),B.onerror=Kt(C),B.onblocked=u._fireOnBlocked}if(g)throw new ce.InvalidArgument("Invalid closeOptions argument to db.delete()");b.isBeingOpened?b.dbReadyPromise.then(L):L()})},tt.prototype.backendDB=function(){return this.idbdb},tt.prototype.isOpen=function(){return this.idbdb!==null},tt.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},tt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},tt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tt.prototype,"tables",{get:function(){var o=this;return s(this._allTables).map(function(u){return o._allTables[u]})},enumerable:!1,configurable:!0}),tt.prototype.transaction=function(){var o=(function(u,g,b){var x=arguments.length;if(x<2)throw new ce.InvalidArgument("Too few arguments");for(var C=new Array(x-1);--x;)C[x-1]=arguments[x];return b=C.pop(),[u,F(C),b]}).apply(this,arguments);return this._transaction.apply(this,o)},tt.prototype._transaction=function(o,u,g){var b=this,x=ze.trans;x&&x.db===this&&o.indexOf("!")===-1||(x=null);var C,L,B=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(L=u.map(function(V){if(V=V instanceof b.Table?V.name:V,typeof V!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return V}),o=="r"||o===tr)C=tr;else{if(o!="rw"&&o!=Kr)throw new ce.InvalidArgument("Invalid transaction mode: "+o);C=Kr}if(x){if(x.mode===tr&&C===Kr){if(!B)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");x=null}x&&L.forEach(function(V){if(x&&x.storeNames.indexOf(V)===-1){if(!B)throw new ce.SubTransaction("Table "+V+" not included in parent transaction.");x=null}}),B&&x&&!x.active&&(x=null)}}catch(V){return x?x._promise(null,function(J,Y){Y(V)}):et(V)}var H=(function V(J,Y,te,Q,ie){return Se.resolve().then(function(){var ae=ze.transless||ze,re=J._createTransaction(Y,te,J._dbSchema,Q);if(re.explicit=!0,ae={trans:re,transless:ae},Q)re.idbtrans=Q.idbtrans;else try{re.create(),re.idbtrans._explicit=!0,J._state.PR1398_maxLoop=3}catch(pe){return pe.name===Oe.InvalidState&&J.isOpen()&&0<--J._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),J.close({disableAutoOpen:!1}),J.open().then(function(){return V(J,Y,te,null,ie)})):et(pe)}var se,de=oe(ie);return de&&Ot(),ae=Se.follow(function(){var pe;(se=ie.call(re,re))&&(de?(pe=$e.bind(null,null),se.then(pe,pe)):typeof se.next=="function"&&typeof se.throw=="function"&&(se=Ir(se)))},ae),(se&&typeof se.then=="function"?Se.resolve(se).then(function(pe){return re.active?pe:et(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ae.then(function(){return se})).then(function(pe){return Q&&re._resolve(),re._completion.then(function(){return pe})}).catch(function(pe){return re._reject(pe),et(pe)})})}).bind(null,this,C,L,x,g);return x?x._promise(C,H,"lock"):ze.trans?Bt(ze.transless,function(){return b._whenReady(H)}):this._whenReady(H)},tt.prototype.table=function(o){if(!v(this._allTables,o))throw new ce.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},tt);function tt(o,u){var g=this;this._middlewares={},this.verno=0;var b=tt.dependencies;this._options=u=n({addons:tt.addons,autoOpen:!0,indexedDB:b.indexedDB,IDBKeyRange:b.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},b=u.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var x,C,L,B,H,V={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};V.dbReadyPromise=new Se(function(Y){V.dbReadyResolve=Y}),V.openCanceller=new Se(function(Y,te){V.cancelOpen=te}),this._state=V,this.name=o,this.on=vr(this,"populate","blocked","versionchange","close",{ready:[at,ke]}),this.on.ready.subscribe=z(this.on.ready.subscribe,function(Y){return function(te,Q){tt.vip(function(){var ie,ae=g._state;ae.openComplete?(ae.dbOpenError||Se.resolve().then(te),Q&&Y(te)):ae.onReadyBeingFired?(ae.onReadyBeingFired.push(te),Q&&Y(te)):(Y(te),ie=g,Q||Y(function re(){ie.on.ready.unsubscribe(te),ie.on.ready.unsubscribe(re)}))})}}),this.Collection=(x=this,mr(ya.prototype,function(se,re){this.db=x;var Q=_i,ie=null;if(re)try{Q=re()}catch(de){ie=de}var ae=se._ctx,re=ae.table,se=re.hook.reading.fire;this._ctx={table:re,index:ae.index,isPrimKey:!ae.index||re.schema.primKey.keyPath&&ae.index===re.schema.primKey.name,range:Q,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ie,or:ae.or,valueMapper:se!==Ke?se:null}})),this.Table=(C=this,mr(ga.prototype,function(Y,te,Q){this.db=C,this._tx=Q,this.name=Y,this.schema=te,this.hook=C._allTables[Y]?C._allTables[Y].hook:vr(null,{creating:[fe,ke],reading:[Le,Ke],updating:[it,ke],deleting:[vt,ke]})})),this.Transaction=(L=this,mr(ba.prototype,function(Y,te,Q,ie,ae){var re=this;this.db=L,this.mode=Y,this.storeNames=te,this.schema=Q,this.chromeTransactionDurability=ie,this.idbtrans=null,this.on=vr(this,"complete","error","abort"),this.parent=ae||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Se(function(se,de){re._resolve=se,re._reject=de}),this._completion.then(function(){re.active=!1,re.on.complete.fire()},function(se){var de=re.active;return re.active=!1,re.on.error.fire(se),re.parent?re.parent._reject(se):de&&re.idbtrans&&re.idbtrans.abort(),et(se)})})),this.Version=(B=this,mr(Eo.prototype,function(Y){this.db=B,this._cfg={version:Y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(H=this,mr(Xr.prototype,function(Y,te,Q){if(this.db=H,this._ctx={table:Y,index:te===":id"?null:te,or:Q},this._cmp=this._ascending=Ye,this._descending=function(ie,ae){return Ye(ae,ie)},this._max=function(ie,ae){return 0<Ye(ie,ae)?ie:ae},this._min=function(ie,ae){return Ye(ie,ae)<0?ie:ae},this._IDBKeyRange=H._deps.IDBKeyRange,!this._IDBKeyRange)throw new ce.MissingAPI})),this.on("versionchange",function(Y){0<Y.newVersion?console.warn("Another connection wants to upgrade database '".concat(g.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(g.name,"'. Closing db now to resume the delete request.")),g.close({disableAutoOpen:!1})}),this.on("blocked",function(Y){!Y.newVersion||Y.newVersion<Y.oldVersion?console.warn("Dexie.delete('".concat(g.name,"') was blocked")):console.warn("Upgrade '".concat(g.name,"' blocked by other connection holding version ").concat(Y.oldVersion/10))}),this._maxKey=fn(u.IDBKeyRange),this._createTransaction=function(Y,te,Q,ie){return new g.Transaction(Y,te,Q,g._options.chromeTransactionDurability,ie)},this._fireOnBlocked=function(Y){g.on("blocked").fire(Y),qn.filter(function(te){return te.name===g.name&&te!==g&&!te._state.vcFired}).map(function(te){return te.on("versionchange").fire(Y)})},this.use(ka),this.use(ko),this.use(Ca),this.use(ti),this.use(_o);var J=new Proxy(this,{get:function(Y,te,Q){if(te==="_vip")return!0;if(te==="table")return function(ae){return ri(g.table(ae),J)};var ie=Reflect.get(Y,te,Q);return ie instanceof ga?ri(ie,J):te==="tables"?ie.map(function(ae){return ri(ae,J)}):te==="_createTransaction"?function(){return ri(ie.apply(this,arguments),J)}:ie}});this.vip=J,b.forEach(function(Y){return Y(g)})}var ii,l=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",c=(p.prototype.subscribe=function(o,u,g){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:u,complete:g})},p.prototype[l]=function(){return this},p);function p(o){this._subscribe=o}try{ii={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{ii={indexedDB:null,IDBKeyRange:null}}function m(o){var u,g=!1,b=new c(function(x){var C=oe(o),L,B=!1,H={},V={},J={get closed(){return B},unsubscribe:function(){B||(B=!0,L&&L.abort(),Y&&hn.storagemutated.unsubscribe(Q))}};x.start&&x.start(J);var Y=!1,te=function(){return xi(ie)},Q=function(ae){Dr(H,ae),Zr(V,H)&&te()},ie=function(){var ae,re,se;!B&&ii.indexedDB&&(H={},ae={},L&&L.abort(),L=new AbortController,se=function(de){var pe=er();try{C&&Ot();var ye=cn(o,de);return ye=C?ye.finally($e):ye}finally{pe&&Sn()}}(re={subscr:ae,signal:L.signal,requery:te,querier:o,trans:null}),Promise.resolve(se).then(function(de){g=!0,u=de,B||re.signal.aborted||(H={},function(pe){for(var ye in pe)if(v(pe,ye))return;return 1}(V=ae)||Y||(hn(Cn,Q),Y=!0),xi(function(){return!B&&x.next&&x.next(de)}))},function(de){g=!1,["DatabaseClosedError","AbortError"].includes(de==null?void 0:de.name)||B||xi(function(){B||x.error&&x.error(de)})}))};return setTimeout(te,0),J});return b.hasValue=function(){return g},b.getValue=function(){return u},b}var E=gn;function I(o){var u=$;try{$=!0,hn.storagemutated.fire(o),qi(o,!0)}finally{$=u}}w(E,n(n({},Re),{delete:function(o){return new E(o,{addons:[]}).delete()},exists:function(o){return new E(o,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return u=E.dependencies,g=u.indexedDB,u=u.IDBKeyRange,(Ti(g)?Promise.resolve(g.databases()).then(function(b){return b.map(function(x){return x.name}).filter(function(x){return x!==yr})}):Oi(g,u).toCollection().primaryKeys()).then(o)}catch{return et(new ce.MissingAPI)}var u,g},defineClass:function(){return function(o){f(this,o)}},ignoreTransaction:function(o){return ze.trans?Bt(ze.transless,o):o()},vip:Ri,async:function(o){return function(){try{var u=Ir(o.apply(this,arguments));return u&&typeof u.then=="function"?u:Se.resolve(u)}catch(g){return et(g)}}},spawn:function(o,u,g){try{var b=Ir(o.apply(g,u||[]));return b&&typeof b.then=="function"?b:Se.resolve(b)}catch(x){return et(x)}},currentTransaction:{get:function(){return ze.trans||null}},waitFor:function(o,u){return u=Se.resolve(typeof o=="function"?E.ignoreTransaction(o):o).timeout(u||6e4),ze.trans?ze.trans.waitFor(u):u},Promise:Se,debug:{get:function(){return Ve},set:function(o){ht(o)}},derive:k,extend:f,props:w,override:z,Events:vr,on:hn,liveQuery:m,extendObservabilitySet:Dr,getByKeyPath:K,setByKeyPath:S,delByKeyPath:function(o,u){typeof u=="string"?S(o,u,void 0):"length"in u&&[].map.call(u,function(g){S(o,g,void 0)})},shallowClone:G,deepClone:j,getObjectDiff:Fi,cmp:Ye,asap:T,minKey:-1/0,addons:[],connections:qn,errnames:Oe,dependencies:ii,cache:Wt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,u,g){return o+u/Math.pow(10,2*g)})})),E.maxKey=fn(E.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(hn(Cn,function(o){$||(o=new CustomEvent(ki,{detail:o}),$=!0,dispatchEvent(o),$=!1)}),addEventListener(ki,function(o){o=o.detail,$||I(o)}));var R,$=!1,U=function(){};return typeof BroadcastChannel<"u"&&((U=function(){(R=new BroadcastChannel(ki)).onmessage=function(o){return o.data&&I(o.data)}})(),typeof R.unref=="function"&&R.unref(),hn(Cn,function(o){$||R.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!gn.disableBfCache&&o.persisted){Ve&&console.debug("Dexie: handling persisted pagehide"),R!=null&&R.close();for(var u=0,g=qn;u<g.length;u++)g[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!gn.disableBfCache&&o.persisted&&(Ve&&console.debug("Dexie: handling persisted pageshow"),U(),I({all:new yt(-1/0,[[]])}))})),Se.rejectionMapper=function(o,u){return!o||o instanceof ue||o instanceof TypeError||o instanceof SyntaxError||!o.name||!Pe[o.name]?o:(u=new Pe[o.name](u||o.message,o),"stack"in o&&D(u,"stack",{get:function(){return this.inner.stack}}),u)},ht(Ve),n(gn,Object.freeze({__proto__:null,Dexie:gn,liveQuery:m,Entity:Hr,cmp:Ye,PropModification:wr,replacePrefix:function(o,u){return new wr({replacePrefix:[o,u]})},add:function(o){return new wr({add:o})},remove:function(o){return new wr({remove:o})},default:gn,RangeSet:yt,mergeRanges:In,rangesOverlap:Mn}),{default:gn}),gn})}(Ja)),Ja.exports}var pb=fb();const bu=Mt(pb),dd=Symbol.for("Dexie"),wu=globalThis[dd]||(globalThis[dd]=bu);if(bu.semVer!==wu.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${bu.semVer} and ${wu.semVer}`);const It=new wu("GraphStudioDB");It.version(1).stores({settings:"",history:"++id,timestamp"});class gb{constructor(e,t="mixed"){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.layout=e.layout,this.generator=new cb(this),this.metric=new Uh(this),this.graphsPanel=new lb(this),this.facePanel=new db(this),this.needsRedraw={node:!0,edge:!0,face:!0,rect:!1},this._saveQueue=Promise.resolve(),this.index=-1,this.cut=!1,this.graphClass={directed:Im,undirected:Mm,mixed:hr},this._graph=Wn.empty(this.graphClass[t],0),this._graph.updateAttributes(n=>({...n,label:"Graph",id:0,selected:!1})),this.graphs={index:0,all:[this._graph]},this.selectNodeIndex=0,this.selectEdgeIndex=0,this.subGraph=void 0,this.init()}init(){this.setupEventListeners(),this.graphsPanel.init(),this.facePanel.init()}get graph(){return this.graphs.all[this.graphs.index]}set graph(e){e.mergeAttributes(this.graphs.all[this.graphs.index].getAttributes()),this.graphs.all[this.graphs.index]=e}addNode(e,t){this.graph.addNode(e,t),this.saveGraphState("add node")}async updateIndex(e=null){const t=await It.history.count();if(e<0)return console.log("Nothing to Undo..."),!1;if(e>=t)return console.log("Nothing to Redo..."),!1;e===null?this.index=t-1:this.index=e;const n=await this.getSnapshot(this.index);return this.loadSnapshot(n),this.refresh(),!0}clearTo(e="mixed"){this.eventBus.emit("updateSetting",{key:"type",value:e}),this.graph=Wn.empty(this.graphClass[e],0),this.saveGraphState(`new ${e}`)}setupEventListeners(){this.eventBus.on("redo",async e=>{await this.updateIndex(this.index+1)}),this.eventBus.on("undo",async e=>{await this.updateIndex(this.index-1)})}saveGraphState(e="",t=!0){this._saveQueue=this._saveQueue.then(()=>this._performSaveGraphState(e,t)).catch(n=>{console.error("Error saving graph state:",n)})}async _performSaveGraphState(e="",t=!0){const n=await this.getSnapshot(this.index);if(n&&await It.history.where("timestamp").above(n.timestamp).delete(),this.settings.saveHistory){const i={version:1,index:this.graphs.index,all:this.graphs.all.map(a=>a.export()),timestamp:Date.now(),action:e};await this.saveHistory(i),this.index++,this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),t&&this.app.updateSimulation(),this.redraw()}}redraw(e={node:!0,edge:!0,face:!0,rect:!0}){this.needsRedraw=e,setTimeout(()=>{this.needsRedraw={node:!1,edge:!1,face:!1,rect:!1}},120)}makeGraphComplete(e="directed"){for(let t=0;t<this.graph.order;t++)for(let n=t+1;n<this.graph.order;n++)this.graph.type=="mixed"?e=="undirected"?this.graph.mergeUndirectedEdge(t,n):this.graph.mergeDirectedEdge(t,n):this.graph.mergeEdge(t,n);this.saveGraphState("connect all edges")}dropSelected(){const e=this.graph.getSelectedEdges(),t=this.graph.getSelectedNodes();this.graph.getSelectedFaces().forEach(i=>{this.graph.hasFace(i)&&this.graph.dropFace(i)}),e.forEach(i=>{this.graph.hasEdge(i)&&this.graph.dropEdge(i)}),t.forEach(i=>{this.graph.hasNode(i)&&this.graph.dropNode(i)}),this.app.rect.scale.active=!1,this.saveGraphState("remove selected")}connectSelectedNodes(e="directed"){this.graph.connectSelectedNodes(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge`)}connectSelectedNodesInOrder(e="directed"){this.graph.connectSelectedNodesInOrder(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge in order`)}updateSelectedColor(e=!0,t=!0,n=!0,i=!0,a=!0){this.graph.updateSelectedNodesColor(e?this.settings.node_color:!1,t?this.settings.stroke_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedEdgesColor(n?this.settings.edge_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedFacesColor(i?this.settings.face_color:!1,a?this.settings.label_color:!1),this.saveGraphState("update color",!1)}updateSelectedName(e){e?(this.graph.updateSelectedName(e),this.updateSelectedGarphsAttributes({label:e})):this.graph.updateSelectedName(""),this.saveGraphState("update name",!1)}getSelectedGraphs(){return this.graphs.all.filter(e=>e.getAttribute("selected"))}updateSelectedGarphsAttributes(e){this.getSelectedGraphs().forEach(t=>{t.mergeAttributes(e)})}updateSelectedInfo(e){if(e){const t={"":e};this.graph.updateSelectedInfo(t),this.updateSelectedGarphsAttributes({desc:t})}else this.graph.updateSelectedInfo({}),this.updateSelectedGarphsAttributes({desc:{}});this.saveGraphState("update info",!1)}updateSelectedWeight(e){const t=parseFloat(e);t?(this.graph.updateSelectedWeight(t),this.updateSelectedGarphsAttributes({weight:t})):(this.graph.updateSelectedWeight(void 0),this.updateSelectedGarphsAttributes({weight:void 0})),this.saveGraphState("update weight",!1)}deselectAll(){this.deselectAllNode(),this.deselectAllEdge(),this.deselectAllFace(),this.deselectAllGraph(),this.redraw()}deselectAllGraph(){for(const e of this.graphs.all)e.updateAttribute("selected",t=>!1);this.app.rect.scale.active=!1}deselectAllNode(){this.graph.updateEachNodeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({node:!0})}deselectAllEdge(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({edge:!0})}deselectAllFace(){this.graph.forEachFace((e,t)=>this.graph.deselectFace(e)),this.app.rect.scale.active=!1,this.redraw({face:!0})}selectAll(e=null){this.selectAllNode(e),this.selectAllEdge(e),this.selectAllFace(e),this.redraw()}selectAllFace(e){this.deselectAllFace(),e?e.forEach(t=>{this.selectFace(t)}):this.graph.updateEachFaceAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({face:!0})}selectAllEdge(e){this.deselectAllEdge(),e?e.forEach(t=>{this.selectEdge(t)}):this.graph.updateEachEdgeAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({edge:!0})}selectAllNode(e){e?(this.deselectAllNode(),e.forEach(t=>{this.graph.hasNode(t)&&this.graph.updateNodeAttributes(t,n=>({...n,selected:n.id+1}))})):this.graph.updateEachNodeAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({node:!0})}selectNode(e){this.graph.selectNode(e)}selectFace(e){this.graph.selectFace(e)}selectEdge(e){this.graph.selectEdge(e)}selectNextNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=La(this.selectNodeIndex+1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectPerviousNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=La(this.selectNodeIndex-1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectNextEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=La(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}selectPerviousEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=La(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}copySubgraph(){this.subGraph=this.graph.copySubgraph(),this.cut=!1}cutSubgraph(){this.subGraph=this.graph.cutSubgraph(),this.cut=!0,this.redraw()}pasteSubgraph(e=!1,t={x:150,y:100}){this.subGraph=this.graph.pasteSubgraph(this.subGraph,this.cut,t),e&&this.subgraph(),this.cut=!1,this.saveGraphState()}reverseGraph(){if(this.graph.type!=="undirected"){const e=Rr.reverse(this.graph);this.graph.replace(e),this.saveGraphState()}}toDirectedGraph(){if(this.graph.type!=="directed"){const e=Rr.toDirected(this.graph);this.clearTo("directed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"directed"}),this.saveGraphState()}}toMixedGraph(){if(this.graph.type!=="mixed"){const e=Rr.toMixed(this.graph);this.clearTo("mixed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"mixed"}),this.saveGraphState()}}toUndirectedGraph(){if(this.graph.type!=="undirected"){const e=Rr.toUndirected(this.graph);this.clearTo("undirected"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"undirected"}),this.saveGraphState()}}toWeighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:1})),this.saveGraphState("add weight to all edge")}toUnweighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:void 0})),this.saveGraphState("remove weight from all edge")}async saveHistory(e){var t;try{await It.history.add(e);const n=((t=this.settings)==null?void 0:t.historyLimit)||100,i=await It.history.count();if(i>n){const s=(await It.history.orderBy("id").limit(i-n).toArray()).map(d=>d.id);await It.history.bulkDelete(s),console.log(`Pruned ${s.length} old history snapshots.`)}}catch(n){console.error("Failed to save history snapshot:",n)}}async getLastSnapshot(){return await It.history.orderBy("id").reverse().first()}async getSnapshot(e){return await It.history.orderBy("id").offset(e).limit(1).first()}loadSnapshot(e){this.graphs={index:e.index,all:[]};for(const t of e.all){const n=Wn.empty(this.graphClass[t.options.type],0);this.graphs.all.push(n.import(t))}}refresh(){this.eventBus.emit("updateSetting",{key:"type",value:this.graphs.all[0].type}),this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),this.app.updateSimulation(),this.redraw()}async clearHistory(){await It.history.clear(),this.index=-1,console.log("History table cleared.")}subgraph(){if(!this.graph.getSelectedNodes().length){this.metric.addHeader("Graphs"),this.metric.addInfo("Select at least one node"),this.metric.addLine();return}const t=this.graph.copySubgraph();t.removeAttribute("id"),t.removeAttribute("label"),this.graphs.all.push(t),t.deselectAll(),this.deselectAll(),this.saveGraphState("add subgraph")}addFace(){const e=this.graph.getSelectedNodes(),t=Rr.subgraph(this.graph,e);this.metric._isCycle(t)&&(this.graph.addFace(e),this.saveGraphState("add face"))}}const yb="Shortcuts",vb={n:{desc:"New graph",action:"new-mixed-btn"},o:{desc:"Import graph",action:"import-graph"},s:{desc:"Scale",action:"toggle-scale-btn",value:!0},u:{desc:"Undo",action:"undo-btn"},d:{desc:"Delete",action:"remove-selection-btn"},c:{desc:"Update color",action:"color-selection-btn"},e:{desc:"Add edge",action:"add-edge-btn"},"alt+e":{desc:"Add edge",action:"add-edge-in-order-btn"},a:{desc:"All node info",action:"all-node-info-btn"},q:{desc:"Clear panel",action:"clear-info-panel-btn"},y:{desc:"Copy",action:"copy-subgraph"},x:{desc:"Cut",action:"cut-subgraph"},p:{desc:"Paste",action:"paste-subgraph"},"ctrl+p":{desc:"Paste",action:"paste-subgraph-seprate"},r:{desc:"Rename",action:"rename-btn"},i:{desc:"Info",action:"desc-btn"},w:{desc:"weight",action:"weight-btn"},f:{desc:"Force Simulation",action:"toggle-force-btn",value:!0},"ctrl+f":{desc:"Force Simulation",action:"add-face-btn"},t:{desc:"Tree",action:"toggle-tree-btn",value:!0},F5:{desc:"Reload",action:"reload"},ArrowUp:{desc:"Select all node",action:"select-all-node"},ArrowDown:{desc:"Deselect all node",action:"deselect-all-node"},ArrowRight:{desc:"Select next node",action:"select-next-node"},ArrowLeft:{desc:"Select previous node",action:"select-pervious-node"},"shift+ArrowRight":{desc:"Select next node",action:"select-next-node"},"shift+ArrowLeft":{desc:"Select previous node",action:"select-pervious-node"},shift:{desc:"Select",action:"toggle-select-btn",value:!0},alt:{desc:"Component",action:"toggle-component-btn",value:!0},ctrl:{desc:"Panning",action:"toggle-panning-btn",value:!0},"alt+a":{desc:"All edge info",action:"all-edge-info-btn"},"alt+ArrowUp":{desc:"Select all edge",action:"select-all-edge"},"alt+ArrowDown":{desc:"Deselect all edge",action:"deselect-all-edge"},"alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"shift+alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"shift+alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"ctrl+r":{desc:"Redo",action:"redo-btn"},"ctrl+s":{desc:"Export graph",action:"export-graph"},C:{desc:"Complete",action:"complete-btn"},"alt+C":{desc:"Complete",action:"complete-directed-btn"},O:{desc:"Organize circle",action:"organize-circle"},E:{desc:"Add directed edge",action:"add-directed-edge-btn"},"alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},P:{desc:"Export PNG",action:"export-png"},"shift+C":{desc:"Complete",action:"complete-btn"},"shift+alt+C":{desc:"Complete",action:"complete-directed-btn"},"shift+O":{desc:"Organize circle",action:"organize-circle"},"shift+alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},"shift+E":{desc:"Add directed edge",action:"add-directed-edge-btn"},"shift+P":{desc:"Export PNG",action:"export-png"},space:{desc:"Home",action:{c:{desc:"+ Color",action:{c:{desc:"Color Picker",action:"color-picker-btn"},n:{desc:"Update Node Color",action:"update-node-color"},s:{desc:"Update Stroke Color",action:"update-stroke-color"},e:{desc:"Update Edge Color",action:"update-edge-color"},l:{desc:"Update Label Color",action:"update-label-color"}}},n:{desc:"+ New Graph",action:{m:{desc:"Mixed Graph",action:"new-mixed-btn"},d:{desc:"Directed Graph",action:"new-digraph-btn"},u:{desc:"Undirected Graph",action:"new-undirected-graph-btn"}}},"":{desc:"Next Node (Alt for Edge)",action:""},"":{desc:"Pervious Node (Alt for Edge)",action:""},"":{desc:"Select all Nodes (Alt for Edges)",action:""},"":{desc:"Deselect all Nodes (Alt for Edges)",action:""}}}},Ya={desc:yb,action:vb},Ft=document;class mb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.eventKeyMap={AltRight:"alt",ControlRight:"ctrl",ShiftRight:"shift",AltLeft:"alt",ControlLeft:"ctrl",ShiftLeft:"shift",Space:"space"},this.pressedKeys=new Set,this.lastChord=Ya.action.space.action,this.modalChord=Ft.querySelector(".modal-chord"),this.inputModal=Ft.querySelector(".modal-input"),this._input=!1,this.header=Ft.querySelector(".modal-chord .shortcut-chord .header"),this.fakeHeader=Ft.querySelector(".modal-chord  .shortcut-chord-fake .header"),this._Chord=Ft.querySelector(".shortcut-chord"),this.fakeChord=Ft.querySelector(".shortcut-chord-fake"),this.exceptionKey=["ArrowUp","ArrowDown","arrowLeft","ArrowRight"]}init(){this.chordGenerator(this.lastChord),Ft.addEventListener("keydown",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const n=this.updatePressedKeys(t,"add");if(this._input){if(n==="Escape"&&this.toggleInput("rename",!1),n==="Enter"){const i=Ft.querySelector(".input-chord input");this.app.menu.handleMenuAction(this._input,i.value),this.toggleInput("rename",!1)}}else{this.isChordVisible()&&this.eventBus.on("key:down",{key:this.pressedKeys});const i=this.findKey();i?t.preventDefault():this.pressedKeys.clear(),this.action(i)}}),Ft.addEventListener("keyup",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const n=this.updatePressedKeys(t,"delete");this._input||(t.preventDefault(),this.lastChord[n]&&typeof this.lastChord[n].value=="boolean"&&this.app.menu.handleMenuAction(this.lastChord[n].action,!this.lastChord[n].value)),this.eventBus.emit("key:up",{key:this.pressedKeys})});const e=Ft.querySelectorAll(".modal, .modal-chord, .modal-input");e.length>0&&e.forEach(t=>{t.addEventListener("click",n=>{n.target===t&&(t.style.display="none",this.lastChord=Ya.action,this._input=!1)})})}chordGenerator(e){const t=Ft.createElement("ul");for(const a in e){const s=e[a].desc,d=Ft.createElement("li");d.innerHTML=`
      <span class="title">${a}</span>
      <span class="arrow"></span>
      <span class="desc">${s}</span>
    `,t.appendChild(d)}const n=this._Chord.querySelector("ul");n&&this._Chord.removeChild(n);const i=this.fakeChord.querySelector("ul");i&&this.fakeChord.removeChild(i),this._Chord.appendChild(t),this.fakeChord.appendChild(t.cloneNode(!0))}action(e){const t=this.lastChord[e];t?typeof t.action=="string"?(this.app.menu.handleMenuAction(t.action,t.value),this.lastChord=Ya.action,this.toggleChord(!1)):(this.lastChord=t.action,this.chordGenerator(this.lastChord),this.toggleChord(!0)):(this.toggleChord(!1),this.lastChord=Ya.action)}toggleChord(e=!0){e?this.modalChord.style.display="flex":this.modalChord.style.display="none"}toggleInput(e="rename",t=!0){const n=Ft.querySelector(".input-chord .header"),i=Ft.querySelector(".input-chord input");switch(e){case"rename":n.textContent="Rename",i.name="rename",i.placeholder="Enter New Name ...";break;case"desc":n.textContent="Description",i.name="desc",i.placeholder="Enter New Description ...";break;case"weight":n.textContent="Weight",i.name="weight",i.placeholder="Enter New Weight ...";break}t?(this.inputModal.style.display="flex",i.focus(),this._input=e):(this.inputModal.style.display="none",this._input=!1),setTimeout(()=>{i.value=""},1)}findKey(){return Object.keys(this.lastChord).find(n=>{const i=n.split("+");return this.isCombo(...i)})}isCombo(...e){return e.every(t=>this.pressedKeys.has(t))&&this.pressedKeys.size===e.length}updatePressedKeys(e,t="add"){const n=this.eventKeyMap[e.code]||e.key;return t==="add"&&n!=="meta"?this.pressedKeys.add(n):this.pressedKeys.delete(n),n}isShiftHold(){return this.pressedKeys.has("shift")}isCtrlHold(){return this.pressedKeys.has("ctrl")}isChordVisible(){return this.modalChord.style.display!=="none"}}const rt=document;function Eu(r,e){rt.querySelector(".container").classList.toggle("grid-hidden",r.grid<=2),rt.getElementById("grid-size-1").value=r.grid,rt.getElementById("vertex-size-1").value=r.node_radius,rt.getElementById("edge-size-1").value=r.edge_size,rt.getElementById("label-size-1").value=r.label_size,rt.getElementById("history-limit-1").value=r.historyLimit,rt.querySelector("#vertex-label .check").classList.toggle("hidden",!r.vertexLabel),rt.querySelector("#edge-label .check").classList.toggle("hidden",!r.edgeLabel),rt.querySelector("#face-label .check").classList.toggle("hidden",!r.faceLabel),rt.querySelector("#weight-label .check").classList.toggle("hidden",!r.weightLabel),rt.querySelector("#performance .check").classList.toggle("hidden",!r.performance),rt.querySelector("#save-history .check").classList.toggle("hidden",!r.saveHistory),rt.querySelector("#component").classList.toggle("gray-background",!r.component),rt.querySelector("#scale").classList.toggle("gray-background",!r.scale),rt.querySelector("#tree").classList.toggle("gray-background",!r.tree),rt.querySelector("#force").classList.toggle("gray-background",!r.forceSimulation),rt.querySelector("#colorPicker").classList.toggle("gray-background",!r.colorPicker),rt.querySelector("#panning").classList.toggle("gray-background",!r.panning),rt.querySelector("#select").classList.toggle("gray-background",!r.select),e.style.cursor=r.panning?"move":"default";const t=rt.documentElement;rt.querySelector(".container").classList.toggle("grid-hidden",r.grid<=2),t.style.setProperty("--grid-size",`${r.grid}px`),t.style.setProperty("--grid-color",r.grid_color),rt.querySelector(".container").style.backgroundColor=r.background_color}var Or={},bn={},Hs,hd;function bb(){if(hd)return Hs;hd=1;var r=je(),e=zh(),t=an(),n=e.createUnweightedIndexedBrandes,i=e.createDijkstraIndexedBrandes,a={edgeCentralityAttribute:"betweennessCentrality",getEdgeWeight:"weight",normalized:!0};function s(f,h,y){if(!r(h))throw new Error("graphology-centrality/edge-beetweenness-centrality: the given graph is not a valid graphology instance.");y=t(y,a);var v=y.edgeCentralityAttribute,w=y.normalized,_=y.getEdgeWeight?i(h,y.getEdgeWeight):n(h),D=h.order,k,N,O,M,z,A,T,K,S,G,q,F,W=new Float64Array(D),Z={};h.forEachEdge(function(X){Z[X]=0});var j=_.index.nodes;for(A=0;A<D;A++){for(k=_(A),N=k[0],O=k[1],M=k[2],T=N.size;T--;)W[N.items[N.size-T]]=0;for(;N.size!==0;)for(q=N.pop(),z=(1+W[q])/M[q],F=j[q],T=0,K=O[q].length;T<K;T++){S=O[q][T],G=M[S]*z;var ve=h.edge(j[S],F);Z[ve]+=G,W[S]+=G}}var ge=null;return w?ge=D<=1?null:1/(D*(D-1)):ge=h.type==="undirected"?.5:null,ge!==null&&h.forEachEdge(function(X){Z[X]*=ge}),f?h.updateEachEdgeAttributes(function(X,P){return P[v]=Z[X],P}):Z}var d=s.bind(null,!1);return d.assign=s.bind(null,!0),Hs=d,Hs}var Ys,fd;function wb(){if(fd)return Ys;fd=1;var r=an(),e=je(),t=Fr().createEdgeWeightGetter,n={nodeAuthorityAttribute:"authority",nodeHubAttribute:"hub",getEdgeWeight:"weight",maxIterations:100,normalize:!0,tolerance:1e-8};function i(f,h){var y=Object.create(null),v,w;for(v=0,w=f.length;v<w;v++)y[f[v]]=h;return y}function a(f){var h=0;for(var y in f)h+=f[y];return h}function s(f,h,y){if(!e(h))throw new Error("graphology-hits: the given graph is not a valid graphology instance.");if(h.multi)throw new Error("graphology-hits: the HITS algorithm does not work with MultiGraphs.");y=r(y,n);var v=t(y.getEdgeWeight).fromEntry,w=h.order,_=h.nodes(),D,k=i(_,1/w),N={},O=!1,M,z,A,T,K,S,G,q,F,W,Z,j,ve;for(h.forEachEdge(function(ge,X,P,ee,ne,le,oe){N[ge]=v(ge,X,P,ee,ne,le,oe)}),S=0;S<y.maxIterations;S++){for(M=k,k=i(_,0),z=i(_,0),q=0,G=0,Z=0;Z<w;Z++)for(A=_[Z],D=h.outboundEdges(A),j=0,ve=D.length;j<ve;j++)K=D[j],T=h.opposite(A,K),z[T]+=M[A]*N[K],z[T]>G&&(G=z[T]);for(Z=0;Z<w;Z++)for(A=_[Z],D=h.outboundEdges(A),j=0,ve=D.length;j<ve;j++)K=D[j],T=h.opposite(A,K),k[A]+=z[T]*N[K],k[T]>q&&(q=k[T]);W=1/q;for(A in k)k[A]*=W;W=1/G;for(A in z)z[A]*=W;F=0;for(A in k)F+=Math.abs(k[A]-M[A]);if(F<y.tolerance){O=!0;break}}if(!O)throw Error("graphology-metrics/centrality/hits: failed to converge.");if(y.normalize){W=1/a(z);for(A in z)z[A]*=W;W=1/a(k);for(A in k)k[A]*=W}if(f){h.updateEachNodeAttributes(function(ge,X){return X[y.nodeAuthorityAttribute]=z[ge],X[y.nodeHubAttribute]=k[ge],X},{attributes:[y.nodeAuthorityAttribute,y.nodeHubAttribute]});return}return{hubs:k,authorities:z}}var d=s.bind(null,!1);return d.assign=s.bind(null,!0),Ys=d,Ys}var pd;function Eb(){if(pd)return bn;pd=1;var r=Lh();return bn.betweenness=$h(),bn.edgeBetweenness=bb(),bn.closeness=Rh(),bn.eigenvector=Gh(),bn.hits=wb(),bn.pagerank=Bh(),bn.degree=r.degreeCentrality,bn.inDegree=r.inDegreeCentrality,bn.outDegree=r.outDegreeCentrality,bn}var Tn={},Un={},gd;function xb(){if(gd)return Un;gd=1;var r=je(),e="weight";function t(n,i,a,s,d){if(!r(a))throw new Error("graphology-metrics/"+n+": the given graph is not a valid graphology instance.");d=d||e;var f=0;return a[i](s,function(h,y,v,w,_,D,k){var N=typeof d=="function"?d(h,y,v,w,_,D,k):y[d];(typeof N!="number"||isNaN(N))&&(N=1),f+=N}),f}return Un.weightedDegree=t.bind(null,"weightedDegree","forEachEdge"),Un.weightedInDegree=t.bind(null,"weightedInDegree","forEachInEdge"),Un.weightedOutDegree=t.bind(null,"weightedOutDegree","forEachOutEdge"),Un.weightedInboundDegree=t.bind(null,"weightedInboundDegree","forEachInboundEdge"),Un.weightedOutboundDegree=t.bind(null,"weightedOutboundDegree","forEachOutboundEdge"),Un.weightedUndirectedDegree=t.bind(null,"weightedUndirectedDegree","forEachUndirectedEdge"),Un.weightedDirectedDegree=t.bind(null,"weightedDirectedDegree","forEachDirectedEdge"),Un}var yd;function _b(){if(yd)return Tn;yd=1;var r=xb();return Tn.eccentricity=Ku(),Tn.weightedDegree=r.weightedDegree,Tn.weightedInDegree=r.weightedInDegree,Tn.weightedOutDegree=r.weightedOutDegree,Tn.weightedInboundDegree=r.weightedInboundDegree,Tn.weightedOutboundDegree=r.weightedOutboundDegree,Tn.weightedUndirectedDegree=r.weightedUndirectedDegree,Tn.weightedDirectedDegree=r.weightedDirectedDegree,Tn}var vd;function Sb(){return vd||(vd=1,Or.centrality=Eb(),Or.edge=Oh(),Or.graph=Mh(),Or.layoutQuality=jh(),Or.node=_b()),Or}Sb();var zr;const gi=class gi{constructor(e){Vu(this,zr,!0);if(this.app=e,this.eventBus=e.eventBus,gi.instance)return gi.instance;gi.instance=this,this.debounceTimer=null,this.defaultSettings={background_color:"#ffffff",colorPicker:!1,component:!1,console_panel:!0,directed:!0,directed_edge:!0,edgeLabel:!0,edge_color:"#4682b4",edge_size:2,forceSimulation:!0,grid:20,type:"mixed",grid_color:"#00000020",info_panel:!0,label_color:"#000000",label_pos:{x:0,y:0},label_size:15,node_color:"#ffffff",face_color:"#4682b455",node_radius:40,panning:!1,scale:!1,select:!1,stroke_color:"#4682b4",stroke_size:2,tools_panel:!0,tree:!0,vertexLabel:!0,faceLabel:!0,weightLabel:!0,saveHistory:!0,historyLimit:100,graphs_panel:!0,face_panel:!0,performance:!1},this.nightSkyTheme={background_color:"#0d1b2a",edge_color:"#60a5fa",edge_size:1,forceSimulation:!1,grid_color:"#ffffff10",label_color:"#d1d5db",label_pos:{x:-20,y:-20},node_color:"#ffffff",node_radius:10,stroke_color:"#ffffff",stroke_size:0},this.registerEventListeners()}async init(){return this.settings=await this.loadFromIndexDb(),this.settings}registerEventListeners(){this.eventBus.on("updateSetting",e=>{const{key:t,value:n}=e.detail;if(this.setSetting(t,n),t=="grid"){const i=document.documentElement;document.querySelector(".container").classList.toggle("grid-hidden",this.settings.grid<=2),i.style.setProperty("--grid-size",`${this.settings.grid}px`)}else t&&n!==void 0&&this.eventBus.emit("graph:updated",{type:t})}),this.eventBus.on("updateAllSettings",e=>{const t=e.detail;t&&typeof t=="object"&&this.setAllSettings(t)}),this.eventBus.on("resetSettings",()=>{this.resetToDefault()}),this.eventBus.on("toggleSetting",e=>{const{key:t,value:n}=e.detail;t&&(this.toggleSetting(t,n),this.app.graphManager.needsRedraw={node:t=="vertexLabel",edge:t=="directed_edge"||t=="edgeLabel"||t=="weightLabel",face:t=="faceLabel"})})}async loadFromIndexDb(){try{const e=await It.settings.get("appSettings"),t=this.validateSettings(e);return Object.keys(this.defaultSettings).some(i=>!e||!(i in e))?(await It.settings.put(t,"appSettings"),console.log("Missing or invalid keys found  defaults merged and saved.")):console.log("Settings loaded successfully from IndexedDB."),t}catch(e){return console.warn("Failed to load settings from IndexedDB. Using defaults.",e),{...this.defaultSettings}}}saveToIndexedDB(e=this.settings){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(async()=>{try{await It.settings.update("appSettings",e),console.log("Settings saved to IndexedDB"),this.eventBus.emit("settingsChanged",this.getAllSettings())}catch(t){console.error("Failed to save settings to IndexedDB",t)}},500)}resetToDefault(){this.setAllSettings(this.defaultSettings)}getSetting(e){return this.settings[e]}getAllSettings(){return{...this.settings}}setSetting(e,t){const n=this.settings[e];e in this.settings?this.settings[e]!==t&&(this.settings[e]=t,Pa(this,zr)&&this.settings[e]!=n&&this.saveToIndexedDB({[e]:this.settings[e]})):console.warn(`Setting "${e}" does not exist.`)}setAllSettings(e){Object.keys(e).forEach(t=>{t in this.settings&&(this.settings[t]=e[t])}),this.eventBus.emit("settingsChanged",this.getAllSettings()),Pa(this,zr)&&this.saveToIndexedDB(),Eu(this.settings,this.app.canvas)}toggleSetting(e,t=null){const n=["scale","panning","select","component"],i=this.settings[e];e in this.settings&&typeof this.settings[e]=="boolean"?(console.log(),t===null?this.settings[e]=!this.settings[e]:this.settings[e]=t,n.includes(e)&&(this.settings.forceSimulation=!1,n.forEach(a=>{a!=e&&this.settings[e]&&(this.settings[a]=!1)})),e==="forceSimulation"&&(this.settings.forceSimulation?(n.forEach(a=>{this.settings[e]&&(this.settings[a]=!1)}),this.app.startSimulation()):this.app.stopSimulation()),this.settings.performance&&(this.settings.forceSimulation=!1),Pa(this,zr)&&this.settings[e]!=i&&!n.includes(e)&&this.saveToIndexedDB({[e]:this.settings[e]}),Eu(this.settings,this.app.canvas),this.app.widget.init()):console.warn(`Setting "${e}" does not exist or is not a boolean.`)}setAutoSave(e){Qu(this,zr,e)}validateSettings(e){const t=this.defaultSettings,n={};for(const i in t)n[i]=e!=null&&e.hasOwnProperty(i)?e[i]:t[i];return n}loadNightSkyTheme(){this.setAllSettings(this.nightSkyTheme)}};zr=new WeakMap,Ct(gi,"instance",null);let xu=gi;const Ge=document;class Ab{constructor(e,t,n="menu-bar"){if(this.app=e,this.eventBus=e.eventBus,this.graphManager=e.graphManager,this.appSettings=e.appSettings,this.layout=e.layout,this.menuData=t,this.container=Ge.getElementById(n),!this.container){console.error("Menu container not found!");return}this.spaceEvent=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,which:32,bubbles:!0})}init(){this.renderMenu(),this.attachEventListeners()}renderMenu(){this.container.innerHTML="";const e=Ge.createElement("ul");this.menuData.forEach(t=>{const n=this.createMenu(t);e.appendChild(n)}),this.container.appendChild(e)}createMenu(e){const t=Ge.createElement("li");if(e.id&&(t.id=e.id),e.title&&(t.textContent=e.title),e.submenu){const n=this.createSubmenu(e.submenu);t.appendChild(n)}return t}createSubmenu(e){const t=Ge.createElement("ul");return e.forEach(n=>{if(n.type==="divider"){t.appendChild(Ge.createElement("hr"));return}const i=Ge.createElement("li");if(n.id&&(i.id=n.id),n.title){const a=Ge.createElement("label");if(a.textContent=n.title,n.link){const s=Ge.createElement("a");s.href=n.link,s.target="_blank",n.label?s.textContent=n.label:(s.textContent="?",s.classList.add("border")),a.insertBefore(s,a.firstChild)}i.appendChild(a)}if(n.shortcut){const a=Ge.createElement("span");a.textContent=n.shortcut,i.appendChild(a)}if("check"in n&&!n.shortcut){const a=Ge.createElement("span");a.innerHTML="&#10004;",a.classList.add("check"),n.check||a.classList.add("hidden"),i.appendChild(a)}if(n.input)if(n.id==="import-graph")i.appendChild(this.createInput(n.input[0]));else{const a=Ge.createElement("div");n.input.forEach(s=>{a.appendChild(this.createInput(s))}),i.appendChild(a)}n.name&&i.setAttribute("name",n.name),n.submenu&&i.appendChild(this.createSubmenu(n.submenu)),t.appendChild(i)}),t}createInput(e){const t=Ge.createElement("input");return t.type=e.type||"text",t.id=e.id,"hidden"in e&&(t.hidden=e.hidden),e.name&&(t.name=e.name),e.placeholder&&(t.placeholder=e.placeholder),e.required&&(t.required=!0),["number","range","date"].includes(t.type)&&(e.min!==void 0&&(t.min=e.min),e.max!==void 0&&(t.max=e.max),e.step!==void 0&&(t.step=e.step)),e.value!==void 0&&(e.type==="checkbox"||e.type==="radio"?t.checked=e.value:t.value=e.value),t}handleMenuAction(e,t){const n={"new-mixed-btn":()=>{this.graphManager.clearTo("mixed")},"new-digraph-btn":()=>{this.graphManager.clearTo("directed")},"new-undirected-graph-btn":()=>{this.graphManager.clearTo("undirected")},"import-graph":()=>this.eventBus.emit("import"),"export-graph":()=>this.eventBus.emit("export",{type:"json"}),"export-png":()=>this.eventBus.emit("export",{type:"png"}),"default-settings-btn":()=>this.appSettings.resetToDefault(),"sky-night-theme-btn":()=>this.appSettings.loadNightSkyTheme(),reload:()=>location.reload(),"add-edge-btn":()=>this.graphManager.connectSelectedNodes("undirected"),"add-face-btn":()=>this.graphManager.addFace(),"add-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("undirected"),"add-directed-edge-btn":()=>this.graphManager.connectSelectedNodes("directed"),"add-directed-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("directed"),"remove-selection-btn":()=>this.graphManager.dropSelected(),"color-selection-btn":()=>this.graphManager.updateSelectedColor(!0,!0,!0,!0),"complete-btn":()=>this.graphManager.makeGraphComplete("undirected"),"complete-directed-btn":()=>this.graphManager.makeGraphComplete("directed"),"node-color":()=>this.eventBus.emit("updateSetting",{key:"node_color",value:t}),"edge-color":()=>this.eventBus.emit("updateSetting",{key:"edge_color",value:t}),"label-color":()=>this.eventBus.emit("updateSetting",{key:"label_color",value:t}),"stroke-color":()=>this.eventBus.emit("updateSetting",{key:"stroke_color",value:t}),"background-color":()=>{Ge.querySelector(".container").style.backgroundColor=t,this.eventBus.emit("updateSetting",{key:"background_color",value:t})},"grid-color":()=>{Ge.documentElement.style.setProperty("--grid-color",t),this.eventBus.emit("updateSetting",{key:"grid_color",value:t})},rename:()=>this.graphManager.updateSelectedName(t),"rename-btn":()=>this.app.keyHandler.toggleInput("rename"),desc:()=>this.graphManager.updateSelectedInfo(t),"desc-btn":()=>this.app.keyHandler.toggleInput("desc"),weight:()=>this.graphManager.updateSelectedWeight(t),"weight-btn":()=>this.app.keyHandler.toggleInput("weight"),"redo-btn":()=>this.eventBus.emit("redo"),"undo-btn":()=>this.eventBus.emit("undo"),"panel-btn":()=>this.eventBus.emit("toggleSetting",{key:"info_panel"}),"tools-btn":()=>this.eventBus.emit("toggleSetting",{key:"tools_panel"}),"graphs-btn":()=>this.eventBus.emit("toggleSetting",{key:"graphs_panel"}),"faces-btn":()=>this.eventBus.emit("toggleSetting",{key:"face_panel"}),"shortcut-chord-btn":()=>Ge.dispatchEvent(this.spaceEvent),"component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component"}),"scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale"}),"tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree"}),"force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation"}),"panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning"}),"select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select"}),"toggle-component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component",value:t}),"toggle-scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale",value:t}),"toggle-tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree",value:t}),"toggle-force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation",value:t}),"toggle-panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning",value:t}),"toggle-select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select",value:t}),"color-picker-btn":()=>this.eventBus.emit("toggleSetting",{key:"colorPicker"}),"vertex-label":()=>this.eventBus.emit("toggleSetting",{key:"vertexLabel"}),"edge-label":()=>this.eventBus.emit("toggleSetting",{key:"edgeLabel"}),"face-label":()=>this.eventBus.emit("toggleSetting",{key:"faceLabel"}),"weight-label":()=>this.eventBus.emit("toggleSetting",{key:"weightLabel"}),"vertex-size-1":()=>this.eventBus.emit("updateSetting",{key:"node_radius",value:t}),"edge-size-1":()=>this.eventBus.emit("updateSetting",{key:"edge_size",value:t}),"label-size-1":()=>this.eventBus.emit("updateSetting",{key:"label_size",value:t}),"grid-size-1":()=>this.eventBus.emit("updateSetting",{key:"grid",value:t}),"stroke-size-1":()=>this.eventBus.emit("updateSetting",{key:"stroke_size",value:t}),performance:()=>this.eventBus.emit("toggleSetting",{key:"performance"}),"save-history":()=>this.eventBus.emit("toggleSetting",{key:"saveHistory"}),"clear-histoory-btn":()=>this.graphManager.clearHistory(),"history-limit-1":()=>{this.graphManager.limit=t,this.eventBus.emit("updateSetting",{key:"historyLimit",value:t})},"basic-info-btn":()=>this.graphManager.metric.basicInfo(),"lies-on-cycle-btn":()=>this.graphManager.metric.liesOnCycle(),"list-degrees-btn":()=>this.graphManager.metric.degreeSequesnce(),"components-btn":()=>this.graphManager.metric.countComponents(),"neighbors-btn":()=>this.graphManager.metric.neighbors(),"shortest-path-btn":()=>this.graphManager.metric.shortestPath(),"density-btn":()=>this.graphManager.metric.density(),"diameter-btn":()=>this.graphManager.metric.diameter(),"eccentricity-btn":()=>this.graphManager.metric.eccentricity(),"simmelian-strength-btn":()=>this.graphManager.metric.simmelianStrength(),"betweenness-centrality-btn":()=>this.graphManager.metric.betweennessCentrality(),"closeness-centrality-btn":()=>this.graphManager.metric.closenessCentrality(),"degree-centrality-btn":()=>this.graphManager.metric.degreeCentrality(),"eigenvector-centrality-btn":()=>this.graphManager.metric.eigenvectorCentrality(),"pagerank-btn":()=>this.graphManager.metric.pagerank(),"edge-uniformity-btn":()=>this.graphManager.metric.edgeUniformity(),"neighborhood-preservation-btn":()=>this.graphManager.metric.neighborhoodPreservation(),"stress-btn":()=>this.graphManager.metric.stress(),"disparity-btn":()=>this.graphManager.metric.disparity(),"clear-info-panel-btn":()=>Ge.querySelector("#floating-panel .body-info").innerHTML="","all-node-info-btn":()=>this.graphManager.metric.allNodeInfo(),"all-edge-info-btn":()=>this.graphManager.metric.allEdgeInfo(),"all-face-info-btn":()=>this.graphManager.metric.allFaceInfo(),"all-graph-info-btn":()=>this.graphManager.metric.allGraphInfo(),empty:()=>this.graphManager.generator.empty(Ge.getElementById("g-empty-1").value),"g-empty-1":()=>this.graphManager.generator.empty(t),cycle:()=>this.graphManager.generator.cycle(Ge.getElementById("g-cycle-1").value),"g-cycle-1":()=>this.graphManager.generator.cycle(t),path:()=>this.graphManager.generator.path(Ge.getElementById("g-path-1").value),"g-path-1":()=>this.graphManager.generator.path(t),ladder:()=>this.graphManager.generator.ladder(Ge.getElementById("g-ladder-1").value),"g-ladder-1":()=>this.graphManager.generator.ladder(t),complete:()=>this.graphManager.generator.complete(Ge.getElementById("g-complete-1").value),"g-complete-1":()=>this.graphManager.generator.complete(t),"complete-bipartite":()=>this.graphManager.generator.completeBipartite(Ge.getElementById("g-complete-bipartite-1").value,Ge.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-1":()=>this.graphManager.generator.completeBipartite(t,Ge.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-2":()=>this.graphManager.generator.completeBipartite(Ge.getElementById("g-complete-bipartite-1").value,t),caveman:()=>this.graphManager.generator.caveman(Ge.getElementById("g-caveman-1").value,Ge.getElementById("g-caveman-2").value),"g-caveman-1":()=>this.graphManager.generator.caveman(t,Ge.getElementById("g-caveman-2").value),"g-caveman-2":()=>this.graphManager.generator.caveman(Ge.getElementById("g-caveman-1").value,t),"connected-caveman":()=>this.graphManager.generator.connectedCaveman(Ge.getElementById("g-connected-caveman-1").value,Ge.getElementById("g-connected-caveman-2").value),"g-connected-caveman-1":()=>this.graphManager.generator.connectedCaveman(t,Ge.getElementById("g-connected-caveman-2").value),"g-connected-caveman-2":()=>this.graphManager.generator.connectedCaveman(Ge.getElementById("g-connected-caveman-1").value,t),clusters:()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,Ge.getElementById("g-clusters-2").value,Ge.getElementById("g-clusters-3").value),"g-clusters-1":()=>this.graphManager.generator.clusters(t,Ge.getElementById("g-clusters-2").value,Ge.getElementById("g-clusters-3").value),"g-clusters-2":()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,t,Ge.getElementById("g-clusters-3").value),"g-clusters-3":()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,Ge.getElementById("g-clusters-2").value,t),"erdos-renyi":()=>this.graphManager.generator.erdosRenyi(Ge.getElementById("g-erdos-renyi-1").value,Ge.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-1":()=>this.graphManager.generator.erdosRenyi(t,Ge.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-2":()=>this.graphManager.generator.erdosRenyi(Ge.getElementById("g-erdos-renyi-1").value,t),"griven-newmn":()=>this.graphManager.generator.girvanNewman(Ge.getElementById("g-girvan-newman-1").value),"g-girvan-newman-1":()=>this.graphManager.generator.girvanNewman(t),"krackhardt-kite":()=>this.graphManager.generator.krackhardtkite(),"florentine-families":()=>this.graphManager.generator.florentineFamilies(),"karate-club":()=>this.graphManager.generator.karateClub(),aries:()=>this.graphManager.generator.zodiac.aries(),taurus:()=>this.graphManager.generator.zodiac.taurus(),gemini:()=>this.graphManager.generator.zodiac.gemini(),cancer:()=>this.graphManager.generator.zodiac.cancer(),leo:()=>this.graphManager.generator.zodiac.leo(),virgo:()=>this.graphManager.generator.zodiac.virgo(),libra:()=>this.graphManager.generator.zodiac.libra(),scorpius:()=>this.graphManager.generator.zodiac.scorpius(),ophiuchus:()=>this.graphManager.generator.zodiac.ophiuchus(),sagittarius:()=>this.graphManager.generator.zodiac.sagittarius(),capricornus:()=>this.graphManager.generator.zodiac.capricornus(),aquarius:()=>this.graphManager.generator.zodiac.aquarius(),pisces:()=>this.graphManager.generator.zodiac.pisces(),"organize-circle":()=>this.layout.applyLayout("circle"),"center-layout":()=>this.layout.applyLayout("center"),"random-layout":()=>this.layout.applyLayout("random"),"rotate-layout-1":()=>this.layout.applyLayout("rotate",t),"rotate-layout":()=>{const i=Ge.getElementById("rotate-layout-1").value;return this.layout.applyLayout("rotate",i)},"hflip-layout":()=>this.layout.applyLayout("h-flip"),"vflip-layout":()=>this.layout.applyLayout("v-flip"),"force-layout":()=>this.layout.applyLayout("force",{itteration:Ge.getElementById("force-itteration").value,gravity:Ge.getElementById("force-gravity").value}),"froce-itteration":()=>this.layout.applyLayout("force",{val:t,gravity:Ge.getElementById("force-gravity").value}),"force-gravity":()=>this.layout.applyLayout("force",{itteration:Ge.getElementById("force-itteration").value,gravity:t}),"noverlap-layout":()=>this.layout.applyLayout("noverlap"),"reverse-direction":()=>this.graphManager.reverseGraph(),"to-undirected":()=>this.graphManager.toUndirectedGraph(),"to-directed":()=>this.graphManager.toDirectedGraph(),"to-mixed":()=>this.graphManager.toMixedGraph(),"to-weighted":()=>this.graphManager.toWeighted(),"to-unweighted":()=>this.graphManager.toUnweighted(),"subgraph-btn":()=>this.graphManager.subgraph(),graphs:()=>this.graphManager.graphsPanel.selectLis(t),faces:()=>this.graphManager.facePanel.selectLis(t),"how-to-use":()=>window.open("https://www.youtube.com/playlist?list=PLaa8UNGS4QED9DUhAZt7O963qkScAWah3","_blank"),command:()=>{Ge.querySelector(".modal").style.display="flex",Ge.querySelector(".modal .help-panel").style.display="block"},about:()=>window.open("http://picinfiniti.net/","_blank"),"select-all-node":()=>this.graphManager.selectAllNode(),"deselect-all-node":()=>this.graphManager.deselectAllNode(),"select-next-node":()=>this.graphManager.selectNextNode(),"select-pervious-node":()=>this.graphManager.selectPerviousNode(),"select-all-edge":()=>this.graphManager.selectAllEdge(),"deselect-all-edge":()=>this.graphManager.deselectAllEdge(),"select-next-edge":()=>this.graphManager.selectNextEdge(),"select-pervious-edge":()=>this.graphManager.selectPerviousEdge(),"copy-subgraph":()=>this.graphManager.copySubgraph(),"cut-subgraph":()=>this.graphManager.cutSubgraph(),"paste-subgraph":()=>this.graphManager.pasteSubgraph(),"paste-subgraph-seprate":()=>this.graphManager.pasteSubgraph(!0),"update-node-color":()=>this.graphManager.updateSelectedColor(!0,!1,!1,!1,!1),"update-stroke-color":()=>this.graphManager.updateSelectedColor(!1,!0,!1,!1,!1),"update-edge-color":()=>this.graphManager.updateSelectedColor(!1,!1,!0,!1,!1),"update-face-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!0,!1),"update-label-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!1,!0)};n[e]?n[e]():console.log(`No action defined for: ${e}`)}attachEventListeners(){Ge.addEventListener("click",e=>{if(e.target.tagName==="INPUT")return;const t=e.target.closest("li");if(!t)return;const n=t.getAttribute("name")||t.id;n&&this.handleMenuAction(n,t.id)}),Ge.addEventListener("input",e=>{const t=e.target;if(!t||t.name=="rename"||t.name=="desc"||t.name=="weight")return;const n=t.id||t.getAttribute("name");if(n){const i=t.value||1;this.handleMenuAction(n,i)}})}}const di=document;class kb{constructor(e){this.app=e,this.eventBus=e.eventBus}init(){this.app.eventBus.on("import",e=>{di.getElementById("file-input").click()}),this.app.eventBus.on("export",async e=>{const t=document;if(e.detail.type==="json")try{const n=[];n.push("[");let i=!0;await It.history.orderBy("id").each(f=>{i||n.push(`,
`),n.push(JSON.stringify(f,null,2)),i=!1}),n.push("]");const a=new Blob(n,{type:"application/json"}),s=URL.createObjectURL(a),d=t.createElement("a");d.href=s,d.download="graph-history.json",t.body.appendChild(d),d.click(),t.body.removeChild(d),URL.revokeObjectURL(s),console.log("Efficient history export completed.")}catch(n){console.error("Failed to stream-export history:",n)}e.detail.type==="png"&&this.exportGraphAsImage()}),di.getElementById("file-input").addEventListener("change",async e=>{const t=e.target.files[0];if(t){try{const n=new FileReader;n.onload=async i=>{try{const a=JSON.parse(i.target.result);if(!Array.isArray(a)){alert("Invalid file format. Expected an array of snapshots.");return}if(a.length===0){alert("The file contains no history snapshots.");return}if(!confirm("Importing will erase your current history. Continue?"))return;a.sort((f,h)=>f.id-h.id),await It.history.clear(),await It.history.bulkAdd(a);const d=await this.app.graphManager.getLastSnapshot();d?(this.app.graphManager.loadSnapshot(d),this.app.graphManager.refresh(),console.log(`Imported ${a.length} snapshots into history.`)):alert("Import succeeded, but no usable snapshot was found.")}catch(a){console.error("Failed to import history:",a),alert("Import failed. The file may be corrupted or not valid JSON.")}},n.readAsText(t)}catch(n){console.error("File reading error:",n),alert("Failed to read the selected file.")}e.target.value=""}})}exportGraphAsImage(){const e=this.app.canvas.width,t=this.app.canvas.height,n=di.createElement("canvas");n.width=e,n.height=t;const i=n.getContext("2d");i.drawImage(this.app._canvas._canvas.face.canvas,0,0),i.drawImage(this.app._canvas._canvas.edge.canvas,0,0),i.drawImage(this.app._canvas._canvas.node.canvas,0,0),n.toBlob(a=>{if(!a){console.error("Export failed: canvas may be empty or tainted.");return}const s=di.createElement("a");s.href=URL.createObjectURL(a),s.download="graph-studio-export.png",di.body.appendChild(s),s.click(),di.body.removeChild(s)},"image/png")}}const Cb=[{title:"File",id:"file",submenu:[{title:" New Graph",id:"new-mixed-btn",shortcut:"(n)"},{title:" Import",id:"import-graph",shortcut:"(o)",input:[{type:"file",id:"file-input",hidden:!0}]},{title:" Export",id:"export-graph",shortcut:"(Ctrl+s)"},{title:" Export to PNG",id:"export-png",shortcut:"(P)"},{type:"divider"},{title:" Default Setting",id:"default-settings-btn"},{title:" Sky Night",id:"sky-night-theme-btn"},{type:"divider"},{title:" Reload",id:"reload",shortcut:"(F5)"}]},{title:"Edit",id:"edit",submenu:[{title:"Delete",name:"remove-selection-btn",shortcut:"(d)"},{title:"Assign Color",name:"color-selection-btn",shortcut:"(c)"},{title:"Add Edge",name:"add-edge-btn",shortcut:"(alt-e)"},{title:"Add Directed Edge",name:"add-directed-edge-btn",shortcut:"(alt-E)"},{title:"Add Face",name:"add-face-btn",shortcut:"(ctrl+f)"},{type:"divider"},{title:"Copy",name:"copy-subgraph",shortcut:"(y)"},{title:"Cut",name:"cut-subgraph",shortcut:"(x)"},{title:"Paste",name:"paste-subgraph",shortcut:"(p)"},{type:"divider"},{title:"Rename",name:"rename-btn",shortcut:"(r)"},{title:"Edit Info",name:"desc-btn",shortcut:"(i)"},{title:"Edit Weight",name:"weight-btn",shortcut:"(w)"},{type:"divider"},{title:"Undo",name:"undo-btn",shortcut:"(u)"},{title:"Redo",name:"redo-btn",shortcut:"(Ctrl+r)"}]},{title:"Settings",id:"settings",submenu:[{title:"Graph",id:"graph-settings",shortcut:">",submenu:[{title:"Vertex",id:"vertex-label",check:!0},{title:"Edge",id:"edge-label",check:!0},{title:"Face",id:"face-label",check:!0},{title:"Weight",id:"weight-label",check:!0},{type:"divider"},{title:"Grid",id:"gride-size",input:[{type:"range",id:"grid-size-1",min:0,max:100,value:20}]},{title:"Node",id:"vertex-size",input:[{type:"range",id:"vertex-size-1",min:0,max:200,value:10,step:.1}]},{title:"Edge",id:"edge-size",input:[{type:"range",id:"edge-size-1",min:1,max:100,value:2}]},{title:"Label",id:"label-size",input:[{type:"range",id:"label-size-1",min:0,max:100,value:15}]},{title:"Stroke",id:"stroke-size",input:[{type:"range",id:"stroke-size-1",min:0,max:50,value:5,step:.1}]}]},{title:"View",id:"view",shortcut:">",submenu:[{title:"Info Panel",id:"panel-btn",check:!0},{title:"Tools Panel",id:"tools-btn",check:!0},{title:"Graphs Panel",id:"graphs-btn",check:!0},{title:"Face Panel",id:"faces-btn",check:!0},{type:"divider"},{title:"Key Chord",id:"shortcut-chord-btn",shortcut:""}]},{type:"divider"},{title:"Performance",id:"performance",check:!0},{title:"History",id:"History",shortcut:">",submenu:[{title:"History Limit",id:"history-limit",input:[{type:"number",id:"history-limit-1",min:5,max:1e4,value:5}]},{title:"Save History",id:"save-history",check:!0},{title:"Clear History",id:"clear-histoory-btn"}]}]},{title:"Tools",id:"tools",submenu:[{title:"Scale",id:"scale-btn",check:!1,shortcut:"(s)"},{title:"Panning",id:"panning-btn",check:!1,shortcut:"Ctrl"},{title:"Selecting",id:"select-btn",check:!1,shortcut:"Shift"},{title:"Component",id:"component-btn",check:!1,shortcut:"Alt"},{type:"divider"},{title:"Tree",id:"tree-btn",check:!1,shortcut:"(t)"},{title:"Force Simulation",id:"force-btn",check:!1,shortcut:"(f)"},{type:"divider"},{title:"Color Picker",id:"color-picker-btn",check:!1,shortcut:" cc"}]},{title:"Generator",id:"generator",submenu:[{title:"Classic",id:"classic",shortcut:">",submenu:[{title:"Empty",id:"empty",input:[{type:"number",id:"g-empty-1",min:1,max:500,value:5}]},{title:"K",id:"complete",link:"https://en.wikipedia.org/wiki/Complete_graph",input:[{type:"number",id:"g-complete-1",min:1,max:500,value:5}]},{title:"K,",id:"complete-bipartite",link:"https://en.wikipedia.org/wiki/Complete_bipartite_graph",input:[{type:"number",id:"g-complete-bipartite-1",min:1,max:500,value:5},{type:"number",id:"g-complete-bipartite-2",min:1,max:500,value:5}]},{title:"P",id:"path",link:"https://en.wikipedia.org/wiki/Path_graph",input:[{type:"number",id:"g-path-1",min:2,max:500,value:5}]},{title:"C",id:"cycle",link:"https://en.wikipedia.org/wiki/Cycle_graph",input:[{type:"number",id:"g-cycle-1",min:3,max:500,value:5}]},{title:"L",id:"ladder",link:"https://en.wikipedia.org/wiki/Ladder_graph",input:[{type:"number",id:"g-ladder-1",min:2,max:500,value:5}]}]},{title:"Community",id:"community",shortcut:">",submenu:[{title:"C,",id:"caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-caveman-2",min:1,max:500,value:5}]},{title:"Q,",id:"connected-caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-connected-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-connected-caveman-2",min:1,max:500,value:5}]}]},{title:"Random",id:"random",shortcut:">",submenu:[{title:"Clusters",id:"clusters",input:[{type:"number",id:"g-clusters-1",min:2,max:500,value:20},{type:"number",id:"g-clusters-2",min:2,max:500,value:20},{type:"number",id:"g-clusters-3",min:2,max:500,value:10}]},{title:"erdos Renyi",id:"erdos-renyi",link:"https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model",input:[{type:"number",id:"g-erdos-renyi-1",min:1,max:500,value:10},{type:"number",id:"g-erdos-renyi-2",min:0,max:1,step:.1,value:.5}]},{title:"Girvan Newman",id:"griven-newmn",link:"https://www.pnas.org/doi/pdf/10.1073/pnas.122653799",input:[{type:"number",id:"g-girvan-newman-1",min:1,max:500,value:5}]}]},{title:"Small",id:"small",shortcut:">",submenu:[{title:"Krackhardt kite",id:"krackhardt-kite",link:"https://en.wikipedia.org/wiki/Krackhardt_kite_graph"}]},{title:"Social",id:"social",shortcut:">",submenu:[{title:"Florentine families",id:"florentine-families"},{title:"Zacharys karate club",id:"karate-club",link:"https://en.wikipedia.org/wiki/Zachary%27s_karate_club"}]},{type:"divider"},{title:"Zodiac",id:"zodiac",shortcut:">",submenu:[{title:"Aries",id:"aries",label:"",link:"https://en.wikipedia.org/wiki/Aries_(astrology)"},{title:"Taurus",id:"taurus",label:"",link:"https://en.wikipedia.org/wiki/Taurus_(astrology)"},{title:"Gemini",id:"gemini",label:"",link:"https://en.wikipedia.org/wiki/Gemini_(astrology)"},{title:"Cancer",id:"cancer",label:"",link:"https://en.wikipedia.org/wiki/Cancer_(astrology)"},{title:"Leo",id:"leo",label:"",link:"https://en.wikipedia.org/wiki/Leo_(astrology)"},{title:"Virgo",id:"virgo",label:"",link:"https://en.wikipedia.org/wiki/Virgo_(astrology)"},{title:"Libra",id:"libra",label:"",link:"https://en.wikipedia.org/wiki/Libra_(astrology)"},{title:"Scorpius",id:"scorpius",label:"",link:"https://en.wikipedia.org/wiki/Scorpio_(astrology)"},{title:"Ophiuchus",id:"ophiuchus",label:"",link:"https://en.wikipedia.org/wiki/Ophiuchus_(astrology)"},{title:"Sagittarius",id:"sagittarius",label:"",link:"https://en.wikipedia.org/wiki/Sagittarius_(astrology)"},{title:"Capricornus",id:"capricornus",label:"",link:"https://en.wikipedia.org/wiki/Capricorn_(astrology)"},{title:"Aquarius",id:"aquarius",label:"",link:"https://en.wikipedia.org/wiki/Aquarius_(astrology)"},{title:"Pisces",id:"pisces",label:"",link:"https://en.wikipedia.org/wiki/Pisces_(astrology)"}]}]},{title:"Metrics",id:"metrics",submenu:[{title:"Basic",id:"basic",shortcut:">",submenu:[{title:"Basic Information",id:"basic-info-btn"},{title:"Components",id:"components-btn"},{title:"Lies On Cycle",id:"lies-on-cycle-btn"},{title:"Degree Sequence",id:"list-degrees-btn"},{title:"Density",id:"density-btn"},{title:"Diameter",id:"diameter-btn"}]},{title:"Centrality",id:"centrality",shortcut:">",submenu:[{title:"Betweenness Centrality",id:"betweenness-centrality-btn"},{title:"Closeness Centrality",id:"closeness-centrality-btn"},{title:"Degree Centrality",id:"degree-centrality-btn"},{title:"Eccentricity",id:"eccentricity-btn"},{title:"Eigenvector Centrality",id:"eigenvector-centrality-btn"},{title:"PageRank",id:"pagerank-btn"}]},{title:"Layout Quality",id:"layout-quality",shortcut:">",submenu:[{title:"Edge Uniformity",id:"edge-uniformity-btn"},{title:"Neighborhood Preservation",id:"neighborhood-preservation-btn"},{title:"Stress",id:"stress-btn"}]},{title:"Other",shortcut:">",id:"other",submenu:[{title:"Simmelian Strength",id:"simmelian-strength-btn"},{title:"Disparity",id:"disparity-btn"}]},{type:"divider"},{title:"Neighbors",id:"neighbors-btn"},{title:"Shortest Path",id:"shortest-path-btn"},{title:"Selected Nodes Info",id:"all-node-info-btn",shortcut:"(a)"},{title:"Selected Edges Info",id:"all-edge-info-btn",shortcut:"(Alt+a)"},{title:"Selected Faces Info",id:"all-face-info-btn"},{title:"Selected Graphs Info",id:"all-graph-info-btn"},{type:"divider"},{title:"Clear Panel",id:"clear-info-panel-btn",shortcut:"(q)"}]},{title:"Operators",id:"help",submenu:[{title:"Layout",id:"layout",shortcut:">",submenu:[{title:"Center Nodes",name:"center-layout"},{title:"Organize Nodes",name:"organize-circle",shortcut:"(O)"},{title:"Random",name:"random-layout"},{title:"Vertical Flip",name:"vflip-layout"},{title:"Horizontal Flip",name:"hflip-layout"},{title:"Rotate",name:"rotate-layout",input:[{type:"number",id:"rotate-layout-1",min:-180,max:180,value:45}]},{type:"divider"},{title:"Force Atlas",name:"force-layout",input:[{type:"number",id:"force-itteration",min:0,max:500,value:50},{type:"number",id:"force-gravity",min:0,max:1,value:25}],link:"https://graphology.github.io/standard-library/layout-forceatlas2.html"}]},{title:"Converter",id:"converter",shortcut:">",submenu:[{title:"To Mixed",id:"to-mixed"},{title:"To Undirected",id:"to-undirected"},{title:"To Directed",id:"to-directed"},{title:"To Weighted",id:"to-weighted"},{title:"To Unweighted",id:"to-unweighted"}]},{title:"Reverse Direction",id:"reverse-direction"},{title:"Subgraph",id:"subgraph-btn"},{title:"Complete Graph",name:"complete-btn",shortcut:"(alt-C)"}]},{title:"Help",id:"help",submenu:[{title:"Mouse Commnads",id:"command",name:"command-btn"},{title:"How to use",id:"how-to-use"},{title:"About",id:"about",shortcut:"version: 1.9.5"}]}];var hi={},md;function Db(){if(md)return hi;md=1;var r=je();function e(d){return typeof d=="number"&&!isNaN(d)}var t=["x","y"];function n(d,f){if(!r(d))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.exhaustive!==!1;h||(h=t);var v={},w=h.length;return d.forEachNode(function(_,D){var k=0,N={},O;for(O=0;O<w;O++){var M=h[O],z=D[M];e(z)&&(N[M]=z,k++)}y?k===w&&(v[_]=N):k&&(v[_]=N)}),v}function i(d,f,h){if(!r(d))throw new Error("graphology-layout/utils.assignLayout: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions||t,v=y.length,w;d.updateEachNodeAttributes(function(_,D){var k=f[_];if(!k)return D;for(var N=0;N<v;N++)w=y[N],D[w]=k[w];return D},{attributes:y})}function a(d,f){if(!r(d))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.type||Float64Array;h||(h=t);var v=h.length,w=new y(d.order*v),_=0;return d.forEachNode(function(D,k){var N;for(N=0;N<v;N++){var O=h[N],M=k[O];e(M)||(M=0),w[_++]=M}}),w}function s(d,f,h){if(!r(d))throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions;y||(y=t);var v=y.length;if(f.length!==d.order*v)throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: given layout has an incorrect length wrt number of nodes & dimenions.");var w=0;d.updateEachNodeAttributes(function(_,D){for(var k=0;k<v;k++)D[y[k]]=f[w++];return D},{attributes:y})}return hi.collectLayout=n,hi.assignLayout=i,hi.collectLayoutAsFlatArray=a,hi.assignLayoutAsFlatArray=s,hi}var Rn=Db();let fi=null;const _u=[];let Xa=!1;const Su=new Map,Ib=5e3;function Mb(r,e,t,n={}){const i=e.export(),a=JSON.stringify({type:r,graph:i,payload:n});if(Su.has(a)){t(Su.get(a));return}_u.push({type:r,graph:i,payload:n,callback:t,key:a}),Au()}function Au(){if(Xa||_u.length===0)return;const r=_u.shift(),{type:e,graph:t,payload:n,callback:i,key:a}=r;Xa=!0,fi||(fi=new Worker(new URL("/assets/graph-algorithms.worker-Dgh77PcG.js",import.meta.url),{type:"module"}));const s=setTimeout(()=>{console.warn(`[${e}] timed out. Restarting worker...`),fi.terminate(),fi=null,Xa=!1,Au()},Ib);fi.onmessage=({data:d})=>{clearTimeout(s),Xa=!1,d.error?console.error(`[Worker Error] ${e}:`,d.error):(Su.set(a,d.result),i(d.result)),Au()},fi.postMessage({type:e,graph:t,payload:n})}var pi={},Xs,bd;function Pb(){if(bd)return Xs;bd=1;function r(t){return function(n,i){return n+Math.floor(t()*(i-n+1))}}var e=r(Math.random);return e.createRandom=r,Xs=e,Xs}var Vs,wd;function Nb(){if(wd)return Vs;wd=1;var r=Pb().createRandom;function e(n){var i=r(n);return function(a){for(var s=a.length,d=s-1,f=-1;++f<s;){var h=i(f,d),y=a[h];a[h]=a[f],a[f]=y}}}var t=e(Math.random);return t.createShuffleInPlace=e,Vs=t,Vs}var Qs,Ed;function Ob(){if(Ed)return Qs;Ed=1;var r=an(),e=je(),t=Nb(),n={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function i(S,G,q,F,W){this.wrappedCircle=W||null,this.children={},this.countChildren=0,this.id=S||null,this.next=null,this.previous=null,this.x=G||null,this.y=q||null,W?this.r=1010101:this.r=F||999}i.prototype.hasChildren=function(){return this.countChildren>0},i.prototype.addChild=function(S,G){this.children[S]=G,++this.countChildren},i.prototype.getChild=function(S){if(!this.children.hasOwnProperty(S)){var G=new i;this.children[S]=G,++this.countChildren}return this.children[S]},i.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var S=this;for(var G in S.children){var q=S.children[G];q.x+=S.x,q.y+=S.y,q.applyPositionToChildren()}}};function a(S,G,q){for(var F in G.children){var W=G.children[F];W.hasChildren()?a(S,W,q):q[W.id]={x:W.x,y:W.y}}}function s(S,G){var q=S.r-G.r,F=G.x-S.x,W=G.y-S.y;return q<0||q*q<F*F+W*W}function d(S,G){var q=S.r-G.r+1e-6,F=G.x-S.x,W=G.y-S.y;return q>0&&q*q>F*F+W*W}function f(S,G){for(var q=0;q<G.length;++q)if(!d(S,G[q]))return!1;return!0}function h(S){return new i(null,S.x,S.y,S.r)}function y(S,G){var q=S.x,F=S.y,W=S.r,Z=G.x,j=G.y,ve=G.r,ge=Z-q,X=j-F,P=ve-W,ee=Math.sqrt(ge*ge+X*X);return new i(null,(q+Z+ge/ee*P)/2,(F+j+X/ee*P)/2,(ee+W+ve)/2)}function v(S,G,q){var F=S.x,W=S.y,Z=S.r,j=G.x,ve=G.y,ge=G.r,X=q.x,P=q.y,ee=q.r,ne=F-j,le=F-X,oe=W-ve,he=W-P,ue=ge-Z,me=ee-Z,_e=F*F+W*W-Z*Z,Me=_e-j*j-ve*ve+ge*ge,Oe=_e-X*X-P*P+ee*ee,qe=le*oe-ne*he,ce=(oe*Oe-he*Me)/(qe*2)-F,Pe=(he*ue-oe*me)/qe,Re=(le*Me-ne*Oe)/(qe*2)-W,ke=(ne*me-le*ue)/qe,Ke=Pe*Pe+ke*ke-1,Le=2*(Z+ce*Pe+Re*ke),Ee=ce*ce+Re*Re-Z*Z,fe=-(Ke?(Le+Math.sqrt(Le*Le-4*Ke*Ee))/(2*Ke):Ee/Le);return new i(null,F+ce+Pe*fe,W+Re+ke*fe,fe)}function w(S){switch(S.length){case 1:return h(S[0]);case 2:return y(S[0],S[1]);case 3:return v(S[0],S[1],S[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+S.length)}}function _(S,G){var q,F;if(f(G,S))return[G];for(q=0;q<S.length;++q)if(s(G,S[q])&&f(y(S[q],G),S))return[S[q],G];for(q=0;q<S.length-1;++q)for(F=q+1;F<S.length;++F)if(s(y(S[q],S[F]),G)&&s(y(S[q],G),S[F])&&s(y(S[F],G),S[q])&&f(v(S[q],S[F],G),S))return[S[q],S[F],G];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function D(S){var G=S.wrappedCircle,q=S.next.wrappedCircle,F=G.r+q.r,W=(G.x*q.r+q.x*G.r)/F,Z=(G.y*q.r+q.y*G.r)/F;return W*W+Z*Z}function k(S,G){var q=0,F=S.slice(),W=S.length,Z=[],j,ve;for(G(F);q<W;)j=F[q],ve&&d(ve,j)?++q:(Z=_(Z,j),ve=w(Z),q=0);return ve}function N(S,G,q){var F=S.x-G.x,W,Z,j=S.y-G.y,ve,ge,X=F*F+j*j;X?(Z=G.r+q.r,Z*=Z,ge=S.r+q.r,ge*=ge,Z>ge?(W=(X+ge-Z)/(2*X),ve=Math.sqrt(Math.max(0,ge/X-W*W)),q.x=S.x-W*F-ve*j,q.y=S.y-W*j+ve*F):(W=(X+Z-ge)/(2*X),ve=Math.sqrt(Math.max(0,Z/X-W*W)),q.x=G.x+W*F-ve*j,q.y=G.y+W*j+ve*F)):(q.x=G.x+q.r,q.y=G.y)}function O(S,G){var q=S.r+G.r-1e-6,F=G.x-S.x,W=G.y-S.y;return q>0&&q*q>F*F+W*W}function M(S,G){var q=S.length;if(q===0)return 0;var F,W,Z,j,ve,ge,X,P,ee,ne;if(F=S[0],F.x=0,F.y=0,q<=1)return F.r;if(W=S[1],F.x=-W.r,W.x=F.r,W.y=0,q<=2)return F.r+W.r;Z=S[2],N(W,F,Z),F=new i(null,null,null,null,F),W=new i(null,null,null,null,W),Z=new i(null,null,null,null,Z),F.next=Z.previous=W,W.next=F.previous=Z,Z.next=W.previous=F;e:for(ge=3;ge<q;++ge){Z=S[ge],N(F.wrappedCircle,W.wrappedCircle,Z),Z=new i(null,null,null,null,Z),X=W.next,P=F.previous,ee=W.wrappedCircle.r,ne=F.wrappedCircle.r;do if(ee<=ne){if(O(X.wrappedCircle,Z.wrappedCircle)){W=X,F.next=W,W.previous=F,--ge;continue e}ee+=X.wrappedCircle.r,X=X.next}else{if(O(P.wrappedCircle,Z.wrappedCircle)){F=P,F.next=W,W.previous=F,--ge;continue e}ne+=P.wrappedCircle.r,P=P.previous}while(X!==P.next);for(Z.previous=F,Z.next=W,F.next=W.previous=W=Z,j=D(F);(Z=Z.next)!==W;)(ve=D(Z))<j&&(F=Z,j=ve);W=F.next}F=[W.wrappedCircle],Z=W;for(var le=1e4;(Z=Z.next)!==W&&--le!==0;)F.push(Z.wrappedCircle);for(Z=k(F,G),ge=0;ge<q;++ge)F=S[ge],F.x-=Z.x,F.y-=Z.y;return Z.r}function z(S,G){var q=0;if(S.hasChildren()){for(var F in S.children){var W=S.children[F];W.hasChildren()&&(W.r=z(W,G))}q=M(Object.values(S.children),G)}return q}function A(S,G){z(S,G);for(var q in S.children){var F=S.children[q];F.applyPositionToChildren()}}function T(S,G,q){if(!e(G))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");q=r(q,n);var F={},W={},Z=G.nodes(),j=q.center,ve=q.hierarchyAttributes,ge=t.createShuffleInPlace(q.rng),X=q.scale,P=new i;G.forEachNode(function(ue,me){var _e=me.size?me.size:1,Me=new i(ue,null,null,_e),Oe=P;ve.forEach(function(qe){var ce=me[qe];Oe=Oe.getChild(ce)}),Oe.addChild(ue,Me)}),A(P,ge),a(G,P,F);var ee=Z.length,ne,le,oe;for(oe=0;oe<ee;oe++){var he=Z[oe];ne=j+X*F[he].x,le=j+X*F[he].y,W[he]={x:ne,y:le},S&&(G.setNodeAttribute(he,q.attributes.x,ne),G.setNodeAttribute(he,q.attributes.y,le))}return W}var K=T.bind(null,!1);return K.assign=T.bind(null,!0),Qs=K,Qs}var Zs,xd;function Tb(){if(xd)return Zs;xd=1;var r=an(),e=je(),t={dimensions:["x","y"],center:.5,scale:1};function n(a,s,d){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");d=r(d,t);var f=d.dimensions;if(!Array.isArray(f)||f.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=d.center,y=d.scale,v=Math.PI*2,w=(h-.5)*y,_=s.order,D=f[0],k=f[1];function N(z,A){return A[D]=y*Math.cos(z*v/_)+w,A[k]=y*Math.sin(z*v/_)+w,A}var O=0;if(!a){var M={};return s.forEachNode(function(z){M[z]=N(O++,{})}),M}s.updateEachNodeAttributes(function(z,A){return N(O++,A),A},{attributes:f})}var i=n.bind(null,!1);return i.assign=n.bind(null,!0),Zs=i,Zs}var Js,_d;function Rb(){if(_d)return Js;_d=1;var r=an(),e=je(),t={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function n(a,s,d){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");d=r(d,t);var f=d.dimensions;if(!Array.isArray(f)||f.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=f.length,y=d.center,v=d.rng,w=d.scale,_=(y-.5)*w;function D(N){for(var O=0;O<h;O++)N[f[O]]=v()*w+_;return N}if(!a){var k={};return s.forEachNode(function(N){k[N]=D({})}),k}s.updateEachNodeAttributes(function(N,O){return D(O),O},{attributes:f})}var i=n.bind(null,!1);return i.assign=n.bind(null,!0),Js=i,Js}var eu,Sd;function Lb(){if(Sd)return eu;Sd=1;var r=an(),e=je(),t=Math.PI/180,n={dimensions:["x","y"],centeredOnZero:!1,degrees:!1};function i(s,d,f,h){if(!e(d))throw new Error("graphology-layout/rotation: the given graph is not a valid graphology instance.");h=r(h,n),h.degrees&&(f*=t);var y=h.dimensions;if(!Array.isArray(y)||y.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");if(d.order===0)return s?void 0:{};var v=y[0],w=y[1],_=0,D=0;if(!h.centeredOnZero){var k=1/0,N=-1/0,O=1/0,M=-1/0;d.forEachNode(function(S,G){var q=G[v],F=G[w];q<k&&(k=q),q>N&&(N=q),F<O&&(O=F),F>M&&(M=F)}),_=(k+N)/2,D=(O+M)/2}var z=Math.cos(f),A=Math.sin(f);function T(S){var G=S[v],q=S[w];return S[v]=_+(G-_)*z-(q-D)*A,S[w]=D+(G-_)*A+(q-D)*z,S}if(!s){var K={};return d.forEachNode(function(S,G){var q={};q[v]=G[v],q[w]=G[w],K[S]=T(q)}),K}d.updateEachNodeAttributes(function(S,G){return T(G),G},{attributes:y})}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),eu=a,eu}var Ad;function zb(){return Ad||(Ad=1,pi.circlepack=Ob(),pi.circular=Tb(),pi.random=Rb(),pi.rotation=Lb()),pi}var tu,kd;function $b(){return kd||(kd=1,tu=zb()),tu}var nu=$b(),ru,Cd;function Gb(){if(Cd)return ru;Cd=1;var r=0,e=1,t=2,n=3,i=4,a=5,s=6,d=7,f=8,h=9,y=0,v=1,w=2,_=0,D=1,k=2,N=3,O=4,M=5,z=6,A=7,T=8,K=3,S=10,G=3,q=9,F=10;return ru=function(Z,j,ve){var ge,X,P,ee,ne,le,oe,he,ue,me,_e=j.length,Me=ve.length,Oe=Z.adjustSizes,qe=Z.barnesHutTheta*Z.barnesHutTheta,ce,Pe,Re,ke,Ke,Le,Ee,fe=[];for(P=0;P<_e;P+=S)j[P+i]=j[P+t],j[P+a]=j[P+n],j[P+t]=0,j[P+n]=0;if(Z.outboundAttractionDistribution){for(ce=0,P=0;P<_e;P+=S)ce+=j[P+s];ce/=_e/S}if(Z.barnesHutOptimize){var vt=1/0,it=-1/0,Et=1/0,at=-1/0,Ve,ht,ot;for(P=0;P<_e;P+=S)vt=Math.min(vt,j[P+r]),it=Math.max(it,j[P+r]),Et=Math.min(Et,j[P+e]),at=Math.max(at,j[P+e]);var gt=it-vt,xt=at-Et;for(gt>xt?(Et-=(gt-xt)/2,at=Et+gt):(vt-=(xt-gt)/2,it=vt+xt),fe[0+_]=-1,fe[0+D]=(vt+it)/2,fe[0+k]=(Et+at)/2,fe[0+N]=Math.max(it-vt,at-Et),fe[0+O]=-1,fe[0+M]=-1,fe[0+z]=0,fe[0+A]=0,fe[0+T]=0,ge=1,P=0;P<_e;P+=S)for(X=0,ot=K;;)if(fe[X+M]>=0){j[P+r]<fe[X+D]?j[P+e]<fe[X+k]?Ve=fe[X+M]:Ve=fe[X+M]+q:j[P+e]<fe[X+k]?Ve=fe[X+M]+q*2:Ve=fe[X+M]+q*3,fe[X+A]=(fe[X+A]*fe[X+z]+j[P+r]*j[P+s])/(fe[X+z]+j[P+s]),fe[X+T]=(fe[X+T]*fe[X+z]+j[P+e]*j[P+s])/(fe[X+z]+j[P+s]),fe[X+z]+=j[P+s],X=Ve;continue}else if(fe[X+_]<0){fe[X+_]=P;break}else{if(fe[X+M]=ge*q,he=fe[X+N]/2,ue=fe[X+M],fe[ue+_]=-1,fe[ue+D]=fe[X+D]-he,fe[ue+k]=fe[X+k]-he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+M]=-1,fe[ue+z]=0,fe[ue+A]=0,fe[ue+T]=0,ue+=q,fe[ue+_]=-1,fe[ue+D]=fe[X+D]-he,fe[ue+k]=fe[X+k]+he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+M]=-1,fe[ue+z]=0,fe[ue+A]=0,fe[ue+T]=0,ue+=q,fe[ue+_]=-1,fe[ue+D]=fe[X+D]+he,fe[ue+k]=fe[X+k]-he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+M]=-1,fe[ue+z]=0,fe[ue+A]=0,fe[ue+T]=0,ue+=q,fe[ue+_]=-1,fe[ue+D]=fe[X+D]+he,fe[ue+k]=fe[X+k]+he,fe[ue+N]=he,fe[ue+O]=fe[X+O],fe[ue+M]=-1,fe[ue+z]=0,fe[ue+A]=0,fe[ue+T]=0,ge+=4,j[fe[X+_]+r]<fe[X+D]?j[fe[X+_]+e]<fe[X+k]?Ve=fe[X+M]:Ve=fe[X+M]+q:j[fe[X+_]+e]<fe[X+k]?Ve=fe[X+M]+q*2:Ve=fe[X+M]+q*3,fe[X+z]=j[fe[X+_]+s],fe[X+A]=j[fe[X+_]+r],fe[X+T]=j[fe[X+_]+e],fe[Ve+_]=fe[X+_],fe[X+_]=-1,j[P+r]<fe[X+D]?j[P+e]<fe[X+k]?ht=fe[X+M]:ht=fe[X+M]+q:j[P+e]<fe[X+k]?ht=fe[X+M]+q*2:ht=fe[X+M]+q*3,Ve===ht)if(ot--){X=Ve;continue}else{ot=K;break}fe[ht+_]=P;break}}if(Z.barnesHutOptimize)for(Pe=Z.scalingRatio,P=0;P<_e;P+=S)for(X=0;;)if(fe[X+M]>=0)if(Le=Math.pow(j[P+r]-fe[X+A],2)+Math.pow(j[P+e]-fe[X+T],2),me=fe[X+N],4*me*me/Le<qe){if(Re=j[P+r]-fe[X+A],ke=j[P+e]-fe[X+T],Oe===!0?Le>0?(Ee=Pe*j[P+s]*fe[X+z]/Le,j[P+t]+=Re*Ee,j[P+n]+=ke*Ee):Le<0&&(Ee=-Pe*j[P+s]*fe[X+z]/Math.sqrt(Le),j[P+t]+=Re*Ee,j[P+n]+=ke*Ee):Le>0&&(Ee=Pe*j[P+s]*fe[X+z]/Le,j[P+t]+=Re*Ee,j[P+n]+=ke*Ee),X=fe[X+O],X<0)break;continue}else{X=fe[X+M];continue}else{if(le=fe[X+_],le>=0&&le!==P&&(Re=j[P+r]-j[le+r],ke=j[P+e]-j[le+e],Le=Re*Re+ke*ke,Oe===!0?Le>0?(Ee=Pe*j[P+s]*j[le+s]/Le,j[P+t]+=Re*Ee,j[P+n]+=ke*Ee):Le<0&&(Ee=-Pe*j[P+s]*j[le+s]/Math.sqrt(Le),j[P+t]+=Re*Ee,j[P+n]+=ke*Ee):Le>0&&(Ee=Pe*j[P+s]*j[le+s]/Le,j[P+t]+=Re*Ee,j[P+n]+=ke*Ee)),X=fe[X+O],X<0)break;continue}else for(Pe=Z.scalingRatio,ee=0;ee<_e;ee+=S)for(ne=0;ne<ee;ne+=S)Re=j[ee+r]-j[ne+r],ke=j[ee+e]-j[ne+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-j[ee+f]-j[ne+f],Le>0?(Ee=Pe*j[ee+s]*j[ne+s]/Le/Le,j[ee+t]+=Re*Ee,j[ee+n]+=ke*Ee,j[ne+t]-=Re*Ee,j[ne+n]-=ke*Ee):Le<0&&(Ee=100*Pe*j[ee+s]*j[ne+s],j[ee+t]+=Re*Ee,j[ee+n]+=ke*Ee,j[ne+t]-=Re*Ee,j[ne+n]-=ke*Ee)):(Le=Math.sqrt(Re*Re+ke*ke),Le>0&&(Ee=Pe*j[ee+s]*j[ne+s]/Le/Le,j[ee+t]+=Re*Ee,j[ee+n]+=ke*Ee,j[ne+t]-=Re*Ee,j[ne+n]-=ke*Ee));for(ue=Z.gravity/Z.scalingRatio,Pe=Z.scalingRatio,P=0;P<_e;P+=S)Ee=0,Re=j[P+r],ke=j[P+e],Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),Z.strongGravityMode?Le>0&&(Ee=Pe*j[P+s]*ue):Le>0&&(Ee=Pe*j[P+s]*ue/Le),j[P+t]-=Re*Ee,j[P+n]-=ke*Ee;for(Pe=1*(Z.outboundAttractionDistribution?ce:1),oe=0;oe<Me;oe+=G)ee=ve[oe+y],ne=ve[oe+v],he=ve[oe+w],Ke=Math.pow(he,Z.edgeWeightInfluence),Re=j[ee+r]-j[ne+r],ke=j[ee+e]-j[ne+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-j[ee+f]-j[ne+f],Z.linLogMode?Z.outboundAttractionDistribution?Le>0&&(Ee=-Pe*Ke*Math.log(1+Le)/Le/j[ee+s]):Le>0&&(Ee=-Pe*Ke*Math.log(1+Le)/Le):Z.outboundAttractionDistribution?Le>0&&(Ee=-Pe*Ke/j[ee+s]):Le>0&&(Ee=-Pe*Ke)):(Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),Z.linLogMode?Z.outboundAttractionDistribution?Le>0&&(Ee=-Pe*Ke*Math.log(1+Le)/Le/j[ee+s]):Le>0&&(Ee=-Pe*Ke*Math.log(1+Le)/Le):Z.outboundAttractionDistribution?(Le=1,Ee=-Pe*Ke/j[ee+s]):(Le=1,Ee=-Pe*Ke)),Le>0&&(j[ee+t]+=Re*Ee,j[ee+n]+=ke*Ee,j[ne+t]-=Re*Ee,j[ne+n]-=ke*Ee);var st,ut,ft,nt,_t,mt;if(Oe===!0)for(P=0;P<_e;P+=S)j[P+h]!==1&&(st=Math.sqrt(Math.pow(j[P+t],2)+Math.pow(j[P+n],2)),st>F&&(j[P+t]=j[P+t]*F/st,j[P+n]=j[P+n]*F/st),ut=j[P+s]*Math.sqrt((j[P+i]-j[P+t])*(j[P+i]-j[P+t])+(j[P+a]-j[P+n])*(j[P+a]-j[P+n])),ft=Math.sqrt((j[P+i]+j[P+t])*(j[P+i]+j[P+t])+(j[P+a]+j[P+n])*(j[P+a]+j[P+n]))/2,nt=.1*Math.log(1+ft)/(1+Math.sqrt(ut)),_t=j[P+r]+j[P+t]*(nt/Z.slowDown),j[P+r]=_t,mt=j[P+e]+j[P+n]*(nt/Z.slowDown),j[P+e]=mt);else for(P=0;P<_e;P+=S)j[P+h]!==1&&(ut=j[P+s]*Math.sqrt((j[P+i]-j[P+t])*(j[P+i]-j[P+t])+(j[P+a]-j[P+n])*(j[P+a]-j[P+n])),ft=Math.sqrt((j[P+i]+j[P+t])*(j[P+i]+j[P+t])+(j[P+a]+j[P+n])*(j[P+a]+j[P+n]))/2,nt=j[P+d]*Math.log(1+ft)/(1+Math.sqrt(ut)),j[P+d]=Math.min(1,Math.sqrt(nt*(Math.pow(j[P+t],2)+Math.pow(j[P+n],2))/(1+Math.sqrt(ut)))),_t=j[P+r]+j[P+t]*(nt/Z.slowDown),j[P+r]=_t,mt=j[P+e]+j[P+n]*(nt/Z.slowDown),j[P+e]=mt);return{}},ru}var Kn={},Dd;function qb(){if(Dd)return Kn;Dd=1;var r=10,e=3;return Kn.assign=function(t){t=t||{};var n=Array.prototype.slice.call(arguments).slice(1),i,a,s;for(i=0,s=n.length;i<s;i++)if(n[i])for(a in n[i])t[a]=n[i][a];return t},Kn.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Kn.graphToByteArrays=function(t,n){var i=t.order,a=t.size,s={},d,f=new Float32Array(i*r),h=new Float32Array(a*e);return d=0,t.forEachNode(function(y,v){s[y]=d,f[d]=v.x,f[d+1]=v.y,f[d+2]=0,f[d+3]=0,f[d+4]=0,f[d+5]=0,f[d+6]=1,f[d+7]=1,f[d+8]=v.size||1,f[d+9]=v.fixed?1:0,d+=r}),d=0,t.forEachEdge(function(y,v,w,_,D,k,N){var O=s[w],M=s[_],z=n(y,v,w,_,D,k,N);f[O+6]+=z,f[M+6]+=z,h[d]=O,h[d+1]=M,h[d+2]=z,d+=e}),{nodes:f,edges:h}},Kn.assignLayoutChanges=function(t,n,i){var a=0;t.updateEachNodeAttributes(function(s,d){return d.x=n[a],d.y=n[a+1],a+=r,i?i(s,d):d})},Kn.readGraphPositions=function(t,n){var i=0;t.forEachNode(function(a,s){n[i]=s.x,n[i+1]=s.y,i+=r})},Kn.collectLayoutChanges=function(t,n,i){for(var a=t.nodes(),s={},d=0,f=0,h=n.length;d<h;d+=r){if(i){var y=Object.assign({},t.getNodeAttributes(a[f]));y.x=n[d],y.y=n[d+1],y=i(a[f],y),s[a[f]]={x:y.x,y:y.y}}else s[a[f]]={x:n[d],y:n[d+1]};f++}return s},Kn.createWorker=function(n){var i=window.URL||window.webkitURL,a=n.toString(),s=i.createObjectURL(new Blob(["("+a+").call(this);"],{type:"text/javascript"})),d=new Worker(s);return i.revokeObjectURL(s),d},Kn}var iu,Id;function Fb(){return Id||(Id=1,iu={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),iu}var au,Md;function jb(){if(Md)return au;Md=1;var r=je(),e=Fr().createEdgeWeightGetter,t=Gb(),n=qb(),i=Fb();function a(f,h,y){if(!r(h))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof y=="number"&&(y={iterations:y});var v=y.iterations;if(typeof v!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(v<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var w=e("getEdgeWeight"in y?y.getEdgeWeight:"weight").fromEntry,_=typeof y.outputReducer=="function"?y.outputReducer:null,D=n.assign({},i,y.settings),k=n.validateSettings(D);if(k)throw new Error("graphology-layout-forceatlas2: "+k.message);var N=n.graphToByteArrays(h,w),O;for(O=0;O<v;O++)t(D,N.nodes,N.edges);if(f){n.assignLayoutChanges(h,N.nodes,_);return}return n.collectLayoutChanges(h,N.nodes)}function s(f){var h=typeof f=="number"?f:f.order;return{barnesHutOptimize:h>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(h)}}var d=a.bind(null,!1);return d.assign=a.bind(null,!0),d.inferSettings=s,au=d,au}var Bb=jb();const Ub=Mt(Bb);var ou,Pd;function Kb(){if(Pd)return ou;Pd=1;var r=0,e=1,t=2,n=3;function i(s,d){return s+""+d}function a(){return .01*(.5-Math.random())}return ou=function(d,f){var h=d.margin,y=d.ratio,v=d.expansion,w=d.gridSize,_=d.speed,D,k,N,O,M,z,A=!0,T=f.length,K=T/n|0,S=new Float32Array(K),G=new Float32Array(K),q=1/0,F=1/0,W=-1/0,Z=-1/0;for(D=0;D<T;D+=n)N=f[D+r],O=f[D+e],z=f[D+t]*y+h,q=Math.min(q,N-z),W=Math.max(W,N+z),F=Math.min(F,O-z),Z=Math.max(Z,O+z);var j=W-q,ve=Z-F,ge=(q+W)/2,X=(F+Z)/2;q=ge-v*j/2,W=ge+v*j/2,F=X-v*ve/2,Z=X+v*ve/2;var P=new Array(w*w),ee=P.length,ne;for(ne=0;ne<ee;ne++)P[ne]=[];var le,oe,he,ue,me,_e,Me,Oe,qe,ce;for(D=0;D<T;D+=n)for(N=f[D+r],O=f[D+e],z=f[D+t]*y+h,le=N-z,oe=N+z,he=O-z,ue=O+z,me=Math.floor(w*(le-q)/(W-q)),_e=Math.floor(w*(oe-q)/(W-q)),Me=Math.floor(w*(he-F)/(Z-F)),Oe=Math.floor(w*(ue-F)/(Z-F)),qe=me;qe<=_e;qe++)for(ce=Me;ce<=Oe;ce++)P[qe*w+ce].push(D);var Pe,Re=new Set,ke,Ke,Le,Ee,fe,vt,it,Et,at,Ve,ht,ot,gt;for(ne=0;ne<ee;ne++)for(Pe=P[ne],D=0,M=Pe.length;D<M;D++)for(ke=Pe[D],Le=f[ke+r],fe=f[ke+e],it=f[ke+t],k=D+1;k<M;k++)Ke=Pe[k],at=i(ke,Ke),!(ee>1&&Re.has(at))&&(ee>1&&Re.add(at),Ee=f[Ke+r],vt=f[Ke+e],Et=f[Ke+t],Ve=Ee-Le,ht=vt-fe,ot=Math.sqrt(Ve*Ve+ht*ht),gt=ot<it*y+h+(Et*y+h),gt&&(A=!1,Ke=Ke/n|0,ot>0?(S[Ke]+=Ve/ot*(1+it),G[Ke]+=ht/ot*(1+it)):(S[Ke]+=j*a(),G[Ke]+=ve*a())));for(D=0,k=0;D<T;D+=n,k++)f[D+r]+=S[k]*.1*_,f[D+e]+=G[k]*.1*_;return{converged:A}},ou}var Tr={},Nd;function Wb(){if(Nd)return Tr;Nd=1;var r=3;return Tr.validateSettings=function(e){return"gridSize"in e&&typeof e.gridSize!="number"||e.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in e&&typeof e.margin!="number"||e.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in e&&typeof e.expansion!="number"||e.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in e&&typeof e.ratio!="number"||e.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in e&&typeof e.speed!="number"||e.speed<=0?{message:"the `speed` setting should be a positive number."}:null},Tr.graphToByteArray=function(e,t){var n=e.order,i=new Float32Array(n*r),a=0;return e.forEachNode(function(s,d){typeof t=="function"&&(d=t(s,d)),i[a]=d.x,i[a+1]=d.y,i[a+2]=d.size||1,a+=r}),i},Tr.assignLayoutChanges=function(e,t,n){var i=0;e.forEachNode(function(a){var s={x:t[i],y:t[i+1]};typeof n=="function"&&(s=n(a,s)),e.mergeNodeAttributes(a,s),i+=r})},Tr.collectLayoutChanges=function(e,t,n){var i={},a=0;return e.forEachNode(function(s){var d={x:t[a],y:t[a+1]};typeof n=="function"&&(d=n(s,d)),i[s]=d,a+=r}),i},Tr.createWorker=function(t){var n=window.URL||window.webkitURL,i=t.toString(),a=n.createObjectURL(new Blob(["("+i+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return n.revokeObjectURL(a),s},Tr}var su,Od;function Hb(){return Od||(Od=1,su={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3}),su}var uu,Td;function Yb(){if(Td)return uu;Td=1;var r=je(),e=Kb(),t=Wb(),n=Hb(),i=500;function a(d,f,h){if(!r(f))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof h=="number"?h={maxIterations:h}:h=h||{};var y=h.maxIterations||i;if(typeof y!="number"||y<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var v=Object.assign({},n,h.settings),w=t.validateSettings(v);if(w)throw new Error("graphology-layout-noverlap: "+w.message);var _=t.graphToByteArray(f,h.inputReducer),D=!1,k;for(k=0;k<y&&!D;k++)D=e(v,_).converged;if(d){t.assignLayoutChanges(f,_,h.outputReducer);return}return t.collectLayoutChanges(f,_,h.outputReducer)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),uu=s,uu}var Xb=Yb();const Vb=Mt(Xb);class Qb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.canvas=e.canvas}init(){}applyLayout(e,t){let n=!0;switch(e){case"force":this.force(t.itteration,t.gravity);break;case"noverlap":this.noverlap();break;case"rotate180":this.rotate180();break;case"rotate":this.rotate(t);break;case"h-flip":this.hFlip();break;case"v-flip":this.vFlip();break;case"center":this.center();break;case"random":this.random();break;case"circle":this.organizeNodesInCircle();break;case"oneLine":this.organizeNodesInLine();break;case"twoLine":this.organizeNodesInTwoLines(t.line1Count,t.Y);break;default:n=!1;break}n&&this.app.graphManager.saveGraphState()}noverlap(){const e=this.app.graphManager.graph,t=Vb(e,{maxIterations:50,settings:{ratio:100,expansion:1.5,gridSize:5}});this.center(t)}force(e=50,t=25){const n=this.app.graphManager.graph;if(n.order<250){const i=Ub(n,{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}});this.center(i)}else Mb("force",n,i=>{this.center(i)},{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}})}hFlip(){const e=this.canvas.width/2,t=this.app.graphManager.graph,n=Rn.collectLayout(t);Object.values(n).forEach(i=>{const a=e-i.x;i.x+=2*a}),Rn.assignLayout(t,n)}vFlip(){const e=this.canvas.height/2,t=this.app.graphManager.graph,n=Rn.collectLayout(t);Object.values(n).forEach(i=>{const a=e-i.y;i.y+=2*a}),Rn.assignLayout(t,n)}rotate(e=90){const t=this.app.graphManager.graph,n=e*Math.PI/-180,i=nu.rotation(t,n);this.center(i)}center(e=void 0){const t=this.canvas.width/2,n=this.canvas.height/2,i=this.app.graphManager.graph;e||(e=Rn.collectLayout(i));const a={x:eo(Object.values(e),f=>f.x),y:eo(Object.values(e),f=>f.y)},s=t-a.x,d=n-a.y;Object.values(e).forEach(f=>{f.x+=s,f.y+=d}),Rn.assignLayout(i,e)}random(){const e=this.canvas.width/2,t=this.canvas.height/2,n=this.app.graphManager.graph,i=nu.random(n,{scale:Math.max(e,t)-200});this.center(i)}organizeNodesInCircle(){const e=this.canvas.width/2,t=this.canvas.height/2,n=this.app.graphManager.graph,i=Math.min(e*.5,t*.5),a=nu.circular(n,{scale:i,dimensions:["x","y"]});Object.values(a).forEach(s=>{s.x+=e,s.y+=t}),Rn.assignLayout(n,a)}organizeNodesInLine(){const e=this.canvas.width/2,t=this.canvas.height/2,n=e*.1,i=this.app.graphManager.graph,a=this.app.graphManager.graph.nodes(),s={};if(i.order===0)return;const d=(this.canvas.width-2*n)/Math.max(1,i.order-1);a.forEach((f,h)=>{s[f]={x:n+h*d,y:t}}),Rn.assignLayout(i,s)}organizeNodesInTwoLines(e,t=50){const n=this.canvas.width/2,i=this.canvas.height/2,a=n*.1,s=t,d=this.app.graphManager.graph,f=this.app.graphManager.graph.nodes(),h={};if(d.order===0)return;if(e>d.order){console.error("Line1 count exceeds total nodes.");return}const y=f.slice(0,e),v=f.slice(e),w=y.length,_=v.length,D=w>1?(this.canvas.width-2*a)/(w-1):0,k=_>1?(this.canvas.width-2*a)/(_-1):0,N=i-s,O=i+s;y.forEach((M,z)=>{h[M]={x:a+z*D,y:N}}),v.forEach((M,z)=>{h[M]={x:a+z*k,y:O}}),Rn.assignLayout(d,h)}rotate180(){const e=this.canvas.width,t=this.canvas.height,n=e*.15,i=this.app.graphManager.graph,a=i.nodes(),s={};if(i.order===0)return;let d=1/0,f=1/0,h=-1/0,y=-1/0;a.forEach(M=>{const{x:z,y:A}=i.getNodeAttributes(M);z<d&&(d=z),A<f&&(f=A),z>h&&(h=z),A>y&&(y=A)});const v=h-d,w=y-f,_=(e-2*n)/v,D=(t-2*n)/w,k=Math.min(_,D),N=(e-v*k)/2,O=(t-w*k)/2;i.forEachNode((M,z)=>{const A=e-((z.x-d)*k+N),T=t-((z.y-f)*k+O);s[M]={x:A,y:T}}),Rn.assignLayout(i,s)}}var Ji={exports:{}},Zb=Ji.exports,Rd;function Jb(){return Rd||(Rd=1,function(r,e){(function(t,n){r.exports=n()})(Zb,function(){function t(l,c){var p=Object.keys(l);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(l);c&&(m=m.filter(function(E){return Object.getOwnPropertyDescriptor(l,E).enumerable})),p.push.apply(p,m)}return p}function n(l){for(var c=1;c<arguments.length;c++){var p=arguments[c]!=null?arguments[c]:{};c%2?t(Object(p),!0).forEach(function(m){f(l,m,p[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(p)):t(Object(p)).forEach(function(m){Object.defineProperty(l,m,Object.getOwnPropertyDescriptor(p,m))})}return l}function i(l){return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},i(l)}function a(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function s(l,c){for(var p=0;p<c.length;p++){var m=c[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(l,k(m.key),m)}}function d(l,c,p){return c&&s(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),l}function f(l,c,p){return(c=k(c))in l?Object.defineProperty(l,c,{value:p,enumerable:!0,configurable:!0,writable:!0}):l[c]=p,l}function h(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),c&&v(l,c)}function y(l){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(c){return c.__proto__||Object.getPrototypeOf(c)},y(l)}function v(l,c){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(p,m){return p.__proto__=m,p},v(l,c)}function w(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function _(l){var c=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var p,m=y(l);if(c){var E=y(this).constructor;p=Reflect.construct(m,arguments,E)}else p=m.apply(this,arguments);return function(I,R){if(R&&(typeof R=="object"||typeof R=="function"))return R;if(R!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w(I)}(this,p)}}function D(){return D=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(l,c,p){var m=function(I,R){for(;!Object.prototype.hasOwnProperty.call(I,R)&&(I=y(I))!==null;);return I}(l,c);if(m){var E=Object.getOwnPropertyDescriptor(m,c);return E.get?E.get.call(arguments.length<3?l:p):E.value}},D.apply(this,arguments)}function k(l){var c=function(p,m){if(typeof p!="object"||p===null)return p;var E=p[Symbol.toPrimitive];if(E!==void 0){var I=E.call(p,m);if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}(l,"string");return typeof c=="symbol"?c:c+""}var N=function(l){return!(!l||!l.Window)&&l instanceof l.Window},O=void 0,M=void 0;function z(l){O=l;var c=l.document.createTextNode("");c.ownerDocument!==l.document&&typeof l.wrap=="function"&&l.wrap(c)===c&&(l=l.wrap(l)),M=l}function A(l){return N(l)?l:(l.ownerDocument||l).defaultView||M.window}typeof window<"u"&&window&&z(window);var T=function(l){return!!l&&i(l)==="object"},K=function(l){return typeof l=="function"},S={window:function(l){return l===M||N(l)},docFrag:function(l){return T(l)&&l.nodeType===11},object:T,func:K,number:function(l){return typeof l=="number"},bool:function(l){return typeof l=="boolean"},string:function(l){return typeof l=="string"},element:function(l){if(!l||i(l)!=="object")return!1;var c=A(l)||M;return/object|function/.test(typeof Element>"u"?"undefined":i(Element))?l instanceof Element||l instanceof c.Element:l.nodeType===1&&typeof l.nodeName=="string"},plainObject:function(l){return T(l)&&!!l.constructor&&/function Object\b/.test(l.constructor.toString())},array:function(l){return T(l)&&l.length!==void 0&&K(l.splice)}};function G(l){var c=l.interaction;if(c.prepared.name==="drag"){var p=c.prepared.axis;p==="x"?(c.coords.cur.page.y=c.coords.start.page.y,c.coords.cur.client.y=c.coords.start.client.y,c.coords.velocity.client.y=0,c.coords.velocity.page.y=0):p==="y"&&(c.coords.cur.page.x=c.coords.start.page.x,c.coords.cur.client.x=c.coords.start.client.x,c.coords.velocity.client.x=0,c.coords.velocity.page.x=0)}}function q(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="drag"){var m=p.prepared.axis;if(m==="x"||m==="y"){var E=m==="x"?"y":"x";c.page[E]=p.coords.start.page[E],c.client[E]=p.coords.start.client[E],c.delta[E]=0}}}var F={id:"actions/drag",install:function(l){var c=l.actions,p=l.Interactable,m=l.defaults;p.prototype.draggable=F.draggable,c.map.drag=F,c.methodDict.drag="draggable",m.actions.drag=F.defaults},listeners:{"interactions:before-action-move":G,"interactions:action-resume":G,"interactions:action-move":q,"auto-start:check":function(l){var c=l.interaction,p=l.interactable,m=l.buttons,E=p.options.drag;if(E&&E.enabled&&(!c.pointerIsDown||!/mouse|pointer/.test(c.pointerType)||m&p.options.drag.mouseButtons))return l.action={name:"drag",axis:E.lockAxis==="start"?E.startAxis:E.lockAxis},!1}},draggable:function(l){return S.object(l)?(this.options.drag.enabled=l.enabled!==!1,this.setPerAction("drag",l),this.setOnEvents("drag",l),/^(xy|x|y|start)$/.test(l.lockAxis)&&(this.options.drag.lockAxis=l.lockAxis),/^(xy|x|y)$/.test(l.startAxis)&&(this.options.drag.startAxis=l.startAxis),this):S.bool(l)?(this.options.drag.enabled=l,this):this.options.drag},beforeMove:G,move:q,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(l){return l.search("drag")===0}},W=F,Z={init:function(l){var c=l;Z.document=c.document,Z.DocumentFragment=c.DocumentFragment||j,Z.SVGElement=c.SVGElement||j,Z.SVGSVGElement=c.SVGSVGElement||j,Z.SVGElementInstance=c.SVGElementInstance||j,Z.Element=c.Element||j,Z.HTMLElement=c.HTMLElement||Z.Element,Z.Event=c.Event,Z.Touch=c.Touch||j,Z.PointerEvent=c.PointerEvent||c.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function j(){}var ve=Z,ge={init:function(l){var c=ve.Element,p=l.navigator||{};ge.supportsTouch="ontouchstart"in l||S.func(l.DocumentTouch)&&ve.document instanceof l.DocumentTouch,ge.supportsPointerEvent=p.pointerEnabled!==!1&&!!ve.PointerEvent,ge.isIOS=/iP(hone|od|ad)/.test(p.platform),ge.isIOS7=/iP(hone|od|ad)/.test(p.platform)&&/OS 7[^\d]/.test(p.appVersion),ge.isIe9=/MSIE 9/.test(p.userAgent),ge.isOperaMobile=p.appName==="Opera"&&ge.supportsTouch&&/Presto/.test(p.userAgent),ge.prefixedMatchesSelector="matches"in c.prototype?"matches":"webkitMatchesSelector"in c.prototype?"webkitMatchesSelector":"mozMatchesSelector"in c.prototype?"mozMatchesSelector":"oMatchesSelector"in c.prototype?"oMatchesSelector":"msMatchesSelector",ge.pEventTypes=ge.supportsPointerEvent?ve.PointerEvent===l.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,ge.wheelEvent=ve.document&&"onmousewheel"in ve.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},X=ge;function P(l,c){if(l.contains)return l.contains(c);for(;c;){if(c===l)return!0;c=c.parentNode}return!1}function ee(l,c){for(;S.element(l);){if(le(l,c))return l;l=ne(l)}return null}function ne(l){var c=l.parentNode;if(S.docFrag(c)){for(;(c=c.host)&&S.docFrag(c););return c}return c}function le(l,c){return M!==O&&(c=c.replace(/\/deep\//g," ")),l[X.prefixedMatchesSelector](c)}var oe=function(l){return l.parentNode||l.host};function he(l,c){for(var p,m=[],E=l;(p=oe(E))&&E!==c&&p!==E.ownerDocument;)m.unshift(E),E=p;return m}function ue(l,c,p){for(;S.element(l);){if(le(l,c))return!0;if((l=ne(l))===p)return le(l,c)}return!1}function me(l){return l.correspondingUseElement||l}function _e(l){var c=l instanceof ve.SVGElement?l.getBoundingClientRect():l.getClientRects()[0];return c&&{left:c.left,right:c.right,top:c.top,bottom:c.bottom,width:c.width||c.right-c.left,height:c.height||c.bottom-c.top}}function Me(l){var c,p=_e(l);if(!X.isIOS7&&p){var m={x:(c=(c=A(l))||M).scrollX||c.document.documentElement.scrollLeft,y:c.scrollY||c.document.documentElement.scrollTop};p.left+=m.x,p.right+=m.x,p.top+=m.y,p.bottom+=m.y}return p}function Oe(l){for(var c=[];l;)c.push(l),l=ne(l);return c}function qe(l){return!!S.string(l)&&(ve.document.querySelector(l),!0)}function ce(l,c){for(var p in c)l[p]=c[p];return l}function Pe(l,c,p){return l==="parent"?ne(p):l==="self"?c.getRect(p):ee(p,l)}function Re(l,c,p,m){var E=l;return S.string(E)?E=Pe(E,c,p):S.func(E)&&(E=E.apply(void 0,m)),S.element(E)&&(E=Me(E)),E}function ke(l){return l&&{x:"x"in l?l.x:l.left,y:"y"in l?l.y:l.top}}function Ke(l){return!l||"x"in l&&"y"in l||((l=ce({},l)).x=l.left||0,l.y=l.top||0,l.width=l.width||(l.right||0)-l.x,l.height=l.height||(l.bottom||0)-l.y),l}function Le(l,c,p){l.left&&(c.left+=p.x),l.right&&(c.right+=p.x),l.top&&(c.top+=p.y),l.bottom&&(c.bottom+=p.y),c.width=c.right-c.left,c.height=c.bottom-c.top}function Ee(l,c,p){var m=p&&l.options[p];return ke(Re(m&&m.origin||l.options.origin,l,c,[l&&c]))||{x:0,y:0}}function fe(l,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(U){return!0},m=arguments.length>3?arguments[3]:void 0;if(m=m||{},S.string(l)&&l.search(" ")!==-1&&(l=vt(l)),S.array(l))return l.forEach(function(U){return fe(U,c,p,m)}),m;if(S.object(l)&&(c=l,l=""),S.func(c)&&p(l))m[l]=m[l]||[],m[l].push(c);else if(S.array(c))for(var E=0,I=c;E<I.length;E++){var R=I[E];fe(l,R,p,m)}else if(S.object(c))for(var $ in c)fe(vt($).map(function(U){return"".concat(l).concat(U)}),c[$],p,m);return m}function vt(l){return l.trim().split(/ +/)}var it=function(l,c){return Math.sqrt(l*l+c*c)},Et=["webkit","moz"];function at(l,c){l.__set||(l.__set={});var p=function(E){if(Et.some(function(I){return E.indexOf(I)===0}))return 1;typeof l[E]!="function"&&E!=="__set"&&Object.defineProperty(l,E,{get:function(){return E in l.__set?l.__set[E]:l.__set[E]=c[E]},set:function(I){l.__set[E]=I},configurable:!0})};for(var m in c)p(m);return l}function Ve(l,c){l.page=l.page||{},l.page.x=c.page.x,l.page.y=c.page.y,l.client=l.client||{},l.client.x=c.client.x,l.client.y=c.client.y,l.timeStamp=c.timeStamp}function ht(l){l.page.x=0,l.page.y=0,l.client.x=0,l.client.y=0}function ot(l){return l instanceof ve.Event||l instanceof ve.Touch}function gt(l,c,p){return l=l||"page",(p=p||{}).x=c[l+"X"],p.y=c[l+"Y"],p}function xt(l,c){return c=c||{x:0,y:0},X.isOperaMobile&&ot(l)?(gt("screen",l,c),c.x+=window.scrollX,c.y+=window.scrollY):gt("page",l,c),c}function st(l){return S.number(l.pointerId)?l.pointerId:l.identifier}function ut(l,c,p){var m=c.length>1?nt(c):c[0];xt(m,l.page),function(E,I){I=I||{},X.isOperaMobile&&ot(E)?gt("screen",E,I):gt("client",E,I)}(m,l.client),l.timeStamp=p}function ft(l){var c=[];return S.array(l)?(c[0]=l[0],c[1]=l[1]):l.type==="touchend"?l.touches.length===1?(c[0]=l.touches[0],c[1]=l.changedTouches[0]):l.touches.length===0&&(c[0]=l.changedTouches[0],c[1]=l.changedTouches[1]):(c[0]=l.touches[0],c[1]=l.touches[1]),c}function nt(l){for(var c={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},p=0;p<l.length;p++){var m=l[p];for(var E in c)c[E]+=m[E]}for(var I in c)c[I]/=l.length;return c}function _t(l){if(!l.length)return null;var c=ft(l),p=Math.min(c[0].pageX,c[1].pageX),m=Math.min(c[0].pageY,c[1].pageY),E=Math.max(c[0].pageX,c[1].pageX),I=Math.max(c[0].pageY,c[1].pageY);return{x:p,y:m,left:p,top:m,right:E,bottom:I,width:E-p,height:I-m}}function mt(l,c){var p=c+"X",m=c+"Y",E=ft(l),I=E[0][p]-E[1][p],R=E[0][m]-E[1][m];return it(I,R)}function Pt(l,c){var p=c+"X",m=c+"Y",E=ft(l),I=E[1][p]-E[0][p],R=E[1][m]-E[0][m];return 180*Math.atan2(R,I)/Math.PI}function on(l){return S.string(l.pointerType)?l.pointerType:S.number(l.pointerType)?[void 0,void 0,"touch","pen","mouse"][l.pointerType]:/touch/.test(l.type||"")||l instanceof ve.Touch?"touch":"mouse"}function Qn(l){var c=S.func(l.composedPath)?l.composedPath():l.path;return[me(c?c[0]:l.target),me(l.currentTarget)]}var Nt=function(){function l(c){a(this,l),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=c}return d(l,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),l}();Object.defineProperty(Nt.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var ze=function(l,c){for(var p=0;p<c.length;p++){var m=c[p];l.push(m)}return l},_n=function(l){return ze([],l)},bt=function(l,c){for(var p=0;p<l.length;p++)if(c(l[p],p,l))return p;return-1},St=function(l,c){return l[bt(l,c)]},Se=function(l){h(p,l);var c=_(p);function p(m,E,I){var R;a(this,p),(R=c.call(this,E._interaction)).dropzone=void 0,R.dragEvent=void 0,R.relatedTarget=void 0,R.draggable=void 0,R.propagationStopped=!1,R.immediatePropagationStopped=!1;var $=I==="dragleave"?m.prev:m.cur,U=$.element,o=$.dropzone;return R.type=I,R.target=U,R.currentTarget=U,R.dropzone=o,R.dragEvent=E,R.relatedTarget=E.target,R.draggable=E.interactable,R.timeStamp=E.timeStamp,R}return d(p,[{key:"reject",value:function(){var m=this,E=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&E.cur.dropzone===this.dropzone&&E.cur.element===this.target)if(E.prev.dropzone=this.dropzone,E.prev.element=this.target,E.rejected=!0,E.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var I=E.activeDrops,R=bt(I,function(U){var o=U.dropzone,u=U.element;return o===m.dropzone&&u===m.target});E.activeDrops.splice(R,1);var $=new p(E,this.dragEvent,"dropdeactivate");$.dropzone=this.dropzone,$.target=this.target,this.dropzone.fire($)}else this.dropzone.fire(new p(E,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),p}(Nt);function sn(l,c){for(var p=0,m=l.slice();p<m.length;p++){var E=m[p],I=E.dropzone,R=E.element;c.dropzone=I,c.target=R,I.fire(c),c.propagationStopped=c.immediatePropagationStopped=!1}}function $n(l,c){for(var p=function(I,R){for(var $=[],U=0,o=I.interactables.list;U<o.length;U++){var u=o[U];if(u.options.drop.enabled){var g=u.options.drop.accept;if(!(S.element(g)&&g!==R||S.string(g)&&!le(R,g)||S.func(g)&&!g({dropzone:u,draggableElement:R})))for(var b=0,x=u.getAllElements();b<x.length;b++){var C=x[b];C!==R&&$.push({dropzone:u,element:C,rect:u.getRect(C)})}}}return $}(l,c),m=0;m<p.length;m++){var E=p[m];E.rect=E.dropzone.getRect(E.element)}return p}function Zn(l,c,p){for(var m=l.dropState,E=l.interactable,I=l.element,R=[],$=0,U=m.activeDrops;$<U.length;$++){var o=U[$],u=o.dropzone,g=o.element,b=o.rect,x=u.dropCheck(c,p,E,I,g,b);R.push(x?g:null)}var C=function(L){for(var B,H,V,J=[],Y=0;Y<L.length;Y++){var te=L[Y],Q=L[B];if(te&&Y!==B)if(Q){var ie=oe(te),ae=oe(Q);if(ie!==te.ownerDocument)if(ae!==te.ownerDocument)if(ie!==ae){J=J.length?J:he(Q);var re=void 0;if(Q instanceof ve.HTMLElement&&te instanceof ve.SVGElement&&!(te instanceof ve.SVGSVGElement)){if(te===ae)continue;re=te.ownerSVGElement}else re=te;for(var se=he(re,Q.ownerDocument),de=0;se[de]&&se[de]===J[de];)de++;var pe=[se[de-1],se[de],J[de]];if(pe[0])for(var ye=pe[0].lastChild;ye;){if(ye===pe[1]){B=Y,J=se;break}if(ye===pe[2])break;ye=ye.previousSibling}}else V=Q,(parseInt(A(H=te).getComputedStyle(H).zIndex,10)||0)>=(parseInt(A(V).getComputedStyle(V).zIndex,10)||0)&&(B=Y);else B=Y}else B=Y}return B}(R);return m.activeDrops[C]||null}function Jn(l,c,p){var m=l.dropState,E={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return p.type==="dragstart"&&(E.activate=new Se(m,p,"dropactivate"),E.activate.target=null,E.activate.dropzone=null),p.type==="dragend"&&(E.deactivate=new Se(m,p,"dropdeactivate"),E.deactivate.target=null,E.deactivate.dropzone=null),m.rejected||(m.cur.element!==m.prev.element&&(m.prev.dropzone&&(E.leave=new Se(m,p,"dragleave"),p.dragLeave=E.leave.target=m.prev.element,p.prevDropzone=E.leave.dropzone=m.prev.dropzone),m.cur.dropzone&&(E.enter=new Se(m,p,"dragenter"),p.dragEnter=m.cur.element,p.dropzone=m.cur.dropzone)),p.type==="dragend"&&m.cur.dropzone&&(E.drop=new Se(m,p,"drop"),p.dropzone=m.cur.dropzone,p.relatedTarget=m.cur.element),p.type==="dragmove"&&m.cur.dropzone&&(E.move=new Se(m,p,"dropmove"),p.dropzone=m.cur.dropzone)),E}function fr(l,c){var p=l.dropState,m=p.activeDrops,E=p.cur,I=p.prev;c.leave&&I.dropzone.fire(c.leave),c.enter&&E.dropzone.fire(c.enter),c.move&&E.dropzone.fire(c.move),c.drop&&E.dropzone.fire(c.drop),c.deactivate&&sn(m,c.deactivate),p.prev.dropzone=E.dropzone,p.prev.element=E.element}function ca(l,c){var p=l.interaction,m=l.iEvent,E=l.event;if(m.type==="dragmove"||m.type==="dragend"){var I=p.dropState;c.dynamicDrop&&(I.activeDrops=$n(c,p.element));var R=m,$=Zn(p,R,E);I.rejected=I.rejected&&!!$&&$.dropzone===I.cur.dropzone&&$.element===I.cur.element,I.cur.dropzone=$&&$.dropzone,I.cur.element=$&&$.element,I.events=Jn(p,0,R)}}var la={id:"actions/drop",install:function(l){var c=l.actions,p=l.interactStatic,m=l.Interactable,E=l.defaults;l.usePlugin(W),m.prototype.dropzone=function(I){return function(R,$){if(S.object($)){if(R.options.drop.enabled=$.enabled!==!1,$.listeners){var U=fe($.listeners),o=Object.keys(U).reduce(function(g,b){return g[/^(enter|leave)/.test(b)?"drag".concat(b):/^(activate|deactivate|move)/.test(b)?"drop".concat(b):b]=U[b],g},{}),u=R.options.drop.listeners;u&&R.off(u),R.on(o),R.options.drop.listeners=o}return S.func($.ondrop)&&R.on("drop",$.ondrop),S.func($.ondropactivate)&&R.on("dropactivate",$.ondropactivate),S.func($.ondropdeactivate)&&R.on("dropdeactivate",$.ondropdeactivate),S.func($.ondragenter)&&R.on("dragenter",$.ondragenter),S.func($.ondragleave)&&R.on("dragleave",$.ondragleave),S.func($.ondropmove)&&R.on("dropmove",$.ondropmove),/^(pointer|center)$/.test($.overlap)?R.options.drop.overlap=$.overlap:S.number($.overlap)&&(R.options.drop.overlap=Math.max(Math.min(1,$.overlap),0)),"accept"in $&&(R.options.drop.accept=$.accept),"checker"in $&&(R.options.drop.checker=$.checker),R}return S.bool($)?(R.options.drop.enabled=$,R):R.options.drop}(this,I)},m.prototype.dropCheck=function(I,R,$,U,o,u){return function(g,b,x,C,L,B,H){var V=!1;if(!(H=H||g.getRect(B)))return!!g.options.drop.checker&&g.options.drop.checker(b,x,V,g,B,C,L);var J=g.options.drop.overlap;if(J==="pointer"){var Y=Ee(C,L,"drag"),te=xt(b);te.x+=Y.x,te.y+=Y.y;var Q=te.x>H.left&&te.x<H.right,ie=te.y>H.top&&te.y<H.bottom;V=Q&&ie}var ae=C.getRect(L);if(ae&&J==="center"){var re=ae.left+ae.width/2,se=ae.top+ae.height/2;V=re>=H.left&&re<=H.right&&se>=H.top&&se<=H.bottom}return ae&&S.number(J)&&(V=Math.max(0,Math.min(H.right,ae.right)-Math.max(H.left,ae.left))*Math.max(0,Math.min(H.bottom,ae.bottom)-Math.max(H.top,ae.top))/(ae.width*ae.height)>=J),g.options.drop.checker&&(V=g.options.drop.checker(b,x,V,g,B,C,L)),V}(this,I,R,$,U,o,u)},p.dynamicDrop=function(I){return S.bool(I)?(l.dynamicDrop=I,p):l.dynamicDrop},ce(c.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),c.methodDict.drop="dropzone",l.dynamicDrop=!1,E.actions.drop=la.defaults},listeners:{"interactions:before-action-start":function(l){var c=l.interaction;c.prepared.name==="drag"&&(c.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(l,c){var p=l.interaction,m=(l.event,l.iEvent);if(p.prepared.name==="drag"){var E=p.dropState;E.activeDrops=[],E.events={},E.activeDrops=$n(c,p.element),E.events=Jn(p,0,m),E.events.activate&&(sn(E.activeDrops,E.events.activate),c.fire("actions/drop:start",{interaction:p,dragEvent:m}))}},"interactions:action-move":ca,"interactions:after-action-move":function(l,c){var p=l.interaction,m=l.iEvent;if(p.prepared.name==="drag"){var E=p.dropState;fr(p,E.events),c.fire("actions/drop:move",{interaction:p,dragEvent:m}),E.events={}}},"interactions:action-end":function(l,c){if(l.interaction.prepared.name==="drag"){var p=l.interaction,m=l.iEvent;ca(l,c),fr(p,p.dropState.events),c.fire("actions/drop:end",{interaction:p,dragEvent:m})}},"interactions:stop":function(l){var c=l.interaction;if(c.prepared.name==="drag"){var p=c.dropState;p&&(p.activeDrops=null,p.events=null,p.cur.dropzone=null,p.cur.element=null,p.prev.dropzone=null,p.prev.element=null,p.rejected=!1)}}},getActiveDrops:$n,getDrop:Zn,getDropEvents:Jn,fireDropEvents:fr,filterEventType:function(l){return l.search("drag")===0||l.search("drop")===0},defaults:{enabled:!1,accept:null,overlap:"pointer"}},er=la;function Sn(l){var c=l.interaction,p=l.iEvent,m=l.phase;if(c.prepared.name==="gesture"){var E=c.pointers.map(function(o){return o.pointer}),I=m==="start",R=m==="end",$=c.interactable.options.deltaSource;if(p.touches=[E[0],E[1]],I)p.distance=mt(E,$),p.box=_t(E),p.scale=1,p.ds=0,p.angle=Pt(E,$),p.da=0,c.gesture.startDistance=p.distance,c.gesture.startAngle=p.angle;else if(R||c.pointers.length<2){var U=c.prevEvent;p.distance=U.distance,p.box=U.box,p.scale=U.scale,p.ds=0,p.angle=U.angle,p.da=0}else p.distance=mt(E,$),p.box=_t(E),p.scale=p.distance/c.gesture.startDistance,p.angle=Pt(E,$),p.ds=p.scale-c.gesture.scale,p.da=p.angle-c.gesture.angle;c.gesture.distance=p.distance,c.gesture.angle=p.angle,S.number(p.scale)&&p.scale!==1/0&&!isNaN(p.scale)&&(c.gesture.scale=p.scale)}}var pr={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(l){var c=l.actions,p=l.Interactable,m=l.defaults;p.prototype.gesturable=function(E){return S.object(E)?(this.options.gesture.enabled=E.enabled!==!1,this.setPerAction("gesture",E),this.setOnEvents("gesture",E),this):S.bool(E)?(this.options.gesture.enabled=E,this):this.options.gesture},c.map.gesture=pr,c.methodDict.gesture="gesturable",m.actions.gesture=pr.defaults},listeners:{"interactions:action-start":Sn,"interactions:action-move":Sn,"interactions:action-end":Sn,"interactions:new":function(l){l.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(l){if(!(l.interaction.pointers.length<2)){var c=l.interactable.options.gesture;if(c&&c.enabled)return l.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(l){return l.search("gesture")===0}},jr=pr;function Je(l,c,p,m,E,I,R){if(!c)return!1;if(c===!0){var $=S.number(I.width)?I.width:I.right-I.left,U=S.number(I.height)?I.height:I.bottom-I.top;if(R=Math.min(R,Math.abs((l==="left"||l==="right"?$:U)/2)),$<0&&(l==="left"?l="right":l==="right"&&(l="left")),U<0&&(l==="top"?l="bottom":l==="bottom"&&(l="top")),l==="left"){var o=$>=0?I.left:I.right;return p.x<o+R}if(l==="top"){var u=U>=0?I.top:I.bottom;return p.y<u+R}if(l==="right")return p.x>($>=0?I.right:I.left)-R;if(l==="bottom")return p.y>(U>=0?I.bottom:I.top)-R}return!!S.element(m)&&(S.element(c)?c===m:ue(m,c,E))}function ct(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="resize"&&p.resizeAxes){var m=c;p.interactable.options.resize.square?(p.resizeAxes==="y"?m.delta.x=m.delta.y:m.delta.y=m.delta.x,m.axes="xy"):(m.axes=p.resizeAxes,p.resizeAxes==="x"?m.delta.y=0:p.resizeAxes==="y"&&(m.delta.x=0))}}var un,Xt,qt={id:"actions/resize",before:["actions/drag"],install:function(l){var c=l.actions,p=l.browser,m=l.Interactable,E=l.defaults;qt.cursors=function(I){return I.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(p),qt.defaultMargin=p.supportsTouch||p.supportsPointerEvent?20:10,m.prototype.resizable=function(I){return function(R,$,U){return S.object($)?(R.options.resize.enabled=$.enabled!==!1,R.setPerAction("resize",$),R.setOnEvents("resize",$),S.string($.axis)&&/^x$|^y$|^xy$/.test($.axis)?R.options.resize.axis=$.axis:$.axis===null&&(R.options.resize.axis=U.defaults.actions.resize.axis),S.bool($.preserveAspectRatio)?R.options.resize.preserveAspectRatio=$.preserveAspectRatio:S.bool($.square)&&(R.options.resize.square=$.square),R):S.bool($)?(R.options.resize.enabled=$,R):R.options.resize}(this,I,l)},c.map.resize=qt,c.methodDict.resize="resizable",E.actions.resize=qt.defaults},listeners:{"interactions:new":function(l){l.interaction.resizeAxes="xy"},"interactions:action-start":function(l){(function(c){var p=c.iEvent,m=c.interaction;if(m.prepared.name==="resize"&&m.prepared.edges){var E=p,I=m.rect;m._rects={start:ce({},I),corrected:ce({},I),previous:ce({},I),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},E.edges=m.prepared.edges,E.rect=m._rects.corrected,E.deltaRect=m._rects.delta}})(l),ct(l)},"interactions:action-move":function(l){(function(c){var p=c.iEvent,m=c.interaction;if(m.prepared.name==="resize"&&m.prepared.edges){var E=p,I=m.interactable.options.resize.invert,R=I==="reposition"||I==="negate",$=m.rect,U=m._rects,o=U.start,u=U.corrected,g=U.delta,b=U.previous;if(ce(b,u),R){if(ce(u,$),I==="reposition"){if(u.top>u.bottom){var x=u.top;u.top=u.bottom,u.bottom=x}if(u.left>u.right){var C=u.left;u.left=u.right,u.right=C}}}else u.top=Math.min($.top,o.bottom),u.bottom=Math.max($.bottom,o.top),u.left=Math.min($.left,o.right),u.right=Math.max($.right,o.left);for(var L in u.width=u.right-u.left,u.height=u.bottom-u.top,u)g[L]=u[L]-b[L];E.edges=m.prepared.edges,E.rect=u,E.deltaRect=g}})(l),ct(l)},"interactions:action-end":function(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="resize"&&p.prepared.edges){var m=c;m.edges=p.prepared.edges,m.rect=p._rects.corrected,m.deltaRect=p._rects.delta}},"auto-start:check":function(l){var c=l.interaction,p=l.interactable,m=l.element,E=l.rect,I=l.buttons;if(E){var R=ce({},c.coords.cur.page),$=p.options.resize;if($&&$.enabled&&(!c.pointerIsDown||!/mouse|pointer/.test(c.pointerType)||I&$.mouseButtons)){if(S.object($.edges)){var U={left:!1,right:!1,top:!1,bottom:!1};for(var o in U)U[o]=Je(o,$.edges[o],R,c._latestPointer.eventTarget,m,E,$.margin||qt.defaultMargin);U.left=U.left&&!U.right,U.top=U.top&&!U.bottom,(U.left||U.right||U.top||U.bottom)&&(l.action={name:"resize",edges:U})}else{var u=$.axis!=="y"&&R.x>E.right-qt.defaultMargin,g=$.axis!=="x"&&R.y>E.bottom-qt.defaultMargin;(u||g)&&(l.action={name:"resize",axes:(u?"x":"")+(g?"y":"")})}return!l.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(l){var c=l.edges,p=l.axis,m=l.name,E=qt.cursors,I=null;if(p)I=E[m+p];else if(c){for(var R="",$=0,U=["top","bottom","left","right"];$<U.length;$++){var o=U[$];c[o]&&(R+=o)}I=E[R]}return I},filterEventType:function(l){return l.search("resize")===0},defaultMargin:null},Br=qt,yo={id:"actions",install:function(l){l.usePlugin(jr),l.usePlugin(Br),l.usePlugin(W),l.usePlugin(er)}},cn=0,Ot={request:function(l){return un(l)},cancel:function(l){return Xt(l)},init:function(l){if(un=l.requestAnimationFrame,Xt=l.cancelAnimationFrame,!un)for(var c=["ms","moz","webkit","o"],p=0;p<c.length;p++){var m=c[p];un=l["".concat(m,"RequestAnimationFrame")],Xt=l["".concat(m,"CancelAnimationFrame")]||l["".concat(m,"CancelRequestAnimationFrame")]}un=un&&un.bind(l),Xt=Xt&&Xt.bind(l),un||(un=function(E){var I=Date.now(),R=Math.max(0,16-(I-cn)),$=l.setTimeout(function(){E(I+R)},R);return cn=I+R,$},Xt=function(E){return clearTimeout(E)})}},$e={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(l){$e.isScrolling=!0,Ot.cancel($e.i),l.autoScroll=$e,$e.interaction=l,$e.prevTime=$e.now(),$e.i=Ot.request($e.scroll)},stop:function(){$e.isScrolling=!1,$e.interaction&&($e.interaction.autoScroll=null),Ot.cancel($e.i)},scroll:function(){var l=$e.interaction,c=l.interactable,p=l.element,m=l.prepared.name,E=c.options[m].autoScroll,I=gr(E.container,c,p),R=$e.now(),$=(R-$e.prevTime)/1e3,U=E.speed*$;if(U>=1){var o={x:$e.x*U,y:$e.y*U};if(o.x||o.y){var u=da(I);S.window(I)?I.scrollBy(o.x,o.y):I&&(I.scrollLeft+=o.x,I.scrollTop+=o.y);var g=da(I),b={x:g.x-u.x,y:g.y-u.y};(b.x||b.y)&&c.fire({type:"autoscroll",target:p,interactable:c,delta:b,interaction:l,container:I})}$e.prevTime=R}$e.isScrolling&&(Ot.cancel($e.i),$e.i=Ot.request($e.scroll))},check:function(l,c){var p;return(p=l.options[c].autoScroll)==null?void 0:p.enabled},onInteractionMove:function(l){var c=l.interaction,p=l.pointer;if(c.interacting()&&$e.check(c.interactable,c.prepared.name))if(c.simulation)$e.x=$e.y=0;else{var m,E,I,R,$=c.interactable,U=c.element,o=c.prepared.name,u=$.options[o].autoScroll,g=gr(u.container,$,U);if(S.window(g))R=p.clientX<$e.margin,m=p.clientY<$e.margin,E=p.clientX>g.innerWidth-$e.margin,I=p.clientY>g.innerHeight-$e.margin;else{var b=_e(g);R=p.clientX<b.left+$e.margin,m=p.clientY<b.top+$e.margin,E=p.clientX>b.right-$e.margin,I=p.clientY>b.bottom-$e.margin}$e.x=E?1:R?-1:0,$e.y=I?1:m?-1:0,$e.isScrolling||($e.margin=u.margin,$e.speed=u.speed,$e.start(c))}}};function gr(l,c,p){return(S.string(l)?Pe(l,c,p):l)||A(p)}function da(l){return S.window(l)&&(l=window.document.body),{x:l.scrollLeft,y:l.scrollTop}}var An={id:"auto-scroll",install:function(l){var c=l.defaults,p=l.actions;l.autoScroll=$e,$e.now=function(){return l.now()},p.phaselessTypes.autoscroll=!0,c.perAction.autoScroll=$e.defaults},listeners:{"interactions:new":function(l){l.interaction.autoScroll=null},"interactions:destroy":function(l){l.interaction.autoScroll=null,$e.stop(),$e.interaction&&($e.interaction=null)},"interactions:stop":$e.stop,"interactions:action-move":function(l){return $e.onInteractionMove(l)}}},ha=An;function Bt(l,c){var p=!1;return function(){return p||(M.console.warn(c),p=!0),l.apply(this,arguments)}}function Ur(l,c){return l.name=c.name,l.axis=c.axis,l.edges=c.edges,l}function xi(l){return S.bool(l)?(this.options.styleCursor=l,this):l===null?(delete this.options.styleCursor,this):this.options.styleCursor}function et(l){return S.func(l)?(this.options.actionChecker=l,this):l===null?(delete this.options.actionChecker,this):this.options.actionChecker}var Gn={id:"auto-start/interactableMethods",install:function(l){var c=l.Interactable;c.prototype.getAction=function(p,m,E,I){var R=function($,U,o,u,g){var b=$.getRect(u),x=U.buttons||{0:1,1:4,3:8,4:16}[U.button],C={action:null,interactable:$,interaction:o,element:u,rect:b,buttons:x};return g.fire("auto-start:check",C),C.action}(this,m,E,I,l);return this.options.actionChecker?this.options.actionChecker(p,m,R,this,I,E):R},c.prototype.ignoreFrom=Bt(function(p){return this._backCompatOption("ignoreFrom",p)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),c.prototype.allowFrom=Bt(function(p){return this._backCompatOption("allowFrom",p)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),c.prototype.actionChecker=et,c.prototype.styleCursor=xi}};function Vt(l,c,p,m,E){return c.testIgnoreAllow(c.options[l.name],p,m)&&c.options[l.name].enabled&&tr(c,p,l,E)?l:null}function fa(l,c,p,m,E,I,R){for(var $=0,U=m.length;$<U;$++){var o=m[$],u=E[$],g=o.getAction(c,p,l,u);if(g){var b=Vt(g,o,u,I,R);if(b)return{action:b,interactable:o,element:u}}}return{action:null,interactable:null,element:null}}function qn(l,c,p,m,E){var I=[],R=[],$=m;function U(u){I.push(u),R.push($)}for(;S.element($);){I=[],R=[],E.interactables.forEachMatch($,U);var o=fa(l,c,p,I,R,m,E);if(o.action&&!o.interactable.options[o.action.name].manualStart)return o;$=ne($)}return{action:null,interactable:null,element:null}}function yr(l,c,p){var m=c.action,E=c.interactable,I=c.element;m=m||{name:null},l.interactable=E,l.element=I,Ur(l.prepared,m),l.rect=E&&m.name?E.getRect(I):null,_i(l,p),p.fire("autoStart:prepared",{interaction:l})}function tr(l,c,p,m){var E=l.options,I=E[p.name].max,R=E[p.name].maxPerElement,$=m.autoStart.maxInteractions,U=0,o=0,u=0;if(!(I&&R&&$))return!1;for(var g=0,b=m.interactions.list;g<b.length;g++){var x=b[g],C=x.prepared.name;if(x.interacting()&&(++U>=$||x.interactable===l&&((o+=C===p.name?1:0)>=I||x.element===c&&(u++,C===p.name&&u>=R))))return!1}return $>0}function Kr(l,c){return S.number(l)?(c.autoStart.maxInteractions=l,this):c.autoStart.maxInteractions}function ln(l,c,p){var m=p.autoStart.cursorElement;m&&m!==l&&(m.style.cursor=""),l.ownerDocument.documentElement.style.cursor=c,l.style.cursor=c,p.autoStart.cursorElement=c?l:null}function _i(l,c){var p=l.interactable,m=l.element,E=l.prepared;if(l.pointerType==="mouse"&&p&&p.options.styleCursor){var I="";if(E.name){var R=p.options[E.name].cursorChecker;I=S.func(R)?R(E,p,m,l._interacting):c.actions.map[E.name].getCursor(E)}ln(l.element,I||"",c)}else c.autoStart.cursorElement&&ln(c.autoStart.cursorElement,"",c)}var Wr={id:"auto-start/base",before:["actions"],install:function(l){var c=l.interactStatic,p=l.defaults;l.usePlugin(Gn),p.base.actionChecker=null,p.base.styleCursor=!0,ce(p.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),c.maxInteractions=function(m){return Kr(m,l)},l.autoStart={maxInteractions:1/0,withinInteractionLimit:tr,cursorElement:null}},listeners:{"interactions:down":function(l,c){var p=l.interaction,m=l.pointer,E=l.event,I=l.eventTarget;p.interacting()||yr(p,qn(p,m,E,I,c),c)},"interactions:move":function(l,c){(function(p,m){var E=p.interaction,I=p.pointer,R=p.event,$=p.eventTarget;E.pointerType!=="mouse"||E.pointerIsDown||E.interacting()||yr(E,qn(E,I,R,$,m),m)})(l,c),function(p,m){var E=p.interaction;if(E.pointerIsDown&&!E.interacting()&&E.pointerWasMoved&&E.prepared.name){m.fire("autoStart:before-start",p);var I=E.interactable,R=E.prepared.name;R&&I&&(I.options[R].manualStart||!tr(I,E.element,E.prepared,m)?E.stop():(E.start(E.prepared,I,E.element),_i(E,m)))}}(l,c)},"interactions:stop":function(l,c){var p=l.interaction,m=p.interactable;m&&m.options.styleCursor&&ln(p.element,"",c)}},maxInteractions:Kr,withinInteractionLimit:tr,validateAction:Vt},Hr=Wr,Ye={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(l,c){var p=l.interaction,m=l.eventTarget,E=l.dx,I=l.dy;if(p.prepared.name==="drag"){var R=Math.abs(E),$=Math.abs(I),U=p.interactable.options.drag,o=U.startAxis,u=R>$?"x":R<$?"y":"xy";if(p.prepared.axis=U.lockAxis==="start"?u[0]:U.lockAxis,u!=="xy"&&o!=="xy"&&o!==u){p.prepared.name=null;for(var g=m,b=function(C){if(C!==p.interactable){var L=p.interactable.options.drag;if(!L.manualStart&&C.testIgnoreAllow(L,g,m)){var B=C.getAction(p.downPointer,p.downEvent,p,g);if(B&&B.name==="drag"&&function(H,V){if(!V)return!1;var J=V.options.drag.startAxis;return H==="xy"||J==="xy"||J===H}(u,C)&&Hr.validateAction(B,C,g,m,c))return C}}};S.element(g);){var x=c.interactables.forEachMatch(g,b);if(x){p.prepared.name="drag",p.interactable=x,p.element=g;break}g=ne(g)}}}}}};function Yr(l){var c=l.prepared&&l.prepared.name;if(!c)return null;var p=l.interactable.options;return p[c].hold||p[c].delay}var pa={id:"auto-start/hold",install:function(l){var c=l.defaults;l.usePlugin(Hr),c.perAction.hold=0,c.perAction.delay=0},listeners:{"interactions:new":function(l){l.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(l){var c=l.interaction,p=Yr(c);p>0&&(c.autoStartHoldTimer=setTimeout(function(){c.start(c.prepared,c.interactable,c.element)},p))},"interactions:move":function(l){var c=l.interaction,p=l.duplicate;c.autoStartHoldTimer&&c.pointerWasMoved&&!p&&(clearTimeout(c.autoStartHoldTimer),c.autoStartHoldTimer=null)},"autoStart:before-start":function(l){var c=l.interaction;Yr(c)>0&&(c.prepared.name=null)}},getHoldDuration:Yr},ga=pa,Ze={id:"auto-start",install:function(l){l.usePlugin(Hr),l.usePlugin(ga),l.usePlugin(Ye)}},vr=function(l){return/^(always|never|auto)$/.test(l)?(this.options.preventDefault=l,this):S.bool(l)?(this.options.preventDefault=l?"always":"never",this):this.options.preventDefault};function mr(l){var c=l.interaction,p=l.event;c.interactable&&c.interactable.checkAndPreventDefault(p)}var Fn={id:"core/interactablePreventDefault",install:function(l){var c=l.Interactable;c.prototype.preventDefault=vr,c.prototype.checkAndPreventDefault=function(p){return function(m,E,I){var R=m.options.preventDefault;if(R!=="never")if(R!=="always"){if(E.events.supportsPassive&&/^touch(start|move)$/.test(I.type)){var $=A(I.target).document,U=E.getDocOptions($);if(!U||!U.events||U.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(I.type)||S.element(I.target)&&le(I.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||I.preventDefault()}else I.preventDefault()}(this,l,p)},l.interactions.docEvents.push({type:"dragstart",listener:function(p){for(var m=0,E=l.interactions.list;m<E.length;m++){var I=E[m];if(I.element&&(I.element===p.target||P(I.element,p.target)))return void I.interactable.checkAndPreventDefault(p)}}})},listeners:["down","move","up","cancel"].reduce(function(l,c){return l["interactions:".concat(c)]=mr,l},{})};function nr(l,c){if(c.phaselessTypes[l])return!0;for(var p in c.map)if(l.indexOf(p)===0&&l.substr(p.length)in c.phases)return!0;return!1}function kn(l){var c={};for(var p in l){var m=l[p];S.plainObject(m)?c[p]=kn(m):S.array(m)?c[p]=_n(m):c[p]=m}return c}var rr=function(){function l(c){a(this,l),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=c,this.result=br(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return d(l,[{key:"start",value:function(c,p){var m,E,I=c.phase,R=this.interaction,$=function(o){var u=o.interactable.options[o.prepared.name],g=u.modifiers;return g&&g.length?g:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(b){var x=u[b];return x&&x.enabled&&{options:x,methods:x._methods}}).filter(function(b){return!!b})}(R);this.prepareStates($),this.startEdges=ce({},R.edges),this.edges=ce({},this.startEdges),this.startOffset=(m=R.rect,E=p,m?{left:E.x-m.left,top:E.y-m.top,right:m.right-E.x,bottom:m.bottom-E.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var U=this.fillArg({phase:I,pageCoords:p,preEnd:!1});return this.result=br(),this.startAll(U),this.result=this.setAll(U)}},{key:"fillArg",value:function(c){var p=this.interaction;return c.interaction=p,c.interactable=p.interactable,c.element=p.element,c.rect||(c.rect=p.rect),c.edges||(c.edges=this.startEdges),c.startOffset=this.startOffset,c}},{key:"startAll",value:function(c){for(var p=0,m=this.states;p<m.length;p++){var E=m[p];E.methods.start&&(c.state=E,E.methods.start(c))}}},{key:"setAll",value:function(c){var p=c.phase,m=c.preEnd,E=c.skipModifiers,I=c.rect,R=c.edges;c.coords=ce({},c.pageCoords),c.rect=ce({},I),c.edges=ce({},R);for(var $=E?this.states.slice(E):this.states,U=br(c.coords,c.rect),o=0;o<$.length;o++){var u,g=$[o],b=g.options,x=ce({},c.coords),C=null;(u=g.methods)!=null&&u.set&&this.shouldDo(b,m,p)&&(c.state=g,C=g.methods.set(c),Le(c.edges,c.rect,{x:c.coords.x-x.x,y:c.coords.y-x.y})),U.eventProps.push(C)}ce(this.edges,c.edges),U.delta.x=c.coords.x-c.pageCoords.x,U.delta.y=c.coords.y-c.pageCoords.y,U.rectDelta.left=c.rect.left-I.left,U.rectDelta.right=c.rect.right-I.right,U.rectDelta.top=c.rect.top-I.top,U.rectDelta.bottom=c.rect.bottom-I.bottom;var L=this.result.coords,B=this.result.rect;if(L&&B){var H=U.rect.left!==B.left||U.rect.right!==B.right||U.rect.top!==B.top||U.rect.bottom!==B.bottom;U.changed=H||L.x!==U.coords.x||L.y!==U.coords.y}return U}},{key:"applyToInteraction",value:function(c){var p=this.interaction,m=c.phase,E=p.coords.cur,I=p.coords.start,R=this.result,$=this.startDelta,U=R.delta;m==="start"&&ce(this.startDelta,R.delta);for(var o=0,u=[[I,$],[E,U]];o<u.length;o++){var g=u[o],b=g[0],x=g[1];b.page.x+=x.x,b.page.y+=x.y,b.client.x+=x.x,b.client.y+=x.y}var C=this.result.rectDelta,L=c.rect||p.rect;L.left+=C.left,L.right+=C.right,L.top+=C.top,L.bottom+=C.bottom,L.width=L.right-L.left,L.height=L.bottom-L.top}},{key:"setAndApply",value:function(c){var p=this.interaction,m=c.phase,E=c.preEnd,I=c.skipModifiers,R=this.setAll(this.fillArg({preEnd:E,phase:m,pageCoords:c.modifiedCoords||p.coords.cur.page}));if(this.result=R,!R.changed&&(!I||I<this.states.length)&&p.interacting())return!1;if(c.modifiedCoords){var $=p.coords.cur.page,U={x:c.modifiedCoords.x-$.x,y:c.modifiedCoords.y-$.y};R.coords.x+=U.x,R.coords.y+=U.y,R.delta.x+=U.x,R.delta.y+=U.y}this.applyToInteraction(c)}},{key:"beforeEnd",value:function(c){var p=c.interaction,m=c.event,E=this.states;if(E&&E.length){for(var I=!1,R=0;R<E.length;R++){var $=E[R];c.state=$;var U=$.options,o=$.methods,u=o.beforeEnd&&o.beforeEnd(c);if(u)return this.endResult=u,!1;I=I||!I&&this.shouldDo(U,!0,c.phase,!0)}I&&p.move({event:m,preEnd:!0})}}},{key:"stop",value:function(c){var p=c.interaction;if(this.states&&this.states.length){var m=ce({states:this.states,interactable:p.interactable,element:p.element,rect:null},c);this.fillArg(m);for(var E=0,I=this.states;E<I.length;E++){var R=I[E];m.state=R,R.methods.stop&&R.methods.stop(m)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(c){this.states=[];for(var p=0;p<c.length;p++){var m=c[p],E=m.options,I=m.methods,R=m.name;this.states.push({options:E,methods:I,index:p,name:R})}return this.states}},{key:"restoreInteractionCoords",value:function(c){var p=c.interaction,m=p.coords,E=p.rect,I=p.modification;if(I.result){for(var R=I.startDelta,$=I.result,U=$.delta,o=$.rectDelta,u=0,g=[[m.start,R],[m.cur,U]];u<g.length;u++){var b=g[u],x=b[0],C=b[1];x.page.x-=C.x,x.page.y-=C.y,x.client.x-=C.x,x.client.y-=C.y}E.left-=o.left,E.right-=o.right,E.top-=o.top,E.bottom-=o.bottom}}},{key:"shouldDo",value:function(c,p,m,E){return!(!c||c.enabled===!1||E&&!c.endOnly||c.endOnly&&!p||m==="start"&&!c.setStart)}},{key:"copyFrom",value:function(c){this.startOffset=c.startOffset,this.startDelta=c.startDelta,this.startEdges=c.startEdges,this.edges=c.edges,this.states=c.states.map(function(p){return kn(p)}),this.result=br(ce({},c.result.coords),ce({},c.result.rect))}},{key:"destroy",value:function(){for(var c in this)this[c]=null}}]),l}();function br(l,c){return{rect:c,coords:l,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Ut(l,c){var p=l.defaults,m={start:l.start,set:l.set,beforeEnd:l.beforeEnd,stop:l.stop},E=function(I){var R=I||{};for(var $ in R.enabled=R.enabled!==!1,p)$ in R||(R[$]=p[$]);var U={options:R,methods:m,name:c,enable:function(){return R.enabled=!0,U},disable:function(){return R.enabled=!1,U}};return U};return c&&typeof c=="string"&&(E._defaults=p,E._methods=m),E}function ir(l){var c=l.iEvent,p=l.interaction.modification.result;p&&(c.modifiers=p.eventProps)}var wr={id:"modifiers/base",before:["actions"],install:function(l){l.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(l){var c=l.interaction;c.modification=new rr(c)},"interactions:before-action-start":function(l){var c=l.interaction,p=l.interaction.modification;p.start(l,c.coords.start.page),c.edges=p.edges,p.applyToInteraction(l)},"interactions:before-action-move":function(l){var c=l.interaction,p=c.modification,m=p.setAndApply(l);return c.edges=p.edges,m},"interactions:before-action-end":function(l){var c=l.interaction,p=c.modification,m=p.beforeEnd(l);return c.edges=p.startEdges,m},"interactions:action-start":ir,"interactions:action-move":ir,"interactions:action-end":ir,"interactions:after-action-start":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:after-action-move":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:stop":function(l){return l.interaction.modification.stop(l)}}},Si=wr,ya={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},Xe=function(l){h(p,l);var c=_(p);function p(m,E,I,R,$,U,o){var u;a(this,p),(u=c.call(this,m)).relatedTarget=null,u.screenX=void 0,u.screenY=void 0,u.button=void 0,u.buttons=void 0,u.ctrlKey=void 0,u.shiftKey=void 0,u.altKey=void 0,u.metaKey=void 0,u.page=void 0,u.client=void 0,u.delta=void 0,u.rect=void 0,u.x0=void 0,u.y0=void 0,u.t0=void 0,u.dt=void 0,u.duration=void 0,u.clientX0=void 0,u.clientY0=void 0,u.velocity=void 0,u.speed=void 0,u.swipe=void 0,u.axes=void 0,u.preEnd=void 0,$=$||m.element;var g=m.interactable,b=(g&&g.options||ya).deltaSource,x=Ee(g,$,I),C=R==="start",L=R==="end",B=C?w(u):m.prevEvent,H=C?m.coords.start:L?{page:B.page,client:B.client,timeStamp:m.coords.cur.timeStamp}:m.coords.cur;return u.page=ce({},H.page),u.client=ce({},H.client),u.rect=ce({},m.rect),u.timeStamp=H.timeStamp,L||(u.page.x-=x.x,u.page.y-=x.y,u.client.x-=x.x,u.client.y-=x.y),u.ctrlKey=E.ctrlKey,u.altKey=E.altKey,u.shiftKey=E.shiftKey,u.metaKey=E.metaKey,u.button=E.button,u.buttons=E.buttons,u.target=$,u.currentTarget=$,u.preEnd=U,u.type=o||I+(R||""),u.interactable=g,u.t0=C?m.pointers[m.pointers.length-1].downTime:B.t0,u.x0=m.coords.start.page.x-x.x,u.y0=m.coords.start.page.y-x.y,u.clientX0=m.coords.start.client.x-x.x,u.clientY0=m.coords.start.client.y-x.y,u.delta=C||L?{x:0,y:0}:{x:u[b].x-B[b].x,y:u[b].y-B[b].y},u.dt=m.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=ce({},m.coords.velocity[b]),u.speed=it(u.velocity.x,u.velocity.y),u.swipe=L||R==="inertiastart"?u.getSwipe():null,u}return d(p,[{key:"getSwipe",value:function(){var m=this._interaction;if(m.prevEvent.speed<600||this.timeStamp-m.prevEvent.timeStamp>150)return null;var E=180*Math.atan2(m.prevEvent.velocityY,m.prevEvent.velocityX)/Math.PI;E<0&&(E+=360);var I=112.5<=E&&E<247.5,R=202.5<=E&&E<337.5;return{up:R,down:!R&&22.5<=E&&E<157.5,left:I,right:!I&&(292.5<=E||E<67.5),angle:E,speed:m.prevEvent.speed,velocity:{x:m.prevEvent.velocityX,y:m.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),p}(Nt);Object.defineProperties(Xe.prototype,{pageX:{get:function(){return this.page.x},set:function(l){this.page.x=l}},pageY:{get:function(){return this.page.y},set:function(l){this.page.y=l}},clientX:{get:function(){return this.client.x},set:function(l){this.client.x=l}},clientY:{get:function(){return this.client.y},set:function(l){this.client.y=l}},dx:{get:function(){return this.delta.x},set:function(l){this.delta.x=l}},dy:{get:function(){return this.delta.y},set:function(l){this.delta.y=l}},velocityX:{get:function(){return this.velocity.x},set:function(l){this.velocity.x=l}},velocityY:{get:function(){return this.velocity.y},set:function(l){this.velocity.y=l}}});var Ai=d(function l(c,p,m,E,I){a(this,l),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=c,this.pointer=p,this.event=m,this.downTime=E,this.downTarget=I}),vo=function(l){return l.interactable="",l.element="",l.prepared="",l.pointerIsDown="",l.pointerWasMoved="",l._proxy="",l}({}),va=function(l){return l.start="",l.move="",l.end="",l.stop="",l.interacting="",l}({}),Tt=0,ar=function(){function l(c){var p=this,m=c.pointerType,E=c.scopeFire;a(this,l),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=Bt(function(u){this.move(u)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=Tt++,this._scopeFire=E,this.pointerType=m;var I=this;this._proxy={};var R=function(u){Object.defineProperty(p._proxy,u,{get:function(){return I[u]}})};for(var $ in vo)R($);var U=function(u){Object.defineProperty(p._proxy,u,{value:function(){return I[u].apply(I,arguments)}})};for(var o in va)U(o);this._scopeFire("interactions:new",{interaction:this})}return d(l,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(c,p,m){var E=this.updatePointer(c,p,m,!0),I=this.pointers[E];this._scopeFire("interactions:down",{pointer:c,event:p,eventTarget:m,pointerIndex:E,pointerInfo:I,type:"down",interaction:this})}},{key:"start",value:function(c,p,m){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(c.name==="gesture"?2:1)||!p.options[c.name].enabled)&&(Ur(this.prepared,c),this.interactable=p,this.element=m,this.rect=p.getRect(m),this.edges=this.prepared.edges?ce({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(c,p,m){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(c,p,m,!1);var E,I,R=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(E=this.coords.cur.client.x-this.coords.start.client.x,I=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=it(E,I)>this.pointerMoveTolerance);var $,U,o,u=this.getPointerIndex(c),g={pointer:c,pointerIndex:u,pointerInfo:this.pointers[u],event:p,type:"move",eventTarget:m,dx:E,dy:I,duplicate:R,interaction:this};R||($=this.coords.velocity,U=this.coords.delta,o=Math.max(U.timeStamp/1e3,.001),$.page.x=U.page.x/o,$.page.y=U.page.y/o,$.client.x=U.client.x/o,$.client.y=U.client.y/o,$.timeStamp=o),this._scopeFire("interactions:move",g),R||this.simulation||(this.interacting()&&(g.type=null,this.move(g)),this.pointerWasMoved&&Ve(this.coords.prev,this.coords.cur))}},{key:"move",value:function(c){c&&c.event||ht(this.coords.delta),(c=ce({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},c||{})).phase="move",this._doPhase(c)}},{key:"pointerUp",value:function(c,p,m,E){var I=this.getPointerIndex(c);I===-1&&(I=this.updatePointer(c,p,m,!1));var R=/cancel$/i.test(p.type)?"cancel":"up";this._scopeFire("interactions:".concat(R),{pointer:c,pointerIndex:I,pointerInfo:this.pointers[I],event:p,eventTarget:m,type:R,curEventTarget:E,interaction:this}),this.simulation||this.end(p),this.removePointer(c,p)}},{key:"documentBlur",value:function(c){this.end(c),this._scopeFire("interactions:blur",{event:c,type:"blur",interaction:this})}},{key:"end",value:function(c){var p;this._ending=!0,c=c||this._latestPointer.event,this.interacting()&&(p=this._doPhase({event:c,interaction:this,phase:"end"})),this._ending=!1,p===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(c){var p=st(c);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:bt(this.pointers,function(m){return m.id===p})}},{key:"getPointerInfo",value:function(c){return this.pointers[this.getPointerIndex(c)]}},{key:"updatePointer",value:function(c,p,m,E){var I,R,$,U=st(c),o=this.getPointerIndex(c),u=this.pointers[o];return E=E!==!1&&(E||/(down|start)$/i.test(p.type)),u?u.pointer=c:(u=new Ai(U,c,p,null,null),o=this.pointers.length,this.pointers.push(u)),ut(this.coords.cur,this.pointers.map(function(g){return g.pointer}),this._now()),I=this.coords.delta,R=this.coords.prev,$=this.coords.cur,I.page.x=$.page.x-R.page.x,I.page.y=$.page.y-R.page.y,I.client.x=$.client.x-R.client.x,I.client.y=$.client.y-R.client.y,I.timeStamp=$.timeStamp-R.timeStamp,E&&(this.pointerIsDown=!0,u.downTime=this.coords.cur.timeStamp,u.downTarget=m,at(this.downPointer,c),this.interacting()||(Ve(this.coords.start,this.coords.cur),Ve(this.coords.prev,this.coords.cur),this.downEvent=p,this.pointerWasMoved=!1)),this._updateLatestPointer(c,p,m),this._scopeFire("interactions:update-pointer",{pointer:c,event:p,eventTarget:m,down:E,pointerInfo:u,pointerIndex:o,interaction:this}),o}},{key:"removePointer",value:function(c,p){var m=this.getPointerIndex(c);if(m!==-1){var E=this.pointers[m];this._scopeFire("interactions:remove-pointer",{pointer:c,event:p,eventTarget:null,pointerIndex:m,pointerInfo:E,interaction:this}),this.pointers.splice(m,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(c,p,m){this._latestPointer.pointer=c,this._latestPointer.event=p,this._latestPointer.eventTarget=m}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(c,p,m,E){return new Xe(this,c,this.prepared.name,p,this.element,m,E)}},{key:"_fireEvent",value:function(c){var p;(p=this.interactable)==null||p.fire(c),(!this.prevEvent||c.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=c)}},{key:"_doPhase",value:function(c){var p=c.event,m=c.phase,E=c.preEnd,I=c.type,R=this.rect;if(R&&m==="move"&&(Le(this.edges,R,this.coords.delta[this.interactable.options.deltaSource]),R.width=R.right-R.left,R.height=R.bottom-R.top),this._scopeFire("interactions:before-action-".concat(m),c)===!1)return!1;var $=c.iEvent=this._createPreparedEvent(p,m,E,I);return this._scopeFire("interactions:action-".concat(m),c),m==="start"&&(this.prevEvent=$),this._fireEvent($),this._scopeFire("interactions:after-action-".concat(m),c),!0}},{key:"_now",value:function(){return Date.now()}}]),l}();function Er(l){dn(l.interaction)}function dn(l){if(!function(p){return!(!p.offset.pending.x&&!p.offset.pending.y)}(l))return!1;var c=l.offset.pending;return Xr(l.coords.cur,c),Xr(l.coords.delta,c),Le(l.edges,l.rect,c),c.x=0,c.y=0,!0}function ma(l){var c=l.x,p=l.y;this.offset.pending.x+=c,this.offset.pending.y+=p,this.offset.total.x+=c,this.offset.total.y+=p}function Xr(l,c){var p=l.page,m=l.client,E=c.x,I=c.y;p.x+=E,p.y+=I,m.x+=E,m.y+=I}va.offsetBy="";var lt={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(l){l.Interaction.prototype.offsetBy=ma},listeners:{"interactions:new":function(l){l.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(l){return function(c){c.pointerIsDown&&(Xr(c.coords.cur,c.offset.total),c.offset.pending.x=0,c.offset.pending.y=0)}(l.interaction)},"interactions:before-action-start":Er,"interactions:before-action-move":Er,"interactions:before-action-end":function(l){var c=l.interaction;if(dn(c))return c.move({offset:!0}),c.end(),!1},"interactions:stop":function(l){var c=l.interaction;c.offset.total.x=0,c.offset.total.y=0,c.offset.pending.x=0,c.offset.pending.y=0}}},Kt=lt,xr=function(){function l(c){a(this,l),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=c}return d(l,[{key:"start",value:function(c){var p=this.interaction,m=Cn(p);if(!m||!m.enabled)return!1;var E=p.coords.velocity.client,I=it(E.x,E.y),R=this.modification||(this.modification=new rr(p));if(R.copyFrom(p.modification),this.t0=p._now(),this.allowResume=m.allowResume,this.v0=I,this.currentOffset={x:0,y:0},this.startCoords=p.coords.cur.page,this.modifierArg=R.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-p.coords.cur.timeStamp<50&&I>m.minSpeed&&I>m.endSpeed)this.startInertia();else{if(R.result=R.setAll(this.modifierArg),!R.result.changed)return!1;this.startSmoothEnd()}return p.modification.result.rect=null,p.offsetBy(this.targetOffset),p._doPhase({interaction:p,event:c,phase:"inertiastart"}),p.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),p.modification.result.rect=null,this.active=!0,p.simulation=this,!0}},{key:"startInertia",value:function(){var c=this,p=this.interaction.coords.velocity.client,m=Cn(this.interaction),E=m.resistance,I=-Math.log(m.endSpeed/this.v0)/E;this.targetOffset={x:(p.x-I)/E,y:(p.y-I)/E},this.te=I,this.lambda_v0=E/this.v0,this.one_ve_v0=1-m.endSpeed/this.v0;var R=this.modification,$=this.modifierArg;$.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},R.result=R.setAll($),R.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+R.result.delta.x,y:this.targetOffset.y+R.result.delta.y}),this.onNextFrame(function(){return c.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var c=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return c.smoothEndTick()})}},{key:"onNextFrame",value:function(c){var p=this;this.timeout=Ot.request(function(){p.active&&c()})}},{key:"inertiaTick",value:function(){var c,p,m,E,I,R,$,U=this,o=this.interaction,u=Cn(o).resistance,g=(o._now()-this.t0)/1e3;if(g<this.te){var b,x=1-(Math.exp(-u*g)-this.lambda_v0)/this.one_ve_v0;this.isModified?(c=0,p=0,m=this.targetOffset.x,E=this.targetOffset.y,I=this.modifiedOffset.x,R=this.modifiedOffset.y,b={x:hn($=x,c,m,I),y:hn($,p,E,R)}):b={x:this.targetOffset.x*x,y:this.targetOffset.y*x};var C={x:b.x-this.currentOffset.x,y:b.y-this.currentOffset.y};this.currentOffset.x+=C.x,this.currentOffset.y+=C.y,o.offsetBy(C),o.move(),this.onNextFrame(function(){return U.inertiaTick()})}else o.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var c=this,p=this.interaction,m=p._now()-this.t0,E=Cn(p).smoothEndDuration;if(m<E){var I={x:ba(m,0,this.targetOffset.x,E),y:ba(m,0,this.targetOffset.y,E)},R={x:I.x-this.currentOffset.x,y:I.y-this.currentOffset.y};this.currentOffset.x+=R.x,this.currentOffset.y+=R.y,p.offsetBy(R),p.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return c.smoothEndTick()})}else p.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(c){var p=c.pointer,m=c.event,E=c.eventTarget,I=this.interaction;I.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),I.updatePointer(p,m,E,!0),I._doPhase({interaction:I,event:m,phase:"resume"}),Ve(I.coords.prev,I.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Ot.cancel(this.timeout)}}]),l}();function Cn(l){var c=l.interactable,p=l.prepared;return c&&c.options&&p.name&&c.options[p.name].inertia}var ki={id:"inertia",before:["modifiers","actions"],install:function(l){var c=l.defaults;l.usePlugin(Kt),l.usePlugin(Si),l.actions.phases.inertiastart=!0,l.actions.phases.resume=!0,c.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(l){var c=l.interaction;c.inertia=new xr(c)},"interactions:before-action-end":function(l){var c=l.interaction,p=l.event;return(!c._interacting||c.simulation||!c.inertia.start(p))&&null},"interactions:down":function(l){var c=l.interaction,p=l.eventTarget,m=c.inertia;if(m.active)for(var E=p;S.element(E);){if(E===c.element){m.resume(l);break}E=ne(E)}},"interactions:stop":function(l){var c=l.interaction.inertia;c.active&&c.stop()},"interactions:before-action-resume":function(l){var c=l.interaction.modification;c.stop(l),c.start(l,l.interaction.coords.cur.page),c.applyToInteraction(l)},"interactions:before-action-inertiastart":function(l){return l.interaction.modification.setAndApply(l)},"interactions:action-resume":ir,"interactions:action-inertiastart":ir,"interactions:after-action-inertiastart":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:after-action-resume":function(l){return l.interaction.modification.restoreInteractionCoords(l)}}};function hn(l,c,p,m){var E=1-l;return E*E*c+2*E*l*p+l*l*m}function ba(l,c,p,m){return-p*(l/=m)*(l-2)+c}var Qt=ki;function Vr(l,c){for(var p=0;p<c.length;p++){var m=c[p];if(l.immediatePropagationStopped)break;m(l)}}var Ci=function(){function l(c){a(this,l),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=ce({},c||{})}return d(l,[{key:"fire",value:function(c){var p,m=this.global;(p=this.types[c.type])&&Vr(c,p),!c.propagationStopped&&m&&(p=m[c.type])&&Vr(c,p)}},{key:"on",value:function(c,p){var m=fe(c,p);for(c in m)this.types[c]=ze(this.types[c]||[],m[c])}},{key:"off",value:function(c,p){var m=fe(c,p);for(c in m){var E=this.types[c];if(E&&E.length)for(var I=0,R=m[c];I<R.length;I++){var $=R[I],U=E.indexOf($);U!==-1&&E.splice(U,1)}}}},{key:"getRect",value:function(c){return null}}]),l}(),Di=function(){function l(c){a(this,l),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=c,at(this,c)}return d(l,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),l}();function fn(l){return S.object(l)?{capture:!!l.capture,passive:!!l.passive}:{capture:!!l,passive:!1}}function or(l,c){return l===c||(typeof l=="boolean"?!!c.capture===l&&!c.passive:!!l.capture==!!c.capture&&!!l.passive==!!c.passive)}var wa={id:"events",install:function(l){var c,p=[],m={},E=[],I={add:R,remove:$,addDelegate:function(u,g,b,x,C){var L=fn(C);if(!m[b]){m[b]=[];for(var B=0;B<E.length;B++){var H=E[B];R(H,b,U),R(H,b,o,!0)}}var V=m[b],J=St(V,function(Y){return Y.selector===u&&Y.context===g});J||(J={selector:u,context:g,listeners:[]},V.push(J)),J.listeners.push({func:x,options:L})},removeDelegate:function(u,g,b,x,C){var L,B=fn(C),H=m[b],V=!1;if(H)for(L=H.length-1;L>=0;L--){var J=H[L];if(J.selector===u&&J.context===g){for(var Y=J.listeners,te=Y.length-1;te>=0;te--){var Q=Y[te];if(Q.func===x&&or(Q.options,B)){Y.splice(te,1),Y.length||(H.splice(L,1),$(g,b,U),$(g,b,o,!0)),V=!0;break}}if(V)break}}},delegateListener:U,delegateUseCapture:o,delegatedEvents:m,documents:E,targets:p,supportsOptions:!1,supportsPassive:!1};function R(u,g,b,x){if(u.addEventListener){var C=fn(x),L=St(p,function(B){return B.eventTarget===u});L||(L={eventTarget:u,events:{}},p.push(L)),L.events[g]||(L.events[g]=[]),St(L.events[g],function(B){return B.func===b&&or(B.options,C)})||(u.addEventListener(g,b,I.supportsOptions?C:C.capture),L.events[g].push({func:b,options:C}))}}function $(u,g,b,x){if(u.addEventListener&&u.removeEventListener){var C=bt(p,function(ie){return ie.eventTarget===u}),L=p[C];if(L&&L.events)if(g!=="all"){var B=!1,H=L.events[g];if(H){if(b==="all"){for(var V=H.length-1;V>=0;V--){var J=H[V];$(u,g,J.func,J.options)}return}for(var Y=fn(x),te=0;te<H.length;te++){var Q=H[te];if(Q.func===b&&or(Q.options,Y)){u.removeEventListener(g,b,I.supportsOptions?Y:Y.capture),H.splice(te,1),H.length===0&&(delete L.events[g],B=!0);break}}}B&&!Object.keys(L.events).length&&p.splice(C,1)}else for(g in L.events)L.events.hasOwnProperty(g)&&$(u,g,"all")}}function U(u,g){for(var b=fn(g),x=new Di(u),C=m[u.type],L=Qn(u)[0],B=L;S.element(B);){for(var H=0;H<C.length;H++){var V=C[H],J=V.selector,Y=V.context;if(le(B,J)&&P(Y,L)&&P(Y,B)){var te=V.listeners;x.currentTarget=B;for(var Q=0;Q<te.length;Q++){var ie=te[Q];or(ie.options,b)&&ie.func(x)}}}B=ne(B)}}function o(u){return U(u,!0)}return(c=l.document)==null||c.createElement("div").addEventListener("test",null,{get capture(){return I.supportsOptions=!0},get passive(){return I.supportsPassive=!0}}),l.events=I,I}},Ii={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(l){for(var c=0,p=Ii.methodOrder;c<p.length;c++){var m=p[c],E=Ii[m](l);if(E)return E}return null},simulationResume:function(l){var c=l.pointerType,p=l.eventType,m=l.eventTarget,E=l.scope;if(!/down|start/i.test(p))return null;for(var I=0,R=E.interactions.list;I<R.length;I++){var $=R[I],U=m;if($.simulation&&$.simulation.allowResume&&$.pointerType===c)for(;U;){if(U===$.element)return $;U=ne(U)}}return null},mouseOrPen:function(l){var c,p=l.pointerId,m=l.pointerType,E=l.eventType,I=l.scope;if(m!=="mouse"&&m!=="pen")return null;for(var R=0,$=I.interactions.list;R<$.length;R++){var U=$[R];if(U.pointerType===m){if(U.simulation&&!sr(U,p))continue;if(U.interacting())return U;c||(c=U)}}if(c)return c;for(var o=0,u=I.interactions.list;o<u.length;o++){var g=u[o];if(!(g.pointerType!==m||/down/i.test(E)&&g.simulation))return g}return null},hasPointer:function(l){for(var c=l.pointerId,p=0,m=l.scope.interactions.list;p<m.length;p++){var E=m[p];if(sr(E,c))return E}return null},idle:function(l){for(var c=l.pointerType,p=0,m=l.scope.interactions.list;p<m.length;p++){var E=m[p];if(E.pointers.length===1){var I=E.interactable;if(I&&(!I.options.gesture||!I.options.gesture.enabled))continue}else if(E.pointers.length>=2)continue;if(!E.interacting()&&c===E.pointerType)return E}return null}};function sr(l,c){return l.pointers.some(function(p){return p.id===c})}var mo=Ii,Mi=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function _r(l,c){return function(p){var m=c.interactions.list,E=on(p),I=Qn(p),R=I[0],$=I[1],U=[];if(/^touch/.test(p.type)){c.prevTouchTime=c.now();for(var o=0,u=p.changedTouches;o<u.length;o++){var g=u[o],b={pointer:g,pointerId:st(g),pointerType:E,eventType:p.type,eventTarget:R,curEventTarget:$,scope:c},x=Sr(b);U.push([b.pointer,b.eventTarget,b.curEventTarget,x])}}else{var C=!1;if(!X.supportsPointerEvent&&/mouse/.test(p.type)){for(var L=0;L<m.length&&!C;L++)C=m[L].pointerType!=="mouse"&&m[L].pointerIsDown;C=C||c.now()-c.prevTouchTime<500||p.timeStamp===0}if(!C){var B={pointer:p,pointerId:st(p),pointerType:E,eventType:p.type,curEventTarget:$,eventTarget:R,scope:c},H=Sr(B);U.push([B.pointer,B.eventTarget,B.curEventTarget,H])}}for(var V=0;V<U.length;V++){var J=U[V],Y=J[0],te=J[1],Q=J[2];J[3][l](Y,p,te,Q)}}}function Sr(l){var c=l.pointerType,p=l.scope,m={interaction:mo.search(l),searchDetails:l};return p.fire("interactions:find",m),m.interaction||p.interactions.new({pointerType:c})}function Ar(l,c){var p=l.doc,m=l.scope,E=l.options,I=m.interactions.docEvents,R=m.events,$=R[c];for(var U in m.browser.isIOS&&!E.events&&(E.events={passive:!1}),R.delegatedEvents)$(p,U,R.delegateListener),$(p,U,R.delegateUseCapture,!0);for(var o=E&&E.events,u=0;u<I.length;u++){var g=I[u];$(p,g.type,g.listener,o)}}var bo={id:"core/interactions",install:function(l){for(var c={},p=0;p<Mi.length;p++){var m=Mi[p];c[m]=_r(m,l)}var E,I=X.pEventTypes;function R(){for(var $=0,U=l.interactions.list;$<U.length;$++){var o=U[$];if(o.pointerIsDown&&o.pointerType==="touch"&&!o._interacting)for(var u=function(){var x=b[g];l.documents.some(function(C){return P(C.doc,x.downTarget)})||o.removePointer(x.pointer,x.event)},g=0,b=o.pointers;g<b.length;g++)u()}}(E=ve.PointerEvent?[{type:I.down,listener:R},{type:I.down,listener:c.pointerDown},{type:I.move,listener:c.pointerMove},{type:I.up,listener:c.pointerUp},{type:I.cancel,listener:c.pointerUp}]:[{type:"mousedown",listener:c.pointerDown},{type:"mousemove",listener:c.pointerMove},{type:"mouseup",listener:c.pointerUp},{type:"touchstart",listener:R},{type:"touchstart",listener:c.pointerDown},{type:"touchmove",listener:c.pointerMove},{type:"touchend",listener:c.pointerUp},{type:"touchcancel",listener:c.pointerUp}]).push({type:"blur",listener:function($){for(var U=0,o=l.interactions.list;U<o.length;U++)o[U].documentBlur($)}}),l.prevTouchTime=0,l.Interaction=function($){h(o,$);var U=_(o);function o(){return a(this,o),U.apply(this,arguments)}return d(o,[{key:"pointerMoveTolerance",get:function(){return l.interactions.pointerMoveTolerance},set:function(u){l.interactions.pointerMoveTolerance=u}},{key:"_now",value:function(){return l.now()}}]),o}(ar),l.interactions={list:[],new:function($){$.scopeFire=function(o,u){return l.fire(o,u)};var U=new l.Interaction($);return l.interactions.list.push(U),U},listeners:c,docEvents:E,pointerMoveTolerance:1},l.usePlugin(Fn)},listeners:{"scope:add-document":function(l){return Ar(l,"add")},"scope:remove-document":function(l){return Ar(l,"remove")},"interactable:unset":function(l,c){for(var p=l.interactable,m=c.interactions.list.length-1;m>=0;m--){var E=c.interactions.list[m];E.interactable===p&&(E.stop(),c.fire("interactions:destroy",{interaction:E}),E.destroy(),c.interactions.list.length>2&&c.interactions.list.splice(m,1))}}},onDocSignal:Ar,doOnInteractions:_r,methodNames:Mi},wo=bo,Dn=function(l){return l[l.On=0]="On",l[l.Off=1]="Off",l}(Dn||{}),Pi=function(){function l(c,p,m,E){a(this,l),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new Ci,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=p.actions,this.target=c,this._context=p.context||m,this._win=A(qe(c)?this._context:c),this._doc=this._win.document,this._scopeEvents=E,this.set(p)}return d(l,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(c,p){return S.func(p.onstart)&&this.on("".concat(c,"start"),p.onstart),S.func(p.onmove)&&this.on("".concat(c,"move"),p.onmove),S.func(p.onend)&&this.on("".concat(c,"end"),p.onend),S.func(p.oninertiastart)&&this.on("".concat(c,"inertiastart"),p.oninertiastart),this}},{key:"updatePerActionListeners",value:function(c,p,m){var E,I=this,R=(E=this._actions.map[c])==null?void 0:E.filterEventType,$=function(U){return(R==null||R(U))&&nr(U,I._actions)};(S.array(p)||S.object(p))&&this._onOff(Dn.Off,c,p,void 0,$),(S.array(m)||S.object(m))&&this._onOff(Dn.On,c,m,void 0,$)}},{key:"setPerAction",value:function(c,p){var m=this._defaults;for(var E in p){var I=E,R=this.options[c],$=p[I];I==="listeners"&&this.updatePerActionListeners(c,R.listeners,$),S.array($)?R[I]=_n($):S.plainObject($)?(R[I]=ce(R[I]||{},kn($)),S.object(m.perAction[I])&&"enabled"in m.perAction[I]&&(R[I].enabled=$.enabled!==!1)):S.bool($)&&S.object(m.perAction[I])?R[I].enabled=$:R[I]=$}}},{key:"getRect",value:function(c){return c=c||(S.element(this.target)?this.target:null),S.string(this.target)&&(c=c||this._context.querySelector(this.target)),Me(c)}},{key:"rectChecker",value:function(c){var p=this;return S.func(c)?(this.getRect=function(m){var E=ce({},c.apply(p,m));return"width"in E||(E.width=E.right-E.left,E.height=E.bottom-E.top),E},this):c===null?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(c,p){if(qe(p)||S.object(p)){for(var m in this.options[c]=p,this._actions.map)this.options[m][c]=p;return this}return this.options[c]}},{key:"origin",value:function(c){return this._backCompatOption("origin",c)}},{key:"deltaSource",value:function(c){return c==="page"||c==="client"?(this.options.deltaSource=c,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var c=this.target;return S.string(c)?Array.from(this._context.querySelectorAll(c)):S.func(c)&&c.getAllElements?c.getAllElements():S.element(c)?[c]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(c){return this._context===c.ownerDocument||P(this._context,c)}},{key:"testIgnoreAllow",value:function(c,p,m){return!this.testIgnore(c.ignoreFrom,p,m)&&this.testAllow(c.allowFrom,p,m)}},{key:"testAllow",value:function(c,p,m){return!c||!!S.element(m)&&(S.string(c)?ue(m,c,p):!!S.element(c)&&P(c,m))}},{key:"testIgnore",value:function(c,p,m){return!(!c||!S.element(m))&&(S.string(c)?ue(m,c,p):!!S.element(c)&&P(c,m))}},{key:"fire",value:function(c){return this.events.fire(c),this}},{key:"_onOff",value:function(c,p,m,E,I){S.object(p)&&!S.array(p)&&(E=m,m=null);var R=fe(p,m,I);for(var $ in R){$==="wheel"&&($=X.wheelEvent);for(var U=0,o=R[$];U<o.length;U++){var u=o[U];nr($,this._actions)?this.events[c===Dn.On?"on":"off"]($,u):S.string(this.target)?this._scopeEvents[c===Dn.On?"addDelegate":"removeDelegate"](this.target,this._context,$,u,E):this._scopeEvents[c===Dn.On?"add":"remove"](this.target,$,u,E)}}return this}},{key:"on",value:function(c,p,m){return this._onOff(Dn.On,c,p,m)}},{key:"off",value:function(c,p,m){return this._onOff(Dn.Off,c,p,m)}},{key:"set",value:function(c){var p=this._defaults;for(var m in S.object(c)||(c={}),this.options=kn(p.base),this._actions.methodDict){var E=m,I=this._actions.methodDict[E];this.options[E]={},this.setPerAction(E,ce(ce({},p.perAction),p.actions[E])),this[I](c[E])}for(var R in c)R!=="getRect"?S.func(this[R])&&this[R](c[R]):this.rectChecker(c.getRect);return this}},{key:"unset",value:function(){if(S.string(this.target))for(var c in this._scopeEvents.delegatedEvents)for(var p=this._scopeEvents.delegatedEvents[c],m=p.length-1;m>=0;m--){var E=p[m],I=E.selector,R=E.context,$=E.listeners;I===this.target&&R===this._context&&p.splice(m,1);for(var U=$.length-1;U>=0;U--)this._scopeEvents.removeDelegate(this.target,this._context,c,$[U][0],$[U][1])}else this._scopeEvents.remove(this.target,"all")}}]),l}(),Ni=function(){function l(c){var p=this;a(this,l),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=c,c.addListeners({"interactable:unset":function(m){var E=m.interactable,I=E.target,R=S.string(I)?p.selectorMap[I]:I[p.scope.id],$=bt(R,function(U){return U===E});R.splice($,1)}})}return d(l,[{key:"new",value:function(c,p){p=ce(p||{},{actions:this.scope.actions});var m=new this.scope.Interactable(c,p,this.scope.document,this.scope.events);return this.scope.addDocument(m._doc),this.list.push(m),S.string(c)?(this.selectorMap[c]||(this.selectorMap[c]=[]),this.selectorMap[c].push(m)):(m.target[this.scope.id]||Object.defineProperty(c,this.scope.id,{value:[],configurable:!0}),c[this.scope.id].push(m)),this.scope.fire("interactable:new",{target:c,options:p,interactable:m,win:this.scope._win}),m}},{key:"getExisting",value:function(c,p){var m=p&&p.context||this.scope.document,E=S.string(c),I=E?this.selectorMap[c]:c[this.scope.id];if(I)return St(I,function(R){return R._context===m&&(E||R.inContext(c))})}},{key:"forEachMatch",value:function(c,p){for(var m=0,E=this.list;m<E.length;m++){var I=E[m],R=void 0;if((S.string(I.target)?S.element(c)&&le(c,I.target):c===I.target)&&I.inContext(c)&&(R=p(I)),R!==void 0)return R}}}]),l}(),Ea=function(){function l(){var c=this;a(this,l),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=X,this.defaults=kn(ya),this.Eventable=Ci,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(m){var E=function I(R,$){var U=m.interactables.getExisting(R,$);return U||((U=m.interactables.new(R,$)).events.global=I.globalEvents),U};return E.getPointerAverage=nt,E.getTouchBBox=_t,E.getTouchDistance=mt,E.getTouchAngle=Pt,E.getElementRect=Me,E.getElementClientRect=_e,E.matchesSelector=le,E.closest=ee,E.globalEvents={},E.version="1.10.27",E.scope=m,E.use=function(I,R){return this.scope.usePlugin(I,R),this},E.isSet=function(I,R){return!!this.scope.interactables.get(I,R&&R.context)},E.on=Bt(function(I,R,$){if(S.string(I)&&I.search(" ")!==-1&&(I=I.trim().split(/ +/)),S.array(I)){for(var U=0,o=I;U<o.length;U++){var u=o[U];this.on(u,R,$)}return this}if(S.object(I)){for(var g in I)this.on(g,I[g],R);return this}return nr(I,this.scope.actions)?this.globalEvents[I]?this.globalEvents[I].push(R):this.globalEvents[I]=[R]:this.scope.events.add(this.scope.document,I,R,{options:$}),this},"The interact.on() method is being deprecated"),E.off=Bt(function(I,R,$){if(S.string(I)&&I.search(" ")!==-1&&(I=I.trim().split(/ +/)),S.array(I)){for(var U=0,o=I;U<o.length;U++){var u=o[U];this.off(u,R,$)}return this}if(S.object(I)){for(var g in I)this.off(g,I[g],R);return this}var b;return nr(I,this.scope.actions)?I in this.globalEvents&&(b=this.globalEvents[I].indexOf(R))!==-1&&this.globalEvents[I].splice(b,1):this.scope.events.remove(this.scope.document,I,R,$),this},"The interact.off() method is being deprecated"),E.debug=function(){return this.scope},E.supportsTouch=function(){return X.supportsTouch},E.supportsPointerEvent=function(){return X.supportsPointerEvent},E.stop=function(){for(var I=0,R=this.scope.interactions.list;I<R.length;I++)R[I].stop();return this},E.pointerMoveTolerance=function(I){return S.number(I)?(this.scope.interactions.pointerMoveTolerance=I,this):this.scope.interactions.pointerMoveTolerance},E.addDocument=function(I,R){this.scope.addDocument(I,R)},E.removeDocument=function(I){this.scope.removeDocument(I)},E}(this),this.InteractEvent=Xe,this.Interactable=void 0,this.interactables=new Ni(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(m){return c.removeDocument(m.target)};var p=this;this.Interactable=function(m){h(I,m);var E=_(I);function I(){return a(this,I),E.apply(this,arguments)}return d(I,[{key:"_defaults",get:function(){return p.defaults}},{key:"set",value:function(R){return D(y(I.prototype),"set",this).call(this,R),p.fire("interactable:set",{options:R,interactable:this}),this}},{key:"unset",value:function(){D(y(I.prototype),"unset",this).call(this);var R=p.interactables.list.indexOf(this);R<0||(p.interactables.list.splice(R,1),p.fire("interactable:unset",{interactable:this}))}}]),I}(Pi)}return d(l,[{key:"addListeners",value:function(c,p){this.listenerMaps.push({id:p,map:c})}},{key:"fire",value:function(c,p){for(var m=0,E=this.listenerMaps;m<E.length;m++){var I=E[m].map[c];if(I&&I(p,this,c)===!1)return!1}}},{key:"init",value:function(c){return this.isInitialized?this:function(p,m){return p.isInitialized=!0,S.window(m)&&z(m),ve.init(m),X.init(m),Ot.init(m),p.window=m,p.document=m.document,p.usePlugin(wo),p.usePlugin(wa),p}(this,c)}},{key:"pluginIsInstalled",value:function(c){var p=c.id;return p?!!this._plugins.map[p]:this._plugins.list.indexOf(c)!==-1}},{key:"usePlugin",value:function(c,p){if(!this.isInitialized)return this;if(this.pluginIsInstalled(c))return this;if(c.id&&(this._plugins.map[c.id]=c),this._plugins.list.push(c),c.install&&c.install(this,p),c.listeners&&c.before){for(var m=0,E=this.listenerMaps.length,I=c.before.reduce(function($,U){return $[U]=!0,$[kr(U)]=!0,$},{});m<E;m++){var R=this.listenerMaps[m].id;if(R&&(I[R]||I[kr(R)]))break}this.listenerMaps.splice(m,0,{id:c.id,map:c.listeners})}else c.listeners&&this.listenerMaps.push({id:c.id,map:c.listeners});return this}},{key:"addDocument",value:function(c,p){if(this.getDocIndex(c)!==-1)return!1;var m=A(c);p=p?ce({},p):{},this.documents.push({doc:c,options:p}),this.events.documents.push(c),c!==this.document&&this.events.add(m,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:c,window:m,scope:this,options:p})}},{key:"removeDocument",value:function(c){var p=this.getDocIndex(c),m=A(c),E=this.documents[p].options;this.events.remove(m,"unload",this.onWindowUnload),this.documents.splice(p,1),this.events.documents.splice(p,1),this.fire("scope:remove-document",{doc:c,window:m,scope:this,options:E})}},{key:"getDocIndex",value:function(c){for(var p=0;p<this.documents.length;p++)if(this.documents[p].doc===c)return p;return-1}},{key:"getDocOptions",value:function(c){var p=this.getDocIndex(c);return p===-1?null:this.documents[p].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),l}();function kr(l){return l&&l.replace(/\/.*$/,"")}var Cr=new Ea,dt=Cr.interactStatic,xa=typeof globalThis<"u"?globalThis:window;Cr.init(xa);var Eo=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(l){var c=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(m){var E=m[0],I=m[1];return E in l||I in l}),p=function(m,E){for(var I=l.range,R=l.limits,$=R===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:R,U=l.offset,o=U===void 0?{x:0,y:0}:U,u={range:I,grid:l,x:null,y:null},g=0;g<c.length;g++){var b=c[g],x=b[0],C=b[1],L=Math.round((m-o.x)/l[x]),B=Math.round((E-o.y)/l[C]);u[x]=Math.max($.left,Math.min($.right,L*l[x]+o.x)),u[C]=Math.max($.top,Math.min($.bottom,B*l[C]+o.y))}return u};return p.grid=l,p.coordFields=c,p}}),Qr={id:"snappers",install:function(l){var c=l.interactStatic;c.snappers=ce(c.snappers||{},Eo),c.createSnapGrid=c.snappers.grid}},Oi=Qr,Ti={start:function(l){var c=l.state,p=l.rect,m=l.edges,E=l.pageCoords,I=c.options,R=I.ratio,$=I.enabled,U=c.options,o=U.equalDelta,u=U.modifiers;R==="preserve"&&(R=p.width/p.height),c.startCoords=ce({},E),c.startRect=ce({},p),c.ratio=R,c.equalDelta=o;var g=c.linkedEdges={top:m.top||m.left&&!m.bottom,left:m.left||m.top&&!m.right,bottom:m.bottom||m.right&&!m.top,right:m.right||m.bottom&&!m.left};if(c.xIsPrimaryAxis=!(!m.left&&!m.right),c.equalDelta){var b=(g.left?1:-1)*(g.top?1:-1);c.edgeSign={x:b,y:b}}else c.edgeSign={x:g.left?-1:1,y:g.top?-1:1};if($!==!1&&ce(m,g),u!=null&&u.length){var x=new rr(l.interaction);x.copyFrom(l.interaction.modification),x.prepareStates(u),c.subModification=x,x.startAll(n({},l))}},set:function(l){var c=l.state,p=l.rect,m=l.coords,E=c.linkedEdges,I=ce({},m),R=c.equalDelta?Ri:Li;if(ce(l.edges,E),R(c,c.xIsPrimaryAxis,m,p),!c.subModification)return null;var $=ce({},p);Le(E,$,{x:m.x-I.x,y:m.y-I.y});var U=c.subModification.setAll(n(n({},l),{},{rect:$,edges:E,pageCoords:m,prevCoords:m,prevRect:$})),o=U.delta;return U.changed&&(R(c,Math.abs(o.x)>Math.abs(o.y),U.coords,U.rect),ce(m,U.coords)),U.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function Ri(l,c,p){var m=l.startCoords,E=l.edgeSign;c?p.y=m.y+(p.x-m.x)*E.y:p.x=m.x+(p.y-m.y)*E.x}function Li(l,c,p,m){var E=l.startRect,I=l.startCoords,R=l.ratio,$=l.edgeSign;if(c){var U=m.width/R;p.y=I.y+(U-E.height)*$.y}else{var o=m.height*R;p.x=I.x+(o-E.width)*$.x}}var yt=Ut(Ti,"aspectRatio"),ur=function(){};ur._defaults={};var In=ur;function Mn(l,c,p){return S.func(l)?Re(l,c.interactable,c.element,[p.x,p.y,c]):Re(l,c.interactable,c.element)}var jn={start:function(l){var c=l.rect,p=l.startOffset,m=l.state,E=l.interaction,I=l.pageCoords,R=m.options,$=R.elementRect,U=ce({left:0,top:0,right:0,bottom:0},R.offset||{});if(c&&$){var o=Mn(R.restriction,E,I);if(o){var u=o.right-o.left-c.width,g=o.bottom-o.top-c.height;u<0&&(U.left+=u,U.right+=u),g<0&&(U.top+=g,U.bottom+=g)}U.left+=p.left-c.width*$.left,U.top+=p.top-c.height*$.top,U.right+=p.right-c.width*(1-$.right),U.bottom+=p.bottom-c.height*(1-$.bottom)}m.offset=U},set:function(l){var c=l.coords,p=l.interaction,m=l.state,E=m.options,I=m.offset,R=Mn(E.restriction,p,c);if(R){var $=function(U){return!U||"left"in U&&"top"in U||((U=ce({},U)).left=U.x||0,U.top=U.y||0,U.right=U.right||U.left+U.width,U.bottom=U.bottom||U.top+U.height),U}(R);c.x=Math.max(Math.min($.right-I.right,c.x),$.left+I.left),c.y=Math.max(Math.min($.bottom-I.bottom,c.y),$.top+I.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},_a=Ut(jn,"restrict"),zi={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Dr={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function Zr(l,c){for(var p=0,m=["top","left","bottom","right"];p<m.length;p++){var E=m[p];E in l||(l[E]=c[E])}return l}var Wt={noInner:zi,noOuter:Dr,start:function(l){var c,p=l.interaction,m=l.startOffset,E=l.state,I=E.options;I&&(c=ke(Mn(I.offset,p,p.coords.start.page))),c=c||{x:0,y:0},E.offset={top:c.y+m.top,left:c.x+m.left,bottom:c.y-m.bottom,right:c.x-m.right}},set:function(l){var c=l.coords,p=l.edges,m=l.interaction,E=l.state,I=E.offset,R=E.options;if(p){var $=ce({},c),U=Mn(R.inner,m,$)||{},o=Mn(R.outer,m,$)||{};Zr(U,zi),Zr(o,Dr),p.top?c.y=Math.min(Math.max(o.top+I.top,$.y),U.top+I.top):p.bottom&&(c.y=Math.max(Math.min(o.bottom+I.bottom,$.y),U.bottom+I.bottom)),p.left?c.x=Math.min(Math.max(o.left+I.left,$.x),U.left+I.left):p.right&&(c.x=Math.max(Math.min(o.right+I.right,$.x),U.right+I.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},$i=Ut(Wt,"restrictEdges"),Gi=ce({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(l){}},jn.defaults),Jr=Ut({start:jn.start,set:jn.set,defaults:Gi},"restrictRect"),qi={width:-1/0,height:-1/0},Sa={width:1/0,height:1/0},xo=Ut({start:function(l){return Wt.start(l)},set:function(l){var c=l.interaction,p=l.state,m=l.rect,E=l.edges,I=p.options;if(E){var R=Ke(Mn(I.min,c,l.coords))||qi,$=Ke(Mn(I.max,c,l.coords))||Sa;p.options={endOnly:I.endOnly,inner:ce({},Wt.noInner),outer:ce({},Wt.noOuter)},E.top?(p.options.inner.top=m.bottom-R.height,p.options.outer.top=m.bottom-$.height):E.bottom&&(p.options.inner.bottom=m.top+R.height,p.options.outer.bottom=m.top+$.height),E.left?(p.options.inner.left=m.right-R.width,p.options.outer.left=m.right-$.width):E.right&&(p.options.inner.right=m.left+R.width,p.options.outer.right=m.left+$.width),Wt.set(l),p.options=I}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Ir={start:function(l){var c,p=l.interaction,m=l.interactable,E=l.element,I=l.rect,R=l.state,$=l.startOffset,U=R.options,o=U.offsetWithOrigin?function(b){var x=b.interaction.element,C=ke(Re(b.state.options.origin,null,null,[x])),L=C||Ee(b.interactable,x,b.interaction.prepared.name);return L}(l):{x:0,y:0};if(U.offset==="startCoords")c={x:p.coords.start.page.x,y:p.coords.start.page.y};else{var u=Re(U.offset,m,E,[p]);(c=ke(u)||{x:0,y:0}).x+=o.x,c.y+=o.y}var g=U.relativePoints;R.offsets=I&&g&&g.length?g.map(function(b,x){return{index:x,relativePoint:b,x:$.left-I.width*b.x+c.x,y:$.top-I.height*b.y+c.y}}):[{index:0,relativePoint:null,x:c.x,y:c.y}]},set:function(l){var c=l.interaction,p=l.coords,m=l.state,E=m.options,I=m.offsets,R=Ee(c.interactable,c.element,c.prepared.name),$=ce({},p),U=[];E.offsetWithOrigin||($.x-=R.x,$.y-=R.y);for(var o=0,u=I;o<u.length;o++)for(var g=u[o],b=$.x-g.x,x=$.y-g.y,C=0,L=E.targets.length;C<L;C++){var B=E.targets[C],H=void 0;(H=S.func(B)?B(b,x,c._proxy,g,C):B)&&U.push({x:(S.number(H.x)?H.x:b)+g.x,y:(S.number(H.y)?H.y:x)+g.y,range:S.number(H.range)?H.range:E.range,source:B,index:C,offset:g})}for(var V={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},J=0;J<U.length;J++){var Y=U[J],te=Y.range,Q=Y.x-$.x,ie=Y.y-$.y,ae=it(Q,ie),re=ae<=te;te===1/0&&V.inRange&&V.range!==1/0&&(re=!1),V.target&&!(re?V.inRange&&te!==1/0?ae/te<V.distance/V.range:te===1/0&&V.range!==1/0||ae<V.distance:!V.inRange&&ae<V.distance)||(V.target=Y,V.distance=ae,V.range=te,V.inRange=re,V.delta.x=Q,V.delta.y=ie)}return V.inRange&&(p.x=V.target.x,p.y=V.target.y),m.closest=V,V},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},ei=Ut(Ir,"snap"),ti={start:function(l){var c=l.state,p=l.edges,m=c.options;if(!p)return null;l.state={options:{targets:null,relativePoints:[{x:p.left?0:1,y:p.top?0:1}],offset:m.offset||"self",origin:{x:0,y:0},range:m.range}},c.targetFields=c.targetFields||[["width","height"],["x","y"]],Ir.start(l),c.offsets=l.state.offsets,l.state=c},set:function(l){var c=l.interaction,p=l.state,m=l.coords,E=p.options,I=p.offsets,R={x:m.x-I[0].x,y:m.y-I[0].y};p.options=ce({},E),p.options.targets=[];for(var $=0,U=E.targets||[];$<U.length;$++){var o=U[$],u=void 0;if(u=S.func(o)?o(R.x,R.y,c):o){for(var g=0,b=p.targetFields;g<b.length;g++){var x=b[g],C=x[0],L=x[1];if(C in u||L in u){u.x=u[C],u.y=u[L];break}}p.options.targets.push(u)}}var B=Ir.set(l);return p.options=E,B},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},Fi=Ut(ti,"snapSize"),Mr={aspectRatio:yt,restrictEdges:$i,restrict:_a,restrictRect:Jr,restrictSize:xo,snapEdges:Ut({start:function(l){var c=l.edges;return c?(l.state.targetFields=l.state.targetFields||[[c.left?"left":"right",c.top?"top":"bottom"]],ti.start(l)):null},set:ti.set,defaults:ce(kn(ti.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:ei,snapSize:Fi,spring:In,avoid:In,transform:In,rubberband:In},_o={id:"modifiers",install:function(l){var c=l.interactStatic;for(var p in l.usePlugin(Si),l.usePlugin(Oi),c.modifiers=Mr,Mr){var m=Mr[p],E=m._defaults,I=m._methods;E._methods=I,l.defaults.perAction[p]=E}}},Aa=_o,ka=function(l){h(p,l);var c=_(p);function p(m,E,I,R,$,U){var o;if(a(this,p),at(w(o=c.call(this,$)),I),I!==E&&at(w(o),E),o.timeStamp=U,o.originalEvent=I,o.type=m,o.pointerId=st(E),o.pointerType=on(E),o.target=R,o.currentTarget=null,m==="tap"){var u=$.getPointerIndex(E);o.dt=o.timeStamp-$.pointers[u].downTime;var g=o.timeStamp-$.tapTime;o.double=!!$.prevTap&&$.prevTap.type!=="doubletap"&&$.prevTap.target===o.target&&g<500}else m==="doubletap"&&(o.dt=E.timeStamp-$.tapTime,o.double=!0);return o}return d(p,[{key:"_subtractOrigin",value:function(m){var E=m.x,I=m.y;return this.pageX-=E,this.pageY-=I,this.clientX-=E,this.clientY-=I,this}},{key:"_addOrigin",value:function(m){var E=m.x,I=m.y;return this.pageX+=E,this.pageY+=I,this.clientX+=E,this.clientY+=I,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),p}(Nt),cr={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(l){l.pointerEvents=cr,l.defaults.actions.pointerEvents=cr.defaults,ce(l.actions.phaselessTypes,cr.types)},listeners:{"interactions:new":function(l){var c=l.interaction;c.prevTap=null,c.tapTime=0},"interactions:update-pointer":function(l){var c=l.down,p=l.pointerInfo;!c&&p.hold||(p.hold={duration:1/0,timeout:null})},"interactions:move":function(l,c){var p=l.interaction,m=l.pointer,E=l.event,I=l.eventTarget;l.duplicate||p.pointerIsDown&&!p.pointerWasMoved||(p.pointerIsDown&&ni(l),pn({interaction:p,pointer:m,event:E,eventTarget:I,type:"move"},c))},"interactions:down":function(l,c){(function(p,m){for(var E=p.interaction,I=p.pointer,R=p.event,$=p.eventTarget,U=p.pointerIndex,o=E.pointers[U].hold,u=Oe($),g={interaction:E,pointer:I,event:R,eventTarget:$,type:"hold",targets:[],path:u,node:null},b=0;b<u.length;b++){var x=u[b];g.node=x,m.fire("pointerEvents:collect-targets",g)}if(g.targets.length){for(var C=1/0,L=0,B=g.targets;L<B.length;L++){var H=B[L].eventable.options.holdDuration;H<C&&(C=H)}o.duration=C,o.timeout=setTimeout(function(){pn({interaction:E,eventTarget:$,pointer:I,event:R,type:"hold"},m)},C)}})(l,c),pn(l,c)},"interactions:up":function(l,c){ni(l),pn(l,c),function(p,m){var E=p.interaction,I=p.pointer,R=p.event,$=p.eventTarget;E.pointerWasMoved||pn({interaction:E,eventTarget:$,pointer:I,event:R,type:"tap"},m)}(l,c)},"interactions:cancel":function(l,c){ni(l),pn(l,c)}},PointerEvent:ka,fire:pn,collectEventTargets:Ca,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function pn(l,c){var p=l.interaction,m=l.pointer,E=l.event,I=l.eventTarget,R=l.type,$=l.targets,U=$===void 0?Ca(l,c):$,o=new ka(R,m,E,I,p,c.now());c.fire("pointerEvents:new",{pointerEvent:o});for(var u={interaction:p,pointer:m,event:E,eventTarget:I,targets:U,type:R,pointerEvent:o},g=0;g<U.length;g++){var b=U[g];for(var x in b.props||{})o[x]=b.props[x];var C=Ee(b.eventable,b.node);if(o._subtractOrigin(C),o.eventable=b.eventable,o.currentTarget=b.node,b.eventable.fire(o),o._addOrigin(C),o.immediatePropagationStopped||o.propagationStopped&&g+1<U.length&&U[g+1].node!==o.currentTarget)break}if(c.fire("pointerEvents:fired",u),R==="tap"){var L=o.double?pn({interaction:p,pointer:m,event:E,eventTarget:I,type:"doubletap"},c):o;p.prevTap=L,p.tapTime=L.timeStamp}return o}function Ca(l,c){var p=l.interaction,m=l.pointer,E=l.event,I=l.eventTarget,R=l.type,$=p.getPointerIndex(m),U=p.pointers[$];if(R==="tap"&&(p.pointerWasMoved||!U||U.downTarget!==I))return[];for(var o=Oe(I),u={interaction:p,pointer:m,event:E,eventTarget:I,type:R,path:o,targets:[],node:null},g=0;g<o.length;g++){var b=o[g];u.node=b,c.fire("pointerEvents:collect-targets",u)}return R==="hold"&&(u.targets=u.targets.filter(function(x){var C,L;return x.eventable.options.holdDuration===((C=p.pointers[$])==null||(L=C.hold)==null?void 0:L.duration)})),u.targets}function ni(l){var c=l.interaction,p=l.pointerIndex,m=c.pointers[p].hold;m&&m.timeout&&(clearTimeout(m.timeout),m.timeout=null)}var ji=Object.freeze({__proto__:null,default:cr});function Da(l){var c=l.interaction;c.holdIntervalHandle&&(clearInterval(c.holdIntervalHandle),c.holdIntervalHandle=null)}var Ia={id:"pointer-events/holdRepeat",install:function(l){l.usePlugin(cr);var c=l.pointerEvents;c.defaults.holdRepeatInterval=0,c.types.holdrepeat=l.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(l,c){return l["pointerEvents:".concat(c)]=Da,l},{"pointerEvents:new":function(l){var c=l.pointerEvent;c.type==="hold"&&(c.count=(c.count||0)+1)},"pointerEvents:fired":function(l,c){var p=l.interaction,m=l.pointerEvent,E=l.eventTarget,I=l.targets;if(m.type==="hold"&&I.length){var R=I[0].eventable.options.holdRepeatInterval;R<=0||(p.holdIntervalHandle=setTimeout(function(){c.pointerEvents.fire({interaction:p,eventTarget:E,type:"hold",pointer:m,event:m},c)},R))}}})},So=Ia,Ao={id:"pointer-events/interactableTargets",install:function(l){var c=l.Interactable;c.prototype.pointerEvents=function(m){return ce(this.events.options,m),this};var p=c.prototype._backCompatOption;c.prototype._backCompatOption=function(m,E){var I=p.call(this,m,E);return I===this&&(this.events.options[m]=E),I}},listeners:{"pointerEvents:collect-targets":function(l,c){var p=l.targets,m=l.node,E=l.type,I=l.eventTarget;c.interactables.forEachMatch(m,function(R){var $=R.events,U=$.options;$.types[E]&&$.types[E].length&&R.testIgnoreAllow(U,m,I)&&p.push({node:m,eventable:$,props:{interactable:R}})})},"interactable:new":function(l){var c=l.interactable;c.events.getRect=function(p){return c.getRect(p)}},"interactable:set":function(l,c){var p=l.interactable,m=l.options;ce(p.events.options,c.pointerEvents.defaults),ce(p.events.options,m.pointerEvents||{})}}},ko=Ao,ri={id:"pointer-events",install:function(l){l.usePlugin(ji),l.usePlugin(So),l.usePlugin(ko)}},gn=ri,tt={id:"reflow",install:function(l){var c=l.Interactable;l.actions.phases.reflow=!0,c.prototype.reflow=function(p){return function(m,E,I){for(var R=m.getAllElements(),$=I.window.Promise,U=$?[]:null,o=function(){var g=R[u],b=m.getRect(g);if(!b)return 1;var x,C=St(I.interactions.list,function(H){return H.interacting()&&H.interactable===m&&H.element===g&&H.prepared.name===E.name});if(C)C.move(),U&&(x=C._reflowPromise||new $(function(H){C._reflowResolve=H}));else{var L=Ke(b),B=function(H){return{coords:H,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:L.x,y:L.y},client:{x:L.x,y:L.y},timeStamp:I.now()});x=function(H,V,J,Y,te){var Q=H.interactions.new({pointerType:"reflow"}),ie={interaction:Q,event:te,pointer:te,eventTarget:J,phase:"reflow"};Q.interactable=V,Q.element=J,Q.prevEvent=te,Q.updatePointer(te,te,J,!0),ht(Q.coords.delta),Ur(Q.prepared,Y),Q._doPhase(ie);var ae=H.window,re=ae.Promise,se=re?new re(function(de){Q._reflowResolve=de}):void 0;return Q._reflowPromise=se,Q.start(Y,V,J),Q._interacting?(Q.move(ie),Q.end(te)):(Q.stop(),Q._reflowResolve()),Q.removePointer(te,te),se}(I,m,g,E,B)}U&&U.push(x)},u=0;u<R.length&&!o();u++);return U&&$.all(U).then(function(){return m})}(this,p,l)}},listeners:{"interactions:stop":function(l,c){var p=l.interaction;p.pointerType==="reflow"&&(p._reflowResolve&&p._reflowResolve(),function(m,E){m.splice(m.indexOf(E),1)}(c.interactions.list,p))}}},ii=tt;if(dt.use(Fn),dt.use(Kt),dt.use(gn),dt.use(Qt),dt.use(Aa),dt.use(Ze),dt.use(yo),dt.use(ha),dt.use(ii),dt.default=dt,i(r)==="object"&&r)try{r.exports=dt}catch{}return dt.default=dt,dt})}(Ji,Ji.exports)),Ji.exports}var ew=Jb();const tw=Mt(ew),en=document;class nw{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.metric=new Uh(e),this.panels={info:en.getElementById("floating-panel"),tools:en.getElementById("tools-panel"),graphs:en.getElementById("graphs-panel"),faces:en.getElementById("face-panel")},this.handles={info:"#info",tools:"#tools",graphs:"#graphs",faces:"#faces"},this.addEventListeners(),this.makePanelsDraggable(),this.registerToolListeners(),this.setupContextMenu()}init(){this.togglePanel("info","#panel-btn .check",this.settings.info_panel),this.togglePanel("tools","#tools-btn .check",this.settings.tools_panel),this.togglePanel("graphs","#graphs-btn .check",this.settings.graphs_panel),this.togglePanel("faces","#faces-btn .check",this.settings.face_panel)}setupContextMenu(){const e=en.getElementById("custom-context-menu");en.addEventListener("contextmenu",t=>{t.preventDefault();const{offsetWidth:n,offsetHeight:i}=e,{innerWidth:a,innerHeight:s}=window;let{pageX:d,pageY:f}=t;d+n>a&&(d-=n),f+i>s&&(f-=i),Object.assign(e.style,{left:`${d}px`,top:`${f}px`,display:"block"})}),en.addEventListener("click",()=>{e.style.display="none"})}togglePanel(e,t,n){const i=this.panels[e],a=en.querySelector(t);a==null||a.classList.toggle("hidden",!n),i&&(i.style.display=n?"flex":"none",n||this.resetPanel(i))}resetPanel(e){e.style.transform="translate(0px, 0px)",e.setAttribute("data-x",0),e.setAttribute("data-y",0)}addEventListeners(){const e=(n,i)=>{var a;(a=en.querySelector(n))==null||a.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:i})})};e("#floating-panel .close","info_panel"),e("#tools-panel .close","tools_panel"),e("#graphs-panel .close","graphs_panel"),e("#face-panel .close","face_panel");const t=en.querySelector("#floating-panel .max");t==null||t.addEventListener("click",()=>{var n;this.resetPanel(this.panels.info),(n=en.getElementById("floating-panel"))==null||n.classList.toggle("MAX")})}makePanelsDraggable(){Object.entries(this.panels).forEach(([e,t])=>{const n=this.handles[e];t&&n&&this.makeDraggable(t,n)})}makeDraggable(e,t){tw(e).draggable({allowFrom:t,listeners:{move(n){const i=n.target,a=(parseFloat(i.getAttribute("data-x"))||0)+n.dx,s=(parseFloat(i.getAttribute("data-y"))||0)+n.dy;i.style.transform=`translate(${a}px, ${s}px)`,i.setAttribute("data-x",a),i.setAttribute("data-y",s)}}})}registerToolListeners(){Object.entries({scale:"scale",tree:"tree",force:"forceSimulation",panning:"panning",select:"select",component:"component","color-picker":"colorPicker"}).forEach(([t,n])=>{var i;(i=en.querySelector(`widgets #tools-panel .${t}`))==null||i.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:n})})})}}class rw{constructor(e,t){this.app=e,this.settings=e.settings,this.canvas=e.canvas,this.ctx=e._canvas.ctx,this.selection={x:0,y:0,width:0,height:0,active:!1},this.mouseDown=!1,this.scale={isDragging:!1,active:!1,activeHandle:null,scaleData:{},rect:{x:100,y:100,width:200,height:150},prevMouse:{x:0,y:0},offsetX:0,offsetY:0,handleSize:10,handles:["nw","n","ne","e","se","s","sw","w"],cursorMap:{nw:"nwse-resize",n:"ns-resize",ne:"nesw-resize",e:"ew-resize",se:"nwse-resize",s:"ns-resize",sw:"nesw-resize",w:"ew-resize"}}}init(){this.canvas.addEventListener("mousedown",this.startSelection.bind(this)),this.canvas.addEventListener("mousemove",this.updateSelection.bind(this)),this.canvas.addEventListener("mouseup",this.endSelection.bind(this))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),(this.settings.select||this.settings.scale)&&(this.selection.active&&this.drawSelect(this.selection),this.settings.scale&&this.drawScale())}drawSelect(e){if(!e)return;const t=this.ctx;t.fillStyle="rgba(0, 0, 0, 0.1)",t.fillRect(e.x,e.y,e.width,e.height),t.strokeStyle="rgba(0, 0, 255, 0.7)",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(e.x,e.y,e.width,e.height),t.setLineDash([])}drawScale(){this.scale.active&&this.drawScaleBox(this.scale.rect,this.ctx)}startSelection(e){if(this.mouseDown=!0,this.settings.performance?this.app.graphManager.needsRedraw={rect:!0,node:!0}:this.app.graphManager.needsRedraw={rect:!0,node:!0,edge:!0,face:!0},this.settings.select||this.settings.scale){const[t,n]=tn(e,this.canvas);if(this.selection.x=t,this.selection.y=n,this.selection.width=0,this.selection.height=0,this.selection.active=!this.scale.active,this.settings.scale&&this.scale.active){const[i,a]=tn(e);if(this.scale.prevMouse={x:i,y:a},this.scale.activeHandle=this.hitTestHandle(i,a),this.scale.activeHandle)return;i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height&&(this.scale.isDragging=!0,this.scale.offsetX=i-this.scale.rect.x,this.scale.offsetY=a-this.scale.rect.y)}}else this.selection.active=!1,this.scale.active=!1}updateSelection(e){if(this.selection.active&&!this.scale.active){const[t,n]=tn(e,this.canvas);this.selection.width=t-this.selection.x,this.selection.height=n-this.selection.y;return}if(this.scale.active){const t=this.scale.rect,n=this.app.graphManager.graph.getSelectedNodes(),[i,a]=tn(e);if(this.scale.activeHandle){this.resizeRect(this.scale.activeHandle,i,a);for(let d of n)this.app.graphManager.graph.updateNodeAttributes(d,f=>({...f,x:t.x+t.width*this.scale.scaleData[d].x,y:t.y+t.height*this.scale.scaleData[d].y}));return}if(this.scale.isDragging){this.scale.rect.x=i-this.scale.offsetX,this.scale.rect.y=a-this.scale.offsetY;const d=i-this.scale.prevMouse.x,f=a-this.scale.prevMouse.y;for(let h of n)this.app.graphManager.graph.updateNodeAttributes(h,y=>({...y,x:y.x+d,y:y.y+f}));this.scale.prevMouse={x:i,y:a};return}const s=this.hitTestHandle(i,a);s?this.canvas.style.cursor=this.scale.cursorMap[s]:i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height?this.canvas.style.cursor="move":this.canvas.style.cursor="default"}}endSelection(e){this.mouseDown=!1,this.selection.active=!1,this.scale.isDragging=!1,this.scale.activeHandle=null,this.pointsInRect(this.selection).forEach(i=>{this.app.graphManager.graph.toggleNodeSelection(i)}),this.settings.scale||this.linesInRect(this.selection).forEach(a=>{this.app.graphManager.graph.toggleEdgeSelection(a)});const n=this.app.graphManager.graph.getSelectedNodes();this.settings.scale&&n.length>0&&!this.scale.active&&(this.scale.active=!0,this.scale.rect=iw(this.app.graphManager.graph,n,this.settings.node_radius),this.scaleData={},n.forEach(i=>{const a=this.app.graphManager.graph.getNodeAttributes(i);this.scale.scaleData[i]={id:i,x:(a.x-this.scale.rect.x)/this.scale.rect.width,y:(a.y-this.scale.rect.y)/this.scale.rect.height}})),this.app.graphManager.redraw()}pointsInRect(e){const[t,n,i,a]=Ld(e);return this.app.graphManager.graph.filterNodes((s,d)=>cu(d.x,d.y,t,n,i,a))}linesInRect(e){const t=Ld(e);return this.app.graphManager.graph.filterEdges((n,i,a,s,d,f)=>this.lineIntersectsRect([d.x,d.y,f.x,f.y],t))}lineIntersectsRect(e,t){let[n,i,a,s]=e,[d,f,h,y]=t;const v=this.settings.node_radius/2+20;return!!(zd([n,i,a,s],[d,f,h,y])||zd([n,i,a,s],[d,y,h,f])||cu(n,i,d+v,f+v,h-v,y-v)||cu(a,s,d+v,f+v,h-v,y-v))}drawScaleBox(e,t){e&&(t.fillStyle="#cce5ff20",t.strokeStyle="#3399ff",t.lineWidth=2,t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height),t.fillStyle="#fff",t.strokeStyle="#000",this.scale.handles.forEach(n=>{const[i,a]=this.getHandlePosition(n);t.fillRect(i,a,this.scale.handleSize,this.scale.handleSize),t.strokeRect(i,a,this.scale.handleSize,this.scale.handleSize)}))}getHandlePosition(e){const{x:t,y:n,width:i,height:a}=this.scale.rect,s=this.scale.handleSize/2;switch(e){case"nw":return[t-s,n-s];case"n":return[t+i/2-s,n-s];case"ne":return[t+i-s,n-s];case"e":return[t+i-s,n+a/2-s];case"se":return[t+i-s,n+a-s];case"s":return[t+i/2-s,n+a-s];case"sw":return[t-s,n+a-s];case"w":return[t-s,n+a/2-s]}}hitTestHandle(e,t){return this.scale.handles.find(n=>{const[i,a]=this.getHandlePosition(n);return e>=i&&e<=i+this.scale.handleSize&&t>=a&&t<=a+this.scale.handleSize})}resizeRect(e,t,n){const a=t-this.scale.prevMouse.x,s=n-this.scale.prevMouse.y;let{x:d,y:f,width:h,height:y}=this.scale.rect;switch(e){case"nw":d+=a,f+=s,h-=a,y-=s;break;case"n":f+=s,y-=s;break;case"ne":f+=s,h+=a,y-=s;break;case"e":h+=a;break;case"se":h+=a,y+=s;break;case"s":y+=s;break;case"sw":d+=a,h-=a,y+=s;break;case"w":d+=a,h-=a;break}if(h<20){const v=20-h;e.includes("w")&&(d-=v),h=20}if(y<20){const v=20-y;e.includes("n")&&(f-=v),y=20}this.scale.rect.x=d,this.scale.rect.y=f,this.scale.rect.width=h,this.scale.rect.height=y,this.scale.prevMouse={x:t,y:n}}}function cu(r,e,t,n,i,a){return r>=t&&r<=i&&e>=n&&e<=a}function Ld(r){const e=Math.min(r.x,r.x+r.width),t=Math.min(r.y,r.y+r.height),n=Math.max(r.x,r.x+r.width),i=Math.max(r.y,r.y+r.height);return[e,t,n,i]}function zd(r,e){var t,n,i;const[a,s,d,f]=r,[h,y,v,w]=e;return t=(d-a)*(w-y)-(v-h)*(f-s),t===0?!1:(i=((w-y)*(v-a)+(h-v)*(w-s))/t,n=((s-f)*(v-a)+(d-a)*(w-s))/t,0<i&&i<1&&0<n&&n<1)}function iw(r,e,t){if(!e.length)return null;let n=1/0,i=1/0,a=-1/0,s=-1/0;e.forEach(f=>{const h=r.getNodeAttributes(f);h.x<n&&(n=h.x),h.y<i&&(i=h.y),h.x>a&&(a=h.x),h.y>s&&(s=h.y)});const d=t*1.5;return{x:n-d,y:i-d,width:a-n+2*d,height:s-i+2*d}}var lu={exports:{}};/*! Pickr 1.9.1 MIT | https://github.com/Simonwep/pickr */var $d;function aw(){return $d||($d=1,function(r,e){(function(t,n){r.exports=n()})(self,()=>(()=>{var t={d:(X,P)=>{for(var ee in P)t.o(P,ee)&&!t.o(X,ee)&&Object.defineProperty(X,ee,{enumerable:!0,get:P[ee]})},o:(X,P)=>Object.prototype.hasOwnProperty.call(X,P),r:X=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(X,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(X,"__esModule",{value:!0})}},n={};t.d(n,{default:()=>ve});var i={};function a(X,P,ee,ne,le={}){P instanceof HTMLCollection||P instanceof NodeList?P=Array.from(P):Array.isArray(P)||(P=[P]),Array.isArray(ee)||(ee=[ee]);for(const oe of P)for(const he of ee)oe[X](he,ne,{capture:!1,...le});return Array.prototype.slice.call(arguments,1)}t.r(i),t.d(i,{adjustableInputNumbers:()=>w,createElementFromString:()=>f,createFromTemplate:()=>h,eventPath:()=>y,off:()=>d,on:()=>s,resolveElement:()=>v});const s=a.bind(null,"addEventListener"),d=a.bind(null,"removeEventListener");function f(X){const P=document.createElement("div");return P.innerHTML=X.trim(),P.firstElementChild}function h(X){const P=(ne,le)=>{const oe=ne.getAttribute(le);return ne.removeAttribute(le),oe},ee=(ne,le={})=>{const oe=P(ne,":obj"),he=P(ne,":ref"),ue=oe?le[oe]={}:le;he&&(le[he]=ne);for(const me of Array.from(ne.children)){const _e=P(me,":arr"),Me=ee(me,_e?{}:ue);_e&&(ue[_e]||(ue[_e]=[])).push(Object.keys(Me).length?Me:me)}return le};return ee(f(X))}function y(X){let P=X.path||X.composedPath&&X.composedPath();if(P)return P;let ee=X.target.parentElement;for(P=[X.target,ee];ee=ee.parentElement;)P.push(ee);return P.push(document,window),P}function v(X){return X instanceof Element?X:typeof X=="string"?X.split(/>>/g).reduce((P,ee,ne,le)=>(P=P.querySelector(ee),ne<le.length-1?P.shadowRoot:P),document):null}function w(X,P=ee=>ee){function ee(ne){const le=[.001,.01,.1][Number(ne.shiftKey||2*ne.ctrlKey)]*(ne.deltaY<0?1:-1);let oe=0,he=X.selectionStart;X.value=X.value.replace(/[\d.]+/g,(ue,me)=>me<=he&&me+ue.length>=he?(he=me,P(Number(ue),le,oe)):(oe++,ue)),X.focus(),X.setSelectionRange(he,he),ne.preventDefault(),X.dispatchEvent(new Event("input"))}s(X,"focus",()=>s(window,"wheel",ee,{passive:!1})),s(X,"blur",()=>d(window,"wheel",ee))}const{min:_,max:D,floor:k,round:N}=Math;function O(X,P,ee){P/=100,ee/=100;const ne=k(X=X/360*6),le=X-ne,oe=ee*(1-P),he=ee*(1-le*P),ue=ee*(1-(1-le)*P),me=ne%6;return[255*[ee,he,oe,oe,ue,ee][me],255*[ue,ee,ee,he,oe,oe][me],255*[oe,oe,ue,ee,ee,he][me]]}function M(X,P,ee){const ne=(2-(P/=100))*(ee/=100)/2;return ne!==0&&(P=ne===1?0:ne<.5?P*ee/(2*ne):P*ee/(2-2*ne)),[X,100*P,100*ne]}function z(X,P,ee){const ne=_(X/=255,P/=255,ee/=255),le=D(X,P,ee),oe=le-ne;let he,ue;if(oe===0)he=ue=0;else{ue=oe/le;const me=((le-X)/6+oe/2)/oe,_e=((le-P)/6+oe/2)/oe,Me=((le-ee)/6+oe/2)/oe;X===le?he=Me-_e:P===le?he=1/3+me-Me:ee===le&&(he=2/3+_e-me),he<0?he+=1:he>1&&(he-=1)}return[360*he,100*ue,100*le]}function A(X,P,ee,ne){return P/=100,ee/=100,[...z(255*(1-_(1,(X/=100)*(1-(ne/=100))+ne)),255*(1-_(1,P*(1-ne)+ne)),255*(1-_(1,ee*(1-ne)+ne)))]}function T(X,P,ee){P/=100;const ne=2*(P*=(ee/=100)<.5?ee:1-ee)/(ee+P)*100,le=100*(ee+P);return[X,isNaN(ne)?0:ne,le]}function K(X){return z(...X.match(/.{2}/g).map(P=>parseInt(P,16)))}function S(X){X=X.match(/^[a-zA-Z]+$/)?function(le){if(le.toLowerCase()==="black")return"#000";const oe=document.createElement("canvas").getContext("2d");return oe.fillStyle=le,oe.fillStyle==="#000"?null:oe.fillStyle}(X):X;const P={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},ee=le=>le.map(oe=>/^(|\d+)\.\d+|\d+$/.test(oe)?Number(oe):void 0);let ne;e:for(const le in P)if(ne=P[le].exec(X))switch(le){case"cmyk":{const[,oe,he,ue,me]=ee(ne);if(oe>100||he>100||ue>100||me>100)break e;return{values:A(oe,he,ue,me),type:le}}case"rgba":{let[,oe,,he,,ue,,,me]=ee(ne);if(oe=ne[2]==="%"?oe/100*255:oe,he=ne[4]==="%"?he/100*255:he,ue=ne[6]==="%"?ue/100*255:ue,me=ne[9]==="%"?me/100:me,oe>255||he>255||ue>255||me<0||me>1)break e;return{values:[...z(oe,he,ue),me],a:me,type:le}}case"hexa":{let[,oe]=ne;oe.length!==4&&oe.length!==3||(oe=oe.split("").map(me=>me+me).join(""));const he=oe.substring(0,6);let ue=oe.substring(6);return ue=ue?parseInt(ue,16)/255:void 0,{values:[...K(he),ue],a:ue,type:le}}case"hsla":{let[,oe,he,ue,,me]=ee(ne);if(me=ne[6]==="%"?me/100:me,oe>360||he>100||ue>100||me<0||me>1)break e;return{values:[...T(oe,he,ue),me],a:me,type:le}}case"hsva":{let[,oe,he,ue,,me]=ee(ne);if(me=ne[6]==="%"?me/100:me,oe>360||he>100||ue>100||me<0||me>1)break e;return{values:[oe,he,ue,me],a:me,type:le}}}return{values:null,type:null}}function G(X=0,P=0,ee=0,ne=1){const le=(he,ue)=>(me=-1)=>ue(~me?he.map(_e=>Number(_e.toFixed(me))):he),oe={h:X,s:P,v:ee,a:ne,toHSVA(){const he=[oe.h,oe.s,oe.v,oe.a];return he.toString=le(he,ue=>`hsva(${ue[0]}, ${ue[1]}%, ${ue[2]}%, ${oe.a})`),he},toHSLA(){const he=[...M(oe.h,oe.s,oe.v),oe.a];return he.toString=le(he,ue=>`hsla(${ue[0]}, ${ue[1]}%, ${ue[2]}%, ${oe.a})`),he},toRGBA(){const he=[...O(oe.h,oe.s,oe.v),oe.a];return he.toString=le(he,ue=>`rgba(${ue[0]}, ${ue[1]}, ${ue[2]}, ${oe.a})`),he},toCMYK(){const he=function(ue,me,_e){const Me=O(ue,me,_e),Oe=Me[0]/255,qe=Me[1]/255,ce=Me[2]/255,Pe=_(1-Oe,1-qe,1-ce);return[100*(Pe===1?0:(1-Oe-Pe)/(1-Pe)),100*(Pe===1?0:(1-qe-Pe)/(1-Pe)),100*(Pe===1?0:(1-ce-Pe)/(1-Pe)),100*Pe]}(oe.h,oe.s,oe.v);return he.toString=le(he,ue=>`cmyk(${ue[0]}%, ${ue[1]}%, ${ue[2]}%, ${ue[3]}%)`),he},toHEXA(){const he=function(me,_e,Me){return O(me,_e,Me).map(Oe=>N(Oe).toString(16).padStart(2,"0"))}(oe.h,oe.s,oe.v),ue=oe.a>=1?"":Number((255*oe.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return ue&&he.push(ue),he.toString=()=>`#${he.join("").toUpperCase()}`,he},clone:()=>G(oe.h,oe.s,oe.v,oe.a)};return oe}const q=X=>Math.max(Math.min(X,1),0);function F(X){const P={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},X),_keyboard(oe){const{options:he}=P,{type:ue,key:me}=oe;if(document.activeElement===he.wrapper){const{lock:_e}=P.options,Me=me==="ArrowUp",Oe=me==="ArrowRight",qe=me==="ArrowDown",ce=me==="ArrowLeft";if(ue==="keydown"&&(Me||Oe||qe||ce)){let Pe=0,Re=0;_e==="v"?Pe=Me||Oe?1:-1:_e==="h"?Pe=Me||Oe?-1:1:(Re=Me?-1:qe?1:0,Pe=ce?-1:Oe?1:0),P.update(q(P.cache.x+.01*Pe),q(P.cache.y+.01*Re)),oe.preventDefault()}else me.startsWith("Arrow")&&(P.options.onstop(),oe.preventDefault())}},_tapstart(oe){s(document,["mouseup","touchend","touchcancel"],P._tapstop),s(document,["mousemove","touchmove"],P._tapmove),oe.cancelable&&oe.preventDefault(),P._tapmove(oe)},_tapmove(oe){const{options:he,cache:ue}=P,{lock:me,element:_e,wrapper:Me}=he,Oe=Me.getBoundingClientRect();let qe=0,ce=0;if(oe){const ke=oe&&oe.touches&&oe.touches[0];qe=oe?(ke||oe).clientX:0,ce=oe?(ke||oe).clientY:0,qe<Oe.left?qe=Oe.left:qe>Oe.left+Oe.width&&(qe=Oe.left+Oe.width),ce<Oe.top?ce=Oe.top:ce>Oe.top+Oe.height&&(ce=Oe.top+Oe.height),qe-=Oe.left,ce-=Oe.top}else ue&&(qe=ue.x*Oe.width,ce=ue.y*Oe.height);me!=="h"&&(_e.style.left=`calc(${qe/Oe.width*100}% - ${_e.offsetWidth/2}px)`),me!=="v"&&(_e.style.top=`calc(${ce/Oe.height*100}% - ${_e.offsetHeight/2}px)`),P.cache={x:qe/Oe.width,y:ce/Oe.height};const Pe=q(qe/Oe.width),Re=q(ce/Oe.height);switch(me){case"v":return he.onchange(Pe);case"h":return he.onchange(Re);default:return he.onchange(Pe,Re)}},_tapstop(){P.options.onstop(),d(document,["mouseup","touchend","touchcancel"],P._tapstop),d(document,["mousemove","touchmove"],P._tapmove)},trigger(){P._tapmove()},update(oe=0,he=0){const{left:ue,top:me,width:_e,height:Me}=P.options.wrapper.getBoundingClientRect();P.options.lock==="h"&&(he=oe),P._tapmove({clientX:ue+_e*oe,clientY:me+Me*he})},destroy(){const{options:oe,_tapstart:he,_keyboard:ue}=P;d(document,["keydown","keyup"],ue),d([oe.wrapper,oe.element],"mousedown",he),d([oe.wrapper,oe.element],"touchstart",he,{passive:!1})}},{options:ee,_tapstart:ne,_keyboard:le}=P;return s([ee.wrapper,ee.element],"mousedown",ne),s([ee.wrapper,ee.element],"touchstart",ne,{passive:!1}),s(document,["keydown","keyup"],le),P}function W(X={}){X=Object.assign({onchange:()=>0,className:"",elements:[]},X);const P=s(X.elements,"click",ee=>{X.elements.forEach(ne=>ne.classList[ee.target===ne?"add":"remove"](X.className)),X.onchange(ee),ee.stopPropagation()});return{destroy:()=>d(...P)}}const Z={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},j=(X,P,ee)=>{const ne=typeof X!="object"||X instanceof HTMLElement?{reference:X,popper:P,...ee}:X;return{update(le=ne){const{reference:oe,popper:he}=Object.assign(ne,le);if(!he||!oe)throw new Error("Popper- or reference-element missing.");return((ue,me,_e)=>{const{container:Me,arrow:Oe,margin:qe,padding:ce,position:Pe,variantFlipOrder:Re,positionFlipOrder:ke}={container:document.documentElement.getBoundingClientRect(),...Z,..._e},{left:Ke,top:Le}=me.style;me.style.left="0",me.style.top="0";const Ee=ue.getBoundingClientRect(),fe=me.getBoundingClientRect(),vt={t:Ee.top-fe.height-qe,b:Ee.bottom+qe,r:Ee.right+qe,l:Ee.left-fe.width-qe},it={vs:Ee.left,vm:Ee.left+Ee.width/2-fe.width/2,ve:Ee.left+Ee.width-fe.width,hs:Ee.top,hm:Ee.bottom-Ee.height/2-fe.height/2,he:Ee.bottom-fe.height},[Et,at="middle"]=Pe.split("-"),Ve=ke[Et],ht=Re[at],{top:ot,left:gt,bottom:xt,right:st}=Me;for(const ut of Ve){const ft=ut==="t"||ut==="b";let nt=vt[ut];const[_t,mt]=ft?["top","left"]:["left","top"],[Pt,on]=ft?[fe.height,fe.width]:[fe.width,fe.height],[Qn,Nt]=ft?[xt,st]:[st,xt],[ze,_n]=ft?[ot,gt]:[gt,ot];if(!(nt<ze||nt+Pt+ce>Qn))for(const bt of ht){let St=it[(ft?"v":"h")+bt];if(!(St<_n||St+on+ce>Nt)){if(St-=fe[mt],nt-=fe[_t],me.style[mt]=`${St}px`,me.style[_t]=`${nt}px`,Oe){const Se=ft?Ee.width/2:Ee.height/2,sn=on/2,$n=Se>sn,Zn=St+{s:$n?sn:Se,m:sn,e:$n?sn:on-Se}[bt],Jn=nt+{t:Pt,b:0,r:0,l:Pt}[ut];Oe.style[mt]=`${Zn}px`,Oe.style[_t]=`${Jn}px`}return ut+bt}}}return me.style.left=Ke,me.style.top=Le,null})(oe,he,ne)}}},ge=class ge{constructor(P){Ct(this,"_initializingActive",!0);Ct(this,"_recalc",!0);Ct(this,"_nanopop",null);Ct(this,"_root",null);Ct(this,"_color",G());Ct(this,"_lastColor",G());Ct(this,"_swatchColors",[]);Ct(this,"_setupAnimationFrame",null);Ct(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]});this.options=P=Object.assign({...ge.DEFAULT_OPTIONS},P);const{swatches:ee,components:ne,theme:le,sliders:oe,lockOpacity:he,padding:ue}=P;["nano","monolith"].includes(le)&&!oe&&(P.sliders="h"),ne.interaction||(ne.interaction={});const{preview:me,opacity:_e,hue:Me,palette:Oe}=ne;ne.opacity=!he&&_e,ne.palette=Oe||me||_e||Me,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),ee&&ee.length&&ee.forEach(Re=>this.addSwatch(Re));const{button:qe,app:ce}=this._root;this._nanopop=j(qe,ce,{margin:ue}),qe.setAttribute("role","button"),qe.setAttribute("aria-label",this._t("btn:toggle"));const Pe=this;this._setupAnimationFrame=requestAnimationFrame(function Re(){if(!ce.offsetWidth)return requestAnimationFrame(Re);Pe.setColor(P.default),Pe._rePositioningPicker(),P.defaultRepresentation&&(Pe._representation=P.defaultRepresentation,Pe.setColorRepresentation(Pe._representation)),P.showAlways&&Pe.show(),Pe._initializingActive=!1,Pe._emit("init")})}_preBuild(){const{options:P}=this;for(const ee of["el","container"])P[ee]=v(P[ee]);this._root=(ee=>{const{components:ne,useAsButton:le,inline:oe,appClass:he,theme:ue,lockOpacity:me}=ee.options,_e=ce=>ce?"":'style="display:none" hidden',Me=ce=>ee._t(ce),Oe=h(`
      <div :ref="root" class="pickr">

        ${le?"":'<button type="button" :ref="button" class="pcr-button"></button>'}

        <div :ref="app" class="pcr-app ${he||""}" data-theme="${ue}" ${oe?'style="position: unset"':""} aria-label="${Me("ui:dialog")}" role="window">
          <div class="pcr-selection" ${_e(ne.palette)}>
            <div :obj="preview" class="pcr-color-preview" ${_e(ne.preview)}>
              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${Me("btn:last-color")}"></button>
              <div :ref="currentColor" class="pcr-current-color"></div>
            </div>

            <div :obj="palette" class="pcr-color-palette">
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${Me("aria:palette")}" role="listbox"></div>
            </div>

            <div :obj="hue" class="pcr-color-chooser" ${_e(ne.hue)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${Me("aria:hue")}" role="slider"></div>
            </div>

            <div :obj="opacity" class="pcr-color-opacity" ${_e(ne.opacity)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${Me("aria:opacity")}" role="slider"></div>
            </div>
          </div>

          <div class="pcr-swatches ${ne.palette?"":"pcr-last"}" :ref="swatches"></div>

          <div :obj="interaction" class="pcr-interaction" ${_e(Object.keys(ne.interaction).length)}>
            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${_e(ne.interaction.input)} aria-label="${Me("aria:input")}">

            <input :arr="options" class="pcr-type" data-type="HEXA" value="${me?"HEX":"HEXA"}" type="button" ${_e(ne.interaction.hex)}>
            <input :arr="options" class="pcr-type" data-type="RGBA" value="${me?"RGB":"RGBA"}" type="button" ${_e(ne.interaction.rgba)}>
            <input :arr="options" class="pcr-type" data-type="HSLA" value="${me?"HSL":"HSLA"}" type="button" ${_e(ne.interaction.hsla)}>
            <input :arr="options" class="pcr-type" data-type="HSVA" value="${me?"HSV":"HSVA"}" type="button" ${_e(ne.interaction.hsva)}>
            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${_e(ne.interaction.cmyk)}>

            <input :ref="save" class="pcr-save" value="${Me("btn:save")}" type="button" ${_e(ne.interaction.save)} aria-label="${Me("aria:btn:save")}">
            <input :ref="cancel" class="pcr-cancel" value="${Me("btn:cancel")}" type="button" ${_e(ne.interaction.cancel)} aria-label="${Me("aria:btn:cancel")}">
            <input :ref="clear" class="pcr-clear" value="${Me("btn:clear")}" type="button" ${_e(ne.interaction.clear)} aria-label="${Me("aria:btn:clear")}">
          </div>
        </div>
      </div>
    `),qe=Oe.interaction;return qe.options.find(ce=>!ce.hidden&&!ce.classList.add("active")),qe.type=()=>qe.options.find(ce=>ce.classList.contains("active")),Oe})(this),P.useAsButton&&(this._root.button=P.el),P.container.appendChild(this._root.root)}_finalBuild(){const P=this.options,ee=this._root;if(P.container.removeChild(ee.root),P.inline){const ne=P.el.parentElement;P.el.nextSibling?ne.insertBefore(ee.app,P.el.nextSibling):ne.appendChild(ee.app)}else P.container.appendChild(ee.app);P.useAsButton?P.inline&&P.el.remove():P.el.parentNode.replaceChild(ee.root,P.el),P.disabled&&this.disable(),P.comparison||(ee.button.style.transition="none",P.useAsButton||(ee.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const P=this,ee=this.options.components,ne=(P.options.sliders||"v").repeat(2),[le,oe]=ne.match(/^[vh]+$/g)?ne:[],he=()=>this._color||(this._color=this._lastColor.clone()),ue={palette:F({element:P._root.palette.picker,wrapper:P._root.palette.palette,onstop:()=>P._emit("changestop","slider",P),onchange(me,_e){if(!ee.palette)return;const Me=he(),{_root:Oe,options:qe}=P,{lastColor:ce,currentColor:Pe}=Oe.preview;P._recalc&&(Me.s=100*me,Me.v=100-100*_e,Me.v<0&&(Me.v=0),P._updateOutput("slider"));const Re=Me.toRGBA().toString(0);this.element.style.background=Re,this.wrapper.style.background=`
                        linear-gradient(to top, rgba(0, 0, 0, ${Me.a}), transparent),
                        linear-gradient(to left, hsla(${Me.h}, 100%, 50%, ${Me.a}), rgba(255, 255, 255, ${Me.a}))
                    `,qe.comparison?qe.useAsButton||P._lastColor||ce.style.setProperty("--pcr-color",Re):(Oe.button.style.setProperty("--pcr-color",Re),Oe.button.classList.remove("clear"));const ke=Me.toHEXA().toString();for(const{el:Ke,color:Le}of P._swatchColors)Ke.classList[ke===Le.toHEXA().toString()?"add":"remove"]("pcr-active");Pe.style.setProperty("--pcr-color",Re)}}),hue:F({lock:oe==="v"?"h":"v",element:P._root.hue.picker,wrapper:P._root.hue.slider,onstop:()=>P._emit("changestop","slider",P),onchange(me){if(!ee.hue||!ee.palette)return;const _e=he();P._recalc&&(_e.h=360*me),this.element.style.backgroundColor=`hsl(${_e.h}, 100%, 50%)`,ue.palette.trigger()}}),opacity:F({lock:le==="v"?"h":"v",element:P._root.opacity.picker,wrapper:P._root.opacity.slider,onstop:()=>P._emit("changestop","slider",P),onchange(me){if(!ee.opacity||!ee.palette)return;const _e=he();P._recalc&&(_e.a=Math.round(100*me)/100),this.element.style.background=`rgba(0, 0, 0, ${_e.a})`,ue.palette.trigger()}}),selectable:W({elements:P._root.interaction.options,className:"active",onchange(me){P._representation=me.target.getAttribute("data-type").toUpperCase(),P._recalc&&P._updateOutput("swatch")}})};this._components=ue}_bindEvents(){const{_root:P,options:ee}=this,ne=[s(P.interaction.clear,"click",()=>this._clearColor()),s([P.interaction.cancel,P.preview.lastColor],"click",()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")}),s(P.interaction.save,"click",()=>{!this.applyColor()&&!ee.showAlways&&this.hide()}),s(P.interaction.result,["keyup","input"],le=>{this.setColor(le.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),le.stopImmediatePropagation()}),s(P.interaction.result,["focus","blur"],le=>{this._recalc=le.type==="blur",this._recalc&&this._updateOutput(null)}),s([P.palette.palette,P.palette.picker,P.hue.slider,P.hue.picker,P.opacity.slider,P.opacity.picker],["mousedown","touchstart"],()=>this._recalc=!0,{passive:!0})];if(!ee.showAlways){const le=ee.closeWithKey;ne.push(s(P.button,"click",()=>this.isOpen()?this.hide():this.show()),s(document,"keyup",oe=>this.isOpen()&&(oe.key===le||oe.code===le)&&this.hide()),s(document,["touchstart","mousedown"],oe=>{this.isOpen()&&!y(oe).some(he=>he===P.app||he===P.button)&&this.hide()},{capture:!0}))}if(ee.adjustableNumbers){const le={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};w(P.interaction.result,(oe,he,ue)=>{const me=le[this.getColorRepresentation().toLowerCase()];if(me){const _e=me[ue],Me=oe+(_e>=100?1e3*he:he);return Me<=0?0:Number((Me<_e?Me:_e).toPrecision(3))}return oe})}if(ee.autoReposition&&!ee.inline){let le=null;const oe=this;ne.push(s(window,["scroll","resize"],()=>{oe.isOpen()&&(ee.closeOnScroll&&oe.hide(),le===null?(le=setTimeout(()=>le=null,100),requestAnimationFrame(function he(){oe._rePositioningPicker(),le!==null&&requestAnimationFrame(he)})):(clearTimeout(le),le=setTimeout(()=>le=null,100)))},{capture:!0}))}this._eventBindings=ne}_rePositioningPicker(){const{options:P}=this;if(!P.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:P.position})){const ee=this._root.app,ne=ee.getBoundingClientRect();ee.style.top=(window.innerHeight-ne.height)/2+"px",ee.style.left=(window.innerWidth-ne.width)/2+"px"}}_updateOutput(P){const{_root:ee,_color:ne,options:le}=this;if(ee.interaction.type()){const oe=`to${ee.interaction.type().getAttribute("data-type")}`;ee.interaction.result.value=typeof ne[oe]=="function"?ne[oe]().toString(le.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",ne,P,this)}_clearColor(P=!1){const{_root:ee,options:ne}=this;ne.useAsButton||ee.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),ee.button.classList.add("clear"),ne.showAlways||this.hide(),this._lastColor=null,this._initializingActive||P||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(P){const{values:ee,type:ne,a:le}=S(P),{lockOpacity:oe}=this.options,he=le!==void 0&&le!==1;return ee&&ee.length===3&&(ee[3]=void 0),{values:!ee||oe&&he?null:ee,type:ne}}_t(P){return this.options.i18n[P]||ge.I18N_DEFAULTS[P]}_emit(P,...ee){this._eventListener[P].forEach(ne=>ne(...ee,this))}on(P,ee){return this._eventListener[P].push(ee),this}off(P,ee){const ne=this._eventListener[P]||[],le=ne.indexOf(ee);return~le&&ne.splice(le,1),this}addSwatch(P){const{values:ee}=this._parseLocalColor(P);if(ee){const{_swatchColors:ne,_root:le}=this,oe=G(...ee),he=f(`<button type="button" style="--pcr-color: ${oe.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return le.swatches.appendChild(he),ne.push({el:he,color:oe}),this._eventBindings.push(s(he,"click",()=>{this.setHSVA(...oe.toHSVA(),!0),this._emit("swatchselect",oe),this._emit("change",oe,"swatch",this)})),!0}return!1}removeSwatch(P){const ee=this._swatchColors[P];if(ee){const{el:ne}=ee;return this._root.swatches.removeChild(ne),this._swatchColors.splice(P,1),!0}return!1}applyColor(P=!1){const{preview:ee,button:ne}=this._root,le=this._color.toRGBA().toString(0);return ee.lastColor.style.setProperty("--pcr-color",le),this.options.useAsButton||ne.style.setProperty("--pcr-color",le),ne.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||P||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach(P=>d(...P)),Object.keys(this._components).forEach(P=>this._components[P].destroy())}destroyAndRemove(){this.destroy();const{root:P,app:ee}=this._root;P.parentElement&&P.parentElement.removeChild(P),ee.parentElement.removeChild(ee),Object.keys(this).forEach(ne=>this[ne]=null)}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(P=360,ee=0,ne=0,le=1,oe=!1){const he=this._recalc;if(this._recalc=!1,P<0||P>360||ee<0||ee>100||ne<0||ne>100||le<0||le>1)return!1;this._color=G(P,ee,ne,le);const{hue:ue,opacity:me,palette:_e}=this._components;return ue.update(P/360),me.update(le),_e.update(ee/100,1-ne/100),oe||this.applyColor(),he&&this._updateOutput(),this._recalc=he,!0}setColor(P,ee=!1){if(P===null)return this._clearColor(ee),!0;const{values:ne,type:le}=this._parseLocalColor(P);if(ne){const oe=le.toUpperCase(),{options:he}=this._root.interaction,ue=he.find(me=>me.getAttribute("data-type")===oe);if(ue&&!ue.hidden)for(const me of he)me.classList[me===ue?"add":"remove"]("active");return!!this.setHSVA(...ne,ee)&&this.setColorRepresentation(oe)}return!1}setColorRepresentation(P){return P=P.toUpperCase(),!!this._root.interaction.options.find(ee=>ee.getAttribute("data-type").startsWith(P)&&!ee.click())}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}};Ct(ge,"utils",i),Ct(ge,"version","1.9.1"),Ct(ge,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),Ct(ge,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),Ct(ge,"create",P=>new ge(P));let ve=ge;return n=n.default})())}(lu)),lu.exports}var ow=aw();const sw=Mt(ow);class uw{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.pickrs={},["node","stroke","edge","face","label","background","grid"].forEach(n=>{const i=`#${n}-color`;this.pickrs[n]=sw.create({el:i,theme:"nano",default:this.settings[`${n}_color`],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,input:!0,save:!0}}})})}init(){for(const e in this.pickrs){const t=this.pickrs[e];t.on("change",n=>{const i=n.toHEXA().toString().toLowerCase();t.setColor(i),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:i})})}}setColor(e,t){const n=this.pickrs[e];n&&(n.setColor(this.ToHex(t)),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:this.ToHex(t)}))}getColor(e){const t=this.pickrs[e];return t?t.getColor().toHEXA().toString().toLowerCase():null}resetColors(){for(const e in this.pickrs)this.setColor(e,this.settings[`${e}_color`])}ToHex(e){if(typeof e!="string")return null;const t=e.trim().toLowerCase();if(/^#([0-9a-f]{3,8})$/i.test(t))return t.length===4?"#"+[...t.slice(1)].map(v=>v+v).join(""):t;const n=document.createElement("canvas").getContext("2d");n.fillStyle=t;const i=n.fillStyle.match(/\d+(\.\d+)?/g).map(Number),[a,s,d,f=1]=i,h=v=>Math.round(v).toString(16).padStart(2,"0"),y=Math.round(f*255).toString(16).padStart(2,"0");return"#"+h(a)+h(s)+h(d)+(f<1?y:"")}}class cw{constructor(e){this.app=e,this.graphManager=e.graphManager,this.mainCanvas=e._canvas._canvas.main,this.nodeCanvas=e._canvas._canvas.node,this.edgeCanvas=e._canvas._canvas.edge,this.faceCanvas=e._canvas._canvas.face,this.settings=e.settings,this.rect=e.rect}drawGraph(e={node:!0,edge:!0,face:!0,rect:!0}){if(!e.node&&!e.edge&&!e.face&&!e.rect)return;const t=this.graphManager.graph,n=this.settings,i=+n.edge_size,s=`${n.label_size}px sans-serif`,d=n.label_pos.x,f=n.label_pos.y,h=n.node_radius,y=n.stroke_size;e.face&&this.drawFaces(this.faceCanvas,t,n,s,d,f),e.edge&&this.drawEdges(this.edgeCanvas,t,n,i,h,s,d,f),e.node&&this.drawNodes(this.nodeCanvas,t,n,h,y,s,d,f),e.rect&&this.rect.draw()}drawArrowhead(e,t,n,i,a,s){s.beginPath(),s.moveTo(e,t),s.lineTo(e-i*Math.cos(n-Math.PI/6),t-i*Math.sin(n-Math.PI/6)),s.lineTo(e-i*Math.cos(n+Math.PI/6),t-i*Math.sin(n+Math.PI/6)),s.closePath(),s.fillStyle=a,s.fill()}drawLabel(e,t,n,i,a,s){t!=null&&t.trim()&&(e.fillStyle=a||"#000",e.font=s,e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,i))}drawFaces(e,t,n,i,a,s){const d=e.ctx;d.clearRect(0,0,e.canvas.width,e.canvas.height),t.forEachFace((f,h)=>{const y=h.nodes.map(w=>{const _=t.getNodeAttributes(w);return[_.x,_.y]}),v={x:eo(y,w=>w[0]),y:eo(y,w=>w[1])};if(y){d.fillStyle=h.selected?"#FFA50055":h.color,d.beginPath(),d.moveTo(y[0][0],y[0][1]);for(let w=1;w<y.length;w++)d.lineTo(y[w][0],y[w][1]);d.closePath(),d.fill()}n.faceLabel&&this.drawLabel(d,h.label,v.x,v.y,h.labelColor,i)})}drawEdges(e,t,n,i,a,s,d,f){const h=e.ctx;h.clearRect(0,0,e.canvas.width,e.canvas.height),t.forEachEdge((y,v,w,_,D,k)=>{const N=k.x-D.x,O=k.y-D.y,M=Math.hypot(N,O),z=N/M*(12+i),A=O/M*(12+i),T=t.hasEdge(_,w),K=T?D.x+z:D.x,S=T?D.y+A:D.y,G=k.x-z,q=k.y-A;if(h.beginPath(),h.moveTo(K,S),h.lineTo(G,q),h.strokeStyle=v.selected?"orange":v.color,h.lineWidth=i,h.stroke(),h.closePath(),t.isDirected(y)){const F=Math.atan2(O,N),W=k.x-Math.cos(F)*a/4,Z=k.y-Math.sin(F)*a/4;this.drawArrowhead(W,Z,F,14+i,v.selected?"orange":v.color,h)}if((n.edgeLabel||n.weightLabel)&&(v.label||v.weight!=null)){const F=(D.x+k.x)/2,W=(D.y+k.y)/2,Z=-O/M,j=N/M,ve=F+Z*10+d,ge=W+j*10+f,X=[];n.edgeLabel&&v.label&&X.push(v.label),n.weightLabel&&v.weight!=null&&X.push(v.weight),X.length&&this.drawLabel(h,X.join(", "),ve,ge,v.labelColor,s)}})}drawNodes(e,t,n,i,a,s,d,f){const h=e.ctx;h.clearRect(0,0,e.canvas.width,e.canvas.height),t.forEachNode((y,v)=>{h.beginPath(),h.arc(v.x,v.y,i*v.size,0,2*Math.PI),h.fillStyle=v.selected?"orange":v.color,h.fill(),a!==0&&(h.lineWidth=a,h.strokeStyle=v.selected?"orange":v.stroke,h.stroke()),h.closePath(),n.vertexLabel&&this.drawLabel(h,v.label,v.x+d,v.y+f,v.labelColor,s)})}}class lw{constructor(){this.eventBus=Qy,this.appSettings=new xu(this),this._canvas=null,this.layout=null,this.graphManager=null,this.rect=null,this.graphRenderer=null,this.menu=null,this.widget=null,this.keyHandler=null,this.eventHanders=null,this.colorPicker=null,this.simulation=null,this.nodes=[],this.links=[],this.init()}async init(){this.settings=await this.appSettings.init(),this._canvas=new Jy(this),this.canvas=this._canvas.canvas,this.layout=new Qb(this),this.graphManager=new gb(this,this.settings.type),this.rect=new rw(this),this.graphRenderer=new cw(this),this.menu=new Ab(this,Cb),this.widget=new nw(this),this.keyHandler=new mb(this),this.eventHanders=new kb(this),this.colorPicker=new uw(this),this.menu.init(),Eu(this.settings,this.canvas),this.widget.init(),this._canvas.init(),this.rect.init(),this.keyHandler.init(),this.eventHanders.init(),this.initSimulation(),this.loadInitialGraph(),this.colorPicker.init(),this.startAnimationLoop()}initSimulation(){this.nodes=this.graphManager.graph.getNodesForD3(),this.links=this.graphManager.graph.getEdgesForD3(),this.simulation=Hy(this.nodes).force("link",Gy(this.links).id(e=>e.id).distance(10).strength(.5)).force("charge",Yy().strength(-300)).force("collide",zy(20)).force("center",my(this.canvas.width/2,this.canvas.height/2)).force("x",Xy(this.canvas.width/2).strength(.05)).force("y",Vy(this.canvas.height/1).strength(.05)).velocityDecay(.3).alphaDecay(.02),this.appSettings.settings.forceSimulation||this.simulation.stop()}async loadInitialGraph(){const e=await this.graphManager.getLastSnapshot();e?(this.graphManager.loadSnapshot(e),await this.graphManager.updateIndex()):this.graphManager.generator.clusters(20,20,10)}ticked(){this.nodes.forEach(e=>{this.graphManager.graph.updateNodeAttributes(e.id,t=>({...t,x:e.x,y:e.y}))}),this.eventBus.emit("graph:updated",{type:"tick"})}startSimulation(){this.simulation.alpha(.3).restart()}stopSimulation(){this.simulation.stop()}updateSimulation(){this.nodes.length=0,this.nodes=this.graphManager.graph.getNodesForD3(),this.links.length=0,this.links=this.graphManager.graph.getEdgesForD3(),this.simulation.nodes(this.nodes),this.simulation.force("link").links(this.links),this.appSettings.settings.forceSimulation?this.startSimulation():this.stopSimulation()}updateForce(){const e=this.graphManager.graph;this.nodes.length=0,e.forEachNode((t,n)=>{this.nodes.push({id:Number(t),x:n.x,y:n.y})}),this.links.length=0,e.forEachEdge(function(t,n,i,a,s,d){this.links.push({source:Number(i),target:Number(a)})})}startAnimationLoop(){const e=()=>{this.appSettings.settings.forceSimulation?(this.simulation.tick(),this.ticked(),this.graphRenderer.drawGraph({node:!0,edge:!0,face:!0})):this.graphRenderer.drawGraph(this.graphManager.needsRedraw),requestAnimationFrame(e)};requestAnimationFrame(e)}}document.addEventListener("DOMContentLoaded",()=>{const r=new lw;window.graphStudio=r,window.addEventListener("resize",()=>{r._canvas.updateCanvasSize(window.innerWidth,window.innerHeight)}),document.querySelectorAll("img").forEach(e=>{e.setAttribute("draggable","false")})});
