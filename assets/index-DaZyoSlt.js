var Ah=Object.defineProperty;var ju=r=>{throw TypeError(r)};var kh=(r,e,t)=>e in r?Ah(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Ct=(r,e,t)=>kh(r,typeof e!="symbol"?e+"":e,t),Bu=(r,e,t)=>e.has(r)||ju("Cannot "+t);var Ca=(r,e,t)=>(Bu(r,e,"read from private field"),t?t.call(r):e.get(r)),Uu=(r,e,t)=>e.has(r)?ju("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Ku=(r,e,t,n)=>(Bu(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function Qa(r,e){let t=0,n=0;if(e===void 0)for(let i of r)i!=null&&(i=+i)>=i&&(++t,n+=i);else{let i=-1;for(let a of r)(a=e(a,++i,r))!=null&&(a=+a)>=a&&(++t,n+=a)}if(t)return n/t}var Ch={value:()=>{}};function ao(){for(var r=0,e=arguments.length,t={},n;r<e;++r){if(!(n=arguments[r]+"")||n in t||/[\s.]/.test(n))throw new Error("illegal type: "+n);t[n]=[]}return new Wa(t)}function Wa(r){this._=r}function Dh(r,e){return r.trim().split(/^|\s+/).map(function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}Wa.prototype=ao.prototype={constructor:Wa,on:function(r,e){var t=this._,n=Dh(r+"",t),i,a=-1,s=n.length;if(arguments.length<2){for(;++a<s;)if((i=(r=n[a]).type)&&(i=Ih(t[i],r.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(r=n[a]).type)t[i]=Wu(t[i],r.name,e);else if(e==null)for(i in t)t[i]=Wu(t[i],r.name,null);return this},copy:function(){var r={},e=this._;for(var t in e)r[t]=e[t].slice();return new Wa(r)},call:function(r,e){if((i=arguments.length-2)>0)for(var t=new Array(i),n=0,i,a;n<i;++n)t[n]=arguments[n+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],n=0,i=a.length;n<i;++n)a[n].value.apply(e,t)},apply:function(r,e,t){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var n=this._[r],i=0,a=n.length;i<a;++i)n[i].value.apply(e,t)}};function Ih(r,e){for(var t=0,n=r.length,i;t<n;++t)if((i=r[t]).name===e)return i.value}function Wu(r,e,t){for(var n=0,i=r.length;n<i;++n)if(r[n].name===e){r[n]=Ch,r=r.slice(0,n).concat(r.slice(n+1));break}return t!=null&&r.push({name:e,value:t}),r}var su="http://www.w3.org/1999/xhtml";const Hu={svg:"http://www.w3.org/2000/svg",xhtml:su,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function oo(r){var e=r+="",t=e.indexOf(":");return t>=0&&(e=r.slice(0,t))!=="xmlns"&&(r=r.slice(t+1)),Hu.hasOwnProperty(e)?{space:Hu[e],local:r}:r}function Mh(r){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===su&&e.documentElement.namespaceURI===su?e.createElement(r):e.createElementNS(t,r)}}function Ph(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function Cd(r){var e=oo(r);return(e.local?Ph:Mh)(e)}function Nh(){}function xu(r){return r==null?Nh:function(){return this.querySelector(r)}}function Oh(r){typeof r!="function"&&(r=xu(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=new Array(s),f,h,y=0;y<s;++y)(f=a[y])&&(h=r.call(f,f.__data__,y,a))&&("__data__"in f&&(h.__data__=f.__data__),d[y]=h);return new Yt(n,this._parents)}function Th(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function Rh(){return[]}function Dd(r){return r==null?Rh:function(){return this.querySelectorAll(r)}}function Lh(r){return function(){return Th(r.apply(this,arguments))}}function zh(r){typeof r=="function"?r=Lh(r):r=Dd(r);for(var e=this._groups,t=e.length,n=[],i=[],a=0;a<t;++a)for(var s=e[a],d=s.length,f,h=0;h<d;++h)(f=s[h])&&(n.push(r.call(f,f.__data__,h,s)),i.push(f));return new Yt(n,i)}function Id(r){return function(){return this.matches(r)}}function Md(r){return function(e){return e.matches(r)}}var $h=Array.prototype.find;function Gh(r){return function(){return $h.call(this.children,r)}}function qh(){return this.firstElementChild}function Fh(r){return this.select(r==null?qh:Gh(typeof r=="function"?r:Md(r)))}var jh=Array.prototype.filter;function Bh(){return Array.from(this.children)}function Uh(r){return function(){return jh.call(this.children,r)}}function Kh(r){return this.selectAll(r==null?Bh:Uh(typeof r=="function"?r:Md(r)))}function Wh(r){typeof r!="function"&&(r=Id(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=[],f,h=0;h<s;++h)(f=a[h])&&r.call(f,f.__data__,h,a)&&d.push(f);return new Yt(n,this._parents)}function Pd(r){return new Array(r.length)}function Hh(){return new Yt(this._enter||this._groups.map(Pd),this._parents)}function Za(r,e){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=e}Za.prototype={constructor:Za,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,e){return this._parent.insertBefore(r,e)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function Yh(r){return function(){return r}}function Xh(r,e,t,n,i,a){for(var s=0,d,f=e.length,h=a.length;s<h;++s)(d=e[s])?(d.__data__=a[s],n[s]=d):t[s]=new Za(r,a[s]);for(;s<f;++s)(d=e[s])&&(i[s]=d)}function Vh(r,e,t,n,i,a,s){var d,f,h=new Map,y=e.length,b=a.length,w=new Array(y),E;for(d=0;d<y;++d)(f=e[d])&&(w[d]=E=s.call(f,f.__data__,d,e)+"",h.has(E)?i[d]=f:h.set(E,f));for(d=0;d<b;++d)E=s.call(r,a[d],d,a)+"",(f=h.get(E))?(n[d]=f,f.__data__=a[d],h.delete(E)):t[d]=new Za(r,a[d]);for(d=0;d<y;++d)(f=e[d])&&h.get(w[d])===f&&(i[d]=f)}function Qh(r){return r.__data__}function Zh(r,e){if(!arguments.length)return Array.from(this,Qh);var t=e?Vh:Xh,n=this._parents,i=this._groups;typeof r!="function"&&(r=Yh(r));for(var a=i.length,s=new Array(a),d=new Array(a),f=new Array(a),h=0;h<a;++h){var y=n[h],b=i[h],w=b.length,E=Jh(r.call(y,y&&y.__data__,h,n)),I=E.length,D=d[h]=new Array(I),N=s[h]=new Array(I),O=f[h]=new Array(w);t(y,b,D,N,O,E,e);for(var P=0,z=0,C,L;P<I;++P)if(C=D[P]){for(P>=z&&(z=P+1);!(L=N[z])&&++z<I;);C._next=L||null}}return s=new Yt(s,n),s._enter=d,s._exit=f,s}function Jh(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function ef(){return new Yt(this._exit||this._groups.map(Pd),this._parents)}function tf(r,e,t){var n=this.enter(),i=this,a=this.exit();return typeof r=="function"?(n=r(n),n&&(n=n.selection())):n=n.append(r+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?a.remove():t(a),n&&i?n.merge(i).order():i}function nf(r){for(var e=r.selection?r.selection():r,t=this._groups,n=e._groups,i=t.length,a=n.length,s=Math.min(i,a),d=new Array(i),f=0;f<s;++f)for(var h=t[f],y=n[f],b=h.length,w=d[f]=new Array(b),E,I=0;I<b;++I)(E=h[I]||y[I])&&(w[I]=E);for(;f<i;++f)d[f]=t[f];return new Yt(d,this._parents)}function rf(){for(var r=this._groups,e=-1,t=r.length;++e<t;)for(var n=r[e],i=n.length-1,a=n[i],s;--i>=0;)(s=n[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function af(r){r||(r=of);function e(b,w){return b&&w?r(b.__data__,w.__data__):!b-!w}for(var t=this._groups,n=t.length,i=new Array(n),a=0;a<n;++a){for(var s=t[a],d=s.length,f=i[a]=new Array(d),h,y=0;y<d;++y)(h=s[y])&&(f[y]=h);f.sort(e)}return new Yt(i,this._parents).order()}function of(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function sf(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function uf(){return Array.from(this)}function cf(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,a=n.length;i<a;++i){var s=n[i];if(s)return s}return null}function lf(){let r=0;for(const e of this)++r;return r}function df(){return!this.node()}function hf(r){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var i=e[t],a=0,s=i.length,d;a<s;++a)(d=i[a])&&r.call(d,d.__data__,a,i);return this}function ff(r){return function(){this.removeAttribute(r)}}function pf(r){return function(){this.removeAttributeNS(r.space,r.local)}}function gf(r,e){return function(){this.setAttribute(r,e)}}function yf(r,e){return function(){this.setAttributeNS(r.space,r.local,e)}}function vf(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(r):this.setAttribute(r,t)}}function mf(r,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,t)}}function bf(r,e){var t=oo(r);if(arguments.length<2){var n=this.node();return t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}return this.each((e==null?t.local?pf:ff:typeof e=="function"?t.local?mf:vf:t.local?yf:gf)(t,e))}function Nd(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function wf(r){return function(){this.style.removeProperty(r)}}function xf(r,e,t){return function(){this.style.setProperty(r,e,t)}}function Ef(r,e,t){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(r):this.style.setProperty(r,n,t)}}function _f(r,e,t){return arguments.length>1?this.each((e==null?wf:typeof e=="function"?Ef:xf)(r,e,t??"")):hi(this.node(),r)}function hi(r,e){return r.style.getPropertyValue(e)||Nd(r).getComputedStyle(r,null).getPropertyValue(e)}function Sf(r){return function(){delete this[r]}}function Af(r,e){return function(){this[r]=e}}function kf(r,e){return function(){var t=e.apply(this,arguments);t==null?delete this[r]:this[r]=t}}function Cf(r,e){return arguments.length>1?this.each((e==null?Sf:typeof e=="function"?kf:Af)(r,e)):this.node()[r]}function Od(r){return r.trim().split(/^|\s+/)}function Eu(r){return r.classList||new Td(r)}function Td(r){this._node=r,this._names=Od(r.getAttribute("class")||"")}Td.prototype={add:function(r){var e=this._names.indexOf(r);e<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var e=this._names.indexOf(r);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function Rd(r,e){for(var t=Eu(r),n=-1,i=e.length;++n<i;)t.add(e[n])}function Ld(r,e){for(var t=Eu(r),n=-1,i=e.length;++n<i;)t.remove(e[n])}function Df(r){return function(){Rd(this,r)}}function If(r){return function(){Ld(this,r)}}function Mf(r,e){return function(){(e.apply(this,arguments)?Rd:Ld)(this,r)}}function Pf(r,e){var t=Od(r+"");if(arguments.length<2){for(var n=Eu(this.node()),i=-1,a=t.length;++i<a;)if(!n.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?Mf:e?Df:If)(t,e))}function Nf(){this.textContent=""}function Of(r){return function(){this.textContent=r}}function Tf(r){return function(){var e=r.apply(this,arguments);this.textContent=e??""}}function Rf(r){return arguments.length?this.each(r==null?Nf:(typeof r=="function"?Tf:Of)(r)):this.node().textContent}function Lf(){this.innerHTML=""}function zf(r){return function(){this.innerHTML=r}}function $f(r){return function(){var e=r.apply(this,arguments);this.innerHTML=e??""}}function Gf(r){return arguments.length?this.each(r==null?Lf:(typeof r=="function"?$f:zf)(r)):this.node().innerHTML}function qf(){this.nextSibling&&this.parentNode.appendChild(this)}function Ff(){return this.each(qf)}function jf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Bf(){return this.each(jf)}function Uf(r){var e=typeof r=="function"?r:Cd(r);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Kf(){return null}function Wf(r,e){var t=typeof r=="function"?r:Cd(r),n=e==null?Kf:typeof e=="function"?e:xu(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),n.apply(this,arguments)||null)})}function Hf(){var r=this.parentNode;r&&r.removeChild(this)}function Yf(){return this.each(Hf)}function Xf(){var r=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function Vf(){var r=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(r,this.nextSibling):r}function Qf(r){return this.select(r?Vf:Xf)}function Zf(r){return arguments.length?this.property("__data__",r):this.node().__data__}function Jf(r){return function(e){r.call(this,e,this.__data__)}}function ep(r){return r.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function tp(r){return function(){var e=this.__on;if(e){for(var t=0,n=-1,i=e.length,a;t<i;++t)a=e[t],(!r.type||a.type===r.type)&&a.name===r.name?this.removeEventListener(a.type,a.listener,a.options):e[++n]=a;++n?e.length=n:delete this.__on}}}function np(r,e,t){return function(){var n=this.__on,i,a=Jf(e);if(n){for(var s=0,d=n.length;s<d;++s)if((i=n[s]).type===r.type&&i.name===r.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=t),i.value=e;return}}this.addEventListener(r.type,a,t),i={type:r.type,name:r.name,value:e,listener:a,options:t},n?n.push(i):this.__on=[i]}}function rp(r,e,t){var n=ep(r+""),i,a=n.length,s;if(arguments.length<2){var d=this.node().__on;if(d){for(var f=0,h=d.length,y;f<h;++f)for(i=0,y=d[f];i<a;++i)if((s=n[i]).type===y.type&&s.name===y.name)return y.value}return}for(d=e?np:tp,i=0;i<a;++i)this.each(d(n[i],e,t));return this}function zd(r,e,t){var n=Nd(r),i=n.CustomEvent;typeof i=="function"?i=new i(e,t):(i=n.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),r.dispatchEvent(i)}function ip(r,e){return function(){return zd(this,r,e)}}function ap(r,e){return function(){return zd(this,r,e.apply(this,arguments))}}function op(r,e){return this.each((typeof e=="function"?ap:ip)(r,e))}function*sp(){for(var r=this._groups,e=0,t=r.length;e<t;++e)for(var n=r[e],i=0,a=n.length,s;i<a;++i)(s=n[i])&&(yield s)}var $d=[null];function Yt(r,e){this._groups=r,this._parents=e}function na(){return new Yt([[document.documentElement]],$d)}function up(){return this}Yt.prototype=na.prototype={constructor:Yt,select:Oh,selectAll:zh,selectChild:Fh,selectChildren:Kh,filter:Wh,data:Zh,enter:Hh,exit:ef,join:tf,merge:nf,selection:up,order:rf,sort:af,call:sf,nodes:uf,node:cf,size:lf,empty:df,each:hf,attr:bf,style:_f,property:Cf,classed:Pf,text:Rf,html:Gf,raise:Ff,lower:Bf,append:Uf,insert:Wf,remove:Yf,clone:Qf,datum:Zf,on:rp,dispatch:op,[Symbol.iterator]:sp};function Lt(r){return typeof r=="string"?new Yt([[document.querySelector(r)]],[document.documentElement]):new Yt([[r]],$d)}function cp(r){let e;for(;e=r.sourceEvent;)r=e;return r}function tn(r,e){if(r=cp(r),e===void 0&&(e=r.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var n=t.createSVGPoint();return n.x=r.clientX,n.y=r.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[r.clientX-i.left-e.clientLeft,r.clientY-i.top-e.clientTop]}}return[r.pageX,r.pageY]}const lp={passive:!1},Qi={capture:!0,passive:!1};function Ao(r){r.stopImmediatePropagation()}function li(r){r.preventDefault(),r.stopImmediatePropagation()}function dp(r){var e=r.document.documentElement,t=Lt(r).on("dragstart.drag",li,Qi);"onselectstart"in e?t.on("selectstart.drag",li,Qi):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function hp(r,e){var t=r.document.documentElement,n=Lt(r).on("dragstart.drag",null);e&&(n.on("click.drag",li,Qi),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in t?n.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Da=r=>()=>r;function uu(r,{sourceEvent:e,subject:t,target:n,identifier:i,active:a,x:s,y:d,dx:f,dy:h,dispatch:y}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:y}})}uu.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function fp(r){return!r.ctrlKey&&!r.button}function pp(){return this.parentNode}function gp(r,e){return e??{x:r.x,y:r.y}}function yp(){return navigator.maxTouchPoints||"ontouchstart"in this}function vp(){var r=fp,e=pp,t=gp,n=yp,i={},a=ao("start","drag","end"),s=0,d,f,h,y,b=0;function w(C){C.on("mousedown.drag",E).filter(n).on("touchstart.drag",N).on("touchmove.drag",O,lp).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function E(C,L){if(!(y||!r.call(this,C,L))){var K=z(this,e.call(this,C,L),C,L,"mouse");K&&(Lt(C.view).on("mousemove.drag",I,Qi).on("mouseup.drag",D,Qi),dp(C.view),Ao(C),h=!1,d=C.clientX,f=C.clientY,K("start",C))}}function I(C){if(li(C),!h){var L=C.clientX-d,K=C.clientY-f;h=L*L+K*K>b}i.mouse("drag",C)}function D(C){Lt(C.view).on("mousemove.drag mouseup.drag",null),hp(C.view,h),li(C),i.mouse("end",C)}function N(C,L){if(r.call(this,C,L)){var K=C.changedTouches,S=e.call(this,C,L),G=K.length,q,j;for(q=0;q<G;++q)(j=z(this,S,C,L,K[q].identifier,K[q]))&&(Ao(C),j("start",C,K[q]))}}function O(C){var L=C.changedTouches,K=L.length,S,G;for(S=0;S<K;++S)(G=i[L[S].identifier])&&(li(C),G("drag",C,L[S]))}function P(C){var L=C.changedTouches,K=L.length,S,G;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),S=0;S<K;++S)(G=i[L[S].identifier])&&(Ao(C),G("end",C,L[S]))}function z(C,L,K,S,G,q){var j=a.copy(),Y=tn(q||K,L),te,B,me;if((me=t.call(C,new uu("beforestart",{sourceEvent:K,target:w,identifier:G,active:s,x:Y[0],y:Y[1],dx:0,dy:0,dispatch:j}),S))!=null)return te=me.x-Y[0]||0,B=me.y-Y[1]||0,function ge(V,M,J){var ne=Y,de;switch(V){case"start":i[G]=ge,de=s++;break;case"end":delete i[G],--s;case"drag":Y=tn(J||M,L),de=s;break}j.call(V,C,new uu(V,{sourceEvent:M,subject:me,target:w,identifier:G,active:de,x:Y[0]+te,y:Y[1]+B,dx:Y[0]-ne[0],dy:Y[1]-ne[1],dispatch:j}),S)}}return w.filter=function(C){return arguments.length?(r=typeof C=="function"?C:Da(!!C),w):r},w.container=function(C){return arguments.length?(e=typeof C=="function"?C:Da(C),w):e},w.subject=function(C){return arguments.length?(t=typeof C=="function"?C:Da(C),w):t},w.touchable=function(C){return arguments.length?(n=typeof C=="function"?C:Da(!!C),w):n},w.on=function(){var C=a.on.apply(a,arguments);return C===a?w:C},w.clickDistance=function(C){return arguments.length?(b=(C=+C)*C,w):Math.sqrt(b)},w}function _u(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function Gd(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function ra(){}var Zi=.7,Ja=1/Zi,di="\\s*([+-]?\\d+)\\s*",Ji="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",On="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mp=/^#([0-9a-f]{3,8})$/,bp=new RegExp(`^rgb\\(${di},${di},${di}\\)$`),wp=new RegExp(`^rgb\\(${On},${On},${On}\\)$`),xp=new RegExp(`^rgba\\(${di},${di},${di},${Ji}\\)$`),Ep=new RegExp(`^rgba\\(${On},${On},${On},${Ji}\\)$`),_p=new RegExp(`^hsl\\(${Ji},${On},${On}\\)$`),Sp=new RegExp(`^hsla\\(${Ji},${On},${On},${Ji}\\)$`),Yu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_u(ra,ea,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:Xu,formatHex:Xu,formatHex8:Ap,formatHsl:kp,formatRgb:Vu,toString:Vu});function Xu(){return this.rgb().formatHex()}function Ap(){return this.rgb().formatHex8()}function kp(){return qd(this).formatHsl()}function Vu(){return this.rgb().formatRgb()}function ea(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=mp.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?Qu(e):t===3?new jt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Ia(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Ia(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=bp.exec(r))?new jt(e[1],e[2],e[3],1):(e=wp.exec(r))?new jt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=xp.exec(r))?Ia(e[1],e[2],e[3],e[4]):(e=Ep.exec(r))?Ia(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=_p.exec(r))?ec(e[1],e[2]/100,e[3]/100,1):(e=Sp.exec(r))?ec(e[1],e[2]/100,e[3]/100,e[4]):Yu.hasOwnProperty(r)?Qu(Yu[r]):r==="transparent"?new jt(NaN,NaN,NaN,0):null}function Qu(r){return new jt(r>>16&255,r>>8&255,r&255,1)}function Ia(r,e,t,n){return n<=0&&(r=e=t=NaN),new jt(r,e,t,n)}function Cp(r){return r instanceof ra||(r=ea(r)),r?(r=r.rgb(),new jt(r.r,r.g,r.b,r.opacity)):new jt}function cu(r,e,t,n){return arguments.length===1?Cp(r):new jt(r,e,t,n??1)}function jt(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}_u(jt,cu,Gd(ra,{brighter(r){return r=r==null?Ja:Math.pow(Ja,r),new jt(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Zi:Math.pow(Zi,r),new jt(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new jt(Nr(this.r),Nr(this.g),Nr(this.b),eo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zu,formatHex:Zu,formatHex8:Dp,formatRgb:Ju,toString:Ju}));function Zu(){return`#${Mr(this.r)}${Mr(this.g)}${Mr(this.b)}`}function Dp(){return`#${Mr(this.r)}${Mr(this.g)}${Mr(this.b)}${Mr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ju(){const r=eo(this.opacity);return`${r===1?"rgb(":"rgba("}${Nr(this.r)}, ${Nr(this.g)}, ${Nr(this.b)}${r===1?")":`, ${r})`}`}function eo(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Nr(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Mr(r){return r=Nr(r),(r<16?"0":"")+r.toString(16)}function ec(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new mn(r,e,t,n)}function qd(r){if(r instanceof mn)return new mn(r.h,r.s,r.l,r.opacity);if(r instanceof ra||(r=ea(r)),!r)return new mn;if(r instanceof mn)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),a=Math.max(e,t,n),s=NaN,d=a-i,f=(a+i)/2;return d?(e===a?s=(t-n)/d+(t<n)*6:t===a?s=(n-e)/d+2:s=(e-t)/d+4,d/=f<.5?a+i:2-a-i,s*=60):d=f>0&&f<1?0:s,new mn(s,d,f,r.opacity)}function Ip(r,e,t,n){return arguments.length===1?qd(r):new mn(r,e,t,n??1)}function mn(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}_u(mn,Ip,Gd(ra,{brighter(r){return r=r==null?Ja:Math.pow(Ja,r),new mn(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Zi:Math.pow(Zi,r),new mn(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new jt(ko(r>=240?r-240:r+120,i,n),ko(r,i,n),ko(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new mn(tc(this.h),Ma(this.s),Ma(this.l),eo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=eo(this.opacity);return`${r===1?"hsl(":"hsla("}${tc(this.h)}, ${Ma(this.s)*100}%, ${Ma(this.l)*100}%${r===1?")":`, ${r})`}`}}));function tc(r){return r=(r||0)%360,r<0?r+360:r}function Ma(r){return Math.max(0,Math.min(1,r||0))}function ko(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const Fd=r=>()=>r;function Mp(r,e){return function(t){return r+t*e}}function Pp(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function Np(r){return(r=+r)==1?jd:function(e,t){return t-e?Pp(e,t,r):Fd(isNaN(e)?t:e)}}function jd(r,e){var t=e-r;return t?Mp(r,t):Fd(isNaN(r)?e:r)}const nc=function r(e){var t=Np(e);function n(i,a){var s=t((i=cu(i)).r,(a=cu(a)).r),d=t(i.g,a.g),f=t(i.b,a.b),h=jd(i.opacity,a.opacity);return function(y){return i.r=s(y),i.g=d(y),i.b=f(y),i.opacity=h(y),i+""}}return n.gamma=r,n}(1);function sr(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}var lu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Co=new RegExp(lu.source,"g");function Op(r){return function(){return r}}function Tp(r){return function(e){return r(e)+""}}function Rp(r,e){var t=lu.lastIndex=Co.lastIndex=0,n,i,a,s=-1,d=[],f=[];for(r=r+"",e=e+"";(n=lu.exec(r))&&(i=Co.exec(e));)(a=i.index)>t&&(a=e.slice(t,a),d[s]?d[s]+=a:d[++s]=a),(n=n[0])===(i=i[0])?d[s]?d[s]+=i:d[++s]=i:(d[++s]=null,f.push({i:s,x:sr(n,i)})),t=Co.lastIndex;return t<e.length&&(a=e.slice(t),d[s]?d[s]+=a:d[++s]=a),d.length<2?f[0]?Tp(f[0].x):Op(e):(e=f.length,function(h){for(var y=0,b;y<e;++y)d[(b=f[y]).i]=b.x(h);return d.join("")})}var rc=180/Math.PI,du={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Bd(r,e,t,n,i,a){var s,d,f;return(s=Math.sqrt(r*r+e*e))&&(r/=s,e/=s),(f=r*t+e*n)&&(t-=r*f,n-=e*f),(d=Math.sqrt(t*t+n*n))&&(t/=d,n/=d,f/=d),r*n<e*t&&(r=-r,e=-e,f=-f,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,r)*rc,skewX:Math.atan(f)*rc,scaleX:s,scaleY:d}}var Pa;function Lp(r){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return e.isIdentity?du:Bd(e.a,e.b,e.c,e.d,e.e,e.f)}function zp(r){return r==null||(Pa||(Pa=document.createElementNS("http://www.w3.org/2000/svg","g")),Pa.setAttribute("transform",r),!(r=Pa.transform.baseVal.consolidate()))?du:(r=r.matrix,Bd(r.a,r.b,r.c,r.d,r.e,r.f))}function Ud(r,e,t,n){function i(h){return h.length?h.pop()+" ":""}function a(h,y,b,w,E,I){if(h!==b||y!==w){var D=E.push("translate(",null,e,null,t);I.push({i:D-4,x:sr(h,b)},{i:D-2,x:sr(y,w)})}else(b||w)&&E.push("translate("+b+e+w+t)}function s(h,y,b,w){h!==y?(h-y>180?y+=360:y-h>180&&(h+=360),w.push({i:b.push(i(b)+"rotate(",null,n)-2,x:sr(h,y)})):y&&b.push(i(b)+"rotate("+y+n)}function d(h,y,b,w){h!==y?w.push({i:b.push(i(b)+"skewX(",null,n)-2,x:sr(h,y)}):y&&b.push(i(b)+"skewX("+y+n)}function f(h,y,b,w,E,I){if(h!==b||y!==w){var D=E.push(i(E)+"scale(",null,",",null,")");I.push({i:D-4,x:sr(h,b)},{i:D-2,x:sr(y,w)})}else(b!==1||w!==1)&&E.push(i(E)+"scale("+b+","+w+")")}return function(h,y){var b=[],w=[];return h=r(h),y=r(y),a(h.translateX,h.translateY,y.translateX,y.translateY,b,w),s(h.rotate,y.rotate,b,w),d(h.skewX,y.skewX,b,w),f(h.scaleX,h.scaleY,y.scaleX,y.scaleY,b,w),h=y=null,function(E){for(var I=-1,D=w.length,N;++I<D;)b[(N=w[I]).i]=N.x(E);return b.join("")}}}var $p=Ud(Lp,"px, ","px)","deg)"),Gp=Ud(zp,", ",")",")"),fi=0,Wi=0,Gi=0,Kd=1e3,to,Hi,no=0,Or=0,so=0,ta=typeof performance=="object"&&performance.now?performance:Date,Wd=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Su(){return Or||(Wd(qp),Or=ta.now()+so)}function qp(){Or=0}function ro(){this._call=this._time=this._next=null}ro.prototype=Au.prototype={constructor:ro,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?Su():+t)+(e==null?0:+e),!this._next&&Hi!==this&&(Hi?Hi._next=this:to=this,Hi=this),this._call=r,this._time=t,hu()},stop:function(){this._call&&(this._call=null,this._time=1/0,hu())}};function Au(r,e,t){var n=new ro;return n.restart(r,e,t),n}function Fp(){Su(),++fi;for(var r=to,e;r;)(e=Or-r._time)>=0&&r._call.call(void 0,e),r=r._next;--fi}function ic(){Or=(no=ta.now())+so,fi=Wi=0;try{Fp()}finally{fi=0,Bp(),Or=0}}function jp(){var r=ta.now(),e=r-no;e>Kd&&(so-=e,no=r)}function Bp(){for(var r,e=to,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:to=t);Hi=r,hu(n)}function hu(r){if(!fi){Wi&&(Wi=clearTimeout(Wi));var e=r-Or;e>24?(r<1/0&&(Wi=setTimeout(ic,r-ta.now()-so)),Gi&&(Gi=clearInterval(Gi))):(Gi||(no=ta.now(),Gi=setInterval(jp,Kd)),fi=1,Wd(ic))}}function ac(r,e,t){var n=new ro;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}var Up=ao("start","end","cancel","interrupt"),Kp=[],Hd=0,oc=1,fu=2,Ha=3,sc=4,pu=5,Ya=6;function uo(r,e,t,n,i,a){var s=r.__transition;if(!s)r.__transition={};else if(t in s)return;Wp(r,t,{name:e,index:n,group:i,on:Up,tween:Kp,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Hd})}function ku(r,e){var t=bn(r,e);if(t.state>Hd)throw new Error("too late; already scheduled");return t}function Tn(r,e){var t=bn(r,e);if(t.state>Ha)throw new Error("too late; already running");return t}function bn(r,e){var t=r.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Wp(r,e,t){var n=r.__transition,i;n[e]=t,t.timer=Au(a,0,t.time);function a(h){t.state=oc,t.timer.restart(s,t.delay,t.time),t.delay<=h&&s(h-t.delay)}function s(h){var y,b,w,E;if(t.state!==oc)return f();for(y in n)if(E=n[y],E.name===t.name){if(E.state===Ha)return ac(s);E.state===sc?(E.state=Ya,E.timer.stop(),E.on.call("interrupt",r,r.__data__,E.index,E.group),delete n[y]):+y<e&&(E.state=Ya,E.timer.stop(),E.on.call("cancel",r,r.__data__,E.index,E.group),delete n[y])}if(ac(function(){t.state===Ha&&(t.state=sc,t.timer.restart(d,t.delay,t.time),d(h))}),t.state=fu,t.on.call("start",r,r.__data__,t.index,t.group),t.state===fu){for(t.state=Ha,i=new Array(w=t.tween.length),y=0,b=-1;y<w;++y)(E=t.tween[y].value.call(r,r.__data__,t.index,t.group))&&(i[++b]=E);i.length=b+1}}function d(h){for(var y=h<t.duration?t.ease.call(null,h/t.duration):(t.timer.restart(f),t.state=pu,1),b=-1,w=i.length;++b<w;)i[b].call(r,y);t.state===pu&&(t.on.call("end",r,r.__data__,t.index,t.group),f())}function f(){t.state=Ya,t.timer.stop(),delete n[e];for(var h in n)return;delete r.__transition}}function Hp(r,e){var t=r.__transition,n,i,a=!0,s;if(t){e=e==null?null:e+"";for(s in t){if((n=t[s]).name!==e){a=!1;continue}i=n.state>fu&&n.state<pu,n.state=Ya,n.timer.stop(),n.on.call(i?"interrupt":"cancel",r,r.__data__,n.index,n.group),delete t[s]}a&&delete r.__transition}}function Yp(r){return this.each(function(){Hp(this,r)})}function Xp(r,e){var t,n;return function(){var i=Tn(this,r),a=i.tween;if(a!==t){n=t=a;for(var s=0,d=n.length;s<d;++s)if(n[s].name===e){n=n.slice(),n.splice(s,1);break}}i.tween=n}}function Vp(r,e,t){var n,i;if(typeof t!="function")throw new Error;return function(){var a=Tn(this,r),s=a.tween;if(s!==n){i=(n=s).slice();for(var d={name:e,value:t},f=0,h=i.length;f<h;++f)if(i[f].name===e){i[f]=d;break}f===h&&i.push(d)}a.tween=i}}function Qp(r,e){var t=this._id;if(r+="",arguments.length<2){for(var n=bn(this.node(),t).tween,i=0,a=n.length,s;i<a;++i)if((s=n[i]).name===r)return s.value;return null}return this.each((e==null?Xp:Vp)(t,r,e))}function Cu(r,e,t){var n=r._id;return r.each(function(){var i=Tn(this,n);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return bn(i,n).value[e]}}function Yd(r,e){var t;return(typeof e=="number"?sr:e instanceof ea?nc:(t=ea(e))?(e=t,nc):Rp)(r,e)}function Zp(r){return function(){this.removeAttribute(r)}}function Jp(r){return function(){this.removeAttributeNS(r.space,r.local)}}function eg(r,e,t){var n,i=t+"",a;return function(){var s=this.getAttribute(r);return s===i?null:s===n?a:a=e(n=s,t)}}function tg(r,e,t){var n,i=t+"",a;return function(){var s=this.getAttributeNS(r.space,r.local);return s===i?null:s===n?a:a=e(n=s,t)}}function ng(r,e,t){var n,i,a;return function(){var s,d=t(this),f;return d==null?void this.removeAttribute(r):(s=this.getAttribute(r),f=d+"",s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d)))}}function rg(r,e,t){var n,i,a;return function(){var s,d=t(this),f;return d==null?void this.removeAttributeNS(r.space,r.local):(s=this.getAttributeNS(r.space,r.local),f=d+"",s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d)))}}function ig(r,e){var t=oo(r),n=t==="transform"?Gp:Yd;return this.attrTween(r,typeof e=="function"?(t.local?rg:ng)(t,n,Cu(this,"attr."+r,e)):e==null?(t.local?Jp:Zp)(t):(t.local?tg:eg)(t,n,e))}function ag(r,e){return function(t){this.setAttribute(r,e.call(this,t))}}function og(r,e){return function(t){this.setAttributeNS(r.space,r.local,e.call(this,t))}}function sg(r,e){var t,n;function i(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&og(r,a)),t}return i._value=e,i}function ug(r,e){var t,n;function i(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&ag(r,a)),t}return i._value=e,i}function cg(r,e){var t="attr."+r;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var n=oo(r);return this.tween(t,(n.local?sg:ug)(n,e))}function lg(r,e){return function(){ku(this,r).delay=+e.apply(this,arguments)}}function dg(r,e){return e=+e,function(){ku(this,r).delay=e}}function hg(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?lg:dg)(e,r)):bn(this.node(),e).delay}function fg(r,e){return function(){Tn(this,r).duration=+e.apply(this,arguments)}}function pg(r,e){return e=+e,function(){Tn(this,r).duration=e}}function gg(r){var e=this._id;return arguments.length?this.each((typeof r=="function"?fg:pg)(e,r)):bn(this.node(),e).duration}function yg(r,e){if(typeof e!="function")throw new Error;return function(){Tn(this,r).ease=e}}function vg(r){var e=this._id;return arguments.length?this.each(yg(e,r)):bn(this.node(),e).ease}function mg(r,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Tn(this,r).ease=t}}function bg(r){if(typeof r!="function")throw new Error;return this.each(mg(this._id,r))}function wg(r){typeof r!="function"&&(r=Id(r));for(var e=this._groups,t=e.length,n=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,d=n[i]=[],f,h=0;h<s;++h)(f=a[h])&&r.call(f,f.__data__,h,a)&&d.push(f);return new Kn(n,this._parents,this._name,this._id)}function xg(r){if(r._id!==this._id)throw new Error;for(var e=this._groups,t=r._groups,n=e.length,i=t.length,a=Math.min(n,i),s=new Array(n),d=0;d<a;++d)for(var f=e[d],h=t[d],y=f.length,b=s[d]=new Array(y),w,E=0;E<y;++E)(w=f[E]||h[E])&&(b[E]=w);for(;d<n;++d)s[d]=e[d];return new Kn(s,this._parents,this._name,this._id)}function Eg(r){return(r+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function _g(r,e,t){var n,i,a=Eg(e)?ku:Tn;return function(){var s=a(this,r),d=s.on;d!==n&&(i=(n=d).copy()).on(e,t),s.on=i}}function Sg(r,e){var t=this._id;return arguments.length<2?bn(this.node(),t).on.on(r):this.each(_g(t,r,e))}function Ag(r){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==r)return;e&&e.removeChild(this)}}function kg(){return this.on("end.remove",Ag(this._id))}function Cg(r){var e=this._name,t=this._id;typeof r!="function"&&(r=xu(r));for(var n=this._groups,i=n.length,a=new Array(i),s=0;s<i;++s)for(var d=n[s],f=d.length,h=a[s]=new Array(f),y,b,w=0;w<f;++w)(y=d[w])&&(b=r.call(y,y.__data__,w,d))&&("__data__"in y&&(b.__data__=y.__data__),h[w]=b,uo(h[w],e,t,w,h,bn(y,t)));return new Kn(a,this._parents,e,t)}function Dg(r){var e=this._name,t=this._id;typeof r!="function"&&(r=Dd(r));for(var n=this._groups,i=n.length,a=[],s=[],d=0;d<i;++d)for(var f=n[d],h=f.length,y,b=0;b<h;++b)if(y=f[b]){for(var w=r.call(y,y.__data__,b,f),E,I=bn(y,t),D=0,N=w.length;D<N;++D)(E=w[D])&&uo(E,e,t,D,w,I);a.push(w),s.push(y)}return new Kn(a,s,e,t)}var Ig=na.prototype.constructor;function Mg(){return new Ig(this._groups,this._parents)}function Pg(r,e){var t,n,i;return function(){var a=hi(this,r),s=(this.style.removeProperty(r),hi(this,r));return a===s?null:a===t&&s===n?i:i=e(t=a,n=s)}}function Xd(r){return function(){this.style.removeProperty(r)}}function Ng(r,e,t){var n,i=t+"",a;return function(){var s=hi(this,r);return s===i?null:s===n?a:a=e(n=s,t)}}function Og(r,e,t){var n,i,a;return function(){var s=hi(this,r),d=t(this),f=d+"";return d==null&&(f=d=(this.style.removeProperty(r),hi(this,r))),s===f?null:s===n&&f===i?a:(i=f,a=e(n=s,d))}}function Tg(r,e){var t,n,i,a="style."+e,s="end."+a,d;return function(){var f=Tn(this,r),h=f.on,y=f.value[a]==null?d||(d=Xd(e)):void 0;(h!==t||i!==y)&&(n=(t=h).copy()).on(s,i=y),f.on=n}}function Rg(r,e,t){var n=(r+="")=="transform"?$p:Yd;return e==null?this.styleTween(r,Pg(r,n)).on("end.style."+r,Xd(r)):typeof e=="function"?this.styleTween(r,Og(r,n,Cu(this,"style."+r,e))).each(Tg(this._id,r)):this.styleTween(r,Ng(r,n,e),t).on("end.style."+r,null)}function Lg(r,e,t){return function(n){this.style.setProperty(r,e.call(this,n),t)}}function zg(r,e,t){var n,i;function a(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Lg(r,s,t)),n}return a._value=e,a}function $g(r,e,t){var n="style."+(r+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,zg(r,e,t??""))}function Gg(r){return function(){this.textContent=r}}function qg(r){return function(){var e=r(this);this.textContent=e??""}}function Fg(r){return this.tween("text",typeof r=="function"?qg(Cu(this,"text",r)):Gg(r==null?"":r+""))}function jg(r){return function(e){this.textContent=r.call(this,e)}}function Bg(r){var e,t;function n(){var i=r.apply(this,arguments);return i!==t&&(e=(t=i)&&jg(i)),e}return n._value=r,n}function Ug(r){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(r==null)return this.tween(e,null);if(typeof r!="function")throw new Error;return this.tween(e,Bg(r))}function Kg(){for(var r=this._name,e=this._id,t=Vd(),n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],d=s.length,f,h=0;h<d;++h)if(f=s[h]){var y=bn(f,e);uo(f,r,t,h,s,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new Kn(n,this._parents,r,t)}function Wg(){var r,e,t=this,n=t._id,i=t.size();return new Promise(function(a,s){var d={value:s},f={value:function(){--i===0&&a()}};t.each(function(){var h=Tn(this,n),y=h.on;y!==r&&(e=(r=y).copy(),e._.cancel.push(d),e._.interrupt.push(d),e._.end.push(f)),h.on=e}),i===0&&a()})}var Hg=0;function Kn(r,e,t,n){this._groups=r,this._parents=e,this._name=t,this._id=n}function Vd(){return++Hg}var Fn=na.prototype;Kn.prototype={constructor:Kn,select:Cg,selectAll:Dg,selectChild:Fn.selectChild,selectChildren:Fn.selectChildren,filter:wg,merge:xg,selection:Mg,transition:Kg,call:Fn.call,nodes:Fn.nodes,node:Fn.node,size:Fn.size,empty:Fn.empty,each:Fn.each,on:Sg,attr:ig,attrTween:cg,style:Rg,styleTween:$g,text:Fg,textTween:Ug,remove:kg,tween:Qp,delay:hg,duration:gg,ease:vg,easeVarying:bg,end:Wg,[Symbol.iterator]:Fn[Symbol.iterator]};function Yg(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var Xg={time:null,delay:0,duration:250,ease:Yg};function Vg(r,e){for(var t;!(t=r.__transition)||!(t=t[e]);)if(!(r=r.parentNode))throw new Error(`transition ${e} not found`);return t}function Qg(r){var e,t;r instanceof Kn?(e=r._id,r=r._name):(e=Vd(),(t=Xg).time=Su(),r=r==null?null:r+"");for(var n=this._groups,i=n.length,a=0;a<i;++a)for(var s=n[a],d=s.length,f,h=0;h<d;++h)(f=s[h])&&uo(f,r,e,h,s,t||Vg(f,e));return new Kn(n,this._parents,r,e)}na.prototype.interrupt=Yp;na.prototype.transition=Qg;function Zg(r,e){var t,n=1;r==null&&(r=0),e==null&&(e=0);function i(){var a,s=t.length,d,f=0,h=0;for(a=0;a<s;++a)d=t[a],f+=d.x,h+=d.y;for(f=(f/s-r)*n,h=(h/s-e)*n,a=0;a<s;++a)d=t[a],d.x-=f,d.y-=h}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(r=+a,i):r},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(n=+a,i):n},i}function Jg(r){const e=+this._x.call(null,r),t=+this._y.call(null,r);return Qd(this.cover(e,t),e,t,r)}function Qd(r,e,t,n){if(isNaN(e)||isNaN(t))return r;var i,a=r._root,s={data:n},d=r._x0,f=r._y0,h=r._x1,y=r._y1,b,w,E,I,D,N,O,P;if(!a)return r._root=s,r;for(;a.length;)if((D=e>=(b=(d+h)/2))?d=b:h=b,(N=t>=(w=(f+y)/2))?f=w:y=w,i=a,!(a=a[O=N<<1|D]))return i[O]=s,r;if(E=+r._x.call(null,a.data),I=+r._y.call(null,a.data),e===E&&t===I)return s.next=a,i?i[O]=s:r._root=s,r;do i=i?i[O]=new Array(4):r._root=new Array(4),(D=e>=(b=(d+h)/2))?d=b:h=b,(N=t>=(w=(f+y)/2))?f=w:y=w;while((O=N<<1|D)===(P=(I>=w)<<1|E>=b));return i[P]=a,i[O]=s,r}function ey(r){var e,t,n=r.length,i,a,s=new Array(n),d=new Array(n),f=1/0,h=1/0,y=-1/0,b=-1/0;for(t=0;t<n;++t)isNaN(i=+this._x.call(null,e=r[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,d[t]=a,i<f&&(f=i),i>y&&(y=i),a<h&&(h=a),a>b&&(b=a));if(f>y||h>b)return this;for(this.cover(f,h).cover(y,b),t=0;t<n;++t)Qd(this,s[t],d[t],r[t]);return this}function ty(r,e){if(isNaN(r=+r)||isNaN(e=+e))return this;var t=this._x0,n=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(r))+1,a=(n=Math.floor(e))+1;else{for(var s=i-t||1,d=this._root,f,h;t>r||r>=i||n>e||e>=a;)switch(h=(e<n)<<1|r<t,f=new Array(4),f[h]=d,d=f,s*=2,h){case 0:i=t+s,a=n+s;break;case 1:t=i-s,a=n+s;break;case 2:i=t+s,n=a-s;break;case 3:t=i-s,n=a-s;break}this._root&&this._root.length&&(this._root=d)}return this._x0=t,this._y0=n,this._x1=i,this._y1=a,this}function ny(){var r=[];return this.visit(function(e){if(!e.length)do r.push(e.data);while(e=e.next)}),r}function ry(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function zt(r,e,t,n,i){this.node=r,this.x0=e,this.y0=t,this.x1=n,this.y1=i}function iy(r,e,t){var n,i=this._x0,a=this._y0,s,d,f,h,y=this._x1,b=this._y1,w=[],E=this._root,I,D;for(E&&w.push(new zt(E,i,a,y,b)),t==null?t=1/0:(i=r-t,a=e-t,y=r+t,b=e+t,t*=t);I=w.pop();)if(!(!(E=I.node)||(s=I.x0)>y||(d=I.y0)>b||(f=I.x1)<i||(h=I.y1)<a))if(E.length){var N=(s+f)/2,O=(d+h)/2;w.push(new zt(E[3],N,O,f,h),new zt(E[2],s,O,N,h),new zt(E[1],N,d,f,O),new zt(E[0],s,d,N,O)),(D=(e>=O)<<1|r>=N)&&(I=w[w.length-1],w[w.length-1]=w[w.length-1-D],w[w.length-1-D]=I)}else{var P=r-+this._x.call(null,E.data),z=e-+this._y.call(null,E.data),C=P*P+z*z;if(C<t){var L=Math.sqrt(t=C);i=r-L,a=e-L,y=r+L,b=e+L,n=E.data}}return n}function ay(r){if(isNaN(y=+this._x.call(null,r))||isNaN(b=+this._y.call(null,r)))return this;var e,t=this._root,n,i,a,s=this._x0,d=this._y0,f=this._x1,h=this._y1,y,b,w,E,I,D,N,O;if(!t)return this;if(t.length)for(;;){if((I=y>=(w=(s+f)/2))?s=w:f=w,(D=b>=(E=(d+h)/2))?d=E:h=E,e=t,!(t=t[N=D<<1|I]))return this;if(!t.length)break;(e[N+1&3]||e[N+2&3]||e[N+3&3])&&(n=e,O=N)}for(;t.data!==r;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[N]=a:delete e[N],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(n?n[O]=t:this._root=t),this):(this._root=a,this)}function oy(r){for(var e=0,t=r.length;e<t;++e)this.remove(r[e]);return this}function sy(){return this._root}function uy(){var r=0;return this.visit(function(e){if(!e.length)do++r;while(e=e.next)}),r}function cy(r){var e=[],t,n=this._root,i,a,s,d,f;for(n&&e.push(new zt(n,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!r(n=t.node,a=t.x0,s=t.y0,d=t.x1,f=t.y1)&&n.length){var h=(a+d)/2,y=(s+f)/2;(i=n[3])&&e.push(new zt(i,h,y,d,f)),(i=n[2])&&e.push(new zt(i,a,y,h,f)),(i=n[1])&&e.push(new zt(i,h,s,d,y)),(i=n[0])&&e.push(new zt(i,a,s,h,y))}return this}function ly(r){var e=[],t=[],n;for(this._root&&e.push(new zt(this._root,this._x0,this._y0,this._x1,this._y1));n=e.pop();){var i=n.node;if(i.length){var a,s=n.x0,d=n.y0,f=n.x1,h=n.y1,y=(s+f)/2,b=(d+h)/2;(a=i[0])&&e.push(new zt(a,s,d,y,b)),(a=i[1])&&e.push(new zt(a,y,d,f,b)),(a=i[2])&&e.push(new zt(a,s,b,y,h)),(a=i[3])&&e.push(new zt(a,y,b,f,h))}t.push(n)}for(;n=t.pop();)r(n.node,n.x0,n.y0,n.x1,n.y1);return this}function dy(r){return r[0]}function hy(r){return arguments.length?(this._x=r,this):this._x}function fy(r){return r[1]}function py(r){return arguments.length?(this._y=r,this):this._y}function Du(r,e,t){var n=new Iu(e??dy,t??fy,NaN,NaN,NaN,NaN);return r==null?n:n.addAll(r)}function Iu(r,e,t,n,i,a){this._x=r,this._y=e,this._x0=t,this._y0=n,this._x1=i,this._y1=a,this._root=void 0}function uc(r){for(var e={data:r.data},t=e;r=r.next;)t=t.next={data:r.data};return e}var Gt=Du.prototype=Iu.prototype;Gt.copy=function(){var r=new Iu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,n;if(!e)return r;if(!e.length)return r._root=uc(e),r;for(t=[{source:e,target:r._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(n=e.source[i])&&(n.length?t.push({source:n,target:e.target[i]=new Array(4)}):e.target[i]=uc(n));return r};Gt.add=Jg;Gt.addAll=ey;Gt.cover=ty;Gt.data=ny;Gt.extent=ry;Gt.find=iy;Gt.remove=ay;Gt.removeAll=oy;Gt.root=sy;Gt.size=uy;Gt.visit=cy;Gt.visitAfter=ly;Gt.x=hy;Gt.y=py;function $t(r){return function(){return r}}function ur(r){return(r()-.5)*1e-6}function gy(r){return r.x+r.vx}function yy(r){return r.y+r.vy}function vy(r){var e,t,n,i=1,a=1;typeof r!="function"&&(r=$t(r==null?1:+r));function s(){for(var h,y=e.length,b,w,E,I,D,N,O=0;O<a;++O)for(b=Du(e,gy,yy).visitAfter(d),h=0;h<y;++h)w=e[h],D=t[w.index],N=D*D,E=w.x+w.vx,I=w.y+w.vy,b.visit(P);function P(z,C,L,K,S){var G=z.data,q=z.r,j=D+q;if(G){if(G.index>w.index){var Y=E-G.x-G.vx,te=I-G.y-G.vy,B=Y*Y+te*te;B<j*j&&(Y===0&&(Y=ur(n),B+=Y*Y),te===0&&(te=ur(n),B+=te*te),B=(j-(B=Math.sqrt(B)))/B*i,w.vx+=(Y*=B)*(j=(q*=q)/(N+q)),w.vy+=(te*=B)*j,G.vx-=Y*(j=1-j),G.vy-=te*j)}return}return C>E+j||K<E-j||L>I+j||S<I-j}}function d(h){if(h.data)return h.r=t[h.data.index];for(var y=h.r=0;y<4;++y)h[y]&&h[y].r>h.r&&(h.r=h[y].r)}function f(){if(e){var h,y=e.length,b;for(t=new Array(y),h=0;h<y;++h)b=e[h],t[b.index]=+r(b,h,e)}}return s.initialize=function(h,y){e=h,n=y,f()},s.iterations=function(h){return arguments.length?(a=+h,s):a},s.strength=function(h){return arguments.length?(i=+h,s):i},s.radius=function(h){return arguments.length?(r=typeof h=="function"?h:$t(+h),f(),s):r},s}function my(r){return r.index}function cc(r,e){var t=r.get(e);if(!t)throw new Error("node not found: "+e);return t}function by(r){var e=my,t=b,n,i=$t(30),a,s,d,f,h,y=1;r==null&&(r=[]);function b(N){return 1/Math.min(d[N.source.index],d[N.target.index])}function w(N){for(var O=0,P=r.length;O<y;++O)for(var z=0,C,L,K,S,G,q,j;z<P;++z)C=r[z],L=C.source,K=C.target,S=K.x+K.vx-L.x-L.vx||ur(h),G=K.y+K.vy-L.y-L.vy||ur(h),q=Math.sqrt(S*S+G*G),q=(q-a[z])/q*N*n[z],S*=q,G*=q,K.vx-=S*(j=f[z]),K.vy-=G*j,L.vx+=S*(j=1-j),L.vy+=G*j}function E(){if(s){var N,O=s.length,P=r.length,z=new Map(s.map((L,K)=>[e(L,K,s),L])),C;for(N=0,d=new Array(O);N<P;++N)C=r[N],C.index=N,typeof C.source!="object"&&(C.source=cc(z,C.source)),typeof C.target!="object"&&(C.target=cc(z,C.target)),d[C.source.index]=(d[C.source.index]||0)+1,d[C.target.index]=(d[C.target.index]||0)+1;for(N=0,f=new Array(P);N<P;++N)C=r[N],f[N]=d[C.source.index]/(d[C.source.index]+d[C.target.index]);n=new Array(P),I(),a=new Array(P),D()}}function I(){if(s)for(var N=0,O=r.length;N<O;++N)n[N]=+t(r[N],N,r)}function D(){if(s)for(var N=0,O=r.length;N<O;++N)a[N]=+i(r[N],N,r)}return w.initialize=function(N,O){s=N,h=O,E()},w.links=function(N){return arguments.length?(r=N,E(),w):r},w.id=function(N){return arguments.length?(e=N,w):e},w.iterations=function(N){return arguments.length?(y=+N,w):y},w.strength=function(N){return arguments.length?(t=typeof N=="function"?N:$t(+N),I(),w):t},w.distance=function(N){return arguments.length?(i=typeof N=="function"?N:$t(+N),D(),w):i},w}const wy=1664525,xy=1013904223,lc=4294967296;function Ey(){let r=1;return()=>(r=(wy*r+xy)%lc)/lc}function _y(r){return r.x}function Sy(r){return r.y}var Ay=10,ky=Math.PI*(3-Math.sqrt(5));function Cy(r){var e,t=1,n=.001,i=1-Math.pow(n,1/300),a=0,s=.6,d=new Map,f=Au(b),h=ao("tick","end"),y=Ey();r==null&&(r=[]);function b(){w(),h.call("tick",e),t<n&&(f.stop(),h.call("end",e))}function w(D){var N,O=r.length,P;D===void 0&&(D=1);for(var z=0;z<D;++z)for(t+=(a-t)*i,d.forEach(function(C){C(t)}),N=0;N<O;++N)P=r[N],P.fx==null?P.x+=P.vx*=s:(P.x=P.fx,P.vx=0),P.fy==null?P.y+=P.vy*=s:(P.y=P.fy,P.vy=0);return e}function E(){for(var D=0,N=r.length,O;D<N;++D){if(O=r[D],O.index=D,O.fx!=null&&(O.x=O.fx),O.fy!=null&&(O.y=O.fy),isNaN(O.x)||isNaN(O.y)){var P=Ay*Math.sqrt(.5+D),z=D*ky;O.x=P*Math.cos(z),O.y=P*Math.sin(z)}(isNaN(O.vx)||isNaN(O.vy))&&(O.vx=O.vy=0)}}function I(D){return D.initialize&&D.initialize(r,y),D}return E(),e={tick:w,restart:function(){return f.restart(b),e},stop:function(){return f.stop(),e},nodes:function(D){return arguments.length?(r=D,E(),d.forEach(I),e):r},alpha:function(D){return arguments.length?(t=+D,e):t},alphaMin:function(D){return arguments.length?(n=+D,e):n},alphaDecay:function(D){return arguments.length?(i=+D,e):+i},alphaTarget:function(D){return arguments.length?(a=+D,e):a},velocityDecay:function(D){return arguments.length?(s=1-D,e):1-s},randomSource:function(D){return arguments.length?(y=D,d.forEach(I),e):y},force:function(D,N){return arguments.length>1?(N==null?d.delete(D):d.set(D,I(N)),e):d.get(D)},find:function(D,N,O){var P=0,z=r.length,C,L,K,S,G;for(O==null?O=1/0:O*=O,P=0;P<z;++P)S=r[P],C=D-S.x,L=N-S.y,K=C*C+L*L,K<O&&(G=S,O=K);return G},on:function(D,N){return arguments.length>1?(h.on(D,N),e):h.on(D)}}}function Dy(){var r,e,t,n,i=$t(-30),a,s=1,d=1/0,f=.81;function h(E){var I,D=r.length,N=Du(r,_y,Sy).visitAfter(b);for(n=E,I=0;I<D;++I)e=r[I],N.visit(w)}function y(){if(r){var E,I=r.length,D;for(a=new Array(I),E=0;E<I;++E)D=r[E],a[D.index]=+i(D,E,r)}}function b(E){var I=0,D,N,O=0,P,z,C;if(E.length){for(P=z=C=0;C<4;++C)(D=E[C])&&(N=Math.abs(D.value))&&(I+=D.value,O+=N,P+=N*D.x,z+=N*D.y);E.x=P/O,E.y=z/O}else{D=E,D.x=D.data.x,D.y=D.data.y;do I+=a[D.data.index];while(D=D.next)}E.value=I}function w(E,I,D,N){if(!E.value)return!0;var O=E.x-e.x,P=E.y-e.y,z=N-I,C=O*O+P*P;if(z*z/f<C)return C<d&&(O===0&&(O=ur(t),C+=O*O),P===0&&(P=ur(t),C+=P*P),C<s&&(C=Math.sqrt(s*C)),e.vx+=O*E.value*n/C,e.vy+=P*E.value*n/C),!0;if(E.length||C>=d)return;(E.data!==e||E.next)&&(O===0&&(O=ur(t),C+=O*O),P===0&&(P=ur(t),C+=P*P),C<s&&(C=Math.sqrt(s*C)));do E.data!==e&&(z=a[E.data.index]*n/C,e.vx+=O*z,e.vy+=P*z);while(E=E.next)}return h.initialize=function(E,I){r=E,t=I,y()},h.strength=function(E){return arguments.length?(i=typeof E=="function"?E:$t(+E),y(),h):i},h.distanceMin=function(E){return arguments.length?(s=E*E,h):Math.sqrt(s)},h.distanceMax=function(E){return arguments.length?(d=E*E,h):Math.sqrt(d)},h.theta=function(E){return arguments.length?(f=E*E,h):Math.sqrt(f)},h}function Iy(r){var e=$t(.1),t,n,i;typeof r!="function"&&(r=$t(r==null?0:+r));function a(d){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vx+=(i[f]-y.x)*n[f]*d}function s(){if(t){var d,f=t.length;for(n=new Array(f),i=new Array(f),d=0;d<f;++d)n[d]=isNaN(i[d]=+r(t[d],d,t))?0:+e(t[d],d,t)}}return a.initialize=function(d){t=d,s()},a.strength=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),s(),a):e},a.x=function(d){return arguments.length?(r=typeof d=="function"?d:$t(+d),s(),a):r},a}function My(r){var e=$t(.1),t,n,i;typeof r!="function"&&(r=$t(r==null?0:+r));function a(d){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vy+=(i[f]-y.y)*n[f]*d}function s(){if(t){var d,f=t.length;for(n=new Array(f),i=new Array(f),d=0;d<f;++d)n[d]=isNaN(i[d]=+r(t[d],d,t))?0:+e(t[d],d,t)}}return a.initialize=function(d){t=d,s()},a.strength=function(d){return arguments.length?(e=typeof d=="function"?d:$t(+d),s(),a):e},a.y=function(d){return arguments.length?(r=typeof d=="function"?d:$t(+d),s(),a):r},a}function Yi(r,e,t){this.k=r,this.x=e,this.y=t}Yi.prototype={constructor:Yi,scale:function(r){return r===1?this:new Yi(this.k*r,this.x,this.y)},translate:function(r,e){return r===0&e===0?this:new Yi(this.k,this.x+this.k*r,this.y+this.k*e)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Yi.prototype;const Py={listeners:new Map,emit(r,e={}){document.dispatchEvent(new CustomEvent(r,{detail:e}))},on(r,e){if(typeof e!="function"){console.warn(`EventBus: Tried to register a non-function listener for event: ${r}`);return}this.listeners.has(r)||this.listeners.set(r,new Set);const t=this.listeners.get(r);if(t.has(e)){console.warn(`EventBus: Listener for event "${r}" is already registered.`);return}document.addEventListener(r,e),t.add(e)},off(r,e){if(!this.listeners.has(r)){console.warn(`EventBus: Attempted to remove a listener from a non-existent event: ${r}`);return}const t=this.listeners.get(r);if(!t.has(e)){console.warn(`EventBus: Attempted to remove a non-existent listener from event: ${r}`);return}document.removeEventListener(r,e),t.delete(e),t.size===0&&this.listeners.delete(r)},removeAll(r){if(!this.listeners.has(r)){console.warn(`EventBus: Attempted to remove all listeners from a non-existent event: ${r}`);return}this.listeners.get(r).forEach(e=>{document.removeEventListener(r,e)}),this.listeners.delete(r)}};function Do(r){const e=new Set(r.map(Number));let t=0;for(;e.has(t);)t++;return t}function Vi(r,e=3){const t="abcdefghijklmnopqrstuvwxyz",n=[];function i(s,d,f){if(f===0){n.push(s);return}for(let h=d;h<t.length;h++)if(i(s+t[h],h+1,f-1),n.length>r)return}let a=1;for(;n.length<=r&&a<=e;)i("",0,a),a++;return n[r]||null}function Ny(r,e,t,n,i,a){let s=r-t,d=e-n,f=i-t,h=a-n,y=s*f+d*h,b=f*f+h*h,w=b!==0?y/b:-1,E,I;w<0?(E=t,I=n):w>1?(E=i,I=a):(E=t+w*f,I=n+w*h);let D=r-E,N=e-I;return Math.sqrt(D*D+N*N)}function Na(r,e){return(r%e+e)%e}function Io(r,e){r=r.replace(/^#/,""),(r.length===3||r.length===4)&&(r=r.split("").map(n=>n+n).join("")),r.length===8&&(r=r.slice(0,6));const t=Math.round(Math.min(Math.max(e,0),1)*255).toString(16).padStart(2,"0");return`#${r}${t}`}class Oy{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.appSettings.settings,this._canvas={main:{canvas:Lt("#main-canvas").node(),ctx:Lt("#main-canvas").node().getContext("2d")},node:{canvas:Lt("#node-canvas").node(),ctx:Lt("#node-canvas").node().getContext("2d")},edge:{canvas:Lt("#edge-canvas").node(),ctx:Lt("#edge-canvas").node().getContext("2d")},face:{canvas:Lt("#face-canvas").node(),ctx:Lt("#face-canvas").node().getContext("2d")}},this.canvas=Lt("#main-canvas").node(),this.ctx=this.canvas.getContext("2d"),this.mouse={x:0,y:0,dragging:!1}}init(){this.updateCanvasSize(window.innerWidth,window.innerHeight),this.canvas.addEventListener("dblclick",this.handleDbclick.bind(this)),this.canvas.addEventListener("click",this.handleClick.bind(this));let e=0;this.canvas.addEventListener("touchend",t=>{const n=new Date().getTime(),i=n-e;i<300&&i>0&&this.handleDbclick(t),e=n}),Lt("#main-canvas").on("mousedown",t=>{this.mouse.dragging=!1,[this.mouse.x,this.mouse.y]=tn(t)}).on("mousemove",t=>{const[n,i]=tn(t);(Math.abs(n-this.mouse.x)>2||Math.abs(i-this.mouse.y)>2)&&(this.mouse.dragging=!0)}).on("mouseup",t=>{this.mouse.dragging||([this.mouse.x,this.mouse.y]=tn(t))}),Lt(this.canvas).call(vp().container(this.canvas).subject(this.dragsubject.bind(this)).filter(t=>!(this.settings.scale||this.settings.select)).on("start",this.dragstarted.bind(this)).on("drag",this.dragged.bind(this)).on("end",this.dragended.bind(this)))}updateCanvasSize(e,t){for(const n in this._canvas)this._canvas[n].canvas.width=e,this._canvas[n].canvas.height=t;this.app.graphManager.redraw()}addNodeAtEvent(e){e.preventDefault();const[t,n]=e.type=="touchend"?dc(e,this.canvas):tn(e,this.canvas),i=[...new Set(this.app.graphManager.graphs.all.flatMap(d=>d.nodes()))],a=Do(i),s=Vi(a);this.app.graphManager.addNode(a,{x:t,y:n,color:this.settings.node_color,label:s})}addNodeConnectedToNode(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(s=>s.nodes()))],n=Do(t),i=Vi(n),a={x:e.x+30,y:e.y+30,color:this.settings.node_color,label:i};this.app.graphManager.addNode(n,a),this.app.graphManager.graph.addEdge(e.id,n),this.app.graphManager.saveGraphState("tree-node")}dragsubject(e){let t={id:null},n=1/0;return this.app.nodes.forEach(i=>{const a=e.x-i.x,s=e.y-i.y,d=Math.sqrt(a*a+s*s);d<this.settings.node_radius*i.size&&d<n&&(n=d,t=i)}),t&&(this.settings.component?t.component=this.app.graphManager.metric.getComponent(t.id):t.component=this.app.graphManager.graph.getSelectedNodes()),this.settings.panning&&(t.component=this.app.graphManager.graph.nodes()),t}dragstarted(e){e.subject.fx=e.subject.x,e.subject.fy=e.subject.y,e.subject.__moved=!1,e.subject.id!==null&&(this.app.graphManager.update=!0,this.canvas.style.cursor="grab",!e.active&&this.settings.forceSimulation&&this.app.simulation.alphaTarget(.5).restart()),this.settings.performance?this.app.graphManager.needsRedraw={node:!0,edge:!1,face:!1}:this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0}}dragged(e){if(e.subject.fx=e.x,e.subject.fy=e.y,(e.dx!==0||e.dy!==0)&&(e.subject.__moved=!0),!this.settings.forceSimulation&&e.subject.component){for(let t of e.subject.component)this.app.graphManager.graph.updateNodeAttributes(t,n=>({...n,x:n.x+e.dx,y:n.y+e.dy}));e.subject.id!==null&&(this.canvas.style.cursor="grabbing",this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y})))}}dragended(e){e.active||this.app.simulation.alphaTarget(0),e.subject.fx=null,e.subject.fy=null,e.subject.x=e.x,e.subject.y=e.y,this.canvas.style.cursor="default",this.settings.forceSimulation||this.app.updateSimulation(),e.subject.__moved&&e.subject.id!==null&&!this.settings.forceSimulation&&(this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y})),this.settings.forceSimulation||this.app.graphManager.saveGraphState("update-position"))}findClickedNode(e,t){return this.app.nodes.find(n=>{let i=e-n.x,a=t-n.y;return Math.sqrt(i*i+a*a)<this.settings.node_radius*n.size})}findClickedEdge(e,t){let n=10;const i=this.app.graphManager.graph.getEdgesForD3().find(a=>{let s=this.app.graphManager.graph.getNodeAttributes(a.source),d=this.app.graphManager.graph.getNodeAttributes(a.target);return Ny(e,t,s.x,s.y,d.x,d.y)<n});if(i)return{source:this.app.graphManager.graph.getNodeAttributes(i.source),target:this.app.graphManager.graph.getNodeAttributes(i.target)}}insertNodeInEdge(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(d=>d.nodes()))],n=Do(t),i=Vi(n);let a=(e.source.x+e.target.x)/2,s=(e.source.y+e.target.y)/2;this.app.graphManager.graph.addNode(n,{x:a,y:s,color:this.settings.color,label:i}),this.app.graphManager.graph.dropEdge(e.source.id,e.target.id),this.app.graphManager.graph.addEdge(e.source.id,n),this.app.graphManager.graph.addEdge(n,e.target.id),this.app.graphManager.saveGraphState("tree-edge")}handleDbclick(e){const[t,n]=e.type=="touchend"?dc(e,this.canvas):tn(e,this.canvas);let i=this.findClickedNode(t,n),a=this.findClickedEdge(t,n);i?this.settings.tree?this.addNodeConnectedToNode(i):(this.app.graphManager.graph.toggleNodeSelection(i.id),this.app.graphManager.redraw({node:!0})):a?this.settings.tree?this.insertNodeInEdge(a):this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s),this.app.graphManager.redraw({edge:!0})}):this.addNodeAtEvent(e)}handleClick(e){if(this.mouse.dragging)return;let[t,n]=tn(e,this.canvas),i=this.findClickedNode(t,n),a=this.findClickedEdge(t,n);i?this.settings.select?this.app.graphManager.graph.toggleNodeSelection(i.id):(this.app.graphManager.metric.addNEFGInfo(i),this.settings.colorPicker&&(this.app.colorPicker.setColor("node",i.color),this.app.colorPicker.setColor("stroke",i.stroke),this.app.colorPicker.setColor("label",i.labelColor))):a?this.settings.select?this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s)}):(this.app.graphManager.metric.addNEFGInfo(a),this.settings.colorPicker&&(this.app.colorPicker.setColor("edge",a.color),this.app.colorPicker.setColor("label",a.labelColor))):(this.app.graphManager.deselectAll(),this.app.rect.scale.active=!1)}}function dc(r,e){const t=r.changedTouches[0],n=e.getBoundingClientRect();return[t.clientX-n.left,t.clientY-n.top]}var Ty=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Oa={exports:{}},hc;function Ry(){if(hc)return Oa.exports;hc=1;var r=typeof Reflect=="object"?Reflect:null,e=r&&typeof r.apply=="function"?r.apply:function(L,K,S){return Function.prototype.apply.call(L,K,S)},t;r&&typeof r.ownKeys=="function"?t=r.ownKeys:Object.getOwnPropertySymbols?t=function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:t=function(L){return Object.getOwnPropertyNames(L)};function n(C){console&&console.warn&&console.warn(C)}var i=Number.isNaN||function(L){return L!==L};function a(){a.init.call(this)}Oa.exports=a,Oa.exports.once=O,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function d(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(C){if(typeof C!="number"||C<0||i(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");s=C}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(L){if(typeof L!="number"||L<0||i(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this};function f(C){return C._maxListeners===void 0?a.defaultMaxListeners:C._maxListeners}a.prototype.getMaxListeners=function(){return f(this)},a.prototype.emit=function(L){for(var K=[],S=1;S<arguments.length;S++)K.push(arguments[S]);var G=L==="error",q=this._events;if(q!==void 0)G=G&&q.error===void 0;else if(!G)return!1;if(G){var j;if(K.length>0&&(j=K[0]),j instanceof Error)throw j;var Y=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw Y.context=j,Y}var te=q[L];if(te===void 0)return!1;if(typeof te=="function")e(te,this,K);else for(var B=te.length,me=I(te,B),S=0;S<B;++S)e(me[S],this,K);return!0};function h(C,L,K,S){var G,q,j;if(d(K),q=C._events,q===void 0?(q=C._events=Object.create(null),C._eventsCount=0):(q.newListener!==void 0&&(C.emit("newListener",L,K.listener?K.listener:K),q=C._events),j=q[L]),j===void 0)j=q[L]=K,++C._eventsCount;else if(typeof j=="function"?j=q[L]=S?[K,j]:[j,K]:S?j.unshift(K):j.push(K),G=f(C),G>0&&j.length>G&&!j.warned){j.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=C,Y.type=L,Y.count=j.length,n(Y)}return C}a.prototype.addListener=function(L,K){return h(this,L,K,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(L,K){return h(this,L,K,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(C,L,K){var S={fired:!1,wrapFn:void 0,target:C,type:L,listener:K},G=y.bind(S);return G.listener=K,S.wrapFn=G,G}a.prototype.once=function(L,K){return d(K),this.on(L,b(this,L,K)),this},a.prototype.prependOnceListener=function(L,K){return d(K),this.prependListener(L,b(this,L,K)),this},a.prototype.removeListener=function(L,K){var S,G,q,j,Y;if(d(K),G=this._events,G===void 0)return this;if(S=G[L],S===void 0)return this;if(S===K||S.listener===K)--this._eventsCount===0?this._events=Object.create(null):(delete G[L],G.removeListener&&this.emit("removeListener",L,S.listener||K));else if(typeof S!="function"){for(q=-1,j=S.length-1;j>=0;j--)if(S[j]===K||S[j].listener===K){Y=S[j].listener,q=j;break}if(q<0)return this;q===0?S.shift():D(S,q),S.length===1&&(G[L]=S[0]),G.removeListener!==void 0&&this.emit("removeListener",L,Y||K)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(L){var K,S,G;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[L]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[L]),this;if(arguments.length===0){var q=Object.keys(S),j;for(G=0;G<q.length;++G)j=q[G],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(K=S[L],typeof K=="function")this.removeListener(L,K);else if(K!==void 0)for(G=K.length-1;G>=0;G--)this.removeListener(L,K[G]);return this};function w(C,L,K){var S=C._events;if(S===void 0)return[];var G=S[L];return G===void 0?[]:typeof G=="function"?K?[G.listener||G]:[G]:K?N(G):I(G,G.length)}a.prototype.listeners=function(L){return w(this,L,!0)},a.prototype.rawListeners=function(L){return w(this,L,!1)},a.listenerCount=function(C,L){return typeof C.listenerCount=="function"?C.listenerCount(L):E.call(C,L)},a.prototype.listenerCount=E;function E(C){var L=this._events;if(L!==void 0){var K=L[C];if(typeof K=="function")return 1;if(K!==void 0)return K.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function I(C,L){for(var K=new Array(L),S=0;S<L;++S)K[S]=C[S];return K}function D(C,L){for(;L+1<C.length;L++)C[L]=C[L+1];C.pop()}function N(C){for(var L=new Array(C.length),K=0;K<L.length;++K)L[K]=C[K].listener||C[K];return L}function O(C,L){return new Promise(function(K,S){function G(j){C.removeListener(L,q),S(j)}function q(){typeof C.removeListener=="function"&&C.removeListener("error",G),K([].slice.call(arguments))}z(C,L,q,{once:!0}),L!=="error"&&P(C,G,{once:!0})})}function P(C,L,K){typeof C.on=="function"&&z(C,"error",L,K)}function z(C,L,K,S){if(typeof C.on=="function")S.once?C.once(L,K):C.on(L,K);else if(typeof C.addEventListener=="function")C.addEventListener(L,function G(q){S.once&&C.removeEventListener(L,G),K(q)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return Oa.exports}var Ly=Ry(),Mo,fc;function Tr(){if(fc)return Mo;fc=1;function r(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}return typeof Symbol<"u"&&(r.prototype[Symbol.iterator]=function(){return this}),r.of=function(){var e=arguments,t=e.length,n=0;return new r(function(){return n>=t?{done:!0}:{done:!1,value:e[n++]}})},r.empty=function(){var e=new r(function(){return{done:!0}});return e},r.fromSequence=function(e){var t=0,n=e.length;return new r(function(){return t>=n?{done:!0}:{done:!1,value:e[t++]}})},r.is=function(e){return e instanceof r?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"},Mo=r,Mo}var zy=Tr();const rn=Mt(zy);var Ta={},pc;function Zd(){return pc||(pc=1,Ta.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u",Ta.SYMBOL_SUPPORT=typeof Symbol<"u"),Ta}var Po,gc;function Jd(){if(gc)return Po;gc=1;var r=Tr(),e=Zd(),t=e.ARRAY_BUFFER_SUPPORT,n=e.SYMBOL_SUPPORT;function i(a){return typeof a=="string"||Array.isArray(a)||t&&ArrayBuffer.isView(a)?r.fromSequence(a):typeof a!="object"||a===null?null:n&&typeof a[Symbol.iterator]=="function"?a[Symbol.iterator]():typeof a.next=="function"?a:null}return Po=function(s){var d=i(s);if(!d)throw new Error("obliterator: target is not iterable nor a valid iterator.");return d},Po}var No,yc;function $y(){if(yc)return No;yc=1;var r=Jd();return No=function(t,n){for(var i=arguments.length>1?n:1/0,a=i!==1/0?new Array(i):[],s,d=0,f=r(t);;){if(d===i)return a;if(s=f.next(),s.done)return d!==n&&(a.length=d),a;a[d++]=s.value}},No}var Gy=$y();const eh=Mt(Gy);var Oo,vc;function qy(){if(vc)return Oo;vc=1;var r=Tr(),e=Jd();return Oo=function(){var n=arguments,i=null,a=-1;return new r(function(){var d=null;do{if(i===null){if(a++,a>=n.length)return{done:!0};i=e(n[a])}if(d=i.next(),d.done===!0){i=null;continue}break}while(!0);return d})},Oo}var Fy=qy();const Un=Mt(Fy);function jy(){const r=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const n in arguments[e])r[n]=arguments[e][n];return r}let pt=jy;typeof Object.assign=="function"&&(pt=Object.assign);function nn(r,e,t,n){const i=r._nodes.get(e);let a=null;return i&&(n==="mixed"?a=i.out&&i.out[t]||i.undirected&&i.undirected[t]:n==="directed"?a=i.out&&i.out[t]:a=i.undirected&&i.undirected[t]),a}function wt(r){return typeof r=="object"&&r!==null}function th(r){let e;for(e in r)return!1;return!0}function Zt(r,e,t){Object.defineProperty(r,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function gn(r,e,t){const n={enumerable:!0,configurable:!0};typeof t=="function"?n.get=t:(n.value=t,n.writable=!1),Object.defineProperty(r,e,n)}function mc(r){return!(!wt(r)||r.attributes&&!Array.isArray(r.attributes))}function By(){let r=Math.floor(Math.random()*256)&255;return()=>r++}class Mu extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}let Ne=class nh extends Mu{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,nh.prototype.constructor)}};class Ae extends Mu{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ae.prototype.constructor)}}class Fe extends Mu{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Fe.prototype.constructor)}}function rh(r,e){this.key=r,this.attributes=e,this.clear()}rh.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function ih(r,e){this.key=r,this.attributes=e,this.clear()}ih.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function ah(r,e){this.key=r,this.attributes=e,this.clear()}ah.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function pi(r,e,t,n,i){this.key=e,this.attributes=i,this.undirected=r,this.source=t,this.target=n}pi.prototype.attach=function(){let r="out",e="in";this.undirected&&(r=e="undirected");const t=this.source.key,n=this.target.key;this.source[r][n]=this,!(this.undirected&&t===n)&&(this.target[e][t]=this)};pi.prototype.attachMulti=function(){let r="out",e="in";const t=this.source.key,n=this.target.key;this.undirected&&(r=e="undirected");const i=this.source[r],a=i[n];if(typeof a>"u"){i[n]=this,this.undirected&&t===n||(this.target[e][t]=this);return}a.previous=this,this.next=a,i[n]=this,this.target[e][t]=this};pi.prototype.detach=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),delete this.source[t][e],delete this.target[n][r]};pi.prototype.detachMulti=function(){const r=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[n][r]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[n][r]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const oh=0,sh=1,Uy=2,uh=3;function Wn(r,e,t,n,i,a,s){let d,f,h,y;if(n=""+n,t===oh){if(d=r._nodes.get(n),!d)throw new Ae(`Graph.${e}: could not find the "${n}" node in the graph.`);h=i,y=a}else if(t===uh){if(i=""+i,f=r._edges.get(i),!f)throw new Ae(`Graph.${e}: could not find the "${i}" edge in the graph.`);const b=f.source.key,w=f.target.key;if(n===b)d=f.target;else if(n===w)d=f.source;else throw new Ae(`Graph.${e}: the "${n}" node is not attached to the "${i}" edge (${b}, ${w}).`);h=a,y=s}else{if(f=r._edges.get(n),!f)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`);t===sh?d=f.source:d=f.target,h=i,y=a}return[d,h,y]}function Ky(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);return s.attributes[d]}}function Wy(r,e,t){r.prototype[e]=function(n,i){const[a]=Wn(this,e,t,n,i);return a.attributes}}function Hy(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);return s.attributes.hasOwnProperty(d)}}function Yy(r,e,t){r.prototype[e]=function(n,i,a,s){const[d,f,h]=Wn(this,e,t,n,i,a,s);return d.attributes[f]=h,this.emit("nodeAttributesUpdated",{key:d.key,type:"set",attributes:d.attributes,name:f}),this}}function Xy(r,e,t){r.prototype[e]=function(n,i,a,s){const[d,f,h]=Wn(this,e,t,n,i,a,s);if(typeof h!="function")throw new Ne(`Graph.${e}: updater should be a function.`);const y=d.attributes,b=h(y[f]);return y[f]=b,this.emit("nodeAttributesUpdated",{key:d.key,type:"set",attributes:d.attributes,name:f}),this}}function Vy(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);return delete s.attributes[d],this.emit("nodeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:d}),this}}function Qy(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);if(!wt(d))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function Zy(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);if(!wt(d))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return pt(s.attributes,d),this.emit("nodeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:d}),this}}function Jy(r,e,t){r.prototype[e]=function(n,i,a){const[s,d]=Wn(this,e,t,n,i,a);if(typeof d!="function")throw new Ne(`Graph.${e}: provided updater is not a function.`);return s.attributes=d(s.attributes),this.emit("nodeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const ev=[{name:r=>`get${r}Attribute`,attacher:Ky},{name:r=>`get${r}Attributes`,attacher:Wy},{name:r=>`has${r}Attribute`,attacher:Hy},{name:r=>`set${r}Attribute`,attacher:Yy},{name:r=>`update${r}Attribute`,attacher:Xy},{name:r=>`remove${r}Attribute`,attacher:Vy},{name:r=>`replace${r}Attributes`,attacher:Qy},{name:r=>`merge${r}Attributes`,attacher:Zy},{name:r=>`update${r}Attributes`,attacher:Jy}];function tv(r){ev.forEach(function({name:e,attacher:t}){t(r,e("Node"),oh),t(r,e("Source"),sh),t(r,e("Target"),Uy),t(r,e("Opposite"),uh)})}function nv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes[i]}}function rv(r,e,t){r.prototype[e]=function(n){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,s=""+arguments[1];if(i=nn(this,a,s,t),!i)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return i.attributes}}function iv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes.hasOwnProperty(i)}}function av(r,e,t){r.prototype[e]=function(n,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const d=""+n,f=""+i;if(i=arguments[2],a=arguments[3],s=nn(this,d,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${d}" - "${f}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return s.attributes[i]=a,this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function ov(r,e,t){r.prototype[e]=function(n,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const d=""+n,f=""+i;if(i=arguments[2],a=arguments[3],s=nn(this,d,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${d}" - "${f}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof a!="function")throw new Ne(`Graph.${e}: updater should be a function.`);return s.attributes[i]=a(s.attributes[i]),this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function sv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return delete a.attributes[i],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:i}),this}}function uv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!wt(i))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=i,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function cv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!wt(i))throw new Ne(`Graph.${e}: provided attributes are not a plain object.`);return pt(a.attributes,i),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:i}),this}}function lv(r,e,t){r.prototype[e]=function(n,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new Fe(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Fe(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,d=""+i;if(i=arguments[2],a=nn(this,s,d,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${d}").`)}else{if(t!=="mixed")throw new Fe(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new Ae(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof i!="function")throw new Ne(`Graph.${e}: provided updater is not a function.`);return a.attributes=i(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const dv=[{name:r=>`get${r}Attribute`,attacher:nv},{name:r=>`get${r}Attributes`,attacher:rv},{name:r=>`has${r}Attribute`,attacher:iv},{name:r=>`set${r}Attribute`,attacher:av},{name:r=>`update${r}Attribute`,attacher:ov},{name:r=>`remove${r}Attribute`,attacher:sv},{name:r=>`replace${r}Attributes`,attacher:uv},{name:r=>`merge${r}Attributes`,attacher:cv},{name:r=>`update${r}Attributes`,attacher:lv}];function hv(r){dv.forEach(function({name:e,attacher:t}){t(r,e("Edge"),"mixed"),t(r,e("DirectedEdge"),"directed"),t(r,e("UndirectedEdge"),"undirected")})}const fv=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function pv(r,e,t,n){let i=!1;for(const a in e){if(a===n)continue;const s=e[a];if(i=t(s.key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes,s.undirected),r&&i)return s.key}}function gv(r,e,t,n){let i,a,s,d=!1;for(const f in e)if(f!==n){i=e[f];do{if(a=i.source,s=i.target,d=t(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected),r&&d)return i.key;i=i.next}while(i!==void 0)}}function To(r,e){const t=Object.keys(r),n=t.length;let i,a=0;return new rn(function(){do if(i)i=i.next;else{if(a>=n)return{done:!0};const d=t[a++];if(d===e){i=void 0;continue}i=r[d]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function yv(r,e,t,n){const i=e[t];if(!i)return;const a=i.source,s=i.target;if(n(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected)&&r)return i.key}function vv(r,e,t,n){let i=e[t];if(!i)return;let a=!1;do{if(a=n(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),r&&a)return i.key;i=i.next}while(i!==void 0)}function Ro(r,e){let t=r[e];return t.next!==void 0?new rn(function(){if(!t)return{done:!0};const n={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:n}}):rn.of({edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected})}function mv(r,e){if(r.size===0)return[];if(e==="mixed"||e===r.type)return typeof Array.from=="function"?Array.from(r._edges.keys()):eh(r._edges.keys(),r._edges.size);const t=e==="undirected"?r.undirectedSize:r.directedSize,n=new Array(t),i=e==="undirected",a=r._edges.values();let s=0,d,f;for(;d=a.next(),d.done!==!0;)f=d.value,f.undirected===i&&(n[s++]=f.key);return n}function ch(r,e,t,n){if(e.size===0)return;const i=t!=="mixed"&&t!==e.type,a=t==="undirected";let s,d,f=!1;const h=e._edges.values();for(;s=h.next(),s.done!==!0;){if(d=s.value,i&&d.undirected!==a)continue;const{key:y,attributes:b,source:w,target:E}=d;if(f=n(y,b,w.key,E.key,w.attributes,E.attributes,d.undirected),r&&f)return y}}function bv(r,e){if(r.size===0)return rn.empty();const t=e!=="mixed"&&e!==r.type,n=e==="undirected",i=r._edges.values();return new rn(function(){let s,d;for(;;){if(s=i.next(),s.done)return s;if(d=s.value,!(t&&d.undirected!==n))break}return{value:{edge:d.key,attributes:d.attributes,source:d.source.key,target:d.target.key,sourceAttributes:d.source.attributes,targetAttributes:d.target.attributes,undirected:d.undirected},done:!1}})}function Pu(r,e,t,n,i,a){const s=e?gv:pv;let d;if(t!=="undirected"&&(n!=="out"&&(d=s(r,i.in,a),r&&d)||n!=="in"&&(d=s(r,i.out,a,n?void 0:i.key),r&&d))||t!=="directed"&&(d=s(r,i.undirected,a),r&&d))return d}function wv(r,e,t,n){const i=[];return Pu(!1,r,e,t,n,function(a){i.push(a)}),i}function xv(r,e,t){let n=rn.empty();return r!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(n=Un(n,To(t.in))),e!=="in"&&typeof t.out<"u"&&(n=Un(n,To(t.out,e?void 0:t.key)))),r!=="directed"&&typeof t.undirected<"u"&&(n=Un(n,To(t.undirected))),n}function Nu(r,e,t,n,i,a,s){const d=t?vv:yv;let f;if(e!=="undirected"&&(typeof i.in<"u"&&n!=="out"&&(f=d(r,i.in,a,s),r&&f)||typeof i.out<"u"&&n!=="in"&&(n||i.key!==a)&&(f=d(r,i.out,a,s),r&&f))||e!=="directed"&&typeof i.undirected<"u"&&(f=d(r,i.undirected,a,s),r&&f))return f}function Ev(r,e,t,n,i){const a=[];return Nu(!1,r,e,t,n,i,function(s){a.push(s)}),a}function _v(r,e,t,n){let i=rn.empty();return r!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&n in t.in&&(i=Un(i,Ro(t.in,n))),typeof t.out<"u"&&e!=="in"&&n in t.out&&(e||t.key!==n)&&(i=Un(i,Ro(t.out,n)))),r!=="directed"&&typeof t.undirected<"u"&&n in t.undirected&&(i=Un(i,Ro(t.undirected,n))),i}function Sv(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(a,s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return mv(this,n);if(arguments.length===1){a=""+a;const d=this._nodes.get(a);if(typeof d>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return wv(this.multi,n==="mixed"?this.type:n,i,d)}if(arguments.length===2){a=""+a,s=""+s;const d=this._nodes.get(a);if(!d)throw new Ae(`Graph.${t}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new Ae(`Graph.${t}:  could not find the "${s}" target node in the graph.`);return Ev(n,this.multi,i,d,s)}throw new Ne(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Av(r,e){const{name:t,type:n,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(h,y,b){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return b=h,ch(!1,this,n,b);if(arguments.length===2){h=""+h,b=y;const w=this._nodes.get(h);if(typeof w>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);return Pu(!1,this.multi,n==="mixed"?this.type:n,i,w,b)}if(arguments.length===3){h=""+h,y=""+y;const w=this._nodes.get(h);if(!w)throw new Ae(`Graph.${a}:  could not find the "${h}" source node in the graph.`);if(!this._nodes.has(y))throw new Ae(`Graph.${a}:  could not find the "${y}" target node in the graph.`);return Nu(!1,n,this.multi,i,w,y,b)}throw new Ne(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const s="map"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop();let b;if(h.length===0){let w=0;n!=="directed"&&(w+=this.undirectedSize),n!=="undirected"&&(w+=this.directedSize),b=new Array(w);let E=0;h.push((I,D,N,O,P,z,C)=>{b[E++]=y(I,D,N,O,P,z,C)})}else b=[],h.push((w,E,I,D,N,O,P)=>{b.push(y(w,E,I,D,N,O,P))});return this[a].apply(this,h),b};const d="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[d]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop(),b=[];return h.push((w,E,I,D,N,O,P)=>{y(w,E,I,D,N,O,P)&&b.push(w)}),this[a].apply(this,h),b};const f="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[f]=function(){let h=Array.prototype.slice.call(arguments);if(h.length<2||h.length>4)throw new Ne(`Graph.${f}: invalid number of arguments (expecting 2, 3 or 4 and got ${h.length}).`);if(typeof h[h.length-1]=="function"&&typeof h[h.length-2]!="function")throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let y,b;h.length===2?(y=h[0],b=h[1],h=[]):h.length===3?(y=h[1],b=h[2],h=[h[0]]):h.length===4&&(y=h[2],b=h[3],h=[h[0],h[1]]);let w=b;return h.push((E,I,D,N,O,P,z)=>{w=y(w,E,I,D,N,O,P,z)}),this[a].apply(this,h),w}}function kv(r,e){const{name:t,type:n,direction:i}=e,a="find"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(f,h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return y=f,ch(!0,this,n,y);if(arguments.length===2){f=""+f,y=h;const b=this._nodes.get(f);if(typeof b>"u")throw new Ae(`Graph.${a}: could not find the "${f}" node in the graph.`);return Pu(!0,this.multi,n==="mixed"?this.type:n,i,b,y)}if(arguments.length===3){f=""+f,h=""+h;const b=this._nodes.get(f);if(!b)throw new Ae(`Graph.${a}:  could not find the "${f}" source node in the graph.`);if(!this._nodes.has(h))throw new Ae(`Graph.${a}:  could not find the "${h}" target node in the graph.`);return Nu(!0,n,this.multi,i,b,h,y)}throw new Ne(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const s="some"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((b,w,E,I,D,N,O)=>h(b,w,E,I,D,N,O)),!!this[a].apply(this,f)};const d="every"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[d]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((b,w,E,I,D,N,O)=>!h(b,w,E,I,D,N,O)),!this[a].apply(this,f)}}function Cv(r,e){const{name:t,type:n,direction:i}=e,a=t.slice(0,-1)+"Entries";r.prototype[a]=function(s,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rn.empty();if(!arguments.length)return bv(this,n);if(arguments.length===1){s=""+s;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return xv(n,i,f)}if(arguments.length===2){s=""+s,d=""+d;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(d))throw new Ae(`Graph.${a}:  could not find the "${d}" target node in the graph.`);return _v(n,i,f,d)}throw new Ne(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Dv(r){fv.forEach(e=>{Sv(r,e),Av(r,e),kv(r,e),Cv(r,e)})}const Iv=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function co(){this.A=null,this.B=null}co.prototype.wrap=function(r){this.A===null?this.A=r:this.B===null&&(this.B=r)};co.prototype.has=function(r){return this.A!==null&&r in this.A||this.B!==null&&r in this.B};function qi(r,e,t,n,i){for(const a in n){const s=n[a],d=s.source,f=s.target,h=d===t?f:d;if(e&&e.has(h.key))continue;const y=i(h.key,h.attributes);if(r&&y)return h.key}}function Ou(r,e,t,n,i){if(e!=="mixed"){if(e==="undirected")return qi(r,null,n,n.undirected,i);if(typeof t=="string")return qi(r,null,n,n[t],i)}const a=new co;let s;if(e!=="undirected"){if(t!=="out"){if(s=qi(r,null,n,n.in,i),r&&s)return s;a.wrap(n.in)}if(t!=="in"){if(s=qi(r,a,n,n.out,i),r&&s)return s;a.wrap(n.out)}}if(e!=="directed"&&(s=qi(r,a,n,n.undirected,i),r&&s))return s}function Mv(r,e,t){if(r!=="mixed"){if(r==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const n=[];return Ou(!1,r,e,t,function(i){n.push(i)}),n}function Fi(r,e,t){const n=Object.keys(t),i=n.length;let a=0;return new rn(function(){let d=null;do{if(a>=i)return r&&r.wrap(t),{done:!0};const f=t[n[a++]],h=f.source,y=f.target;if(d=h===e?y:h,r&&r.has(d.key)){d=null;continue}}while(d===null);return{done:!1,value:{neighbor:d.key,attributes:d.attributes}}})}function Pv(r,e,t){if(r!=="mixed"){if(r==="undirected")return Fi(null,t,t.undirected);if(typeof e=="string")return Fi(null,t,t[e])}let n=rn.empty();const i=new co;return r!=="undirected"&&(e!=="out"&&(n=Un(n,Fi(i,t,t.in))),e!=="in"&&(n=Un(n,Fi(i,t,t.out)))),r!=="directed"&&(n=Un(n,Fi(i,t,t.undirected))),n}function Nv(r,e){const{name:t,type:n,direction:i}=e;r.prototype[t]=function(a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return Mv(n==="mixed"?this.type:n,i,s)}}function Ov(r,e){const{name:t,type:n,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;h=""+h;const b=this._nodes.get(h);if(typeof b>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);Ou(!1,n==="mixed"?this.type:n,i,b,y)};const s="map"+t[0].toUpperCase()+t.slice(1);r.prototype[s]=function(h,y){const b=[];return this[a](h,(w,E)=>{b.push(y(w,E))}),b};const d="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[d]=function(h,y){const b=[];return this[a](h,(w,E)=>{y(w,E)&&b.push(w)}),b};const f="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[f]=function(h,y,b){if(arguments.length<3)throw new Ne(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let w=b;return this[a](h,(E,I)=>{w=y(w,E,I)}),w}}function Tv(r,e){const{name:t,type:n,direction:i}=e,a=t[0].toUpperCase()+t.slice(1,-1),s="find"+a;r.prototype[s]=function(h,y){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;h=""+h;const b=this._nodes.get(h);if(typeof b>"u")throw new Ae(`Graph.${s}: could not find the "${h}" node in the graph.`);return Ou(!0,n==="mixed"?this.type:n,i,b,y)};const d="some"+a;r.prototype[d]=function(h,y){return!!this[s](h,y)};const f="every"+a;r.prototype[f]=function(h,y){return!this[s](h,(w,E)=>!y(w,E))}}function Rv(r,e){const{name:t,type:n,direction:i}=e,a=t.slice(0,-1)+"Entries";r.prototype[a]=function(s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return rn.empty();s=""+s;const d=this._nodes.get(s);if(typeof d>"u")throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return Pv(n==="mixed"?this.type:n,i,d)}}function Lv(r){Iv.forEach(e=>{Nv(r,e),Ov(r,e),Tv(r,e),Rv(r,e)})}function Ra(r,e,t,n,i){const a=n._nodes.values(),s=n.type;let d,f,h,y,b,w;for(;d=a.next(),d.done!==!0;){let E=!1;if(f=d.value,s!=="undirected"){y=f.out;for(h in y){b=y[h];do w=b.target,E=!0,i(f.key,w.key,f.attributes,w.attributes,b.key,b.attributes,b.undirected),b=b.next;while(b)}}if(s!=="directed"){y=f.undirected;for(h in y)if(!(e&&f.key>h)){b=y[h];do w=b.target,w.key!==h&&(w=b.source),E=!0,i(f.key,w.key,f.attributes,w.attributes,b.key,b.attributes,b.undirected),b=b.next;while(b)}}t&&!E&&i(f.key,null,f.attributes,null,null,null,null)}}function zv(r,e){const t={key:r};return th(e.attributes)||(t.attributes=pt({},e.attributes)),t}function $v(r,e,t){const n={key:e,source:t.source.key,target:t.target.key};return th(t.attributes)||(n.attributes=pt({},t.attributes)),r==="mixed"&&t.undirected&&(n.undirected=!0),n}function Gv(r){if(!wt(r))throw new Ne('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in r))throw new Ne("Graph.import: serialized node is missing its key.");if("attributes"in r&&(!wt(r.attributes)||r.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function qv(r){if(!wt(r))throw new Ne('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in r))throw new Ne("Graph.import: serialized edge is missing its source.");if(!("target"in r))throw new Ne("Graph.import: serialized edge is missing its target.");if("attributes"in r&&(!wt(r.attributes)||r.attributes===null))throw new Ne("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in r&&typeof r.undirected!="boolean")throw new Ne("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Fv=By(),jv=new Set(["directed","undirected","mixed"]),bc=new Set(["domain","_events","_eventsCount","_maxListeners"]),Bv=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],Uv={allowSelfLoops:!0,multi:!1,type:"mixed"};function Kv(r,e,t){if(t&&!wt(t))throw new Ne(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},r._nodes.has(e))throw new Fe(`Graph.addNode: the "${e}" node already exist in the graph.`);const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function wc(r,e,t){const n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function lh(r,e,t,n,i,a,s,d){if(!n&&r.type==="undirected")throw new Fe(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new Fe(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(d&&!wt(d))throw new Ne(`Graph.${e}: invalid attributes. Expecting an object but got "${d}"`);if(a=""+a,s=""+s,d=d||{},!r.allowSelfLoops&&a===s)throw new Fe(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const f=r._nodes.get(a),h=r._nodes.get(s);if(!f)throw new Ae(`Graph.${e}: source node "${a}" not found.`);if(!h)throw new Ae(`Graph.${e}: target node "${s}" not found.`);const y={key:null,undirected:n,source:a,target:s,attributes:d};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new Fe(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!r.multi&&(n?typeof f.undirected[s]<"u":typeof f.out[s]<"u"))throw new Fe(`Graph.${e}: an edge linking "${a}" to "${s}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const b=new pi(n,i,f,h,d);r._edges.set(i,b);const w=a===s;return n?(f.undirectedDegree++,h.undirectedDegree++,w&&(f.undirectedLoops++,r._undirectedSelfLoopCount++)):(f.outDegree++,h.inDegree++,w&&(f.directedLoops++,r._directedSelfLoopCount++)),r.multi?b.attachMulti():b.attach(),n?r._undirectedSize++:r._directedSize++,y.key=i,r.emit("edgeAdded",y),i}function Wv(r,e,t,n,i,a,s,d,f){if(!n&&r.type==="undirected")throw new Fe(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new Fe(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(d){if(f){if(typeof d!="function")throw new Ne(`Graph.${e}: invalid updater function. Expecting a function but got "${d}"`)}else if(!wt(d))throw new Ne(`Graph.${e}: invalid attributes. Expecting an object but got "${d}"`)}a=""+a,s=""+s;let h;if(f&&(h=d,d=void 0),!r.allowSelfLoops&&a===s)throw new Fe(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let y=r._nodes.get(a),b=r._nodes.get(s),w,E;if(!t&&(w=r._edges.get(i),w)){if((w.source.key!==a||w.target.key!==s)&&(!n||w.source.key!==s||w.target.key!==a))throw new Fe(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${a}" source & "${s}" target vs. ("${w.source.key}", "${w.target.key}").`);E=w}if(!E&&!r.multi&&y&&(E=n?y.undirected[s]:y.out[s]),E){const P=[E.key,!1,!1,!1];if(f?!h:!d)return P;if(f){const z=E.attributes;E.attributes=h(z),r.emit("edgeAttributesUpdated",{type:"replace",key:E.key,attributes:E.attributes})}else pt(E.attributes,d),r.emit("edgeAttributesUpdated",{type:"merge",key:E.key,attributes:E.attributes,data:d});return P}d=d||{},f&&h&&(d=h(d));const I={key:null,undirected:n,source:a,target:s,attributes:d};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new Fe(`Graph.${e}: the "${i}" edge already exists in the graph.`);let D=!1,N=!1;y||(y=wc(r,a,{}),D=!0,a===s&&(b=y,N=!0)),b||(b=wc(r,s,{}),N=!0),w=new pi(n,i,y,b,d),r._edges.set(i,w);const O=a===s;return n?(y.undirectedDegree++,b.undirectedDegree++,O&&(y.undirectedLoops++,r._undirectedSelfLoopCount++)):(y.outDegree++,b.inDegree++,O&&(y.directedLoops++,r._directedSelfLoopCount++)),r.multi?w.attachMulti():w.attach(),n?r._undirectedSize++:r._directedSize++,I.key=i,r.emit("edgeAdded",I),[i,!0,D,N]}function Zr(r,e){r._edges.delete(e.key);const{source:t,target:n,attributes:i}=e,a=e.undirected,s=t===n;a?(t.undirectedDegree--,n.undirectedDegree--,s&&(t.undirectedLoops--,r._undirectedSelfLoopCount--)):(t.outDegree--,n.inDegree--,s&&(t.directedLoops--,r._directedSelfLoopCount--)),r.multi?e.detachMulti():e.detach(),a?r._undirectedSize--:r._directedSize--,r.emit("edgeDropped",{key:e.key,attributes:i,source:t.key,target:n.key,undirected:a})}class Qe extends Ly.EventEmitter{constructor(e){if(super(),e=pt({},Uv,e),typeof e.multi!="boolean")throw new Ne(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!jv.has(e.type))throw new Ne(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new Ne(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?rh:e.type==="directed"?ih:ah;Zt(this,"NodeDataClass",t);const n="geid_"+Fv()+"_";let i=0;const a=()=>{let s;do s=n+i++;while(this._edges.has(s));return s};Zt(this,"_attributes",{}),Zt(this,"_nodes",new Map),Zt(this,"_edges",new Map),Zt(this,"_directedSize",0),Zt(this,"_undirectedSize",0),Zt(this,"_directedSelfLoopCount",0),Zt(this,"_undirectedSelfLoopCount",0),Zt(this,"_edgeKeyGenerator",a),Zt(this,"_options",e),bc.forEach(s=>Zt(this,s,this[s])),gn(this,"order",()=>this._nodes.size),gn(this,"size",()=>this._edges.size),gn(this,"directedSize",()=>this._directedSize),gn(this,"undirectedSize",()=>this._undirectedSize),gn(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),gn(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),gn(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),gn(this,"multi",this._options.multi),gn(this,"type",this._options.type),gn(this,"allowSelfLoops",this._options.allowSelfLoops),gn(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.out.hasOwnProperty(t):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const n=""+e,i=this._edges.get(n);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.undirected.hasOwnProperty(t):!1}throw new Ne(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const n=""+e;return this._edges.has(n)}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?typeof n.out<"u"&&n.out.hasOwnProperty(t)||typeof n.undirected<"u"&&n.undirected.hasOwnProperty(t):!1}throw new Ne(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new Fe("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||void 0;if(i)return i.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new Fe("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const i=n.undirected&&n.undirected[t]||void 0;if(i)return i.key}edge(e,t){if(this.multi)throw new Fe("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.edge: could not find the "${t}" target node in the graph.`);const i=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in||t in n.out}areOutNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.out}areInNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in n.undirected}areNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in n.in||t in n.out)||this.type!=="directed"&&t in n.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.in||this.type!=="directed"&&t in n.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new Ae(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.out||this.type!=="directed"&&t in n.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree),n}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.outDegree),n}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree),n}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree,i+=t.directedLoops),n-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.outDegree,i+=t.directedLoops),n-i}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree,i+=t.directedLoops*2),n-i}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const n=this._edges.get(t);if(!n)throw new Ae(`Graph.opposite: could not find the "${t}" edge in the graph.`);const i=n.source.key,a=n.target.key;if(e===i)return a;if(e===a)return i;throw new Ae(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${i}, ${a}).`)}hasExtremity(e,t){e=""+e,t=""+t;const n=this._edges.get(e);if(!n)throw new Ae(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return n.source.key===t||n.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return Kv(this,e,t).key}mergeNode(e,t){if(t&&!wt(t))throw new Ne(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let n=this._nodes.get(e);return n?(t&&(pt(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new Ne(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let n=this._nodes.get(e);if(n){if(t){const a=n.attributes;n.attributes=t(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}const i=t?t({}):{};return n=new this.NodeDataClass(e,i),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.dropNode: could not find the "${e}" node in the graph.`);let n;if(this.type!=="undirected"){for(const i in t.out){n=t.out[i];do Zr(this,n),n=n.next;while(n)}for(const i in t.in){n=t.in[i];do Zr(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(const i in t.undirected){n=t.undirected[i];do Zr(this,n),n=n.next;while(n)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const n=""+arguments[0],i=""+arguments[1];if(t=nn(this,n,i,this.type),!t)throw new Ae(`Graph.dropEdge: could not find the "${n}" -> "${i}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new Ae(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Zr(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new Fe("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Fe("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const n=nn(this,e,t,"directed");if(!n)throw new Ae(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Zr(this,n),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new Fe("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Fe("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const n=nn(this,e,t,"undirected");if(!n)throw new Ae(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Zr(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new Ne("Graph.updateAttribute: updater should be a function.");const n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!wt(e))throw new Ne("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!wt(e))throw new Ne("Graph.mergeAttributes: provided attributes are not a plain object.");return pt(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new Ne("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new Ne("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!mc(t))throw new Ne("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._nodes.values();let i,a;for(;i=n.next(),i.done!==!0;)a=i.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new Ne("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!mc(t))throw new Ne("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._edges.values();let i,a,s,d;for(;i=n.next(),i.done!==!0;)a=i.value,s=a.source,d=a.target,a.attributes=e(a.key,a.attributes,s.key,d.key,s.attributes,d.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new Ne("Graph.forEachAdjacencyEntry: expecting a callback.");Ra(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ne("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Ra(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Ra(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Ne("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Ra(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):eh(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new Ne("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new Ne("Graph.findNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new Ne("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let n,i;const a=new Array(this.order);let s=0;for(;n=t.next(),n.done!==!0;)i=n.value,a[s++]=e(i.key,i.attributes);return a}someNode(e){if(typeof e!="function")throw new Ne("Graph.someNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new Ne("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new Ne("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let n,i;const a=[];for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)&&a.push(i.key);return a}reduceNodes(e,t){if(typeof e!="function")throw new Ne("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Ne("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=t;const i=this._nodes.values();let a,s;for(;a=i.next(),a.done!==!0;)s=a.value,n=e(n,s.key,s.attributes);return n}nodeEntries(){const e=this._nodes.values();return new rn(()=>{const t=e.next();if(t.done)return t;const n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((i,a)=>{e[t++]=zv(a,i)});const n=new Array(this._edges.size);return t=0,this._edges.forEach((i,a)=>{n[t++]=$v(this.type,a,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:n}}import(e,t=!1){if(e instanceof Qe)return e.forEachNode((f,h)=>{t?this.mergeNode(f,h):this.addNode(f,h)}),e.forEachEdge((f,h,y,b,w,E,I)=>{t?I?this.mergeUndirectedEdgeWithKey(f,y,b,h):this.mergeDirectedEdgeWithKey(f,y,b,h):I?this.addUndirectedEdgeWithKey(f,y,b,h):this.addDirectedEdgeWithKey(f,y,b,h)}),this;if(!wt(e))throw new Ne("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!wt(e.attributes))throw new Ne("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let n,i,a,s,d;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new Ne("Graph.import: invalid nodes. Expecting an array.");for(n=0,i=a.length;n<i;n++){s=a[n],Gv(s);const{key:f,attributes:h}=s;t?this.mergeNode(f,h):this.addNode(f,h)}}if(e.edges){let f=!1;if(this.type==="undirected"&&(f=!0),a=e.edges,!Array.isArray(a))throw new Ne("Graph.import: invalid edges. Expecting an array.");for(n=0,i=a.length;n<i;n++){d=a[n],qv(d);const{source:h,target:y,attributes:b,undirected:w=f}=d;let E;"key"in d?(E=t?w?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:w?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,E.call(this,d.key,h,y,b)):(E=t?w?this.mergeUndirectedEdge:this.mergeDirectedEdge:w?this.addUndirectedEdge:this.addDirectedEdge,E.call(this,h,y,b))}}return this}nullCopy(e){const t=new Qe(pt({},this._options,e));return t.replaceAttributes(pt({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((n,i)=>{const a=pt({},n.attributes);n=new t.NodeDataClass(i,a),t._nodes.set(i,n)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Fe(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Fe("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Fe("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),n=this._edges.values();let i,a;for(;i=n.next(),i.done!==!0;)a=i.value,lh(t,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,pt({},a.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,s)=>{e[s]=a.attributes});const t={},n={};this._edges.forEach((a,s)=>{const d=a.undirected?"--":"->";let f="",h=a.source.key,y=a.target.key,b;a.undirected&&h>y&&(b=h,h=y,y=b);const w=`(${h})${d}(${y})`;s.startsWith("geid_")?this.multi&&(typeof n[w]>"u"?n[w]=0:n[w]++,f+=`${n[w]}. `):f+=`[${s}]: `,f+=w,t[f]=a.attributes});const i={};for(const a in this)this.hasOwnProperty(a)&&!bc.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(i[a]=this[a]);return i.attributes=this._attributes,i.nodes=e,i.edges=t,Zt(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Qe.prototype[Symbol.for("nodejs.util.inspect.custom")]=Qe.prototype.inspect);Bv.forEach(r=>{["add","merge","update"].forEach(e=>{const t=r.name(e),n=e==="add"?lh:Wv;r.generateKey?Qe.prototype[t]=function(i,a,s){return n(this,t,!0,(r.type||this.type)==="undirected",null,i,a,s,e==="update")}:Qe.prototype[t]=function(i,a,s,d){return n(this,t,!1,(r.type||this.type)==="undirected",i,a,s,d,e==="update")}})});tv(Qe);hv(Qe);Dv(Qe);Lv(Qe);let dh=class extends Qe{constructor(e){const t=pt({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new Ne("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new Ne('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},hh=class extends Qe{constructor(e){const t=pt({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new Ne("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new Ne('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}};class fh extends Qe{constructor(e){const t=pt({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class ph extends Qe{constructor(e){const t=pt({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new Ne('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class gh extends Qe{constructor(e){const t=pt({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Ne("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new Ne('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function gi(r){r.from=function(e,t){const n=pt({},e.options,t),i=new r(n);return i.import(e),i}}gi(Qe);gi(dh);gi(hh);gi(fh);gi(ph);gi(gh);Qe.Graph=Qe;Qe.DirectedGraph=dh;Qe.UndirectedGraph=hh;Qe.MultiGraph=fh;Qe.MultiDirectedGraph=ph;Qe.MultiUndirectedGraph=gh;Qe.InvalidArgumentsGraphError=Ne;Qe.NotFoundGraphError=Ae;Qe.UsageGraphError=Fe;function Hv(r){r.prototype.updateSelectedNodesName=function(e){this.updateSelectedNodesAttributes({label:e})},r.prototype.updateSelectedNodesInfo=function(e){this.updateSelectedNodesAttributes({desc:e})},r.prototype.setDefaultNodeWeight=function(e=1){this.updateEachNodeAttributes((t,n)=>({...n,weight:e}))},r.prototype.getNodesForD3=function(){return this.nodes().map(e=>({...this.getNodeAttributes(e),id:Number(e)}))},r.prototype.selectNode=function(e){this.setNodeAttribute(e,"selected",!0)},r.prototype.deselectNode=function(e){this.setNodeAttribute(e,"selected",!1)},r.prototype.toggleNodeSelection=function(e){if((this.getNodeAttribute(e,"selected")||0)>0)this.setNodeAttribute(e,"selected",0);else{let n=0;this.forEachNode((i,a)=>{a.selected>n&&(n=a.selected)}),this.setNodeAttribute(e,"selected",n+1)}},r.prototype.getSelectedNodes=function(){return this.filterNodes((e,t)=>t.selected>0).sort((e,t)=>this.getNodeAttribute(e,"selected")-this.getNodeAttribute(t,"selected"))},r.prototype.updateSelectedNodesColor=function(e,t,n){!e||!t||!n?e?this.updateSelectedNodesAttributes({color:e}):t?this.updateSelectedNodesAttributes({stroke:t}):n&&this.updateSelectedNodesAttributes({labelColor:n}):this.updateSelectedNodesAttributes({color:e,stroke:t,labelColor:n})},r.prototype.updateSelectedNodesAttributes=function(e){this.getSelectedNodes().forEach(t=>{this.mergeNodeAttributes(t,e)})},r.prototype.connectSelectedNodes=function(e,t="directed"){const n=this.getSelectedNodes();if(!(n.length<1)){if(n.length>1)for(let i=0;i<n.length;i++)for(let a=i+1;a<n.length;a++){const s=n[i],d=n[a],f={color:e,selected:!1};this.type==="mixed"?t==="undirected"?this.mergeUndirectedEdge(s,d,f):this.mergeDirectedEdge(s,d,f):this.mergeEdge(s,d,f)}else if(this.allowSelfLoops){const i=n[0],a={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(i,i,a):this.mergeDirectedEdge(i,i,a)}}},r.prototype.connectSelectedNodesInOrder=function(e,t="directed"){const n=this.getSelectedNodes();for(let i=0;i<n.length-1;i++){const a=n[i],s=n[i+1],d={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(a,s,d):this.mergeDirectedEdge(a,s,d)}}}function Yv(r){r.prototype.setDefaultEdgeWeight=function(e=1){this.updateEachEdgeAttributes((t,n)=>({...n,weight:e}))},r.prototype.getEdgeSourceTarget=function(e){return[this.source(e),this.target(e)]},r.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},r.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})},r.prototype.getEdgesForD3=function(){return this.edges().map(e=>{const{source:t,target:n}=this.getEdgeAttributes(e);return{source:t,target:n}})},r.prototype.selectEdge=function(e){this.setEdgeAttribute(e,"selected",!0)},r.prototype.deselectEdge=function(e){this.setEdgeAttribute(e,"selected",!1)},r.prototype.toggleEdgeSelection=function(e){if((this.getEdgeAttribute(e,"selected")||0)>0)this.setEdgeAttribute(e,"selected",0);else{let n=0;this.forEachEdge((i,a)=>{a.selected>n&&(n=a.selected)}),this.setEdgeAttribute(e,"selected",n+1)}},r.prototype.getSelectedEdges=function(){return this.filterEdges((e,t)=>t.selected>0).sort((e,t)=>this.getEdgeAttribute(e,"selected")-this.getEdgeAttribute(t,"selected"))},r.prototype.updateSelectedEdgesAttributes=function(e){this.getSelectedEdges().forEach(t=>{this.mergeEdgeAttributes(t,e)})},r.prototype.updateSelectedEdgesColor=function(e,t){const n={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedEdgesAttributes(n)},r.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},r.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})}}function Xv(r){r.prototype.addFace=function(e,t){const n=e.join("_");t={...t,key:n,id:this._faces.size,nodes:e,color:this.colors.face_color,labelColor:this.colors.label_color};var i=new Vv(n,e,t);this._faces.set(n,i)},r.prototype.faces=function(){return Array.from(this._faces.keys())},r.prototype.findFace=function(e){return e.sort(),e.join("_")},r.prototype.dropFace=function(e){this._faces.has(e)&&this._faces.delete(e)},r.prototype.hasFace=function(e){return this._faces.has(e)},r.prototype.faceNodeNeighbors=function(e){const t=[];return this.forEachFace((n,i)=>{i.nodes.includes(e)&&t.push(n)}),t},r.prototype.faceEdgeNeighbors=function(e){const{source:t,target:n}=this.getEdgeAttributes(e),i=[];return this.forEachFace((a,s)=>{s.nodes.includes(""+t)&&s.nodes.includes(""+n)&&i.push(a)}),i},r.prototype.forEachFace=function(e){for(const t of this._faces.values())e(t.key,t.attributes)},r.prototype.setFaceAttribute=function(e,t,n){this._faces.get(e).attributes[t]=n},r.prototype.getFaceAttribute=function(e,t){return this._faces.get(e).attributes[t]},r.prototype.getFaceAttributes=function(e){return this._faces.get(e).attributes},r.prototype.selectFace=function(e){this.setFaceAttribute(e,"selected",!0)},r.prototype.deselectFace=function(e){this.setFaceAttribute(e,"selected",!1)},r.prototype.toggleFaceSelection=function(e){if((this.getFaceAttribute(e,"selected")||0)>0)this.setFaceAttribute(e,"selected",0);else{let n=0;this.forEachFace((i,a)=>{a.selected>n&&(n=a.selected)}),this.setFaceAttribute(e,"selected",n+1)}},r.prototype.getSelectedFaces=function(){return this.faces().filter(e=>this.getFaceAttributes(e).selected>0).sort((e,t)=>this.getFaceAttribute(e,"selected")-this.getFaceAttribute(t,"selected"))},r.prototype.updateSelectedFacesAttributes=function(e){this.getSelectedFaces().forEach(t=>{const n=this.getFaceAttributes(t);this._faces.get(t).attributes={...n,...e}})},r.prototype.updateSelectedFacesColor=function(e,t){const n={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedFacesAttributes(n)},r.prototype.updateSelectedFacesName=function(e){this.updateSelectedFacesAttributes({label:e})},r.prototype.updateSelectedFacesInfo=function(e){this.updateSelectedFacesAttributes({desc:e})},r.prototype.updateSelectedFacesWeight=function(e){this.updateSelectedFacesAttributes({weight:e})},r.prototype.deleteSelectedFaces=function(){this.getSelectedFaces().forEach(e=>this.dropFace(e))}}class Vv{constructor(e,t,n){this.key=e,this.attributes=n,this.nodes=t}}class yi extends Qe{constructor(e){super(e),this.isCustom=!0,this.defaultColors={edge_color:"#4682b4",label_color:"#000000",node_color:"#ffffff",face_color:"#4682b455",stroke_color:"#4682b4"},this.colors=this.defaultColors,this._faces=new Map,this.events()}events(){this.on("nodeAdded",({key:e})=>{const t=this.getNodeAttributes(e);t.id||this.setNodeAttribute(e,"id",+e),t.label===void 0&&this.setNodeAttribute(e,"label",Vi(t.id)),t.weight===void 0&&this.setNodeAttribute(e,"weight",void 0),t.color===void 0&&this.setNodeAttribute(e,"color",this.colors.node_color),t.stroke===void 0&&this.setNodeAttribute(e,"stroke",this.colors.stroke_color),t.labelColor===void 0&&this.setNodeAttribute(e,"labelColor",this.colors.label_color),t.selected===void 0&&this.setNodeAttribute(e,"selected",!1),t.size===void 0&&this.setNodeAttribute(e,"size",.25),t.magnitude===void 0&&this.setNodeAttribute(e,"magnitude",1),t.desc===void 0&&this.setNodeAttribute(e,"desc",{})}),this.on("edgeAdded",({key:e,source:t,target:n})=>{const i=this.getEdgeAttributes(e);i.id||this.setEdgeAttribute(e,"id",this.size-1),i.label===void 0&&this.setEdgeAttribute(e,"label",Vi(i.id)),i.weight===void 0&&this.setEdgeAttribute(e,"weight",void 0),i.color===void 0&&this.setEdgeAttribute(e,"color",this.colors.edge_color),i.labelColor===void 0&&this.setEdgeAttribute(e,"labelColor",this.colors.label_color),i.source||this.setEdgeAttribute(e,"source",Number(t)),i.target||this.setEdgeAttribute(e,"target",Number(n)),i.selected===void 0&&this.setEdgeAttribute(e,"selected",!1),i.desc===void 0&&this.setEdgeAttribute(e,"desc",{})})}validateSettings(e={}){return Object.fromEntries(Object.keys(this.defaultColors).map(t=>[t,t in e?e[t]:this.defaultColors[t]]))}nullCopy(e){const t=new this.constructor(io({},this._options,e));return t.replaceAttributes(io({},this.getAttributes())),t}deselectAll(){this.updateEachNodeAttributes((e,t)=>({...t,selected:0})),this.updateEachEdgeAttributes((e,t)=>({...t,selected:!1}))}deleteSelected(){this.getSelectedEdges().forEach(e=>this.dropEdge(e)),this.getSelectedNodes().forEach(e=>this.dropNode(e))}updateSelectedName(e){this.updateSelectedNodesAttributes({label:e}),this.updateSelectedEdgesAttributes({label:e}),this.updateSelectedFacesAttributes({label:e})}updateSelectedInfo(e){this.updateSelectedNodesAttributes({desc:e}),this.updateSelectedEdgesAttributes({desc:e}),this.updateSelectedFacesAttributes({desc:e})}updateSelectedWeight(e){this.updateSelectedNodesAttributes({weight:e}),this.updateSelectedEdgesAttributes({weight:e}),this.updateSelectedFacesAttributes({weight:e})}selectPath(e){this.deselectAll(),e.forEach(t=>{this.hasNode(t)&&this.selectNode(t)});for(let t=0;t<e.length-1;t++){const n=e[t],i=e[t+1];if(this.hasEdge(n,i)){const a=this.edge(n,i);this.selectEdge(a)}}}replace(e){this.clear(),this.import(e.export())}dropNode(e){const t=this.faceNodeNeighbors(e);t.length&&t.map(n=>{this.dropFace(n)}),super.dropNode(e)}dropEdge(e){var t;if(arguments.length>1){var n=""+arguments[0],i=""+arguments[1];this.findEdge(n,i,s=>{t=s})}else t=e;const a=this.faceEdgeNeighbors(t);a.length&&a.map(s=>{this.dropFace(s)}),super.dropEdge(t)}export(){const e=super.export();e.attributes.selected=!1;var t=new Array(this._faces.size),n=0;return this._faces.forEach(function(i,a){t[n++]=Zv(a,i)}),e.faces=t,e}import(e){const t=super.import(e);if(typeof e.faces=="function")e.forEachFace((n,i)=>{t.addFace(i.nodes,i)});else for(const n of e.faces)t.addFace(n.nodes,n.attributes);return t}subgraph(e){const t=this.nullCopy();if(!e||Array.isArray(e)&&e.length===0||e instanceof Set&&e.size===0)return t;const n=new Set(e);for(const i of n)t.addNode(i,this.getNodeAttributes(i));return this.forEachEdge((i,a,s,d,f,h,y)=>{n.has(s)&&n.has(d)&&(y?t.addUndirectedEdgeWithKey(i,s,d,a):t.addDirectedEdgeWithKey(i,s,d,a))}),this.forEachFace((i,a)=>{const s=a.nodes||[];console.log(s),s.every(d=>n.has(d)||n.has(""+d))&&t.addFace(a.nodes,a)}),t}mergeWith(e){if(this.multi!==e.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");this.mergeAttributes(this.getAttributes());var t={},n=Math.max(...this.nodes())+1;e.forEachNode((i,a)=>{t[i]=n,this.addNode(n,{...a,id:n}),n++}),n=Math.max(...this.edges())+1,e.forEachEdge((i,a,s,d,f,h,y)=>{y?this.addUndirectedEdge(t[s],t[d],{...a,id:n++,source:t[s],target:t[d]}):this.addDirectedEdge(t[s],t[d],{...a,id:n++})}),n=Math.max(...this.faces())+1,e.forEachFace((i,a)=>{const s=a.nodes.map(d=>t[d]);this.addFace(s,{...a,id:n++,nodes:s})})}clear(){this._faces.clear(),this._edges.clear(),this._nodes.clear()}}function Qv(){for(var r=arguments[0],e=1,t=arguments.length;e<t;e++)if(arguments[e])for(var n in arguments[e])r[n]=arguments[e][n];return r}var io=Qv;typeof Object.assign=="function"&&(io=Object.assign);function Zv(r,e){var t={key:r,nodes:e.nodes};return Object.keys(e.attributes).length&&(t.attributes=io({},e.attributes)),t}Hv(yi);Yv(yi);Xv(yi);class Jv extends yi{constructor(e={}){const t=Object.assign({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new InvalidArgumentsGraphError(`DirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}class em extends yi{constructor(e={}){const t=Object.assign({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new InvalidArgumentsGraphError(`UndirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}var Jr={},Lo,xc;function wn(){return xc||(xc=1,Lo=function(e){return e!==null&&typeof e=="function"&&typeof e.prototype=="object"&&typeof e.prototype.addUndirectedEdgeWithKey=="function"&&typeof e.prototype.dropNode=="function"}),Lo}var zo,Ec;function tm(){if(Ec)return zo;Ec=1;var r=wn();return zo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/complete: invalid Graph constructor.");var i=new t,a,s;for(a=0;a<n;a++)i.addNode(a);for(a=0;a<n;a++)for(s=a+1;s<n;s++)i.type!=="directed"&&i.addUndirectedEdge(a,s),i.type!=="undirected"&&(i.addDirectedEdge(a,s),i.addDirectedEdge(s,a));return i},zo}var $o,_c;function Tu(){if(_c)return $o;_c=1;var r=wn();return $o=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/empty: invalid Graph constructor.");var i=new t,a;for(a=0;a<n;a++)i.addNode(a);return i},$o}var Go,Sc;function nm(){if(Sc)return Go;Sc=1;var r=wn();return Go=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/ladder: invalid Graph constructor.");var i=new t,a;for(a=0;a<n-1;a++)i.mergeEdge(a,a+1);for(a=n;a<n*2-1;a++)i.mergeEdge(a,a+1);for(a=0;a<n;a++)i.addEdge(a,a+n);return i},Go}var qo,Ac;function rm(){if(Ac)return qo;Ac=1;var r=wn();return qo=function(t,n){if(!r(t))throw new Error("graphology-generators/classic/path: invalid Graph constructor.");for(var i=new t,a=0;a<n-1;a++)i.mergeEdge(a,a+1);return i},qo}var kc;function im(){return kc||(kc=1,Jr.complete=tm(),Jr.empty=Tu(),Jr.ladder=nm(),Jr.path=rm()),Jr}var Bn=im(),yn={},Fo,Cc;function Ue(){return Cc||(Cc=1,Fo=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"}),Fo}var jo={},Dc;function Ru(){return Dc||(Dc=1,jo.copyNode=function(r,e,t){return t=Object.assign({},t),r.addNode(e,t)}),jo}var ei={},Ic;function Hn(){return Ic||(Ic=1,ei.addEdge=function(e,t,n,i,a,s){return t?n==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(n,i,a,s):n==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(n,i,a,s)},ei.copyEdge=function(e,t,n,i,a,s){return s=Object.assign({},s),t?n==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(n,i,a,s):n==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(n,i,a,s)},ei.mergeEdge=function(e,t,n,i,a,s){return t?n==null?e.mergeUndirectedEdge(i,a,s):e.mergeUndirectedEdgeWithKey(n,i,a,s):n==null?e.mergeDirectedEdge(i,a,s):e.mergeDirectedEdgeWithKey(n,i,a,s)},ei.updateEdge=function(e,t,n,i,a,s){return t?n==null?e.updateUndirectedEdge(i,a,s):e.updateUndirectedEdgeWithKey(n,i,a,s):n==null?e.updateDirectedEdge(i,a,s):e.updateDirectedEdgeWithKey(n,i,a,s)}),ei}var Bo,Mc;function am(){if(Mc)return Bo;Mc=1;function r(e){this.graph=e,this.stack=new Array(e.order),this.seen=new Set,this.size=0}return r.prototype.hasAlreadySeenEverything=function(){return this.seen.size===this.graph.order},r.prototype.countUnseenNodes=function(){return this.graph.order-this.seen.size},r.prototype.forEachNodeYetUnseen=function(e){var t=this.seen,n=this.graph;n.someNode(function(i,a){if(t.size===n.order)return!0;if(t.has(i))return!1;var s=e(i,a);return!!s})},r.prototype.has=function(e){return this.seen.has(e)},r.prototype.push=function(e){var t=this.seen.size;return this.seen.add(e),t===this.seen.size?!1:(this.stack[this.size++]=e,!0)},r.prototype.pushWith=function(e,t){var n=this.seen.size;return this.seen.add(e),n===this.seen.size?!1:(this.stack[this.size++]=t,!0)},r.prototype.pop=function(){if(this.size!==0)return this.stack[--this.size]},Bo=r,Bo}var Pc;function om(){if(Pc)return yn;Pc=1;var r=Ue(),e=Ru().copyNode,t=Hn().copyEdge,n=am();function i(E,I){if(!r(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(E.order){var D=new n(E),N=D.push.bind(D);D.forEachNodeYetUnseen(function(O){var P=[];D.push(O);for(var z;D.size!==0;)z=D.pop(),P.push(z),E.forEachNeighbor(z,N);I(P)})}}function a(E,I){if(!r(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(E.order){var D=new n(E),N=D.push.bind(D);D.forEachNodeYetUnseen(function(O){var P=0;D.push(O);for(var z;D.size!==0;)z=D.pop(),P++,E.forEachNeighbor(z,N);I(P)})}}function s(E,I,D){if(!r(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return;var N=new n(E),O;function P(z,C,L,K,S,G,q){O===K&&(K=L),I(z,C,L,K,S,G,q)&&N.push(K)}N.forEachNodeYetUnseen(function(z){var C=0;for(N.push(z);N.size!==0;)O=N.pop(),C++,E.forEachEdge(O,P);D(C)})}function d(E){var I=0;return a(E,function(){I++}),I}function f(E){var I=[];return i(E,function(D){I.push(D)}),I}function h(E){if(!r(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return[];var I=new n(E),D=I.push.bind(I),N=[],O;return I.forEachNodeYetUnseen(function(P){O=[],I.push(P);for(var z;I.size!==0;)z=I.pop(),O.push(z),E.forEachNeighbor(z,D);return O.length>N.length&&(N=O),N.length>I.countUnseenNodes()}),N}function y(E){var I=h(E),D=E.nullCopy();return I.forEach(function(N){e(D,N,E.getNodeAttributes(N))}),E.forEachEdge(function(N,O,P,z,C,L,K){D.hasNode(P)&&t(D,K,N,P,z,O)}),D}function b(E){var I=new Set(h(E));E.forEachNode(function(D){I.has(D)||E.dropNode(D)})}function w(E){if(!r(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return[];if(E.type==="undirected")throw new Error("graphology-components: the given graph is undirected");var I=E.nodes(),D=[],N,O;if(!E.size){for(N=0,O=I.length;N<O;N++)D.push([I[N]]);return D}var P=1,z=[],C=[],L=new Map,K=new Set,S,G,q,j=function(Y){var te,B=E.outboundNeighbors(Y),me;L.set(Y,P++),z.push(Y),C.push(Y);for(var ge=0,V=B.length;ge<V;ge++)if(te=B[ge],L.has(te)){if(me=L.get(te),!K.has(te))for(;L.get(z[z.length-1])>me;)z.pop()}else j(te);if(L.get(z[z.length-1])===L.get(Y)){S=[];do G=C.pop(),S.push(G),K.add(G);while(G!==Y);D.push(S),z.pop()}};for(N=0,O=I.length;N<O;N++)q=I[N],K.has(q)||j(q);return D}return yn.forEachConnectedComponent=i,yn.forEachConnectedComponentOrder=a,yn.forEachConnectedComponentOrderWithEdgeFilter=s,yn.countConnectedComponents=d,yn.connectedComponents=f,yn.largestConnectedComponent=h,yn.largestConnectedComponentSubgraph=y,yn.cropToLargestConnectedComponent=b,yn.stronglyConnectedComponents=w,yn}var La=om(),In={},Dr={},Uo,Nc;function Lu(){if(Nc)return Uo;Nc=1;var r=Zd(),e=r.ARRAY_BUFFER_SUPPORT,t=r.SYMBOL_SUPPORT;return Uo=function(i,a){var s,d,f,h,y;if(!i)throw new Error("obliterator/forEach: invalid iterable.");if(typeof a!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(i)||e&&ArrayBuffer.isView(i)||typeof i=="string"||i.toString()==="[object Arguments]"){for(f=0,h=i.length;f<h;f++)a(i[f],f);return}if(typeof i.forEach=="function"){i.forEach(a);return}if(t&&Symbol.iterator in i&&typeof i.next!="function"&&(i=i[Symbol.iterator]()),typeof i.next=="function"){for(s=i,f=0;y=s.next(),y.done!==!0;)a(y.value,f),f++;return}for(d in i)i.hasOwnProperty(d)&&a(i[d],d)},Uo}var Ko,Oc;function sm(){if(Oc)return Ko;Oc=1;var r=Tr(),e=Lu();function t(){this.clear()}return t.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},t.prototype.enqueue=function(n){return this.items.push(n),++this.size},t.prototype.dequeue=function(){if(this.size){var n=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,n}},t.prototype.peek=function(){if(this.size)return this.items[this.offset]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=this.offset,s=0,d=this.items.length;a<d;a++,s++)n.call(i,this.items[a],s,this)},t.prototype.toArray=function(){return this.items.slice(this.offset)},t.prototype.values=function(){var n=this.items,i=this.offset;return new r(function(){if(i>=n.length)return{done:!0};var a=n[i];return i++,{value:a,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.offset,a=0;return new r(function(){if(i>=n.length)return{done:!0};var s=n[i];return i++,{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var n=this.toArray();return Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n){var i=new t;return e(n,function(a){i.enqueue(a)}),i},t.of=function(){return t.from(arguments)},Ko=t,Ko}var Wo,Tc;function um(){return Tc||(Tc=1,Wo=function(e,t){var n=t.length;if(n!==0){var i=e.length;e.length+=n;for(var a=0;a<n;a++)e[i+a]=t[a]}}),Wo}var Rc;function zu(){if(Rc)return Dr;Rc=1;var r=Ue(),e=sm(),t=um();function n(h,y,b){if(!r(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');if(!h.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" target node does not exist in the given graph.');if(y=""+y,b=""+b,y===b)return[y];var w=h.inboundNeighbors.bind(h),E=h.outboundNeighbors.bind(h),I={},D={};I[y]=null,D[b]=null;var N=[y],O=[b],P,z,C,L,K,S,G,q,j=!1;e:for(;N.length&&O.length;)if(N.length<=O.length){for(P=N,N=[],K=0,G=P.length;K<G;K++)for(z=P[K],C=E(z),S=0,q=C.length;S<q;S++)if(L=C[S],L in I||(N.push(L),I[L]=z),L in D){j=!0;break e}}else for(P=O,O=[],K=0,G=P.length;K<G;K++)for(z=P[K],C=w(z),S=0,q=C.length;S<q;S++)if(L=C[S],L in D||(O.push(L),D[L]=z),L in I){j=!0;break e}if(!j)return null;for(var Y=[];L;)Y.unshift(L),L=I[L];for(L=D[Y[Y.length-1]];L;)Y.push(L),L=D[L];return Y.length?Y:null}function i(h,y){if(!r(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');y=""+y;var b={},w={},E,I,D,N,O,P;for(b[y]=!0,w[y]=[y];Object.keys(b).length;){E=b,b={};for(D in E)for(I=h.outboundNeighbors(D),O=0,P=I.length;O<P;O++)N=I[O],w[N]||(w[N]=w[D].concat(N),b[N]=!0)}return w}function a(h,y,b){if(!r(y))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!y.hasNode(b))throw new Error('graphology-shortest-path: the "'+b+'" source node does not exist in the given graph.');b=""+b;var w=new Set,E={},I=0;E[b]=0;for(var D=[b],N,O,P;D.length!==0;){var z=[];for(N=0,O=D.length;N<O;N++)P=D[N],!w.has(P)&&(w.add(P),t(z,y[h](P)),E[P]=I);I++,D=z}return E}var s=a.bind(null,"outboundNeighbors"),d=a.bind(null,"neighbors");function f(h,y){y=""+y;var b=[],w={},E={},I=h.nodes(),D,N,O,P,z,C,L,K,S;for(C=0,K=I.length;C<K;C++)P=I[C],w[P]=[],E[P]=0;var G={};E[y]=1,G[y]=0;for(var q=e.of(y);q.size;)for(P=q.dequeue(),b.push(P),D=G[P],N=E[P],O=h.outboundNeighbors(P),L=0,S=O.length;L<S;L++)z=O[L],z in G||(q.enqueue(z),G[z]=D+1),G[z]===D+1&&(E[z]+=N,w[z].push(P));return[b,w,E]}return Dr.bidirectional=n,Dr.singleSource=i,Dr.singleSourceLength=s,Dr.undirectedSingleSourceLength=d,Dr.brandes=f,Dr}var Ho={},Lc;function cm(){if(Lc)return Ho;Lc=1;var r=function(){return!0};return Ho.edgePathFromNodePath=function(e,t){var n=t.length,i,a,s,d;if(n<2)return a=t[0],d=e.multi?e.findEdge(a,a,r):e.edge(a,a),d?[d]:[];n--;var f=new Array(n);for(i=0;i<n;i++){if(a=t[i],s=t[i+1],d=e.multi?e.findOutboundEdge(a,s,r):e.edge(a,s),d===void 0)throw new Error("graphology-shortest-path: given path is impossible in given graph.");f[i]=d}return f},Ho}var ji={},Bi={},zc;function vi(){if(zc)return Bi;zc=1;function r(n){return typeof n!="number"||isNaN(n)?1:n}function e(n,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var d=function(h){return s(h[n])},f=function(){return s(void 0)};return typeof n=="string"?(a.fromAttributes=d,a.fromGraph=function(h,y){return d(h.getNodeAttributes(y))},a.fromEntry=function(h,y){return d(y)}):typeof n=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){return s(n(y,h.getNodeAttributes(y)))},a.fromEntry=function(h,y){return s(n(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f),a}function t(n,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var d=function(h){return s(h[n])},f=function(){return s(void 0)};return typeof n=="string"?(a.fromAttributes=d,a.fromGraph=function(h,y){return d(h.getEdgeAttributes(y))},a.fromEntry=function(h,y){return d(y)},a.fromPartialEntry=a.fromEntry,a.fromMinimalEntry=a.fromEntry):typeof n=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){var b=h.extremities(y);return s(n(y,h.getEdgeAttributes(y),b[0],b[1],h.getNodeAttributes(b[0]),h.getNodeAttributes(b[1]),h.isUndirected(y)))},a.fromEntry=function(h,y,b,w,E,I,D){return s(n(h,y,b,w,E,I,D))},a.fromPartialEntry=function(h,y,b,w){return s(n(h,y,b,w))},a.fromMinimalEntry=function(h,y){return s(n(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f,a.fromMinimalEntry=f),a}return Bi.createNodeValueGetter=e,Bi.createEdgeValueGetter=t,Bi.createEdgeWeightGetter=function(n){return t(n,r)},Bi}var ti={},$c;function $u(){if($c)return ti;$c=1;var r=function(i,a){return i<a?-1:i>a?1:0},e=function(i,a){return i<a?1:i>a?-1:0};function t(i){return function(a,s){return i(s,a)}}function n(i){return i===2?function(a,s){return a[0]<s[0]?-1:a[0]>s[0]?1:a[1]<s[1]?-1:a[1]>s[1]?1:0}:function(a,s){for(var d=0;d<i;){if(a[d]<s[d])return-1;if(a[d]>s[d])return 1;d++}return 0}}return ti.DEFAULT_COMPARATOR=r,ti.DEFAULT_REVERSE_COMPARATOR=e,ti.reverseComparator=t,ti.createTupleComparator=n,ti}var ni={},Yo={},Gc;function ia(){return Gc||(Gc=1,function(r){var e=Math.pow(2,8)-1,t=Math.pow(2,16)-1,n=Math.pow(2,32)-1,i=Math.pow(2,7)-1,a=Math.pow(2,15)-1,s=Math.pow(2,31)-1;r.getPointerArray=function(f){var h=f-1;if(h<=e)return Uint8Array;if(h<=t)return Uint16Array;if(h<=n)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},r.getSignedPointerArray=function(f){var h=f-1;return h<=i?Int8Array:h<=a?Int16Array:h<=s?Int32Array:Float64Array},r.getNumberType=function(f){return f===(f|0)?Math.sign(f)===-1?f<=127&&f>=-128?Int8Array:f<=32767&&f>=-32768?Int16Array:Int32Array:f<=255?Uint8Array:f<=65535?Uint16Array:Uint32Array:Float64Array};var d={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};r.getMinimalRepresentation=function(f,h){var y=null,b=0,w,E,I,D,N;for(D=0,N=f.length;D<N;D++)I=h?h(f[D]):f[D],E=r.getNumberType(I),w=d[E.name],w>b&&(b=w,y=E);return y},r.isTypedArray=function(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(f)},r.concat=function(){var f=0,h,y,b;for(h=0,b=arguments.length;h<b;h++)f+=arguments[h].length;var w=new arguments[0].constructor(f);for(h=0,y=0;h<b;h++)w.set(arguments[h],y),y+=arguments[h].length;return w},r.indices=function(f){for(var h=r.getPointerArray(f),y=new h(f),b=0;b<f;b++)y[b]=b;return y}}(Yo)),Yo}var qc;function lo(){if(qc)return ni;qc=1;var r=Lu(),e=ia();function t(s){return Array.isArray(s)||e.isTypedArray(s)}function n(s){if(typeof s.length=="number")return s.length;if(typeof s.size=="number")return s.size}function i(s){var d=n(s),f=typeof d=="number"?new Array(d):[],h=0;return r(s,function(y){f[h++]=y}),f}function a(s){var d=n(s),f=typeof d=="number"?e.getPointerArray(d):Array,h=typeof d=="number"?new Array(d):[],y=typeof d=="number"?new f(d):[],b=0;return r(s,function(w){h[b]=w,y[b]=b++}),[h,y]}return ni.isArrayLike=t,ni.guessLength=n,ni.toArray=i,ni.toArrayWithIndices=a,ni}var Xo,Fc;function Gu(){if(Fc)return Xo;Fc=1;var r=Lu(),e=$u(),t=lo(),n=e.DEFAULT_COMPARATOR,i=e.reverseComparator;function a(O,P,z,C){for(var L=P[C],K,S;C>z;){if(K=C-1>>1,S=P[K],O(L,S)<0){P[C]=S,C=K;continue}break}P[C]=L}function s(O,P,z){for(var C=P.length,L=z,K=P[z],S=2*z+1,G;S<C;)G=S+1,G<C&&O(P[S],P[G])>=0&&(S=G),P[z]=P[S],z=S,S=2*z+1;P[z]=K,a(O,P,L,z)}function d(O,P,z){P.push(z),a(O,P,0,P.length-1)}function f(O,P){var z=P.pop();if(P.length!==0){var C=P[0];return P[0]=z,s(O,P,0),C}return z}function h(O,P,z){if(P.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var C=P[0];return P[0]=z,s(O,P,0),C}function y(O,P,z){var C;return P.length!==0&&O(P[0],z)<0&&(C=P[0],P[0]=z,z=C,s(O,P,0)),z}function b(O,P){for(var z=P.length,C=z>>1,L=C;--L>=0;)s(O,P,L)}function w(O,P){for(var z=P.length,C=0,L=new Array(z);C<z;)L[C++]=f(O,P);return L}function E(O,P,z){arguments.length===2&&(z=P,P=O,O=n);var C=i(O),L,K,S,G=1/0,q;if(P===1){if(t.isArrayLike(z)){for(L=0,K=z.length;L<K;L++)S=z[L],(G===1/0||O(S,G)<0)&&(G=S);return q=new z.constructor(1),q[0]=G,q}return r(z,function(Y){(G===1/0||O(Y,G)<0)&&(G=Y)}),[G]}if(t.isArrayLike(z)){if(P>=z.length)return z.slice().sort(O);for(q=z.slice(0,P),b(C,q),L=P,K=z.length;L<K;L++)C(z[L],q[0])>0&&h(C,q,z[L]);return q.sort(O)}var j=t.guessLength(z);return j!==null&&j<P&&(P=j),q=new Array(P),L=0,r(z,function(Y){L<P?q[L]=Y:(L===P&&b(C,q),C(Y,q[0])>0&&h(C,q,Y)),L++}),q.length>L&&(q.length=L),q.sort(O)}function I(O,P,z){arguments.length===2&&(z=P,P=O,O=n);var C=i(O),L,K,S,G=-1/0,q;if(P===1){if(t.isArrayLike(z)){for(L=0,K=z.length;L<K;L++)S=z[L],(G===-1/0||O(S,G)>0)&&(G=S);return q=new z.constructor(1),q[0]=G,q}return r(z,function(Y){(G===-1/0||O(Y,G)>0)&&(G=Y)}),[G]}if(t.isArrayLike(z)){if(P>=z.length)return z.slice().sort(C);for(q=z.slice(0,P),b(O,q),L=P,K=z.length;L<K;L++)O(z[L],q[0])>0&&h(O,q,z[L]);return q.sort(C)}var j=t.guessLength(z);return j!==null&&j<P&&(P=j),q=new Array(P),L=0,r(z,function(Y){L<P?q[L]=Y:(L===P&&b(O,q),O(Y,q[0])>0&&h(O,q,Y)),L++}),q.length>L&&(q.length=L),q.sort(C)}function D(O){if(this.clear(),this.comparator=O||n,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}D.prototype.clear=function(){this.items=[],this.size=0},D.prototype.push=function(O){return d(this.comparator,this.items,O),++this.size},D.prototype.peek=function(){return this.items[0]},D.prototype.pop=function(){return this.size!==0&&this.size--,f(this.comparator,this.items)},D.prototype.replace=function(O){return h(this.comparator,this.items,O)},D.prototype.pushpop=function(O){return y(this.comparator,this.items,O)},D.prototype.consume=function(){return this.size=0,w(this.comparator,this.items)},D.prototype.toArray=function(){return w(this.comparator,this.items.slice())},D.prototype.inspect=function(){var O=this.toArray();return Object.defineProperty(O,"constructor",{value:D,enumerable:!1}),O},typeof Symbol<"u"&&(D.prototype[Symbol.for("nodejs.util.inspect.custom")]=D.prototype.inspect);function N(O){if(this.clear(),this.comparator=O||n,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=i(this.comparator)}return N.prototype=D.prototype,D.from=function(O,P){var z=new D(P),C;return t.isArrayLike(O)?C=O.slice():C=t.toArray(O),b(z.comparator,C),z.items=C,z.size=C.length,z},N.from=function(O,P){var z=new N(P),C;return t.isArrayLike(O)?C=O.slice():C=t.toArray(O),b(z.comparator,C),z.items=C,z.size=C.length,z},D.siftUp=s,D.siftDown=a,D.push=d,D.pop=f,D.replace=h,D.pushpop=y,D.heapify=b,D.consume=w,D.nsmallest=E,D.nlargest=I,D.MinHeap=D,D.MaxHeap=N,Xo=D,Xo}var jc;function lm(){if(jc)return ji;jc=1;var r=Ue(),e=vi().createEdgeWeightGetter,t=Gu(),n="weight";function i(b,w){return b[0]>w[0]?1:b[0]<w[0]?-1:b[1]>w[1]?1:b[1]<w[1]?-1:b[2]>w[2]?1:b[2]<w[2]?-1:0}function a(b,w){return b[0]>w[0]?1:b[0]<w[0]?-1:b[1]>w[1]?1:b[1]<w[1]?-1:b[2]>w[2]?1:b[2]<w[2]?-1:b[3]>w[3]?1:b[3]<w[3]?-1:0}function s(b,w,E,I){if(w=""+w,E=""+E,!r(b))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(w&&!b.hasNode(w))throw new Error('graphology-shortest-path/dijkstra: the "'+w+'" source node does not exist in the given graph.');if(E&&!b.hasNode(E))throw new Error('graphology-shortest-path/dijkstra: the "'+E+'" target node does not exist in the given graph.');if(I=e(I||n).fromMinimalEntry,w===E)return[0,[w]];var D=[{},{}],N=[{},{}],O=[new t(i),new t(i)],P=[{},{}];N[0][w]=[w],N[1][E]=[E],P[0][w]=0,P[1][E]=0;var z=[],C=1/0,L=0,K=1,S,G,q,j,Y,te,B,me,ge;for(O[0].push([0,L++,w]),O[1].push([0,L++,E]);O[0].size&&O[1].size;)if(K=1-K,S=O[K].pop(),j=S[0],Y=S[2],!(Y in D[K])){if(D[K][Y]=j,Y in D[1-K])return[C,z];for(G=K===1?b.inboundEdges(Y):b.outboundEdges(Y),me=0,ge=G.length;me<ge;me++){if(B=G[me],te=b.opposite(Y,B),q=D[K][Y]+I(B,b.getEdgeAttributes(B)),te in D[K]&&q<D[K][te])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(te in P[K])||q<P[K][te])&&(P[K][te]=q,O[K].push([q,L++,te]),N[K][te]=N[K][Y].concat(te),te in P[0]&&te in P[1]&&(j=P[0][te]+P[1][te],(z.length===0||C>j)&&(C=j,z=N[0][te].concat(N[1][te].slice(0,-1).reverse()))))}}return[1/0,null]}function d(b,w,E,I,D,N){if(!r(b))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");E=e(E||n).fromMinimalEntry;var O={},P={},z=new t(i),C=0,L,K,S,G,q,j,Y,te,B,me,ge;for(te=0,me=w.length;te<me;te++)G=w[te],P[G]=0,z.push([0,C++,G]),N[G]=[G];for(;z.size;)if(K=z.pop(),Y=K[0],G=K[2],!(G in O)){if(O[G]=Y,G===D)break;for(L=b.outboundEdges(G),B=0,ge=L.length;B<ge;B++){if(j=L[B],q=b.opposite(G,j),S=E(j,b.getEdgeAttributes(j))+O[G],q in O&&S<O[q])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(q in P)||S<P[q])&&(P[q]=S,z.push([S,C++,q]),N[q]=N[G].concat(q))}}return O}function f(b,w,E){var I={};return d(b,[w],E,0,null,I),I}function h(b,w,E,I){return s(b,w,E,I)[1]}function y(b,w,E){w=""+w,E=e(E||n).fromMinimalEntry;var I=[],D={},N={},O=b.nodes(),P,z,C,L,K,S,G,q,j,Y;for(j=0,Y=O.length;j<Y;j++)S=O[j],D[S]=[],N[S]=0;var te={};N[w]=1;var B={};B[w]=0;var me=0,ge=new t(a);for(ge.push([0,me++,w,w]);ge.size;)if(z=ge.pop(),L=z[0],C=z[2],S=z[3],!(S in te))for(N[S]+=N[C],I.push(S),te[S]=L,P=b.outboundEdges(S),j=0,Y=P.length;j<Y;j++)q=P[j],G=b.opposite(S,q),K=L+E(q,b.getEdgeAttributes(q)),!(G in te)&&(!(G in B)||K<B[G])?(B[G]=K,ge.push([K,me++,S,G]),N[G]=0,D[G]=[S]):K===B[G]&&(N[G]+=N[S],D[G].push(S));return[I,D,N]}return ji.bidirectional=h,ji.singleSource=f,ji.brandes=y,ji}var Bc;function dm(){if(Bc)return In;Bc=1;var r=zu(),e=cm();return In.unweighted=r,In.dijkstra=lm(),In.bidirectional=r.bidirectional,In.singleSource=r.singleSource,In.singleSourceLength=r.singleSourceLength,In.undirectedSingleSourceLength=r.undirectedSingleSourceLength,In.brandes=r.brandes,In.edgePathFromNodePath=e.edgePathFromNodePath,In}var Uc=dm(),Dt={},Mn={},Vo,Kc;function yh(){if(Kc)return Vo;Kc=1;var r=Ue();return Vo=function(t){if(!r(t))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!t.multi)return t.size;var n=0,i=0;function a(){n++}function s(){i++}return t.forEachNode(function(d){t.type!=="directed"&&t.forEachUndirectedNeighbor(d,a),t.type!=="undirected"&&t.forEachOutNeighbor(d,s)}),n/2+i},Vo}var Wc;function vh(){if(Wc)return Mn;Wc=1;var r=Ue(),e=yh();function t(s,d){return 2*d/(s*(s-1))}function n(s,d){return d/(s*(s-1))}function i(s,d){var f=s*(s-1);return d/(f+f/2)}function a(s,d,f){var h,y;if(arguments.length>3){if(h=f,y=arguments[3],typeof h!="number"||h<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof y!="number"||y<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!r(f))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");h=f.order,y=f.size,f.multi&&d===!1&&(y=e(f))}if(h<2)return 0;s===null&&(s=f.type),d===null&&(d=f.multi);var b;return s==="undirected"?b=t:s==="directed"?b=n:b=i,b(h,y)}return Mn.abstractDensity=a,Mn.density=a.bind(null,null,null),Mn.directedDensity=a.bind(null,"directed",!1),Mn.undirectedDensity=a.bind(null,"undirected",!1),Mn.mixedDensity=a.bind(null,"mixed",!1),Mn.multiDirectedDensity=a.bind(null,"directed",!0),Mn.multiUndirectedDensity=a.bind(null,"undirected",!0),Mn.multiMixedDensity=a.bind(null,"mixed",!0),Mn}var za={},Hc;function hm(){if(Hc)return za;Hc=1;var r=Ue();function e(n,i){if(!r(n))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,d,f,h={};for(f=0;f<a.length;f++)d=a[f],h[d]=[1/0,-1/0];return n.forEachNode(function(y,b){for(f=0;f<a.length;f++)d=a[f],s=b[d],s<h[d][0]&&(h[d][0]=s),s>h[d][1]&&(h[d][1]=s)}),typeof i=="string"?h[i]:h}function t(n,i){if(!r(n))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,d,f,h={};for(f=0;f<a.length;f++)d=a[f],h[d]=[1/0,-1/0];return n.forEachEdge(function(y,b){for(f=0;f<a.length;f++)d=a[f],s=b[d],s<h[d][0]&&(h[d][0]=s),s>h[d][1]&&(h[d][1]=s)}),typeof i=="string"?h[i]:h}return za.nodeExtent=e,za.edgeExtent=t,za}var Qo,Yc;function mh(){if(Yc)return Qo;Yc=1;var r=Ue(),e=zu().singleSourceLength;return Qo=function(n,i){if(!r(n))throw new Error("graphology-metrics/eccentricity: given graph is not a valid graphology instance.");if(n.size===0)return 1/0;var a=-1/0,s=e(n,i),d,f,h=0;for(d in s)f=s[d],f>a&&(a=f),h++;return h<n.order?1/0:a},Qo}var Zo,Xc;function fm(){if(Xc)return Zo;Xc=1;var r=Ue(),e=mh();return Zo=function(n){if(!r(n))throw new Error("graphology-metrics/diameter: given graph is not a valid graphology instance.");if(n.size===0)return 1/0;var i=-1/0;return n.someNode(function(a){var s=e(n,a);return s>i&&(i=s),i===1/0}),i},Zo}var Jo,Vc;function Rn(){if(Vc)return Jo;Vc=1;function r(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function e(t,n){t=t||{};var i={};for(var a in n){var s=t[a],d=n[a];if(!r(d)){i[a]=e(s,d);continue}s===void 0?i[a]=d:i[a]=s}return i}return Jo=e,Jo}var es,Qc;function qu(){if(Qc)return es;Qc=1;var r=Ue();return es=function(t){if(!r(t))throw new Error("graphology-utils/infer-type: expecting a valid graphology instance.");var n=t.type;return n!=="mixed"?n:t.directedSize===0&&t.undirectedSize===0||t.directedSize>0&&t.undirectedSize>0?"mixed":t.directedSize>0?"directed":"undirected"},es}var ts,Zc;function pm(){if(Zc)return ts;Zc=1;var r=Rn(),e=Ue(),t=qu(),n=vi(),i={getNodeCommunity:"community",getEdgeWeight:"weight",resolution:1};function a(P,z){var C=new Array(P.order),L=new Float64Array(P.order),K={},S=0,G=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry,q=n.createNodeValueGetter(z.getNodeCommunity).fromEntry,j=0,Y={};return P.forEachNode(function(te,B){Y[te]=j,C[j++]=q(te,B)}),P.forEachUndirectedEdge(function(te,B,me,ge,V,M,J){var ne=G(te,B,me,ge,V,M,J);S+=ne,K[te]=ne,L[Y[me]]+=ne,me!==ge&&(L[Y[ge]]+=ne)}),{weights:K,communities:C,weightedDegrees:L,M:S}}function s(P,z){var C=new Array(P.order),L=new Float64Array(P.order),K=new Float64Array(P.order),S={},G=0,q=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry,j=n.createNodeValueGetter(z.getNodeCommunity).fromEntry,Y=0,te={};return P.forEachNode(function(B,me){te[B]=Y,C[Y++]=j(B,me)}),P.forEachDirectedEdge(function(B,me,ge,V,M,J,ne){var de=q(B,me,ge,V,M,J,ne);G+=de,S[B]=de,K[te[ge]]+=de,L[te[V]]+=de}),{weights:S,communities:C,weightedInDegrees:L,weightedOutDegrees:K,M:G}}function d(P,z){var C=z.resolution,L=a(P,z),K=L.communities,S=L.weightedDegrees,G=L.M,q=P.nodes(),j,Y,te,B,me,ge,V=0,M=G*2;for(j=0,te=P.order;j<te;j++)for(Y=0;Y<te;Y++)K[j]===K[Y]&&(ge=P.undirectedEdge(q[j],q[Y]),B=L.weights[ge]||0,me=S[j]*S[Y],j===Y&&typeof ge<"u"?V+=(B-me/M*C)*2:V+=B-me/M*C);return V/M}function f(P,z){var C=z.resolution,L=s(P,z),K=L.communities,S=L.weightedInDegrees,G=L.weightedOutDegrees,q=L.M,j=P.nodes(),Y,te,B,me,ge,V,M=0;for(Y=0,B=P.order;Y<B;Y++)for(te=0;te<B;te++)K[Y]===K[te]&&(V=P.directedEdge(j[Y],j[te]),me=L.weights[V]||0,ge=S[Y]*G[te],M+=me-ge/q*C);return M/q}function h(P,z){var C={},L={},K={},S=n.createNodeValueGetter(z.getNodeCommunity).fromEntry;return P.forEachNode(function(G,q){var j=S(G,q);if(C[G]=j,typeof j>"u")throw new Error('graphology-metrics/modularity: the "'+G+'" node is not in the partition.');L[j]=0,K[j]=0}),{communities:C,totalWeights:L,internalWeights:K}}function y(P,z){var C={},L={},K={},S={},G=n.createNodeValueGetter(z.getNodeCommunity).fromEntry;return P.forEachNode(function(q,j){var Y=G(q,j);if(C[q]=Y,typeof Y>"u")throw new Error('graphology-metrics/modularity: the "'+q+'" node is not in the partition.');L[Y]=0,K[Y]=0,S[Y]=0}),{communities:C,totalInWeights:L,totalOutWeights:K,internalWeights:S}}function b(P,z){var C=z.resolution,L=h(P,z),K=0,S=L.totalWeights,G=L.internalWeights,q=L.communities,j=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry;P.forEachUndirectedEdge(function(me,ge,V,M,J,ne,de){var oe=j(me,ge,V,M,J,ne,de);K+=oe;var he=q[V],ue=q[M];S[he]+=oe,S[ue]+=oe,he===ue&&(G[he]+=oe*2)});var Y=0,te=K*2;for(var B in G)Y+=G[B]/te-Math.pow(S[B]/te,2)*C;return Y}function w(P,z){var C=z.resolution,L=y(P,z),K=0,S=L.totalInWeights,G=L.totalOutWeights,q=L.internalWeights,j=L.communities,Y=n.createEdgeWeightGetter(z.getEdgeWeight).fromEntry;P.forEachDirectedEdge(function(me,ge,V,M,J,ne,de){var oe=Y(me,ge,V,M,J,ne,de);K+=oe;var he=j[V],ue=j[M];G[he]+=oe,S[ue]+=oe,he===ue&&(q[he]+=oe)});var te=0;for(var B in q)te+=q[B]/K-S[B]*G[B]/Math.pow(K,2)*C;return te}function E(P,z,C,L){return L/(2*P)-z*C/(2*(P*P))}function I(P,z,C,L,K,S){return S/P-(K*z+L*C)/(P*P)}function D(P,z){if(!e(P))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(P.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(P.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var C=t(P);if(C==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return z=r(z,i),C==="directed"?f(P,z):d(P,z)}function N(P,z){if(!e(P))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(P.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(P.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var C=t(P);if(C==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return z=r(z,i),C==="directed"?w(P,z):b(P,z)}var O=N;return O.sparse=N,O.dense=D,O.undirectedDelta=E,O.directedDelta=I,ts=O,ts}var ns,Jc;function gm(){if(Jc)return ns;Jc=1;var r=Ue(),e=vi().createEdgeWeightGetter,t="weight";return ns=function(i,a){if(!r(i))throw new Error("graphology-metrics/weighted-size: the given graph is not a valid graphology instance.");a=e(a||t).fromEntry;var s=0;return i.forEachEdge(function(d,f,h,y,b,w,E){s+=a(d,f,h,y,b,w,E)}),s},ns}var el;function ym(){if(el)return Dt;el=1;var r=vh(),e=hm();return Dt.diameter=fm(),Dt.modularity=pm(),Dt.simpleSize=yh(),Dt.weightedSize=gm(),Dt.abstractDensity=r.abstractDensity,Dt.density=r.density,Dt.directedDensity=r.directedDensity,Dt.undirectedDensity=r.undirectedDensity,Dt.mixedDensity=r.mixedDensity,Dt.multiDirectedDensity=r.multiDirectedDensity,Dt.multiUndirectedDensity=r.multiUndirectedDensity,Dt.multiMixedDensity=r.multiMixedDensity,Dt.nodeExtent=e.nodeExtent,Dt.edgeExtent=e.edgeExtent,Dt}var tl=ym(),$a={},rs,nl;function bh(){if(nl)return rs;nl=1;var r=Ue(),e=qu(),t=Rn(),n=vi().createEdgeWeightGetter,i={edgeDisparityAttribute:"disparity",getEdgeWeight:"weight"};function a(d,f,h){if(!r(f))throw new Error("graphology-metrics/edge/disparity: the given graph is not a valid graphology instance.");if(f.multi||e(f)==="mixed")throw new Error("graphology-metrics/edge/disparity: not defined for multi nor mixed graphs.");h=t(h,i);var y=n(h.getEdgeWeight).fromEntry,b={};f.forEachNode(function(N){b[N]=0}),f.forEachEdge(function(N,O,P,z,C,L,K){var S=y(N,O,P,z,C,L,K);b[P]+=S,b[z]+=S});var w,E,I,D={};if(f.forEachAssymetricAdjacencyEntry(function(N,O,P,z,C,L,K){var S=y(C,L,N,O,P,z,K);w!==N&&(w=N,E=f.degree(N),I=b[N]);var G=f.degree(O),q=b[O],j=S/I,Y=S/q,te=Math.pow(1-j,E-1),B=Math.pow(1-Y,G-1);D[C]=Math.min(te,B)}),d){f.updateEachEdgeAttributes(function(N,O){return O[h.edgeDisparityAttribute]=D[N],O},{attributes:[h.edgeDisparityAttribute]});return}return D}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),rs=s,rs}var is={},rl;function wh(){return rl||(rl=1,function(r){r.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var e=new Set,t=1/0,n=null,i,a,s=arguments.length;for(a=0;a<s;a++){if(i=arguments[a],i.size===0)return e;i.size<t&&(t=i.size,n=i)}for(var d=n.values(),f,h,y,b;f=d.next(),!f.done;){for(h=f.value,y=!0,a=0;a<s;a++)if(b=arguments[a],b!==n&&!b.has(h)){y=!1;break}y&&e.add(h)}return e},r.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var e=new Set,t,n=arguments.length,i,a;for(t=0;t<n;t++)for(i=arguments[t].values();a=i.next(),!a.done;)e.add(a.value);return e},r.difference=function(e,t){if(!e.size)return new Set;if(!t.size)return new Set(e);for(var n=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||n.add(a.value);return n},r.symmetricDifference=function(e,t){for(var n=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||n.add(a.value);for(i=t.values();a=i.next(),!a.done;)e.has(a.value)||n.add(a.value);return n},r.isSubset=function(e,t){var n=e.values(),i;if(e===t)return!0;if(e.size>t.size)return!1;for(;i=n.next(),!i.done;)if(!t.has(i.value))return!1;return!0},r.isSuperset=function(e,t){return r.isSubset(t,e)},r.add=function(e,t){for(var n=t.values(),i;i=n.next(),!i.done;)e.add(i.value)},r.subtract=function(e,t){for(var n=t.values(),i;i=n.next(),!i.done;)e.delete(i.value)},r.intersect=function(e,t){for(var n=e.values(),i;i=n.next(),!i.done;)t.has(i.value)||e.delete(i.value)},r.disjunct=function(e,t){for(var n=e.values(),i,a=[];i=n.next(),!i.done;)t.has(i.value)&&a.push(i.value);for(n=t.values();i=n.next(),!i.done;)e.has(i.value)||e.add(i.value);for(var s=0,d=a.length;s<d;s++)e.delete(a[s])},r.intersectionSize=function(e,t){var n;if(e.size>t.size&&(n=e,e=t,t=n),e.size===0)return 0;if(e===t)return e.size;for(var i=e.values(),a,s=0;a=i.next(),!a.done;)t.has(a.value)&&s++;return s},r.unionSize=function(e,t){var n=r.intersectionSize(e,t);return e.size+t.size-n},r.jaccard=function(e,t){var n=r.intersectionSize(e,t);if(n===0)return 0;var i=e.size+t.size-n;return n/i},r.overlap=function(e,t){var n=r.intersectionSize(e,t);return n===0?0:n/Math.min(e.size,t.size)}}(is)),is}var as,il;function vm(){if(il)return as;il=1;var r=Ue(),e=wh().intersectionSize;function t(i,a){if(!r(a))throw new Error("graphology-metrics/simmelian-strength: given graph is not a valid graphology instance.");var s={};if(a.forEachNode(function(f){s[f]=new Set(a.neighbors(f))}),!i){var d={};return a.forEachEdge(function(f,h,y,b){d[f]=e(s[y],s[b])}),d}a.updateEachEdgeAttributes(function(f,h,y,b){return h.simmelianStrength=e(s[y],s[b]),h},{attributes:["simmelianStrength"]})}var n=t.bind(null,!1);return n.assign=t.bind(null,!0),as=n,as}var al;function mm(){return al||(al=1,$a.disparity=bh(),$a.simmelianStrength=vm()),$a}var bm=mm(),os,ol;function xh(){if(ol)return os;ol=1;var r=lo(),e=Tr();function t(n,i){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=n,this.capacity=i,this.items=new n(this.capacity),this.clear()}return t.prototype.clear=function(){this.start=0,this.size=0},t.prototype.push=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var i=this.start+this.size;return i>=this.capacity&&(i-=this.capacity),this.items[i]=n,++this.size},t.prototype.unshift=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var i=this.start-1;return this.start===0&&(i=this.capacity-1),this.items[i]=n,this.start=i,++this.size},t.prototype.pop=function(){if(this.size!==0){this.size--;var n=this.start+this.size;return n>=this.capacity&&(n-=this.capacity),this.items[n]}},t.prototype.shift=function(){if(this.size!==0){var n=this.start;return this.size--,this.start++,this.start===this.capacity&&(this.start=0),this.items[n]}},t.prototype.peekFirst=function(){if(this.size!==0)return this.items[this.start]},t.prototype.peekLast=function(){if(this.size!==0){var n=this.start+this.size-1;return n>=this.capacity&&(n-=this.capacity),this.items[n]}},t.prototype.get=function(n){if(!(this.size===0||n>=this.capacity))return n=this.start+n,n>=this.capacity&&(n-=this.capacity),this.items[n]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=this.capacity,s=this.size,d=this.start,f=0;f<s;)n.call(i,this.items[d],f,this),d++,f++,d===a&&(d=0)},t.prototype.toArray=function(){var n=this.start+this.size;if(n<this.capacity)return this.items.slice(this.start,n);for(var i=new this.ArrayClass(this.size),a=this.capacity,s=this.size,d=this.start,f=0;f<s;)i[f]=this.items[d],d++,f++,d===a&&(d=0);return i},t.prototype.values=function(){var n=this.items,i=this.capacity,a=this.size,s=this.start,d=0;return new e(function(){if(d>=a)return{done:!0};var f=n[s];return s++,d++,s===i&&(s=0),{value:f,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.capacity,a=this.size,s=this.start,d=0;return new e(function(){if(d>=a)return{done:!0};var f=n[s];return s++,s===i&&(s=0),{value:[d++,f],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){var n=this.toArray();return n.type=this.ArrayClass.name,n.capacity=this.capacity,Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n,i,a){if(arguments.length<3&&(a=r.guessLength(n),typeof a!="number"))throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(r.isArrayLike(n)){var d,f;for(d=0,f=n.length;d<f;d++)s.items[d]=n[d];return s.size=f,s}return r.forEach(n,function(h){s.push(h)}),s},os=t,os}var ss,sl;function wm(){if(sl)return ss;sl=1;var r=Tr(),e=ia().getPointerArray;function t(n){var i=e(n);this.size=0,this.length=n,this.dense=new i(n),this.sparse=new i(n)}return t.prototype.clear=function(){this.size=0},t.prototype.has=function(n){var i=this.sparse[n];return i<this.size&&this.dense[i]===n},t.prototype.add=function(n){var i=this.sparse[n];return i<this.size&&this.dense[i]===n?this:(this.dense[this.size]=n,this.sparse[n]=this.size,this.size++,this)},t.prototype.delete=function(n){var i=this.sparse[n];return i>=this.size||this.dense[i]!==n?!1:(i=this.dense[this.size-1],this.dense[this.sparse[n]]=i,this.sparse[i]=this.sparse[n],this.size--,!0)},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a,s=0;s<this.size;s++)a=this.dense[s],n.call(i,a,a)},t.prototype.values=function(){var n=this.size,i=this.dense,a=0;return new r(function(){if(a<n){var s=i[a];return a++,{value:s}}return{done:!0}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){for(var n=new Set,i=0;i<this.size;i++)n.add(this.dense[i]);return Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n.length=this.length,n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),ss=t,ss}var Ga={},ul;function ho(){if(ul)return Ga;ul=1;var r=ia(),e=vi().createEdgeWeightGetter;function t(a,s){return a==="outbound"||a==="inbound"?s.directedSize+s.undirectedSize*2:a==="in"||a==="out"||a==="directed"?s.directedSize:s.undirectedSize*2}function n(a,s){s=s||"outbound";var d=a[s+"Neighbors"].bind(a),f=t(s,a),h=r.getPointerArray(f),y=r.getPointerArray(a.order);this.graph=a,this.neighborhood=new y(f),this.starts=new h(a.order+1),this.nodes=a.nodes();var b={},w,E,I,D,N,O,P=0;for(w=0,E=a.order;w<E;w++)b[this.nodes[w]]=w;for(w=0,E=a.order;w<E;w++)for(N=this.nodes[w],O=d(N),this.starts[w]=P,I=0,D=O.length;I<D;I++)this.neighborhood[P++]=b[O[I]];this.starts[w]=f}n.prototype.bounds=function(a){return[this.starts[a],this.starts[a+1]]},n.prototype.project=function(){var a=this,s={};return a.nodes.forEach(function(d,f){s[d]=Array.from(a.neighborhood.slice(a.starts[f],a.starts[f+1])).map(function(h){return a.nodes[h]})}),s},n.prototype.collect=function(a){var s,d,f={};for(s=0,d=a.length;s<d;s++)f[this.nodes[s]]=a[s];return f},n.prototype.assign=function(a,s){var d=0;this.graph.updateEachNodeAttributes(function(f,h){return h[a]=s[d++],h},{attributes:[a]})},Ga.NeighborhoodIndex=n;function i(a,s,d){d=d||"outbound";var f=a[d+"Edges"].bind(a),h=t(d,a),y=r.getPointerArray(h),b=r.getPointerArray(a.order),w=e(s).fromMinimalEntry;this.graph=a,this.neighborhood=new b(h),this.weights=new Float64Array(h),this.outDegrees=new Float64Array(a.order),this.starts=new y(a.order+1),this.nodes=a.nodes();var E={},I,D,N,O,P,z,C,L,K,S=0;for(I=0,D=a.order;I<D;I++)E[this.nodes[I]]=I;for(I=0,D=a.order;I<D;I++)for(P=this.nodes[I],C=f(P),this.starts[I]=S,N=0,O=C.length;N<O;N++)L=C[N],z=a.opposite(P,L),K=w(L,a.getEdgeAttributes(L)),this.neighborhood[S]=E[z],this.weights[S++]=K,this.outDegrees[I]+=K;this.starts[I]=h}return i.prototype.bounds=n.prototype.bounds,i.prototype.project=n.prototype.project,i.prototype.collect=n.prototype.collect,i.prototype.assign=n.prototype.assign,Ga.WeightedNeighborhoodIndex=i,Ga}var us,cl;function xm(){if(cl)return us;cl=1;var r=Ue(),e=Rn(),t=xh(),n=wm(),i=ho().NeighborhoodIndex,a={nodeCentralityAttribute:"closenessCentrality",wassermanFaust:!1};function s(h){this.index=new i(h,"inbound"),this.queue=new t(Array,h.order),this.seen=new n(h.order)}s.prototype.fromNode=function(h){var y=this.index,b=this.queue,w=this.seen;w.clear(),b.clear(),w.add(h),b.push([h,0]);for(var E,I,D,N,O,P,z=0,C=0;b.size!==0;)for(E=b.shift(),I=E[0],D=E[1],D!==0&&(z+=D,C+=1),O=y.starts[I+1],N=y.starts[I];N<O;N++)P=y.neighborhood[N],!w.has(P)&&(w.add(P),b.push([P,D+1]));return[C,z]};function d(h,y,b){if(!r(y))throw new Error("graphology-metrics/centrality/closeness: the given graph is not a valid graphology instance.");b=e(b,a);var w=b.wassermanFaust,E=new s(y),I=y.order,D,N,O,P,z,C=new Float64Array(I);for(D=0;D<I;D++)N=E.fromNode(D),O=N[0],P=N[1],z=0,P>0&&I>1&&(z=O/P,w&&(z*=O/(I-1))),C[D]=z;return h?E.index.assign(b.nodeCentralityAttribute,C):E.index.collect(C)}var f=d.bind(null,!1);return f.assign=d.bind(null,!0),us=f,us}var Em=xm();const _m=Mt(Em);var Ui={},ll;function Sm(){if(ll)return Ui;ll=1;var r=Ue();function e(a,s,d,f){var h=s+"Centrality";if(!r(d))throw new Error("graphology-centrality/"+h+": the given graph is not a valid graphology instance.");if(s!=="degree"&&d.type==="undirected")throw new Error("graphology-centrality/"+h+": cannot compute "+s+" centrality on an undirected graph.");f=f||{};var y=f.nodeCentralityAttribute||h,b=d.order-1,w=d[s].bind(d);if(a){d.updateEachNodeAttributes(function(I,D){return D[y]=w(I)/b,D},{attributes:[y]});return}var E={};return d.forEachNode(function(I){E[I]=w(I)/b}),E}var t=e.bind(null,!1,"degree"),n=e.bind(null,!1,"inDegree"),i=e.bind(null,!1,"outDegree");return t.assign=e.bind(null,!0,"degree"),n.assign=e.bind(null,!0,"inDegree"),i.assign=e.bind(null,!0,"outDegree"),Ui.degreeCentrality=t,Ui.inDegreeCentrality=n,Ui.outDegreeCentrality=i,Ui}var Am=Sm(),qa={},cs,dl;function km(){if(dl)return cs;dl=1;var r=Tr(),e=lo();function t(n,i){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=i,this.ArrayClass=n,this.items=new this.ArrayClass(this.capacity),this.clear()}return t.prototype.clear=function(){this.size=0},t.prototype.push=function(n){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=n,this.size},t.prototype.pop=function(){if(this.size!==0)return this.items[--this.size]},t.prototype.peek=function(){return this.items[this.size-1]},t.prototype.forEach=function(n,i){i=arguments.length>1?i:this;for(var a=0,s=this.items.length;a<s;a++)n.call(i,this.items[s-a-1],a,this)},t.prototype.toArray=function(){for(var n=new this.ArrayClass(this.size),i=this.size-1,a=this.size;a--;)n[a]=this.items[i-a];return n},t.prototype.values=function(){var n=this.items,i=this.size,a=0;return new r(function(){if(a>=i)return{done:!0};var s=n[i-a-1];return a++,{value:s,done:!1}})},t.prototype.entries=function(){var n=this.items,i=this.size,a=0;return new r(function(){if(a>=i)return{done:!0};var s=n[i-a-1];return{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var n=this.toArray();return n.type=this.ArrayClass.name,n.capacity=this.capacity,Object.defineProperty(n,"constructor",{value:t,enumerable:!1}),n},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(n,i,a){if(arguments.length<3&&(a=e.guessLength(n),typeof a!="number"))throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(e.isArrayLike(n)){var d,f;for(d=0,f=n.length;d<f;d++)s.items[d]=n[d];return s.size=f,s}return e.forEach(n,function(h){s.push(h)}),s},cs=t,cs}var hl;function Cm(){if(hl)return qa;hl=1;var r=xh(),e=km(),t=Gu(),n=ia(),i=ho(),a=i.NeighborhoodIndex,s=i.WeightedNeighborhoodIndex;qa.createUnweightedIndexedBrandes=function(h){var y=new a(h),b=y.neighborhood,w=y.starts,E=h.order,I=new e(n.getPointerArray(E),E),D=new Uint32Array(E),N=new Array(E),O=new Int32Array(E),P=new r(Uint32Array,E),z=function(C){var L,K,S,G,q,j,Y;for(j=0;j<E;j++)N[j]=[],D[j]=0,O[j]=-1;for(D[C]=1,O[C]=0,P.push(C);P.size!==0;)for(j=P.shift(),I.push(j),L=O[j],K=D[j],S=w[j],G=w[j+1],q=S;q<G;q++)Y=b[q],O[Y]===-1&&(P.push(Y),O[Y]=L+1),O[Y]===L+1&&(D[Y]+=K,N[Y].push(j));return[I,N,D]};return z.index=y,z};function d(f,h){return f[0]>h[0]?1:f[0]<h[0]?-1:f[1]>h[1]?1:f[1]<h[1]?-1:f[2]>h[2]?1:f[2]<h[2]?-1:f[3]>h[3]?1:f[3]<h[3]?-1:0}return qa.createDijkstraIndexedBrandes=function(h,y){var b=new s(h,y||"weight"),w=b.neighborhood,E=b.weights,I=b.starts,D=h.order,N=new e(n.getPointerArray(D),D),O=new Uint32Array(D),P=new Array(D),z=new Float64Array(D),C=new Float64Array(D),L=new t(d),K=function(S){var G,q,j,Y,te,B,me,ge,V,M=0;for(ge=0;ge<D;ge++)P[ge]=[],O[ge]=0,z[ge]=-1,C[ge]=-1;for(O[S]=1,C[S]=0,L.push([0,M++,S,S]);L.size!==0;)if(j=L.pop(),Y=j[0],te=j[2],ge=j[3],z[ge]===-1)for(N.push(ge),z[ge]=Y,O[ge]+=O[te],G=I[ge],q=I[ge+1],me=G;me<q;me++)V=w[me],B=Y+E[me],z[V]===-1&&(C[V]===-1||B<C[V])?(C[V]=B,L.push([B,M++,ge,V]),O[V]=0,P[V]=[ge]):B===C[V]&&(O[V]+=O[ge],P[V].push(ge));return[N,P,O]};return K.index=b,K},qa}var ls,fl;function Dm(){if(fl)return ls;fl=1;var r=Ue(),e=Cm(),t=Rn(),n=e.createUnweightedIndexedBrandes,i=e.createDijkstraIndexedBrandes,a={nodeCentralityAttribute:"betweennessCentrality",getEdgeWeight:"weight",normalized:!0};function s(f,h,y){if(!r(h))throw new Error("graphology-centrality/beetweenness-centrality: the given graph is not a valid graphology instance.");y=t(y,a);var b=y.nodeCentralityAttribute,w=y.normalized,E=y.getEdgeWeight?i(h,y.getEdgeWeight):n(h),I=h.order,D,N,O,P,z,C,L,K,S,G,q=new Float64Array(I),j=new Float64Array(I);for(C=0;C<I;C++){for(D=E(C),N=D[0],O=D[1],P=D[2],L=N.size;L--;)q[N.items[N.size-L]]=0;for(;N.size!==0;){for(G=N.pop(),z=(1+q[G])/P[G],L=0,K=O[G].length;L<K;L++)S=O[G][L],q[S]+=P[S]*z;G!==C&&(j[G]+=q[G])}}var Y=null;if(w?Y=I<=2?null:1/((I-1)*(I-2)):Y=h.type==="undirected"?.5:null,Y!==null)for(C=0;C<I;C++)j[C]*=Y;return f?E.index.assign(b,j):E.index.collect(j)}var d=s.bind(null,!1);return d.assign=s.bind(null,!0),ls=d,ls}var Im=Dm();const Mm=Mt(Im);var ds,pl;function Pm(){if(pl)return ds;pl=1;var r=Ue(),e=Rn(),t=ho().WeightedNeighborhoodIndex,n={nodeCentralityAttribute:"eigenvectorCentrality",getEdgeWeight:"weight",maxIterations:100,tolerance:1e-6};function i(d){for(var f=0,h=0,y=0,b=d.length;y<b;y++){var w=Math.abs(d[y]);w>f&&(h*=f/w*(f/w),f=w),h+=w===0&&f===0?0:w/f*(w/f)}return f===1/0?1:f*Math.sqrt(h)}function a(d,f,h){if(!r(f))throw new Error("graphology-metrics/centrality/eigenvector: the given graph is not a valid graphology instance.");h=e(h,n);var y=h.maxIterations,b=h.tolerance,w=f.order,E=new t(f,h.getEdgeWeight),I,D,N,O,P=new Float64Array(f.order);for(I=0;I<w;I++)P[I]=1/w;for(var z=0,C=0,L,K,S,G=!1;z<y;){for(K=P,P=new Float64Array(K),I=0;I<w;I++)for(N=E.starts[I+1],D=E.starts[I];D<N;D++)L=E.neighborhood[D],O=E.weights[D],P[L]+=K[I]*O;for(S=i(P),I=0;I<w;I++)P[I]/=S;for(C=0,I=0;I<w;I++)C+=Math.abs(P[I]-K[I]);if(C<w*b){G=!0;break}z++}if(!G)throw Error("graphology-metrics/centrality/eigenvector: failed to converge.");if(d){E.assign(h.nodeCentralityAttribute,P);return}return E.collect(P)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),ds=s,ds}var Nm=Pm();const Om=Mt(Nm);var ri={},hs,gl;function Tm(){if(gl)return hs;gl=1;var r=Ue();function e(n,i){if(n.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.max: not enough values!");for(var a=void 0,s,d=1,f=n.length;d<f;d++)s=n[d],i!==void 0&&(s=i(s)),(a===void 0||s>a)&&(a=s);return a}function t(n,i){if(n.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.min: not enough values!");for(var a=void 0,s,d=1,f=n.length;d<f;d++)s=n[d],i!==void 0&&(s=i(s)),(a===void 0||s<a)&&(a=s);return a}return hs=function(i,a){if(!r(i))throw new Error("graphology-metrics/layout-quality/connected-closeness: given graph is not a valid graphology instance.");if(i.size<2)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:z.C};a=a||{},a.epsilon=a.epsilon||.03,a.gridSize=a.gridSize||10;var s=a.rng||Math.random,d=L(),f=i.edges().map(function(S){var G=i.getNodeAttributes(i.source(S)),q=i.getNodeAttributes(i.target(S)),j=Math.sqrt(Math.pow(G.x-q.x,2)+Math.pow(G.y-q.y,2));return j}),h=[0,Math.max(e(d),e(f)||0)],y=0,b={},w,E,I,D,N,O=-1;do{for(D=0;D<=a.gridSize;D++)w=h[0]+(h[1]-h[0])*D/a.gridSize,b[w]===void 0&&(b[w]=C(w,i,d,f));E=y,y=0,N=Object.values(b),N.forEach(function(S,G){I=S.C,I>y&&(y=I,O=G)}),h=[N[Math.max(0,O-1)].Delta,N[Math.min(N.length-1,O+1)].Delta]}while((y-E)/y>=a.epsilon/10);var P=K(N,a.epsilon),z=C(P,i,d,f);if(z.C<.1)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:z.C};return{deltaMax:P,ePercentOfDeltaMax:z.ePercent,pPercentOfDeltaMax:z.pPercent,pEdgeOfDeltaMax:z.pEdge,cMax:z.C};function C(S,G,q,j){var Y=j.filter(function(de){return de<=S}),te=q.filter(function(de){return de<=S}),B=Y.length,me=B/j.length,ge=te.length,V=ge/q.length,M=me-V,J=G.undirected?1:2,ne=B/(J*ge*(G.order*(G.order-1))/q.length);return{Delta:S,ePercent:me,pPercent:V,pEdge:ne,C:M}}function L(){if(i.order<2)return[];var S=[],G,q,j,Y,te,B=i.size;if(B<1)return[];for(var me=0;me<B;me++){G=i.nodes()[Math.floor(s()*i.order)];do q=i.nodes()[Math.floor(s()*i.order)];while(G===q);j=i.getNodeAttributes(G),Y=i.getNodeAttributes(q),te=Math.sqrt(Math.pow(j.x-Y.x,2)+Math.pow(j.y-Y.y,2)),S.push(te)}return S}function K(S,G){var q=e(S,function(Y){return Y.C}),j=t(S.filter(function(Y){return Y.C>=(1-G)*q}),function(Y){return Y.Delta});return j}},hs}var fs,yl;function Rm(){if(yl)return fs;yl=1;var r=Ue();function e(t,n){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}return fs=function(n){if(!r(n))throw new Error("graphology-metrics/layout-quality/edge-uniformity: given graph is not a valid graphology instance.");if(n.size===0)return 0;var i=0,a=0,s,d=new Float64Array(n.size);n.forEachEdge(function(b,w,E,I,D,N){var O=e(D,N);d[a++]=O,i+=O});var f=i/n.size,h=0;for(a=0,s=n.size;a<s;a++)h+=Math.pow(f-d[a],2);var y=h/(n.size*Math.pow(f,2));return Math.sqrt(y)},fs}var ps,vl;function Lm(){if(vl)return ps;vl=1;var r=$u(),e=Gu(),t=r.DEFAULT_COMPARATOR,n=r.reverseComparator;function i(d,f,h,y){for(var b=h,w=y,E=f[y],I=2*y+1,D;I<b;)D=I+1,D<b&&d(f[I],f[D])>=0&&(I=D),f[y]=f[I],y=I,I=2*y+1;f[y]=E,e.siftDown(d,f,w,y)}function a(d,f,h,y){for(var b=y,w=b,E=new d(y),I,D;w>0;)I=h[--w],w!==0&&(D=h[0],h[0]=I,i(f,h,--y,0),I=D),E[w]=I;return E}function s(d,f,h){if(arguments.length===2&&(h=f,f=null),this.ArrayClass=d,this.capacity=h,this.items=new d(h),this.clear(),this.comparator=f||t,typeof h!="number"&&h<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=n(this.comparator)}return s.prototype.clear=function(){this.size=0},s.prototype.push=function(d){return this.size<this.capacity?(this.items[this.size]=d,e.siftDown(this.comparator,this.items,0,this.size),this.size++):this.comparator(d,this.items[0])>0&&e.replace(this.comparator,this.items,d),this.size},s.prototype.peek=function(){return this.items[0]},s.prototype.consume=function(){var d=a(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,d},s.prototype.toArray=function(){return a(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)},s.prototype.inspect=function(){var d=this.toArray();return Object.defineProperty(d,"constructor",{value:s,enumerable:!1}),d},typeof Symbol<"u"&&(s.prototype[Symbol.for("nodejs.util.inspect.custom")]=s.prototype.inspect),ps=s,ps}var Fa={},ml;function zm(){if(ml)return Fa;ml=1;var r=new Float64Array(64),e=new Float64Array(64);function t(i,a,s){var d,f,h,y,b;for(r[0]=a,e[0]=s,f=0;f>=0;)if(h=r[f],y=e[f]-1,h<y){for(d=i[h];h<y;){for(;i[y]>=d&&h<y;)y--;for(h<y&&(i[h++]=i[y]);i[h]<=d&&h<y;)h++;h<y&&(i[y--]=i[h])}i[h]=d,r[f+1]=h+1,e[f+1]=e[f],e[f++]=h,e[f]-r[f]>e[f-1]-r[f-1]&&(b=r[f],r[f]=r[f-1],r[f-1]=b,b=e[f],e[f]=e[f-1],e[f-1]=b)}else f--;return i}Fa.inplaceQuickSort=t;function n(i,a,s,d){var f,h,y,b,w,E;for(r[0]=s,e[0]=d,h=0;h>=0;)if(y=r[h],b=e[h]-1,y<b){for(w=a[y],f=i[w];y<b;){for(;i[a[b]]>=f&&y<b;)b--;for(y<b&&(a[y++]=a[b]);i[a[y]]<=f&&y<b;)y++;y<b&&(a[b--]=a[y])}a[y]=w,r[h+1]=y+1,e[h+1]=e[h],e[h++]=y,e[h]-r[h]>e[h-1]-r[h-1]&&(E=r[h],r[h]=r[h-1],r[h-1]=E,E=e[h],e[h]=e[h-1],e[h-1]=E)}else h--;return a}return Fa.inplaceQuickSortIndices=n,Fa}var gs,bl;function $m(){if(bl)return gs;bl=1;var r=lo(),e=ia(),t=$u().createTupleComparator,n=Lm(),i=zm().inplaceQuickSortIndices;function a(b,w,E,I){var D,N=0,O;for(D=0;D<b;D++)O=w[D][E]-I[D],N+=O*O;return N}function s(b,w){var E=w.length,I=new Array(b),D=new Array(E),N,O=e.getPointerArray(E),P=new O(E),z,C,L,K=!0;for(z=0;z<b;z++){for(N=new Float64Array(E),C=0;C<E;C++)L=w[C],N[C]=L[1][z],K&&(D[C]=L[0],P[C]=C);K=!1,I[z]=N}return{axes:I,ids:P,labels:D}}function d(b,w,E,I){for(var D=I.length,N=e.getPointerArray(D+1),O=new N(D),P=new N(D),z=new N(D),C=[[0,0,E.length,-1,0]],L,K,S,G,q,j,Y,te,B=0;C.length!==0;)L=C.pop(),te=L[0],j=L[1],Y=L[2],K=L[3],S=L[4],i(w[te],E,j,Y),D=Y-j,G=j+(D>>>1),q=E[G],O[B]=q,K>-1&&(S===0?P[K]=B+1:z[K]=B+1),te=(te+1)%b,G!==j&&G!==Y-1&&C.push([te,G+1,Y,B,1]),G!==j&&C.push([te,j,G,B,0]),B++;return{axes:w,labels:I,pivots:O,lefts:P,rights:z}}function f(b,w){this.dimensions=b,this.visited=0,this.axes=w.axes,this.labels=w.labels,this.pivots=w.pivots,this.lefts=w.lefts,this.rights=w.rights,this.size=this.labels.length}f.prototype.nearestNeighbor=function(b){var w=1/0,E=null,I=this.dimensions,D=this.axes,N=this.pivots,O=this.lefts,P=this.rights,z=0;function C(L,K){z++;var S=O[K],G=P[K],q=N[K],j=a(I,D,q,b);if(!(j<w&&(E=q,w=j,j===0))){var Y=D[L][q]-b[L];L=(L+1)%I,Y>0?S!==0&&C(L,S-1):G!==0&&C(L,G-1),Y*Y<w&&(Y>0?G!==0&&C(L,G-1):S!==0&&C(L,S-1))}}return C(0,0),this.visited=z,this.labels[E]};var h=t(3),y=t(2);return f.prototype.kNearestNeighbors=function(b,w){if(b<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if(b=Math.min(b,this.size),b===1)return[this.nearestNeighbor(w)];var E=new n(Array,h,b),I=this.dimensions,D=this.axes,N=this.pivots,O=this.lefts,P=this.rights,z=0;function C(S,G){var q=O[G],j=P[G],Y=N[G],te=a(I,D,Y,w);E.push([te,z++,Y]);var B=w[S],me=D[S][Y],ge=B-me;S=(S+1)%I,B<me?q!==0&&C(S,q-1):j!==0&&C(S,j-1),(ge*ge<E.peek()[0]||E.size<b)&&(B<me?j!==0&&C(S,j-1):q!==0&&C(S,q-1))}C(0,0),this.visited=z;for(var L=E.consume(),K=0;K<L.length;K++)L[K]=this.labels[L[K][2]];return L},f.prototype.linearKNearestNeighbors=function(b,w){if(b<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");b=Math.min(b,this.size);var E=new n(Array,y,b),I,D,N;for(I=0,D=this.size;I<D;I++)N=a(this.dimensions,this.axes,this.pivots[I],w),E.push([N,I]);var O=E.consume();for(I=0;I<O.length;I++)O[I]=this.labels[this.pivots[O[I][1]]];return O},f.prototype.inspect=function(){var b=new Map;b.dimensions=this.dimensions,Object.defineProperty(b,"constructor",{value:f,enumerable:!1});var w,E,I;for(w=0;w<this.size;w++){for(I=new Array(this.dimensions),E=0;E<this.dimensions;E++)I[E]=this.axes[E][w];b.set(this.labels[w],I)}return b},typeof Symbol<"u"&&(f.prototype[Symbol.for("nodejs.util.inspect.custom")]=f.prototype.inspect),f.from=function(b,w){var E=r.toArray(b),I=s(w,E),D=d(w,I.axes,I.ids,I.labels);return new f(w,D)},f.fromAxes=function(b,w){w||(w=e.indices(b[0].length));var E=b.length,I=d(b.length,b,e.indices(w.length),w);return new f(E,I)},gs=f,gs}var ys,wl;function Eh(){if(wl)return ys;wl=1;var r=Ue(),e=$m(),t=wh().intersectionSize;return ys=function(i){if(!r(i))throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: cannot compute stress for a null graph.");if(i.size===0)return 0;var a=[new Float64Array(i.order),new Float64Array(i.order)],s=0;i.forEachNode(function(h,y){a[0][s]=y.x,a[1][s++]=y.y});var d=e.fromAxes(a,i.nodes()),f=0;return i.forEachNode(function(h,y){var b=new Set(i.neighbors(h));if(b.size===0||b.size===i.order-1){f+=1;return}var w=d.kNearestNeighbors(b.size+1,[y.x,y.y]);w=new Set(w.slice(1));var E=t(b,w);f+=E/w.size}),f/i.order},ys}var vs,xl;function _h(){if(xl)return vs;xl=1;var r=Ue(),e=zu().undirectedSingleSourceLength;function t(n,i){return Math.sqrt(Math.pow(n.x-i.x,2)+Math.pow(n.y-i.y,2))}return vs=function(i){if(!r(i))throw new Error("graphology-metrics/layout-quality/stress: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/stress: cannot compute stress for a null graph.");var a=new Array(i.order),s=new Array(i.order),d=0,f=i.order*4;i.forEachNode(function(P,z){a[d]=P,s[d++]=z});var h,y,b,w,E,I,D,N,O=0;for(d=0,y=i.order;d<y;d++)for(E=e(i,a[d]),b=s[d],h=d+1;h<y;h++)w=s[h],I=E[a[h]],typeof I>"u"&&(I=f),N=t(b,w),D=1/(I*I),O+=D*Math.pow(N-I,2);return O},vs}var El;function Gm(){return El||(El=1,ri.connectedCloseness=Tm(),ri.edgeUniformity=Rm(),ri.neighborhoodPreservation=Eh(),ri.stress=_h()),ri}var qm=Gm(),Fm=_h();const jm=Mt(Fm);var Bm=mh();const Um=Mt(Bm);var ms,_l;function Km(){if(_l)return ms;_l=1;var r=Ue(),e=Rn(),t=ho().WeightedNeighborhoodIndex,n={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function i(s,d,f){if(!r(d))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");f=e(f,n);var h=f.alpha,y=f.maxIterations,b=f.tolerance,w=f.nodePagerankAttribute,E=d.order,I=1/E,D=new t(d,f.getEdgeWeight),N,O,P,z,C=new Float64Array(d.order),L=new Float64Array(D.weights.length),K=[];for(N=0;N<E;N++)for(C[N]=I,P=D.starts[N+1],z=D.outDegrees[N],z===0&&K.push(N),O=D.starts[N];O<P;O++)L[O]=D.weights[O]/z;for(var S=0,G=0,q,j,Y,te=!1;S<y;){for(Y=C,C=new Float64Array(d.order),q=0,N=0,P=K.length;N<P;N++)q+=Y[K[N]];for(q*=h,N=0;N<E;N++){for(P=D.starts[N+1],O=D.starts[N];O<P;O++)j=D.neighborhood[O],C[j]+=h*Y[N]*L[O];C[N]+=q*I+(1-h)*I}for(G=0,N=0;N<E;N++)G+=Math.abs(C[N]-Y[N]);if(G<E*b){te=!0;break}S++}if(!te)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(s){D.assign(w,C);return}return D.collect(C)}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),ms=a,ms}var Wm=Km();const Hm=Mt(Wm);var Ym=Eh();const Xm=Mt(Ym);var Vm=bh();const Qm=Mt(Vm);var vn={},bs,Sl;function Zm(){if(Sl)return bs;Sl=1;var r=Ue(),e=Ru().copyNode,t=Hn().copyEdge;return bs=function(i,a){if(!r(i)||!r(a))throw new Error("graphology-operators/disjoint-union: invalid graph.");if(i.multi!==a.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");var s=i.nullCopy();s.mergeAttributes(i.getAttributes());var d={},f={},h=0;return i.forEachNode(function(y,b){d[y]=h,e(s,h,b),h++}),a.forEachNode(function(y,b){f[y]=h,e(s,h,b),h++}),h=0,i.forEachEdge(function(y,b,w,E,I,D,N){t(s,N,h++,d[w],d[E],E,b)}),a.forEachEdge(function(y,b,w,E,I,D,N){t(s,N,h++,f[w],f[E],E,b)}),s},bs}var ws,Al;function Jm(){if(Al)return ws;Al=1;var r=Ue(),e=Hn().copyEdge;return ws=function(n){if(!r(n))throw new Error("graphology-operators/reverse: invalid graph.");var i=n.emptyCopy();return n.forEachEdge(function(a,s,d,f,h,y,b){b?e(i,!0,a,d,f,s):e(i,!1,a,f,d,s)}),i},ws}var xs,kl;function e0(){if(kl)return xs;kl=1;var r=Ue(),e=Ru().copyNode,t=Hn().copyEdge;return xs=function(i,a){if(!r(i))throw new Error("graphology-operators/subgraph: invalid graph instance.");var s=i.nullCopy(),d=a;if(Array.isArray(a)){if(a.length===0)return s;a=new Set(a)}if(a instanceof Set){if(a.size===0)return s;d=function(h){return a.has(h)};var f=a;a=new Set,f.forEach(function(h){a.add(""+h)})}if(typeof d!="function")throw new Error("graphology-operators/subgraph: invalid nodes. Expecting an array or a set or a filtering function.");if(typeof a=="function"){if(i.forEachNode(function(h,y){d(h,y)&&e(s,h,y)}),s.order===0)return s}else a.forEach(function(h){if(!i.hasNode(h))throw new Error('graphology-operators/subgraph: the "'+h+'" node was not found in the graph.');e(s,h,i.getNodeAttributes(h))});return i.forEachEdge(function(h,y,b,w,E,I,D){d(b,E)&&(w!==b&&!d(w,I)||t(s,D,h,b,w,y))}),s},xs}var Es,Cl;function t0(){if(Cl)return Es;Cl=1;var r=Ue(),e=Hn().copyEdge;return Es=function(n,i){if(!r(n))throw new Error("graphology-operators/to-directed: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(n.type==="directed")return n.copy();var s=n.emptyCopy({type:"directed"});return n.forEachDirectedEdge(function(d,f,h,y){e(s,!1,d,h,y,f)}),n.forEachUndirectedEdge(function(d,f,h,y){var b=!n.multi&&n.type==="mixed"&&s.edge(h,y),w=!n.multi&&n.type==="mixed"&&s.edge(y,h);b?s.replaceEdgeAttributes(b,a(s.getEdgeAttributes(b),f)):e(s,!1,null,h,y,f),h!==y&&(w?s.replaceEdgeAttributes(w,a(s.getEdgeAttributes(w),f)):e(s,!1,null,y,h,f))}),s},Es}var _s,Dl;function n0(){if(Dl)return _s;Dl=1;var r=Ue();return _s=function(t){if(!r(t))throw new Error("graphology-operators/to-mixed: expecting a valid graphology instance.");return t.copy({type:"mixed"})},_s}var Ss,Il;function r0(){if(Il)return Ss;Il=1;var r=Ue();return Ss=function(t){if(!r(t))throw new Error("graphology-operators/to-multi: expecting a valid graphology instance.");return t.copy({multi:!0})},Ss}var As,Ml;function i0(){if(Ml)return As;Ml=1;var r=Ue(),e=Hn().copyEdge;return As=function(n,i){if(!r(n))throw new Error("graphology-operators/to-simple: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(!n.multi)return n.copy();var s=n.emptyCopy({multi:!1});return n.forEachEdge(function(d,f,h,y,b,w,E){var I=E?s.undirectedEdge(h,y):s.directedEdge(h,y);if(I){a&&s.replaceEdgeAttributes(I,a(s.getEdgeAttributes(I),f));return}e(s,E,d,h,y,f)}),s},As}var ks,Pl;function a0(){if(Pl)return ks;Pl=1;var r=Ue(),e=Hn().copyEdge;return ks=function(n,i){if(!r(n))throw new Error("graphology-operators/to-undirected: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(n.type==="undirected")return n.copy();var s=n.emptyCopy({type:"undirected"});return n.forEachUndirectedEdge(function(d,f,h,y){e(s,!0,d,h,y,f)}),n.forEachDirectedEdge(function(d,f,h,y){if(!n.multi){var b=s.edge(h,y);if(b){a&&s.replaceEdgeAttributes(b,a(s.getEdgeAttributes(b),f));return}}e(s,!0,null,h,y,f)}),s},ks}var Cs,Nl;function o0(){if(Nl)return Cs;Nl=1;var r=Ue();return Cs=function(t,n){if(!r(t)||!r(n))throw new Error("graphology-operators/union: invalid graph.");if(t.multi!==n.multi)throw new Error("graphology-operators/union: both graph should be simple or multi.");var i=t.copy();return i.import(n,!0),i},Cs}var Ol;function s0(){return Ol||(Ol=1,vn.disjointUnion=Zm(),vn.reverse=Jm(),vn.subgraph=e0(),vn.toDirected=t0(),vn.toMixed=n0(),vn.toMulti=r0(),vn.toSimple=i0(),vn.toUndirected=a0(),vn.union=o0()),vn}var ui=s0();const ja=document;class Sh{constructor(e){this.graphManager=e,this.pannel=ja.querySelector("#floating-panel .body-info")}addHeader(e){const t=ja.createElement("h4");t.textContent=e,this.pannel.appendChild(t),console.log(e)}addInfo(e){const t=ja.createElement("div");t.insertAdjacentHTML("beforeend",e),this.pannel.appendChild(t),console.log(e)}addLine(){const e=ja.createElement("hr");this.pannel.appendChild(e),this.pannel.scrollTop=this.pannel.scrollHeight}addNEFGInfo(e){if(e.desc&&Object.keys(e.desc).length!=0||e.weight){this.addHeader(`${e.label}:`);for(let t in e.desc)this.addInfo(`${t}: ${e.desc[t]}`);e.weight&&this.addInfo(`weight: ${e.weight}`),this.addLine()}}allNodeInfo(){for(let e of this.graphManager.graph.getSelectedNodes()){const t=this.graphManager.graph.getNodeAttributes(e);this.addNEFGInfo(t)}}allEdgeInfo(){for(let e of this.graphManager.graph.getSelectedEdges()){const t=this.graphManager.graph.getEdgeAttributes(e);this.addNEFGInfo(t)}}allFaceInfo(){for(let e of this.graphManager.graph.getSelectedFaces()){const t=this.graphManager.graph.getFaceAttributes(e);this.addNEFGInfo(t)}}allGraphInfo(){for(let e of this.graphManager.graphs.all.filter(t=>t.getAttribute("selected"))){const t=e.getAttributes();this.addNEFGInfo(t)}}getComponent(e){const t=this.graphManager.graph,n=La.connectedComponents(t);for(let i of n)if(i.includes(String(e)))return i;return null}basicInfo(){const e=this.graphManager.graph;this.addHeader("Basic Informattion"),this.addInfo(`|V|: ${e.order}`),this.addInfo(`|E|: ${e.size}`),this.addInfo(`|F|: ${e._faces.size}`);const t=e.someEdge((n,i)=>i.weight);this.addInfo(t?`Type: ${e.type}, weighted`:`Type: ${e.type}`),this.addLine()}degreeSequesnce(){this.addHeader("Degree Sequence");const e=this.graphManager.graph,n=`(${e.mapNodes((i,a)=>e.degree(i)).join(", ")})`;this.addInfo(n),this.addLine()}countComponents(){const e=this.graphManager.graph;this.addHeader("Connected Components");const t=La.countConnectedComponents(e);this.addInfo(`Count: ${t}`),La.forEachConnectedComponent(e,n=>{this.addInfo(n.map(i=>e.getNodeAttribute(i,"label")).join(", "))}),this.addLine()}neighbors(){const e=this.graphManager.graph;this.addHeader("Neighbors");const t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[n]=t,i=e.neighbors(n);this.addInfo(i.map(a=>e.getNodeAttribute(a,"label")).join(", ")),this.addLine()}shortestPath(){this.addHeader("Shortest Path");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==2){this.addInfo("Select two nodes"),this.addLine();return}const[n,i]=t,a=Uc.bidirectional(e,n,i);a?(this.addInfo(a.map(s=>e.getNodeAttribute(s,"label")).join(" -> ")),this.addLine(),e.selectPath(a)):(this.addInfo("They are not connected"),this.addLine())}density(){this.addHeader("Density");const e=this.graphManager.graph,t=tl.density(e);this.addInfo(t),this.addLine()}diameter(){this.addHeader("Diameter");const e=this.graphManager.graph,t=tl.diameter(e);this.addInfo(t),this.addLine()}eccentricity(){this.addHeader("Eccentricity");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[n]=t,i=Um(e,n);this.addInfo(i),this.addLine()}simmelianStrength(){this.addHeader("Simmelian strength");const e=this.graphManager.graph,t=bm.simmelianStrength(e);for(const n in t){const{source:i,target:a}=e.getEdgeAttributes(n);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[n]}`)}this.addLine()}betweennessCentrality(){this.addHeader("Betweenness centrality");const e=this.graphManager.graph,t=Mm(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}closenessCentrality(){this.addHeader("Closeness centrality");const e=this.graphManager.graph,t=_m(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}degreeCentrality(){this.addHeader("Degree centrality");const e=this.graphManager.graph,t=Am.degreeCentrality(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}eigenvectorCentrality(){this.addHeader("Eigenvector centrality");const e=this.graphManager.graph,t=Om(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}pagerank(){this.addHeader("Pagerank");const e=this.graphManager.graph,t=Hm(e);for(const n in t)this.addInfo(`${e.getNodeAttribute(n,"label")}: ${t[n]}`);this.addLine()}edgeUniformity(){this.addHeader("Edge Uniformity");const e=this.graphManager.graph,t=qm.edgeUniformity(e);this.addInfo(t),this.addLine()}neighborhoodPreservation(){this.addHeader("Neighborhood preservation");const e=this.graphManager.graph,t=Xm(e);this.addInfo(t),this.addLine()}stress(){this.addHeader("Stress");const e=this.graphManager.graph,t=jm(e);this.addInfo(t),this.addLine()}disparity(){this.addHeader("Disparity");const e=this.graphManager.graph,t=Qm(e);for(const n in t){const{source:i,target:a}=e.getEdgeAttributes(n);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[n]}`)}this.addLine()}_isCycle(e){if(e.order==e.size&&La.countConnectedComponents(e)==1){const t=e.edges()[0],{source:n,target:i}=e.getEdgeAttributes(t);return e.dropEdge(t),Uc.bidirectional(e,i,n)}return!1}liesOnCycle(){this.addHeader("Lies on cycle");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length<3){this.addInfo("Select at least 3 nodes"),this.addLine();return}const n=ui.subgraph(e,t);this.addInfo(!!this._isCycle(n)),this.addLine()}}var Ba={},Ds,Tl;function u0(){if(Tl)return Ds;Tl=1;var r=wn(),e=Tu();return Ds=function(n,i,a){if(!r(n))throw new Error("graphology-generators/community/caveman: invalid Graph constructor.");var s=i*a,d=e(n,s);if(a<2)return d;var f,h,y;for(f=0;f<s;f+=a)for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)d.addEdge(h,y);return d},Ds}var Is,Rl;function c0(){if(Rl)return Is;Rl=1;var r=wn(),e=Tu();return Is=function(n,i,a){if(!r(n))throw new Error("graphology-generators/community/connected-caveman: invalid Graph constructor.");var s=i*a,d=e(n,s);if(a<2)return d;var f,h,y;for(f=0;f<s;f+=a){for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)(h!==f||h!==y-1)&&d.addEdge(h,y);f>0&&d.addEdge(f,(f-1)%s)}return d.addEdge(0,s-1),d},Is}var Ll;function l0(){return Ll||(Ll=1,Ba.caveman=u0(),Ba.connectedCaveman=c0()),Ba}var zl=l0(),Ki={},Ms,$l;function d0(){if($l)return Ms;$l=1;var r=wn();return Ms=function(e,t){if(!r(e))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");t=t||{};var n="clusterDensity"in t?t.clusterDensity:.5,i=t.rng||Math.random,a=t.order,s=t.size,d=t.clusters;if(typeof n!="number"||n>1||n<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof i!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof a!="number"||a<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof s!="number"||s<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof d!="number"||d<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var f=new e;if(!a)return f;var h=new Array(d),y,b,w;for(w=0;w<d;w++)h[w]=[];for(w=0;w<a;w++)y=i()*d|0,f.addNode(w,{cluster:y}),h[y].push(w);if(!s)return f;var E,I,D;for(w=0;w<s;w++){if(i()<1-n){E=i()*a|0;do I=i()*a|0;while(E===I)}else{if(y=i()*d|0,b=h[y],D=b.length,!D||D<2)continue;E=b[i()*D|0];do I=b[i()*D|0];while(E===I)}f.multi?f.addEdge(E,I):f.mergeEdge(E,I)}return f},Ms}var Ps,Gl;function h0(){if(Gl)return Ps;Gl=1;var r=wn(),e=vh().abstractDensity;function t(i,a){if(!r(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,d=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(d=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var y,b;for(y=0;y<s;y++)h.addNode(y);if(d<=0)return h;for(y=0;y<s;y++)for(b=y+1;b<s;b++)h.type!=="directed"&&f()<d&&h.addUndirectedEdge(y,b),h.type!=="undirected"&&(f()<d&&h.addDirectedEdge(y,b),f()<d&&h.addDirectedEdge(b,y));return h}function n(i,a){if(!r(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,d=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(d=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof d!="number"||d<0||d>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var y=0;y<s;y++)h.addNode(y);if(d<=0)return h;var b=-1,w=Math.log(1-d),E,I;if(h.type!=="undirected")for(I=0;I<s;){for(E=Math.log(1-f()),b+=1+(E/w|0),I===b&&b++;I<s&&s<=b;)b-=s,I++,I===b&&b++;I<s&&h.addDirectedEdge(I,b)}if(b=-1,h.type!=="directed")for(I=1;I<s;){for(E=Math.log(1-f()),b+=1+(E/w|0);b>=I&&I<s;)b-=I,I++;I<s&&h.addUndirectedEdge(I,b)}return h}return t.sparse=n,Ps=t,Ps}var Ns,ql;function f0(){if(ql)return Ns;ql=1;var r=wn();return Ns=function(t,n){if(!r(t))throw new Error("graphology-generators/random/girvan-newman: invalid Graph constructor.");var i=n.zOut,a=n.rng||Math.random;if(typeof i!="number")throw new Error("graphology-generators/random/girvan-newman: invalid `zOut`. Should be a number.");if(typeof a!="function")throw new Error("graphology-generators/random/girvan-newman: invalid `rng`. Should be a function.");var s=i/96,d=(16-s*96)/31,f=new t,h,y,b;for(y=0;y<128;y++)f.addNode(y);for(y=0;y<128;y++)for(b=y+1;b<128;b++)h=a(),y%4===b%4?h<d&&f.addEdge(y,b):h<s&&f.addEdge(y,b);return f},Ns}var Fl;function p0(){return Fl||(Fl=1,Ki.clusters=d0(),Ki.erdosRenyi=h0(),Ki.girvanNewman=f0()),Ki}var Os=p0(),Pn={},Ts,jl;function g0(){return jl||(jl=1,Ts=function r(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var n,i,a;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(!r(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!r(i[1],t.get(i[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[i]))return!1;for(i=n;i--!==0;){var s=a[i];if(!r(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}),Ts}var Bl;function y0(){if(Bl)return Pn;Bl=1;var r=g0(),e=Symbol("size");function t(y,b){var w=y.length,E=b.length;if(w!==E)return!1;var I,D,N,O,P=new Set;e:for(N=0;N<w;N++){for(I=y[N],O=0;O<E;O++)if(!P.has(O)&&(D=b[O],r(I,D))){P.add(O);continue e}return!1}return!0}function n(y,b){if(y[e]!==b[e])return!1;for(var w in y)if(!t(y[w],b[w]))return!1;return!0}function i(y,b){var w={},E;return y.forEachOutEdge(b,function(I,D,N,O){E=w[O]||0,E++,w[O]=E}),w}function a(y,b){var w={},E;return y.forEachUndirectedEdge(b,function(I,D,N,O){O=b===N?O:N,!(b>O)&&(E=w[O]||0,E++,w[O]=E)}),w}function s(y,b){var w={};w[e]=0;var E;return y.forEachOutEdge(b,function(I,D,N,O){E=w[O],E||(E=[],w[e]+=1,w[O]=E),E.push(D)}),w}function d(y,b){var w={};w[e]=0;var E;return y.forEachUndirectedEdge(b,function(I,D,N,O){O=b===N?O:N,!(b>O)&&(E=w[O],E||(E=[],w[e]+=1,w[O]=E),E.push(D))}),w}function f(y,b,w){return b===w?!0:b.order!==w.order?!1:b.everyNode(function(E,I){return w.hasNode(E)?y?r(I,w.getNodeAttributes(E)):!0:!1})}function h(y,b,w,E){if(w===E)return!0;if(b){if(w.type==="directed"&&E.type==="undirected"||w.type==="undirected"&&E.type==="directed")return!1}else if(w.type!==E.type||w.allowSelfLoops!==E.allowSelfLoops||w.multi!==E.multi)return!1;if(w.directedSize!==E.directedSize||w.undirectedSize!==E.undirectedSize||!f(y,w,E))return!1;var I=!1,D=!1;if(!w.multi&&!E.multi){if(I=w.everyDirectedEdge(function(P,z,C,L){return E.hasDirectedEdge(C,L)?y?r(w.getDirectedEdgeAttributes(C,L),E.getDirectedEdgeAttributes(C,L)):!0:!1}),!I||(D=w.everyUndirectedEdge(function(P,z,C,L){return E.hasUndirectedEdge(C,L)?y?r(w.getUndirectedEdgeAttributes(C,L),E.getUndirectedEdgeAttributes(C,L)):!0:!1}),!D))return!1}else{var N=y?s:i,O=y?n:r;if(I=w.everyNode(function(P){var z=N(w,P),C=N(E,P);return O(z,C)}),!I||(N=y?d:a,D=w.everyNode(function(P){var z=N(w,P),C=N(E,P);return O(z,C)}),!D))return!1}return!0}return Pn.isGraph=Ue(),Pn.isGraphConstructor=wn(),Pn.haveSameNodes=f.bind(null,!1),Pn.haveSameNodesDeep=f.bind(null,!0),Pn.areSameGraphs=h.bind(null,!1,!1),Pn.areSameGraphsDeep=h.bind(null,!0,!1),Pn.haveSameEdges=h.bind(null,!1,!0),Pn.haveSameEdgesDeep=h.bind(null,!0,!0),Pn}var Rs,Ul;function v0(){return Ul||(Ul=1,Rs=y0()),Rs}var Fu=v0(),Kl=["0111111110111100010101000000000100","1011000100000100010101000000001000","1101000111000100000000000001100010","1110000100001100000000000000000000","1000001000100000000000000000000000","1000001000100000100000000000000000","1000110000000000100000000000000000","1111000000000000000000000000000000","1010000000000000000000000000001011","0010000000000000000000000000000001","1000110000000000000000000000000000","1000000000000000000000000000000000","1001000000000000000000000000000000","1111000000000000000000000000000001","0000000000000000000000000000000011","0000000000000000000000000000000011","0000011000000000000000000000000000","1100000000000000000000000000000000","0000000000000000000000000000000011","1100000000000000000000000000000001","0000000000000000000000000000000011","1100000000000000000000000000000000","0000000000000000000000000000000011","0000000000000000000000000101010011","0000000000000000000000000101000100","0000000000000000000000011000000100","0000000000000000000000000000010001","0010000000000000000000011000000001","0010000000000000000000000000000101","0000000000000000000000010010000011","0100000010000000000000000000000011","1000000000000000000000001100100011","0010000010000011001010110000011101","0000000011000111001110110011111110"],m0=new Set([0,1,2,3,4,5,6,7,8,10,11,12,13,16,17,19,21]);function b0(r,e={}){if(!Fu.isGraphConstructor(r))throw new Error("graphology-generators/social/karate: invalid Graph constructor.");for(var t=new r(e),n,i=0;i<34;i++)n=m0.has(i)?"Mr. Hi":"Officer",t.addNode(i,{club:n});var a,s,d,f,h,y;for(d=0,h=Kl.length;d<h;d++)for(a=Kl[d].split(""),f=d+1,y=a.length;f<y;f++)s=+a[f],s&&t.addEdgeWithKey(d+"->"+f,d,f);return t}var Ls=[[0,1],[2,3],[2,4],[2,5],[1,5],[1,6],[1,7],[1,8],[1,9],[9,10],[3,4],[3,11],[4,6],[4,11],[6,7],[7,12],[8,13],[8,12],[11,12],[12,14]];function w0(r,e={}){if(!Fu.isGraphConstructor(r))throw new Error("graphology-generators/social/florentine-families: invalid Graph constructor.");var t=new r(e),n,i;for(n=0,i=Ls.length;n<i;n++)t.mergeEdge(Ls[n][0],Ls[n][1]);return t}var Jt={},zs,Wl;function x0(){if(Wl)return zs;Wl=1;var r=Ue();return zs=function(t){if(!r(t))throw new Error("graphology-utils/infer-multi: expecting a valid graphology instance.");if(!t.multi||t.order===0||t.size<2)return!1;var n=!1,i,a,s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,b,w,E,I){if(!n){if(I&&f>h&&(d=h,h=f,f=d),f===i&&h===a&&I===s){n=!0;return}i=f,a=h,s=I}}),n},zs}var $s,Hl;function E0(){return Hl||(Hl=1,$s=function(e,t){if(t.length!==0){var n,i,a,s,d;for(a=0,d=t.length;a<d;a++)for(n=t[a],s=a+1;s<d;s++)i=t[s],e.mergeEdge(n,i)}}),$s}var Gs,Yl;function _0(){return Yl||(Yl=1,Gs=function(e,t){if(t.length!==0){var n,i,a,s;if(e.mergeNode(t[0]),t.length!==1){for(a=1,s=t.length;a<s;a++)n=t[a-1],i=t[a],e.mergeEdge(n,i);e.mergeEdge(i,t[0])}}}),Gs}var qs,Xl;function S0(){return Xl||(Xl=1,qs=function(e,t){if(t.length!==0){var n,i,a,s;for(e.mergeNode(t[0]),a=1,s=t.length;a<s;a++)n=t[a-1],i=t[a],e.mergeEdge(n,i)}}),qs}var Fs,Vl;function A0(){return Vl||(Vl=1,Fs=function(e,t){if(t.length!==0){var n,i,a,s=t[0];for(e.mergeNode(s),i=1,a=t.length;i<a;i++)n=t[i],e.mergeEdge(s,n)}}),Fs}var js,Ql;function k0(){if(Ql)return js;Ql=1;var r=Hn().copyEdge;return js=function(t,n,i){typeof n>"u"&&(n={}),typeof i>"u"&&(i={});var a=t.nullCopy();t.forEachNode(function(f,h){var y=n[f];typeof y>"u"&&(y=f),a.addNode(y,h)});var s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,b,w,E,I){f!==s&&(s=f,d=n[f],typeof d>"u"&&(d=f));var D=n[h];typeof D>"u"&&(D=h);var N=i[w];typeof N>"u"&&(N=w),r(a,I,N,d,D,E)}),a},js}var Bs,Zl;function C0(){if(Zl)return Bs;Zl=1;var r=Hn().copyEdge;return Bs=function(t,n,i){var a=t.nullCopy();t.forEachNode(function(f,h){var y=n?n(f,h):f;a.addNode(y,h)});var s,d;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,b,w,E,I){f!==s&&(s=f,d=n?n(f,y):f);var D=n?n(h,b):h,N=i?i(w,E,f,h,y,b,I):w;r(a,I,N,d,D,E)}),a},Bs}var Jl;function D0(){return Jl||(Jl=1,Jt.inferMulti=x0(),Jt.inferType=qu(),Jt.isGraph=Ue(),Jt.isGraphConstructor=wn(),Jt.mergeClique=E0(),Jt.mergeCycle=_0(),Jt.mergePath=S0(),Jt.mergeStar=A0(),Jt.renameGraphKeys=k0(),Jt.updateGraphKeys=C0()),Jt}var Us,ed;function I0(){return ed||(ed=1,Us=D0()),Us}var M0=I0(),td=[[0,1,2,3,4],[1,0,5,6],[2,0,3,4],[3,0,1,2,5,4,6],[5,1,3,6],[4,0,2,3,6,7],[6,1,3,5,4,7],[7,4,6,8],[8,7,9],[9,8]];function P0(r,e={}){if(!Fu.isGraphConstructor(r))throw new Error("invalid Graph constructor.");var t=new r(e),n,i;for(n=0,i=td.length;n<i;n++)M0.mergeStar(t,td[n]);return t}const N0={stars:[{id:0,label:"Hamal",ra:"02 08 34.7",dec:"23 34 50.5",magnitude:2.17},{id:1,label:"Sheratan",ra:"01 56 01.0",dec:"20 55 48.5",magnitude:2.7},{id:2,label:"Gamma",ra:"01 54 53.8",dec:"19 24 58.7",magnitude:3.84},{id:3,label:"41 Arietis",ra:"02 51 27.2",dec:"27 21 50.6",magnitude:3.58}],edges:[[0,1],[1,2],[0,3]]},O0={stars:[{id:0,label:"Aldebaran",ra:"04 37 21.6",dec:"16 33 34.5",magnitude:1},{id:1,label:"Elnath",ra:"05 26 17.5",dec:"28 36 27.0",magnitude:1.65},{id:2,label:"Zeta",ra:"05 37 38.7",dec:"21 08 33.0",magnitude:2.97},{id:3,label:"Theta2",ra:"04 30 05.6",dec:"15 55 34.7",magnitude:3.45},{id:4,label:"Lambda",ra:"04 02 04.1",dec:"12 33 38.8",magnitude:3.38},{id:5,label:"Omicron",ra:"03 26 09.5",dec:"09 06 59.4",magnitude:3.77},{id:6,label:"Gamma",ra:"04 21 13.2",dec:"15 41 16.8",magnitude:3.8},{id:7,label:"Delta",ra:"04 24 22.8",dec:"17 36 04.5",magnitude:3.92},{id:8,label:"Delta3",ra:"04 26 56.4",dec:"17 59 06.4",magnitude:4.31},{id:9,label:"Ain",ra:"04 30 04.9",dec:"19 14 09.9",magnitude:3.69},{id:10,label:"Tau",ra:"04 43 45.1",dec:"23 00 19.2",magnitude:4.22},{id:11,label:"Atlas",ra:"03 50 39.0",dec:"24 07 49.6",magnitude:4.22}],edges:[[0,3],[0,2],[6,4],[4,5],[3,6],[6,7],[8,7],[8,9],[9,0],[9,10],[1,10],[11,7]]},T0={stars:[{id:0,label:"Castor",ra:"07 36 12.8",dec:"31 50 01.2",magnitude:1.58},{id:1,label:"Pollux",ra:"07 46 52.0",dec:"27 57 57.2",magnitude:1.29},{id:2,label:"Kappa",ra:"07 45 58.6",dec:"24 20 15.9",magnitude:3.72},{id:3,label:"Upsilon",ra:"07 37 29.0",dec:"26 50 24.6",magnitude:4.16},{id:4,label:"Iota",ra:"07 27 17.9",dec:"27 44 54.9",magnitude:3.94},{id:5,label:"Tau",ra:"07 12 44.9",dec:"30 12 16.7",magnitude:4.53},{id:6,label:"Theta",ra:"06 54 27.2",dec:"33 55 55.1",magnitude:3.63},{id:7,label:"Wasat",ra:"07 21 38.1",dec:"21 56 09.7",magnitude:3.59},{id:8,label:"Mekbuda",ra:"07 05 36.5",dec:"20 32 00.0",magnitude:4.16},{id:9,label:"Alhena",ra:"06 39 10.1",dec:"16 22 38.5",magnitude:1.92},{id:10,label:"Lambda",ra:"07 19 32.8",dec:"16 29 40.3",magnitude:3.61},{id:11,label:"Xi",ra:"06 46 42.4",dec:"12 52 04.2",magnitude:3.44},{id:12,label:"Mebsuta",ra:"06 45 29.1",dec:"25 06 23.7",magnitude:3.19},{id:13,label:"Nu",ra:"06 30 27.6",dec:"20 11 46.3",magnitude:4.09},{id:14,label:"Tejat",ra:"06 24 29.2",dec:"22 30 03.1",magnitude:2.91},{id:15,label:"Propus",ra:"06 16 24.0",dec:"22 29 58.9",magnitude:3.28},{id:16,label:"1",ra:"06 05 39.1",dec:"23 15 43.8",magnitude:4.31}],edges:[[0,5],[1,3],[3,2],[3,4],[4,5],[5,6],[3,7],[7,8],[7,10],[8,9],[10,11],[5,12],[12,13],[12,14],[14,15],[15,16]]},R0={stars:[{id:0,label:"Acubens",ra:"08 59 52.7",dec:"11 45 32.4",magnitude:4.28},{id:1,label:"Beta",ra:"08 17 53.5",dec:"09 06 24.1",magnitude:3.66},{id:2,label:"Asellus Australis",ra:"08 46 07.7",dec:"18 03 39.9",magnitude:4.09},{id:3,label:"Asellus Borealis",ra:"08 44 45.4",dec:"21 22 39.2",magnitude:4.66},{id:4,label:"Chi",ra:"08 21 36.4",dec:"27 08 10.9",magnitude:5.22},{id:5,label:"Iota",ra:"08 48 14.1",dec:"28 40 04.4",magnitude:4.19}],edges:[[0,2],[1,2],[2,3],[3,4],[3,5]]},L0={stars:[{id:0,label:"Regulus",ra:"10 09 44.0",dec:"11 50 33.1",magnitude:1.32},{id:1,label:"Algieba",ra:"10 21 22.9",dec:"19 42 46.3",magnitude:2.16},{id:2,label:"Zosma",ra:"11 15 28.3",dec:"20 23 02.6",magnitude:2.58},{id:3,label:"Adhafera",ra:"10 18 06.7",dec:"23 17 27.1",magnitude:3.5},{id:4,label:"Denebola",ra:"11 50 22.2",dec:"14 25 44.7",magnitude:2.16},{id:5,label:"Chertan",ra:"11 15 35.1",dec:"15 17 24.1",magnitude:3.33},{id:6,label:"Eta",ra:"10 08 43.5",dec:"16 38 18.8",magnitude:3.5},{id:7,label:"Rasalas",ra:"09 54 12.9",dec:"25 53 16.1",magnitude:4.03},{id:8,label:"Epsilon",ra:"09 47 18.0",dec:"23 39 27.6",magnitude:3.11}],edges:[[1,3],[2,5],[5,4],[1,6],[2,1],[6,0],[0,5],[3,7],[7,8],[2,4]]},z0={stars:[{id:0,label:"Nu",ra:"11 47 10.7",dec:"06 23 09.0",magnitude:4.13},{id:1,label:"Zaniah",ra:"12 21 13.2",dec:"-00 48 34.3",magnitude:3.89},{id:2,label:"Porrima",ra:"12 42 57.7",dec:"-01 35 23.7",magnitude:2.81},{id:3,label:"Spica",ra:"13 26 32.8",dec:"-11 17 43.6",magnitude:.89},{id:4,label:"Kappa",ra:"14 14 15.9",dec:"-10 23 36.5",magnitude:4.31},{id:5,label:"Syrma",ra:"14 17 21.6",dec:"-06 07 24.0",magnitude:4.16},{id:6,label:"Mu",ra:"14 44 24.8",dec:"-05 46 13.4",magnitude:3.95},{id:7,label:"109",ra:"14 47 32.8",dec:"01 47 01.4",magnitude:3.73},{id:8,label:"Tau",ra:"14 02 57.3",dec:"01 25 10.9",magnitude:4.25},{id:9,label:"Heze",ra:"13 36 00.2",dec:"-00 43 38.6",magnitude:3.41},{id:10,label:"Delta",ra:"12 56 53.9",dec:"03 15 28.1",magnitude:3.44},{id:11,label:"Vindemiatrix",ra:"13 03 27.4",dec:"10 49 15.5",magnitude:2.98}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[7,8],[8,9],[9,10],[10,11],[2,10],[3,9]]},$0={stars:[{id:0,label:"Zubenelgenubi II",ra:"14 52 17.9",dec:"-16 08 54.7",magnitude:2.78},{id:1,label:"Sigma",ra:"15 05 34.3",dec:"-25 22 56.3",magnitude:3.3},{id:2,label:"Zubeneschamali",ra:"15 18 23.1",dec:"-09 28 41.6",magnitude:2.56},{id:3,label:"Gamma",ra:"15 36 57.5",dec:"-14 52 31.6",magnitude:4.06},{id:4,label:"Theta",ra:"15 55 16.9",dec:"-16 48 17.5",magnitude:4.28},{id:5,label:"Upsilon",ra:"15 38 34.7",dec:"-28 13 09.8",magnitude:3.73}],edges:[[0,1],[0,2],[2,3],[3,4],[2,1],[1,5]]},G0={stars:[{id:0,label:"Acrab",ra:"16 06 55.3",dec:"-19 52 32.6",magnitude:2.59},{id:1,label:"Dschubba",ra:"16 01 50.6",dec:"-22 41 40.4",magnitude:2.25},{id:2,label:"Pi",ra:"16 00 23.8",dec:"-26 11 14.7",magnitude:2.81},{id:3,label:"Antares",ra:"16 30 58.3",dec:"-26 29 18.3",magnitude:.97},{id:4,label:"Tau",ra:"16 37 28.1",dec:"-28 16 06.8",magnitude:2.73},{id:5,label:"Epsilon",ra:"16 51 48.9",dec:"-34 20 18.8",magnitude:2.45},{id:6,label:"Mu1",ra:"16 53 35.8",dec:"-38 05 23.0",magnitude:2.92},{id:7,label:"Zeta2",ra:"16 56 22.6",dec:"-42 24 11.1",magnitude:3.75},{id:8,label:"Eta",ra:"17 13 58.6",dec:"-43 16 14.8",magnitude:3.41},{id:9,label:"Sargas",ra:"17 39 08.6",dec:"-43 00 43.4",magnitude:1.92},{id:10,label:"Iota1",ra:"17 49 21.5",dec:"-40 08 06.6",magnitude:3.09},{id:11,label:"Kappa",ra:"17 44 14.6",dec:"-39 02 29.6",magnitude:2.31},{id:12,label:"Shaula",ra:"17 35 19.9",dec:"-37 07 15.9",magnitude:1.52},{id:13,label:"Lesath",ra:"17 32 29.4",dec:"-37 18 53.3",magnitude:2.59}],edges:[[0,3],[1,3],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12]]},q0={stars:[{id:0,label:"51",ra:"17 22 58.0",dec:"-23 58 57.0",magnitude:4.78},{id:1,label:"Sabik",ra:"17 11 50.2",dec:"-15 45 26.7",magnitude:2.44},{id:2,label:"Zeta",ra:"16 38 33.8",dec:"-10 37 12.4",magnitude:2.56},{id:3,label:"Yed",ra:"16 19 40.3",dec:"-04 45 23.3",magnitude:3.38},{id:4,label:"Kappa",ra:"16 58 52.5",dec:"09 19 55.5",magnitude:3.36},{id:5,label:"Resalhague",ra:"17 36 06.9",dec:"12 32 15.6",magnitude:2.13},{id:6,label:"Cabalrai",ra:"17 44 43.7",dec:"04 33 12.4",magnitude:2.92},{id:7,label:"Gaia DR2",ra:"15 50 57.4",dec:"-03 30 35.9",magnitude:3.33},{id:8,label:"Epsilon",ra:"15 52 05.6",dec:"04 23 55.1",magnitude:3.75},{id:9,label:"Unukalhai",ra:"15 45 31.8",dec:"06 20 34.7",magnitude:2.8},{id:10,label:"Delta A",ra:"15 36 01.6",dec:"10 27 03.7",magnitude:3.86},{id:11,label:"Beta",ra:"15 47 22.3",dec:"15 20 20.6",magnitude:3.67},{id:12,label:"Gamma",ra:"15 57 38.2",dec:"15 34 31.3",magnitude:3.94},{id:13,label:"Kappa",ra:"15 49 53.7",dec:"18 03 34.6",magnitude:4.19},{id:14,label:"Nu",ra:"17 22 15.5",dec:"-12 52 26.5",magnitude:4.34},{id:15,label:"Xi",ra:"17 39 02.5",dec:"-15 24 56.5",magnitude:3.59},{id:16,label:"Omicron",ra:"17 42 50.5",dec:"-12 53 25.2",magnitude:4.25},{id:17,label:"Eta",ra:"18 22 37.2",dec:"-02 53 41.5",magnitude:3.39},{id:18,label:"Alya",ra:"18 57 28.5",dec:"04 13 59.3",magnitude:4.66}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,1],[14,15],[15,16],[16,17],[17,18],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,11]]},F0={stars:[{id:0,label:"Beta2",ra:"19 25 02.3",dec:"-44 45 00.2",magnitude:4.34},{id:1,label:"Rukbat",ra:"19 25 37.9",dec:"-40 34 00.1",magnitude:3.92},{id:2,label:"Iota",ra:"19 56 59.7",dec:"-41 48 00.9",magnitude:4.25},{id:3,label:"Theta1",ra:"20 01 22.3",dec:"-35 12 25.3",magnitude:4.28},{id:4,label:"62",ra:"20 04 12.2",dec:"-27 38 22.1",magnitude:4.44},{id:5,label:"h2",ra:"19 38 14.3",dec:"-24 49 40.7",magnitude:4.56},{id:6,label:"Tau",ra:"19 08 30.9",dec:"-27 37 59.7",magnitude:3.47},{id:7,label:"Nunki",ra:"18 56 49.9",dec:"-26 15 54.9",magnitude:2},{id:8,label:"Xi2",ra:"18 59 14.2",dec:"-21 04 26.3",magnitude:3.69},{id:9,label:"Omicron",ra:"19 06 11.7",dec:"-21 42 17.7",magnitude:3.91},{id:10,label:"43",ra:"19 19 06.6",dec:"-18 54 31.3",magnitude:5.03},{id:11,label:"Rho1",ra:"19 23 08.0",dec:"-17 48 01.9",magnitude:3.98},{id:12,label:"Eta",ra:"18 19 20.5",dec:"-36 45 10.2",magnitude:3.14},{id:13,label:"Kaus Australis",ra:"18 25 51.1",dec:"-34 22 17.9",magnitude:1.8},{id:14,label:"Ascella",ra:"19 04 13.1",dec:"-29 50 36.0",magnitude:2.61},{id:15,label:"Phi",ra:"18 47 14.1",dec:"-26 57 52.7",magnitude:3.13},{id:16,label:"Kaus Media",ra:"18 22 36.8",dec:"-29 49 00.8",magnitude:2.86},{id:17,label:"Alnsal",ra:"18 07 26.2",dec:"-30 25 23.7",magnitude:3.13},{id:18,label:"3",ra:"17 49 09.4",dec:"-27 50 24.9",magnitude:4.66},{id:19,label:"Kaus Borealis",ra:"18 29 32.0",dec:"-25 24 28.0",magnitude:2.97},{id:20,label:"Mu",ra:"18 15 16.7",dec:"-21 03 09.9",magnitude:3.86},{id:21,label:"HD 180885",ra:"19 21 20.2",dec:"-35 22 27.8",magnitude:5.53},{id:22,label:"V4089",ra:"19 35 52.0",dec:"-39 58 43.5",magnitude:5.91}],edges:[[0,1],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[12,13],[16,17],[17,18],[19,20],[7,15],[6,14],[15,19],[16,19],[14,21],[5,21],[2,22],[1,21],[21,22],[13,16],[13,17],[15,14],[15,16]]},j0={stars:[{id:0,label:"Algedi",ra:"20 19 26.8",dec:"-12 28 05.0",magnitude:3.73},{id:1,label:"Dabih",ra:"20 22 25.3",dec:"-14 42 10.1",magnitude:3.2},{id:2,label:"Psi",ra:"20 47 34.8",dec:"-25 10 49.4",magnitude:4.22},{id:3,label:"Omega",ra:"20 53 18.9",dec:"-26 49 29.2",magnitude:4.22},{id:4,label:"Theta",ra:"21 07 21.2",dec:"-17 08 01.0",magnitude:4.06},{id:5,label:"Zeta",ra:"21 28 05.7",dec:"-22 18 09.6",magnitude:3.92},{id:6,label:"Iota",ra:"21 23 38.3",dec:"-16 43 41.4",magnitude:4.44},{id:7,label:"Nashira",ra:"21 41 28.5",dec:"-16 32 58.0",magnitude:3.77},{id:8,label:"Deneb",ra:"21 48 25.1",dec:"-16 00 50.3",magnitude:2.94},{id:9,label:"Nu",ra:"20 22 03.4",dec:"-12 40 51.8",magnitude:4.72},{id:10,label:"Sigma",ra:"20 20 50.5",dec:"-19 02 25.9",magnitude:5.41}],edges:[[0,1],[1,2],[3,4],[4,1],[4,5],[5,6],[4,6],[6,7],[7,8],[1,9],[1,10]]},B0={stars:[{id:0,label:"c2",ra:"23 10 46.4",dec:"-21 02 11.8",magnitude:3.84},{id:1,label:"Skat",ra:"22 55 58.3",dec:"-15 41 17.0",magnitude:3.28},{id:2,label:"Tua",ra:"22 50 54.6",dec:"-13 27 39.6",magnitude:4.13},{id:3,label:"Sigma",ra:"22 31 57.9",dec:"-10 33 01.7",magnitude:4.81},{id:4,label:"Ancha",ra:"22 18 09.0",dec:"-07 39 34.2",magnitude:4.31},{id:5,label:"Sadalmelik",ra:"22 07 03.9",dec:"-00 11 58.6",magnitude:3.09},{id:6,label:"Sadachbia",ra:"22 22 56.6",dec:"-01 15 44.7",magnitude:3.83},{id:7,label:"Zeta",ra:"22 30 06.8",dec:"00 06 25.3",magnitude:3.73},{id:8,label:"Eta",ra:"22 36 38.2",dec:"00 00 37.0",magnitude:4},{id:9,label:"Lambda",ra:"22 53 54.9",dec:"-07 26 50.0",magnitude:3.8},{id:10,label:"Psi1",ra:"23 17 11.7",dec:"-08 57 07.4",magnitude:4.41},{id:11,label:"b1",ra:"23 24 16.6",dec:"-19 57 51.0",magnitude:4.09},{id:12,label:"Iota",ra:"22 07 47.0",dec:"-13 44 55.3",magnitude:4.25},{id:13,label:"Sadalsuud",ra:"21 32 52.4",dec:"-05 27 43.9",magnitude:3.03},{id:14,label:"Albali",ra:"20 49 01.9",dec:"-09 24 18.4",magnitude:3.78}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[4,12],[13,14],[5,13]]},U0={stars:[{id:0,label:"Upsilon",ra:"25 20 50.0",dec:"27 23 43.0",magnitude:4.75},{id:1,label:"Sigma",ra:"25 04 10.7",dec:"31 56 17.7",magnitude:5.47},{id:2,label:"Phi",ra:"25 15 06.0",dec:"24 42 57.1",magnitude:4.81},{id:3,label:"Eta",ra:"25 32 49.0",dec:"15 28 27.7",magnitude:3.78},{id:4,label:"Omicron",ra:"25 46 42.6",dec:"09 16 58.9",magnitude:4.41},{id:5,label:"Alrescha",ra:"26 03 20.2",dec:"02 53 02.2",magnitude:3.81},{id:6,label:"Xi",ra:"25 54 50.8",dec:"03 18 37.5",magnitude:4.75},{id:7,label:"Nu",ra:"25 42 43.7",dec:"05 36 49.0",magnitude:4.56},{id:8,label:"Mu",ra:"25 31 29.4",dec:"06 16 19.8",magnitude:4.97},{id:9,label:"Epsilon",ra:"25 04 14.1",dec:"08 01 26.9",magnitude:4.41},{id:10,label:"Delta",ra:"24 49 58.4",dec:"07 43 13.8",magnitude:4.53},{id:11,label:"41",ra:"24 21 52.7",dec:"08 19 42.0",magnitude:5.53},{id:12,label:"Omega",ra:"24 00 35.3",dec:"07 00 03.0",magnitude:4.09},{id:13,label:"Iota",ra:"23 41 13.8",dec:"05 45 38.8",magnitude:4.22},{id:14,label:"Theta",ra:"23 29 13.8",dec:"06 30 54.9",magnitude:4.44},{id:15,label:"Gamma",ra:"23 18 27.4",dec:"03 25 04.4",magnitude:3.84},{id:16,label:"Kappa",ra:"23 28 12.5",dec:"01 23 29.7",magnitude:4.94},{id:17,label:"Lambda",ra:"23 43 18.9",dec:"01 55 00.3",magnitude:4.53}],edges:[[0,1],[1,2],[0,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,14],[14,15],[15,16],[16,17],[17,13]]},K0={aries:N0,taurus:O0,gemini:T0,cancer:R0,leo:L0,virgo:z0,libra:$0,scorpius:G0,ophiuchus:q0,sagittarius:F0,capricornus:j0,aquarius:B0,pisces:U0};class W0{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout}load(e){const t=K0[e.toLowerCase()];t?(this.graphManager.graph=V0(e,t.stars,t.edges,this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("rotate180")):console.warn(`Constellation "${e}" not found.`)}aries(){this.load("aries")}taurus(){this.load("taurus")}gemini(){this.load("gemini")}cancer(){this.load("cancer")}leo(){this.load("leo")}virgo(){this.load("virgo")}libra(){this.load("libra")}scorpius(){this.load("scorpius")}ophiuchus(){this.load("ophiuchus")}sagittarius(){this.load("sagittarius")}capricornus(){this.load("capricornus")}aquarius(){this.load("aquarius")}pisces(){this.load("pisces")}orion(){this.load("orion")}}function H0(r=3){return Math.pow(.8,r)}function Y0(r){const[e,t,n]=r.split(" ").map(parseFloat);return(e+t/60+n/3600)*15}function X0(r){const e=r.trim().startsWith("-")?-1:1,t=r.trim().replace("+","").replace("-","").split(" ").map(parseFloat),[n,i,a]=t;return e*(n+i/60+a/3600)}function V0(r,e,t,n){const i=new n;return e.forEach(a=>{const s=Y0(a.ra),d=X0(a.dec);i.addNode(a.id,{label:a.label,x:s,y:d,magnitude:a.magnitude,size:H0(a.magnitude),desc:{name:a.label,magnitude:a.magnitude,RA:Q0(a.ra),DEC:a.dec}})}),t.forEach(([a,s])=>{i.mergeEdge(a,s)}),i}function Q0(r){let[e=0,t=0,n=0]=r.split(" ").map(Number);n=n%60,t=t%60,e=e%24;const i=String(e).padStart(2,"0"),a=String(t).padStart(2,"0"),s=n.toFixed(1).padStart(4,"0");return[i,a,s].join(" ")}class Z0{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout,this.zodiac=new W0(e)}empty(e){this.graphManager.graph=Bn.empty(this.graphManager.graphClass[this.settings.type],+e),this.syncColor(),this.layout.applyLayout("circle")}complete(e){this.graphManager.graph=Bn.complete(this.graphManager.graphClass[this.settings.type],+e),this.syncColor(),this.layout.applyLayout("circle")}ladder(e){this.graphManager.graph=Bn.ladder(this.graphManager.graphClass[this.settings.type],+e),this.syncColor(),this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}completeBipartite(e,t){this.graphManager.graph=Bn.empty(this.graphManager.graphClass[this.settings.type],+e+ +t);for(let n=0;n<+e;n++)for(let i=+e;i<Number(e)+ +t;i++)this.graphManager.graph.addEdge(n,i);this.syncColor(),this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}cycle(e){this.graphManager.graph=Bn.path(this.graphManager.graphClass[this.settings.type],+e),this.graphManager.graph.addEdge(0,+e-1),this.syncColor(),this.layout.applyLayout("circle")}path(e){this.graphManager.graph=Bn.path(this.graphManager.graphClass[this.settings.type],+e),this.syncColor(),this.layout.applyLayout("oneLine")}caveman(e,t){this.graphManager.graph=zl.caveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.syncColor(),this.layout.applyLayout("circle")}connectedCaveman(e,t){this.graphManager.graph=zl.connectedCaveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.syncColor(),this.layout.applyLayout("circle")}clusters(e,t,n){this.graphManager.graph=Os.clusters(this.graphManager.graphClass[this.settings.type],{order:+e<2?2:+e,size:+t<2?2:+t,clusters:+n<2?2:+n}),this.syncColor(),this.layout.applyLayout("random")}erdosRenyi(e,t){this.graphManager.graph=Os.erdosRenyi(this.graphManager.graphClass[this.settings.type],{order:+e,probability:+t>1?1:+t}),this.syncColor(),this.layout.applyLayout("circle")}girvanNewman(e){this.graphManager.graph=Os.girvanNewman(this.graphManager.graphClass[this.settings.type],{zOut:4}),this.syncColor(),this.layout.applyLayout("circle")}krackhardtkite(){this.graphManager.graph=P0(this.graphManager.graphClass[this.settings.type]),this.syncColor(),this.layout.applyLayout("oneLine")}florentineFamilies(){this.graphManager.graph=w0(this.graphManager.graphClass[this.settings.type]),this.syncColor(),this.layout.applyLayout("circle")}karateClub(){this.graphManager.graph=b0(this.graphManager.graphClass[this.settings.type]),this.syncColor(),this.layout.applyLayout("circle")}syncColor(){this.graphManager.graph.updateEachNodeAttributes((e,t)=>({...t,color:this.settings.node_color,labelColor:this.settings.label_color,stroke:this.settings.stroke_color})),this.graphManager.graph.updateEachEdgeAttributes((e,t)=>({...t,color:this.settings.edge_color,labelColor:this.settings.label_color}))}}const nd=document;class J0{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.panel=nd.querySelector("widgets #graphs-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(n=>n.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph;this.index=e.split("-")[1];const n=t.getAttributes();if(this.selectLi(this.index),this.graphManager.metric.addNEFGInfo(n),this.graphManager.facePanel.updateFacePanel(),this.app.keyHandler.isCtrlHold()){let i=this.lis().map(a=>this.graphManager.graphs.all[a].nodes());i=new Set(i.flat()),this.graphManager.selectAllNode(i),this.graphManager.redraw({node:!0})}}selectLi(e){this.app.keyHandler.isCtrlHold()||(this.graphManager.graphs.index=this.index,this.deselectLis("graphs-panel")),this.graphManager.graph.updateAttribute("selected",n=>!0);const t=this.ul.querySelector(`#graphs-${e}`);t&&t.classList.toggle("select"),this.graphManager.redraw()}updateGraphsPanel(){this.ul.innerHTML="",this.graphManager.graphs.all.forEach((e,t)=>{e.getAttribute("id")===void 0&&e.setAttribute("id",t),e.getAttribute("selected")||e.setAttribute("selected",!1),e.getAttribute("label")||e.setAttribute("label",`graph ${t}`);const n=nd.createElement("li");n.id=`graphs-${e.getAttribute("id")}`,n.setAttribute("name","graphs"),n.textContent=e.getAttribute("label"),this.ul.appendChild(n)})}listeners(){this.panel.addEventListener("click",e=>{this.deselectLis(e.target.id)})}deselectLis(e){if(e==="graphs-panel"){this.lis("node").forEach(t=>t.classList.remove("select"));for(const t of this.graphManager.graphs.all)t.updateAttribute("selected",n=>!1)}}}const rd=document;class eb{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.settings=e.settings,this.panel=rd.querySelector("widgets #face-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners(),this.events()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(n=>n.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph,n=e.split("-")[1],i=t.getFaceAttributes(n);this.selectLi(n),this.graphManager.metric.addNEFGInfo(i);let a=this.lis().map(s=>t.getFaceAttribute(s,"nodes"));a=new Set(a.flat()),this.app.keyHandler.isCtrlHold()&&(this.graphManager.selectAllNode(a),this.graphManager.redraw({face:!0,node:!0}))}selectLi(e){this.app.keyHandler.isCtrlHold()||this.deselectLis(),this.graphManager.graph.selectFace(e);const t=this.ul.querySelector(`#face-${e}`);if(t&&t.classList.toggle("select"),this.settings.colorPicker){const n=this.graphManager.graph.getFaceAttribute(e,"color"),i=this.graphManager.graph.getFaceAttribute(e,"labelColor");this.app.colorPicker.setColor("face",n),this.app.colorPicker.setColor("label",i)}}updateFacePanel(){this.ul.innerHTML="";const e=this.graphManager.graph;let t=0;e.forEachFace((n,i)=>{t++,e.getFaceAttribute(n,"id")===void 0&&e.setFaceAttribute(n,"id",index),e.getFaceAttribute(n,"label")||e.setFaceAttribute(n,"label",`face ${t}`);const a=rd.createElement("li");a.id=`face-${n}`,a.setAttribute("name","faces"),a.setAttribute("key",n),a.textContent=e.getFaceAttribute(n,"label"),this.ul.appendChild(a)})}listeners(){this.panel.addEventListener("click",e=>{e.target.id=="face-panel"&&this.deselectLis()})}events(){this.eventBus.on("key:down",e=>{[...e.detail.key].join("")})}deselectLis(){this.lis("node").forEach(e=>e.classList.remove("select")),this.graphManager.deselectAll()}}var Xa={exports:{}},tb=Xa.exports,id;function nb(){return id||(id=1,function(r,e){(function(t,n){r.exports=n()})(tb,function(){var t=function(o,u){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,m){g.__proto__=m}||function(g,m){for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(g[_]=m[_])})(o,u)},n=function(){return(n=Object.assign||function(o){for(var u,g=1,m=arguments.length;g<m;g++)for(var _ in u=arguments[g])Object.prototype.hasOwnProperty.call(u,_)&&(o[_]=u[_]);return o}).apply(this,arguments)};function i(o,u,g){for(var m,_=0,A=u.length;_<A;_++)!m&&_ in u||((m=m||Array.prototype.slice.call(u,0,_))[_]=u[_]);return o.concat(m||Array.prototype.slice.call(u))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ty,s=Object.keys,d=Array.isArray;function f(o,u){return typeof u!="object"||s(u).forEach(function(g){o[g]=u[g]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function b(o,u){return y.call(o,u)}function w(o,u){typeof u=="function"&&(u=u(h(o))),(typeof Reflect>"u"?s:Reflect.ownKeys)(u).forEach(function(g){I(o,g,u[g])})}var E=Object.defineProperty;function I(o,u,g,m){E(o,u,f(g&&b(g,"get")&&typeof g.get=="function"?{get:g.get,set:g.set,configurable:!0}:{value:g,configurable:!0,writable:!0},m))}function D(o){return{from:function(u){return o.prototype=Object.create(u.prototype),I(o.prototype,"constructor",o),{extend:w.bind(null,o.prototype)}}}}var N=Object.getOwnPropertyDescriptor,O=[].slice;function P(o,u,g){return O.call(o,u,g)}function z(o,u){return u(o)}function C(o){if(!o)throw new Error("Assertion Failed")}function L(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function K(o,u){if(typeof u=="string"&&b(o,u))return o[u];if(!u)return o;if(typeof u!="string"){for(var g=[],m=0,_=u.length;m<_;++m){var A=K(o,u[m]);g.push(A)}return g}var R=u.indexOf(".");if(R!==-1){var F=o[u.substr(0,R)];return F==null?void 0:K(F,u.substr(R+1))}}function S(o,u,g){if(o&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof u!="string"&&"length"in u){C(typeof g!="string"&&"length"in g);for(var m=0,_=u.length;m<_;++m)S(o,u[m],g[m])}else{var A,R,F=u.indexOf(".");F!==-1?(A=u.substr(0,F),(R=u.substr(F+1))===""?g===void 0?d(o)&&!isNaN(parseInt(A))?o.splice(A,1):delete o[A]:o[A]=g:S(F=!(F=o[A])||!b(o,A)?o[A]={}:F,R,g)):g===void 0?d(o)&&!isNaN(parseInt(u))?o.splice(u,1):delete o[u]:o[u]=g}}function G(o){var u,g={};for(u in o)b(o,u)&&(g[u]=o[u]);return g}var q=[].concat;function j(o){return q.apply([],o)}var st="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(j([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(u){return u+o+"Array"})}))).filter(function(o){return a[o]}),Y=new Set(st.map(function(o){return a[o]})),te=null;function B(o){return te=new WeakMap,o=function u(g){if(!g||typeof g!="object")return g;var m=te.get(g);if(m)return m;if(d(g)){m=[],te.set(g,m);for(var _=0,A=g.length;_<A;++_)m.push(u(g[_]))}else if(Y.has(g.constructor))m=g;else{var R,F=h(g);for(R in m=F===Object.prototype?{}:Object.create(F),te.set(g,m),g)b(g,R)&&(m[R]=u(g[R]))}return m}(o),te=null,o}var me={}.toString;function ge(o){return me.call(o).slice(8,-1)}var V=typeof Symbol<"u"?Symbol.iterator:"@@iterator",M=typeof V=="symbol"?function(o){var u;return o!=null&&(u=o[V])&&u.apply(o)}:function(){return null};function J(o,u){return u=o.indexOf(u),0<=u&&o.splice(u,1),0<=u}var ne={};function de(o){var u,g,m,_;if(arguments.length===1){if(d(o))return o.slice();if(this===ne&&typeof o=="string")return[o];if(_=M(o)){for(g=[];!(m=_.next()).done;)g.push(m.value);return g}if(o==null)return[o];if(typeof(u=o.length)!="number")return[o];for(g=new Array(u);u--;)g[u]=o[u];return g}for(u=arguments.length,g=new Array(u);u--;)g[u]=arguments[u];return g}var oe=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Et=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],l=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Et),he={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ue(o,u){this.name=o,this.message=u}function ve(o,u){return o+". Errors: "+Object.keys(u).map(function(g){return u[g].toString()}).filter(function(g,m,_){return _.indexOf(g)===m}).join(`
`)}function _e(o,u,g,m){this.failures=u,this.failedKeys=m,this.successCount=g,this.message=ve(o,u)}function Me(o,u){this.name="BulkError",this.failures=Object.keys(u).map(function(g){return u[g]}),this.failuresByPos=u,this.message=ve(o,this.failures)}D(ue).from(Error).extend({toString:function(){return this.name+": "+this.message}}),D(_e).from(ue),D(Me).from(ue);var Oe=l.reduce(function(o,u){return o[u]=u+"Error",o},{}),qe=ue,ce=l.reduce(function(o,u){var g=u+"Error";function m(_,A){this.name=g,_?typeof _=="string"?(this.message="".concat(_).concat(A?`
 `+A:""),this.inner=A||null):typeof _=="object"&&(this.message="".concat(_.name," ").concat(_.message),this.inner=_):(this.message=he[u]||g,this.inner=null)}return D(m).from(qe),o[u]=m,o},{});ce.Syntax=SyntaxError,ce.Type=TypeError,ce.Range=RangeError;var Pe=Et.reduce(function(o,u){return o[u+"Error"]=ce[u],o},{}),Re=l.reduce(function(o,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(o[u+"Error"]=ce[u]),o},{});function ke(){}function Ke(o){return o}function Le(o,u){return o==null||o===Ke?u:function(g){return u(o(g))}}function xe(o,u){return function(){o.apply(this,arguments),u.apply(this,arguments)}}function fe(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);g!==void 0&&(arguments[0]=g);var m=this.onsuccess,_=this.onerror;this.onsuccess=null,this.onerror=null;var A=u.apply(this,arguments);return m&&(this.onsuccess=this.onsuccess?xe(m,this.onsuccess):m),_&&(this.onerror=this.onerror?xe(_,this.onerror):_),A!==void 0?A:g}}function vt(o,u){return o===ke?u:function(){o.apply(this,arguments);var g=this.onsuccess,m=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),g&&(this.onsuccess=this.onsuccess?xe(g,this.onsuccess):g),m&&(this.onerror=this.onerror?xe(m,this.onerror):m)}}function it(o,u){return o===ke?u:function(g){var m=o.apply(this,arguments);f(g,m);var _=this.onsuccess,A=this.onerror;return this.onsuccess=null,this.onerror=null,g=u.apply(this,arguments),_&&(this.onsuccess=this.onsuccess?xe(_,this.onsuccess):_),A&&(this.onerror=this.onerror?xe(A,this.onerror):A),m===void 0?g===void 0?void 0:g:f(m,g)}}function xt(o,u){return o===ke?u:function(){return u.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function at(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);if(g&&typeof g.then=="function"){for(var m=this,_=arguments.length,A=new Array(_);_--;)A[_]=arguments[_];return g.then(function(){return u.apply(m,A)})}return u.apply(this,arguments)}}Re.ModifyError=_e,Re.DexieError=ue,Re.BulkError=Me;var Ve=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ht(o){Ve=o}var ot={},gt=100,st=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,h(o),o];var u=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[u,h(u),o]}(),Et=st[0],l=st[1],st=st[2],l=l&&l.then,ut=Et&&Et.constructor,ft=!!st,rt=function(o,u){xn.push([o,u]),mt&&(queueMicrotask(oa),mt=!1)},_t=!0,mt=!0,Pt=[],an=[],Yn=Ke,Nt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},ze=Nt,xn=[],bt=0,St=[];function Se(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=ze;if(typeof o!="function"){if(o!==ot)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Xn(this,this._value))}this._state=null,this._value=null,++u.ref,function g(m,_){try{_(function(A){if(m._state===null){if(A===m)throw new TypeError("A promise cannot be resolved with itself.");var R=m._lib&&Qn();A&&typeof A.then=="function"?g(m,function(F,W){A instanceof Se?A._then(F,W):A.then(F,W)}):(m._state=!0,m._value=A,Vn(m)),R&&En()}},Xn.bind(null,m))}catch(A){Xn(m,A)}}(this,o)}var on={get:function(){var o=ze,u=Lr;function g(m,_){var A=this,R=!o.global&&(o!==ze||u!==Lr),F=R&&!$e(),W=new Se(function(X,Z){cr(A,new Ln(zr(m,o,R,F),zr(_,o,R,F),X,Z,o))});return this._consoleTask&&(W._consoleTask=this._consoleTask),W}return g.prototype=ot,g},set:function(o){I(this,"then",o&&o.prototype===ot?on:{get:function(){return o},set:on.set})}};function Ln(o,u,g,m,_){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof u=="function"?u:null,this.resolve=g,this.reject=m,this.psd=_}function Xn(o,u){var g,m;an.push(u),o._state===null&&(g=o._lib&&Qn(),u=Yn(u),o._state=!1,o._value=u,m=o,Pt.some(function(_){return _._value===m._value})||Pt.push(m),Vn(o),g&&En())}function Vn(o){var u=o._listeners;o._listeners=[];for(var g=0,m=u.length;g<m;++g)cr(o,u[g]);var _=o._PSD;--_.ref||_.finalize(),bt===0&&(++bt,rt(function(){--bt==0&&lr()},[]))}function cr(o,u){if(o._state!==null){var g=o._state?u.onFulfilled:u.onRejected;if(g===null)return(o._state?u.resolve:u.reject)(o._value);++u.psd.ref,++bt,rt(aa,[g,o,u])}else o._listeners.push(u)}function aa(o,u,g){try{var m,_=u._value;!u._state&&an.length&&(an=[]),m=Ve&&u._consoleTask?u._consoleTask.run(function(){return o(_)}):o(_),u._state||an.indexOf(_)!==-1||function(A){for(var R=Pt.length;R;)if(Pt[--R]._value===A._value)return Pt.splice(R,1)}(u),g.resolve(m)}catch(A){g.reject(A)}finally{--bt==0&&lr(),--g.psd.ref||g.psd.finalize()}}function oa(){Bt(Nt,function(){Qn()&&En()})}function Qn(){var o=_t;return mt=_t=!1,o}function En(){var o,u,g;do for(;0<xn.length;)for(o=xn,xn=[],g=o.length,u=0;u<g;++u){var m=o[u];m[0].apply(null,m[1])}while(0<xn.length);mt=_t=!0}function lr(){var o=Pt;Pt=[],o.forEach(function(m){m._PSD.onunhandled.call(null,m._value,m)});for(var u=St.slice(0),g=u.length;g;)u[--g]()}function Rr(o){return new Se(ot,!1,o)}function Je(o,u){var g=ze;return function(){var m=Qn(),_=ze;try{return _n(g,!0),o.apply(this,arguments)}catch(A){u&&u(A)}finally{_n(_,!1),m&&En()}}}w(Se.prototype,{then:on,_then:function(o,u){cr(this,new Ln(null,null,o,u,ze))},catch:function(o){if(arguments.length===1)return this.then(null,o);var u=o,g=arguments[1];return typeof u=="function"?this.then(null,function(m){return(m instanceof u?g:Rr)(m)}):this.then(null,function(m){return(m&&m.name===u?g:Rr)(m)})},finally:function(o){return this.then(function(u){return Se.resolve(o()).then(function(){return u})},function(u){return Se.resolve(o()).then(function(){return Rr(u)})})},timeout:function(o,u){var g=this;return o<1/0?new Se(function(m,_){var A=setTimeout(function(){return _(new ce.Timeout(u))},o);g.then(m,_).finally(clearTimeout.bind(null,A))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&I(Se.prototype,Symbol.toStringTag,"Dexie.Promise"),Nt.env=ua(),w(Se,{all:function(){var o=de.apply(null,arguments).map(dr);return new Se(function(u,g){o.length===0&&u([]);var m=o.length;o.forEach(function(_,A){return Se.resolve(_).then(function(R){o[A]=R,--m||u(o)},g)})})},resolve:function(o){return o instanceof Se?o:o&&typeof o.then=="function"?new Se(function(u,g){o.then(u,g)}):new Se(ot,!0,o)},reject:Rr,race:function(){var o=de.apply(null,arguments).map(dr);return new Se(function(u,g){o.map(function(m){return Se.resolve(m).then(u,g)})})},PSD:{get:function(){return ze},set:function(o){return ze=o}},totalEchoes:{get:function(){return Lr}},newPSD:un,usePSD:Bt,scheduler:{get:function(){return rt},set:function(o){rt=o}},rejectionMapper:{get:function(){return Yn},set:function(o){Yn=o}},follow:function(o,u){return new Se(function(g,m){return un(function(_,A){var R=ze;R.unhandleds=[],R.onunhandled=A,R.finalize=xe(function(){var F,W=this;F=function(){W.unhandleds.length===0?_():A(W.unhandleds[0])},St.push(function X(){F(),St.splice(St.indexOf(X),1)}),++bt,rt(function(){--bt==0&&lr()},[])},R.finalize),o()},u,g,m)})}}),ut&&(ut.allSettled&&I(Se,"allSettled",function(){var o=de.apply(null,arguments).map(dr);return new Se(function(u){o.length===0&&u([]);var g=o.length,m=new Array(g);o.forEach(function(_,A){return Se.resolve(_).then(function(R){return m[A]={status:"fulfilled",value:R}},function(R){return m[A]={status:"rejected",reason:R}}).then(function(){return--g||u(m)})})})}),ut.any&&typeof AggregateError<"u"&&I(Se,"any",function(){var o=de.apply(null,arguments).map(dr);return new Se(function(u,g){o.length===0&&g(new AggregateError([]));var m=o.length,_=new Array(m);o.forEach(function(A,R){return Se.resolve(A).then(function(F){return u(F)},function(F){_[R]=F,--m||g(new AggregateError(_))})})})}),ut.withResolvers&&(Se.withResolvers=ut.withResolvers));var ct={awaits:0,echoes:0,id:0},sn=0,Xt=[],qt=0,Lr=0,fo=0;function un(o,u,g,m){var _=ze,A=Object.create(_);return A.parent=_,A.ref=0,A.global=!1,A.id=++fo,Nt.env,A.env=ft?{Promise:Se,PromiseProp:{value:Se,configurable:!0,writable:!0},all:Se.all,race:Se.race,allSettled:Se.allSettled,any:Se.any,resolve:Se.resolve,reject:Se.reject}:{},u&&f(A,u),++_.ref,A.finalize=function(){--this.parent.ref||this.parent.finalize()},m=Bt(A,o,g,m),A.ref===0&&A.finalize(),m}function Ot(){return ct.id||(ct.id=++sn),++ct.awaits,ct.echoes+=gt,ct.id}function $e(){return!!ct.awaits&&(--ct.awaits==0&&(ct.id=0),ct.echoes=ct.awaits*gt,!0)}function dr(o){return ct.echoes&&o&&o.constructor===ut?(Ot(),o.then(function(u){return $e(),u},function(u){return $e(),et(u)})):o}function sa(){var o=Xt[Xt.length-1];Xt.pop(),_n(o,!1)}function _n(o,u){var g,m=ze;(u?!ct.echoes||qt++&&o===ze:!qt||--qt&&o===ze)||queueMicrotask(u?(function(_){++Lr,ct.echoes&&--ct.echoes!=0||(ct.echoes=ct.awaits=ct.id=0),Xt.push(ze),_n(_,!0)}).bind(null,o):sa),o!==ze&&(ze=o,m===Nt&&(Nt.env=ua()),ft&&(g=Nt.env.Promise,u=o.env,(m.global||o.global)&&(Object.defineProperty(a,"Promise",u.PromiseProp),g.all=u.all,g.race=u.race,g.resolve=u.resolve,g.reject=u.reject,u.allSettled&&(g.allSettled=u.allSettled),u.any&&(g.any=u.any))))}function ua(){var o=a.Promise;return ft?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Bt(o,u,g,m,_){var A=ze;try{return _n(o,!0),u(g,m,_)}finally{_n(A,!1)}}function zr(o,u,g,m){return typeof o!="function"?o:function(){var _=ze;g&&Ot(),_n(u,!0);try{return o.apply(this,arguments)}finally{_n(_,!1),m&&queueMicrotask($e)}}}function mi(o){Promise===ut&&ct.echoes===0?qt===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+l).indexOf("[native code]")===-1&&(Ot=$e=ke);var et=Se.reject,zn="￿",Vt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ca="String expected.",$n=[],hr="__dbnames",Zn="readonly",$r="readwrite";function cn(o,u){return o?u?function(){return o.apply(this,arguments)&&u.apply(this,arguments)}:o:u}var bi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Gr(o){return typeof o!="string"||/\./.test(o)?function(u){return u}:function(u){return u[o]===void 0&&o in u&&delete(u=B(u))[o],u}}function qr(){throw ce.Type()}function Ye(o,u){try{var g=Fr(o),m=Fr(u);if(g!==m)return g==="Array"?1:m==="Array"?-1:g==="binary"?1:m==="binary"?-1:g==="string"?1:m==="string"?-1:g==="Date"?1:m!=="Date"?NaN:-1;switch(g){case"number":case"Date":case"string":return u<o?1:o<u?-1:0;case"binary":return function(_,A){for(var R=_.length,F=A.length,W=R<F?R:F,X=0;X<W;++X)if(_[X]!==A[X])return _[X]<A[X]?-1:1;return R===F?0:R<F?-1:1}(la(o),la(u));case"Array":return function(_,A){for(var R=_.length,F=A.length,W=R<F?R:F,X=0;X<W;++X){var Z=Ye(_[X],A[X]);if(Z!==0)return Z}return R===F?0:R<F?-1:1}(o,u)}}catch{}return NaN}function Fr(o){var u=typeof o;return u!="object"?u:ArrayBuffer.isView(o)?"binary":(o=ge(o),o==="ArrayBuffer"?"binary":o)}function la(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var da=(Ze.prototype._trans=function(o,u,g){var m=this._tx||ze.trans,_=this.name,A=Ve&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function R(X,Z,H){if(!H.schema[_])throw new ce.NotFound("Table "+_+" not part of transaction");return u(H.idbtrans,H)}var F=Qn();try{var W=m&&m.db._novip===this.db._novip?m===ze.trans?m._promise(o,R,g):un(function(){return m._promise(o,R,g)},{trans:m,transless:ze.transless||ze}):function X(Z,H,ee,Q){if(Z.idbdb&&(Z._state.openComplete||ze.letThrough||Z._vip)){var ie=Z._createTransaction(H,ee,Z._dbSchema);try{ie.create(),Z._state.PR1398_maxLoop=3}catch(ae){return ae.name===Oe.InvalidState&&Z.isOpen()&&0<--Z._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Z.close({disableAutoOpen:!1}),Z.open().then(function(){return X(Z,H,ee,Q)})):et(ae)}return ie._promise(H,function(ae,re){return un(function(){return ze.trans=ie,Q(ae,re,ie)})}).then(function(ae){if(H==="readwrite")try{ie.idbtrans.commit()}catch{}return H==="readonly"?ae:ie._completion.then(function(){return ae})})}if(Z._state.openComplete)return et(new ce.DatabaseClosed(Z._state.dbOpenError));if(!Z._state.isBeingOpened){if(!Z._state.autoOpen)return et(new ce.DatabaseClosed);Z.open().catch(ke)}return Z._state.dbReadyPromise.then(function(){return X(Z,H,ee,Q)})}(this.db,o,[this.name],R);return A&&(W._consoleTask=A,W=W.catch(function(X){return console.trace(X),et(X)})),W}finally{F&&En()}},Ze.prototype.get=function(o,u){var g=this;return o&&o.constructor===Object?this.where(o).first(u):o==null?et(new ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(m){return g.core.get({trans:m,key:o}).then(function(_){return g.hook.reading.fire(_)})}).then(u)},Ze.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(d(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var u=s(o);if(u.length===1)return this.where(u[0]).equals(o[u[0]]);var g=this.schema.indexes.concat(this.schema.primKey).filter(function(F){if(F.compound&&u.every(function(X){return 0<=F.keyPath.indexOf(X)})){for(var W=0;W<u.length;++W)if(u.indexOf(F.keyPath[W])===-1)return!1;return!0}return!1}).sort(function(F,W){return F.keyPath.length-W.keyPath.length})[0];if(g&&this.db._maxKey!==zn){var A=g.keyPath.slice(0,u.length);return this.where(A).equals(A.map(function(W){return o[W]}))}!g&&Ve&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var m=this.schema.idxByName;function _(F,W){return Ye(F,W)===0}var R=u.reduce(function(H,W){var X=H[0],Z=H[1],H=m[W],ee=o[W];return[X||H,X||!H?cn(Z,H&&H.multi?function(Q){return Q=K(Q,W),d(Q)&&Q.some(function(ie){return _(ee,ie)})}:function(Q){return _(ee,K(Q,W))}):Z]},[null,null]),A=R[0],R=R[1];return A?this.where(A.name).equals(o[A.keyPath]).filter(R):g?this.filter(R):this.where(u).equals("")},Ze.prototype.filter=function(o){return this.toCollection().and(o)},Ze.prototype.count=function(o){return this.toCollection().count(o)},Ze.prototype.offset=function(o){return this.toCollection().offset(o)},Ze.prototype.limit=function(o){return this.toCollection().limit(o)},Ze.prototype.each=function(o){return this.toCollection().each(o)},Ze.prototype.toArray=function(o){return this.toCollection().toArray(o)},Ze.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ze.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,d(o)?"[".concat(o.join("+"),"]"):o))},Ze.prototype.reverse=function(){return this.toCollection().reverse()},Ze.prototype.mapToClass=function(o){var u,g=this.db,m=this.name;function _(){return u!==null&&u.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof qr&&(function(W,X){if(typeof X!="function"&&X!==null)throw new TypeError("Class extends value "+String(X)+" is not a constructor or null");function Z(){this.constructor=W}t(W,X),W.prototype=X===null?Object.create(X):(Z.prototype=X.prototype,new Z)}(_,u=o),Object.defineProperty(_.prototype,"db",{get:function(){return g},enumerable:!1,configurable:!0}),_.prototype.table=function(){return m},o=_);for(var A=new Set,R=o.prototype;R;R=h(R))Object.getOwnPropertyNames(R).forEach(function(W){return A.add(W)});function F(W){if(!W)return W;var X,Z=Object.create(o.prototype);for(X in W)if(!A.has(X))try{Z[X]=W[X]}catch{}return Z}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=F,this.hook("reading",F),o},Ze.prototype.defineClass=function(){return this.mapToClass(function(o){f(this,o)})},Ze.prototype.add=function(o,u){var g=this,m=this.schema.primKey,_=m.auto,A=m.keyPath,R=o;return A&&_&&(R=Gr(A)(o)),this._trans("readwrite",function(F){return g.core.mutate({trans:F,type:"add",keys:u!=null?[u]:null,values:[R]})}).then(function(F){return F.numFailures?Se.reject(F.failures[0]):F.lastResult}).then(function(F){if(A)try{S(o,A,F)}catch{}return F})},Ze.prototype.update=function(o,u){return typeof o!="object"||d(o)?this.where(":id").equals(o).modify(u):(o=K(o,this.schema.primKey.keyPath),o===void 0?et(new ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(u))},Ze.prototype.put=function(o,u){var g=this,m=this.schema.primKey,_=m.auto,A=m.keyPath,R=o;return A&&_&&(R=Gr(A)(o)),this._trans("readwrite",function(F){return g.core.mutate({trans:F,type:"put",values:[R],keys:u!=null?[u]:null})}).then(function(F){return F.numFailures?Se.reject(F.failures[0]):F.lastResult}).then(function(F){if(A)try{S(o,A,F)}catch{}return F})},Ze.prototype.delete=function(o){var u=this;return this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"delete",keys:[o]})}).then(function(g){return g.numFailures?Se.reject(g.failures[0]):void 0})},Ze.prototype.clear=function(){var o=this;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"deleteRange",range:bi})}).then(function(u){return u.numFailures?Se.reject(u.failures[0]):void 0})},Ze.prototype.bulkGet=function(o){var u=this;return this._trans("readonly",function(g){return u.core.getMany({keys:o,trans:g}).then(function(m){return m.map(function(_){return u.hook.reading.fire(_)})})})},Ze.prototype.bulkAdd=function(o,u,g){var m=this,_=Array.isArray(u)?u:void 0,A=(g=g||(_?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function(R){var X=m.schema.primKey,F=X.auto,X=X.keyPath;if(X&&_)throw new ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(_&&_.length!==o.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var W=o.length,X=X&&F?o.map(Gr(X)):o;return m.core.mutate({trans:R,type:"add",keys:_,values:X,wantResults:A}).then(function(ie){var H=ie.numFailures,ee=ie.results,Q=ie.lastResult,ie=ie.failures;if(H===0)return A?ee:Q;throw new Me("".concat(m.name,".bulkAdd(): ").concat(H," of ").concat(W," operations failed"),ie)})})},Ze.prototype.bulkPut=function(o,u,g){var m=this,_=Array.isArray(u)?u:void 0,A=(g=g||(_?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function(R){var X=m.schema.primKey,F=X.auto,X=X.keyPath;if(X&&_)throw new ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(_&&_.length!==o.length)throw new ce.InvalidArgument("Arguments objects and keys must have the same length");var W=o.length,X=X&&F?o.map(Gr(X)):o;return m.core.mutate({trans:R,type:"put",keys:_,values:X,wantResults:A}).then(function(ie){var H=ie.numFailures,ee=ie.results,Q=ie.lastResult,ie=ie.failures;if(H===0)return A?ee:Q;throw new Me("".concat(m.name,".bulkPut(): ").concat(H," of ").concat(W," operations failed"),ie)})})},Ze.prototype.bulkUpdate=function(o){var u=this,g=this.core,m=o.map(function(R){return R.key}),_=o.map(function(R){return R.changes}),A=[];return this._trans("readwrite",function(R){return g.getMany({trans:R,keys:m,cache:"clone"}).then(function(F){var W=[],X=[];o.forEach(function(H,ee){var Q=H.key,ie=H.changes,ae=F[ee];if(ae){for(var re=0,se=Object.keys(ie);re<se.length;re++){var le=se[re],pe=ie[le];if(le===u.schema.primKey.keyPath){if(Ye(pe,Q)!==0)throw new ce.Constraint("Cannot update primary key in bulkUpdate()")}else S(ae,le,pe)}A.push(ee),W.push(Q),X.push(ae)}});var Z=W.length;return g.mutate({trans:R,type:"put",keys:W,values:X,updates:{keys:m,changeSpecs:_}}).then(function(H){var ee=H.numFailures,Q=H.failures;if(ee===0)return Z;for(var ie=0,ae=Object.keys(Q);ie<ae.length;ie++){var re,se=ae[ie],le=A[Number(se)];le!=null&&(re=Q[se],delete Q[se],Q[le]=re)}throw new Me("".concat(u.name,".bulkUpdate(): ").concat(ee," of ").concat(Z," operations failed"),Q)})})})},Ze.prototype.bulkDelete=function(o){var u=this,g=o.length;return this._trans("readwrite",function(m){return u.core.mutate({trans:m,type:"delete",keys:o})}).then(function(R){var _=R.numFailures,A=R.lastResult,R=R.failures;if(_===0)return A;throw new Me("".concat(u.name,".bulkDelete(): ").concat(_," of ").concat(g," operations failed"),R)})},Ze);function Ze(){}function fr(o){function u(R,F){if(F){for(var W=arguments.length,X=new Array(W-1);--W;)X[W-1]=arguments[W];return g[R].subscribe.apply(null,X),o}if(typeof R=="string")return g[R]}var g={};u.addEventType=A;for(var m=1,_=arguments.length;m<_;++m)A(arguments[m]);return u;function A(R,F,W){if(typeof R!="object"){var X;F=F||xt;var Z={subscribers:[],fire:W=W||ke,subscribe:function(H){Z.subscribers.indexOf(H)===-1&&(Z.subscribers.push(H),Z.fire=F(Z.fire,H))},unsubscribe:function(H){Z.subscribers=Z.subscribers.filter(function(ee){return ee!==H}),Z.fire=Z.subscribers.reduce(F,W)}};return g[R]=u[R]=Z}s(X=R).forEach(function(H){var ee=X[H];if(d(ee))A(H,X[H][0],X[H][1]);else{if(ee!=="asap")throw new ce.InvalidArgument("Invalid event config");var Q=A(H,Ke,function(){for(var ie=arguments.length,ae=new Array(ie);ie--;)ae[ie]=arguments[ie];Q.subscribers.forEach(function(re){L(function(){re.apply(null,ae)})})})}})}}function pr(o,u){return D(u).from({prototype:o}),u}function Gn(o,u){return!(o.filter||o.algorithm||o.or)&&(u?o.justLimit:!o.replayFilter)}function Jn(o,u){o.filter=cn(o.filter,u)}function Sn(o,u,g){var m=o.replayFilter;o.replayFilter=m?function(){return cn(m(),u())}:u,o.justLimit=g&&!m}function er(o,u){if(o.isPrimKey)return u.primaryKey;var g=u.getIndexByKeyPath(o.index);if(!g)throw new ce.Schema("KeyPath "+o.index+" on object store "+u.name+" is not indexed");return g}function gr(o,u,g){var m=er(o,u.schema);return u.openCursor({trans:g,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:m,range:o.range}})}function Ut(o,u,g,m){var _=o.replayFilter?cn(o.filter,o.replayFilter()):o.filter;if(o.or){var A={},R=function(F,W,X){var Z,H;_&&!_(W,X,function(ee){return W.stop(ee)},function(ee){return W.fail(ee)})||((H=""+(Z=W.primaryKey))=="[object ArrayBuffer]"&&(H=""+new Uint8Array(Z)),b(A,H)||(A[H]=!0,u(F,W,X)))};return Promise.all([o.or._iterate(R,g),tr(gr(o,m,g),o.algorithm,R,!o.keysOnly&&o.valueMapper)])}return tr(gr(o,m,g),cn(o.algorithm,_),u,!o.keysOnly&&o.valueMapper)}function tr(o,u,g,m){var _=Je(m?function(A,R,F){return g(m(A),R,F)}:g);return o.then(function(A){if(A)return A.start(function(){var R=function(){return A.continue()};u&&!u(A,function(F){return R=F},function(F){A.stop(F),R=ke},function(F){A.fail(F),R=ke})||_(A.value,A,function(F){return R=F}),R()})})}var yr=(wi.prototype.execute=function(o){var u=this["@@propmod"];if(u.add!==void 0){var g=u.add;if(d(g))return i(i([],d(o)?o:[],!0),g).sort();if(typeof g=="number")return(Number(o)||0)+g;if(typeof g=="bigint")try{return BigInt(o)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(u.remove!==void 0){var m=u.remove;if(d(m))return d(o)?o.filter(function(_){return!m.includes(_)}).sort():[];if(typeof m=="number")return Number(o)-m;if(typeof m=="bigint")try{return BigInt(o)-m}catch{return BigInt(0)-m}throw new TypeError("Invalid subtrahend ".concat(m))}return g=(g=u.replacePrefix)===null||g===void 0?void 0:g[0],g&&typeof o=="string"&&o.startsWith(g)?u.replacePrefix[1]+o.substring(g.length):o},wi);function wi(o){this["@@propmod"]=o}var ha=(Xe.prototype._read=function(o,u){var g=this._ctx;return g.error?g.table._trans(null,et.bind(null,g.error)):g.table._trans("readonly",o).then(u)},Xe.prototype._write=function(o){var u=this._ctx;return u.error?u.table._trans(null,et.bind(null,u.error)):u.table._trans("readwrite",o,"locked")},Xe.prototype._addAlgorithm=function(o){var u=this._ctx;u.algorithm=cn(u.algorithm,o)},Xe.prototype._iterate=function(o,u){return Ut(this._ctx,o,u,this._ctx.table.core)},Xe.prototype.clone=function(o){var u=Object.create(this.constructor.prototype),g=Object.create(this._ctx);return o&&f(g,o),u._ctx=g,u},Xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Xe.prototype.each=function(o){var u=this._ctx;return this._read(function(g){return Ut(u,o,g,u.table.core)})},Xe.prototype.count=function(o){var u=this;return this._read(function(g){var m=u._ctx,_=m.table.core;if(Gn(m,!0))return _.count({trans:g,query:{index:er(m,_.schema),range:m.range}}).then(function(R){return Math.min(R,m.limit)});var A=0;return Ut(m,function(){return++A,!1},g,_).then(function(){return A})}).then(o)},Xe.prototype.sortBy=function(o,u){var g=o.split(".").reverse(),m=g[0],_=g.length-1;function A(W,X){return X?A(W[g[X]],X-1):W[m]}var R=this._ctx.dir==="next"?1:-1;function F(W,X){return Ye(A(W,_),A(X,_))*R}return this.toArray(function(W){return W.sort(F)}).then(u)},Xe.prototype.toArray=function(o){var u=this;return this._read(function(g){var m=u._ctx;if(m.dir==="next"&&Gn(m,!0)&&0<m.limit){var _=m.valueMapper,A=er(m,m.table.core.schema);return m.table.core.query({trans:g,limit:m.limit,values:!0,query:{index:A,range:m.range}}).then(function(F){return F=F.result,_?F.map(_):F})}var R=[];return Ut(m,function(F){return R.push(F)},g,m.table.core).then(function(){return R})},o)},Xe.prototype.offset=function(o){var u=this._ctx;return o<=0||(u.offset+=o,Gn(u)?Sn(u,function(){var g=o;return function(m,_){return g===0||(g===1?--g:_(function(){m.advance(g),g=0}),!1)}}):Sn(u,function(){var g=o;return function(){return--g<0}})),this},Xe.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),Sn(this._ctx,function(){var u=o;return function(g,m,_){return--u<=0&&m(_),0<=u}},!0),this},Xe.prototype.until=function(o,u){return Jn(this._ctx,function(g,m,_){return!o(g.value)||(m(_),u)}),this},Xe.prototype.first=function(o){return this.limit(1).toArray(function(u){return u[0]}).then(o)},Xe.prototype.last=function(o){return this.reverse().first(o)},Xe.prototype.filter=function(o){var u;return Jn(this._ctx,function(g){return o(g.value)}),(u=this._ctx).isMatch=cn(u.isMatch,o),this},Xe.prototype.and=function(o){return this.filter(o)},Xe.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Xe.prototype.desc=function(){return this.reverse()},Xe.prototype.eachKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,m){o(m.key,m)})},Xe.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Xe.prototype.eachPrimaryKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,m){o(m.primaryKey,m)})},Xe.prototype.keys=function(o){var u=this._ctx;u.keysOnly=!u.isMatch;var g=[];return this.each(function(m,_){g.push(_.key)}).then(function(){return g}).then(o)},Xe.prototype.primaryKeys=function(o){var u=this._ctx;if(u.dir==="next"&&Gn(u,!0)&&0<u.limit)return this._read(function(m){var _=er(u,u.table.core.schema);return u.table.core.query({trans:m,values:!1,limit:u.limit,query:{index:_,range:u.range}})}).then(function(m){return m.result}).then(o);u.keysOnly=!u.isMatch;var g=[];return this.each(function(m,_){g.push(_.primaryKey)}).then(function(){return g}).then(o)},Xe.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Xe.prototype.firstKey=function(o){return this.limit(1).keys(function(u){return u[0]}).then(o)},Xe.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Xe.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var u={};return Jn(this._ctx,function(_){var m=_.primaryKey.toString(),_=b(u,m);return u[m]=!0,!_}),this},Xe.prototype.modify=function(o){var u=this,g=this._ctx;return this._write(function(m){var _,A,R;R=typeof o=="function"?o:(_=s(o),A=_.length,function(re){for(var se=!1,le=0;le<A;++le){var pe=_[le],ye=o[pe],be=K(re,pe);ye instanceof yr?(S(re,pe,ye.execute(be)),se=!0):be!==ye&&(S(re,pe,ye),se=!0)}return se});var F=g.table.core,H=F.schema.primaryKey,W=H.outbound,X=H.extractKey,Z=200,H=u.db._options.modifyChunkSize;H&&(Z=typeof H=="object"?H[F.name]||H["*"]||200:H);function ee(re,pe){var le=pe.failures,pe=pe.numFailures;ie+=re-pe;for(var ye=0,be=s(le);ye<be.length;ye++){var De=be[ye];Q.push(le[De])}}var Q=[],ie=0,ae=[];return u.clone().primaryKeys().then(function(re){function se(pe){var ye=Math.min(Z,re.length-pe);return F.getMany({trans:m,keys:re.slice(pe,pe+ye),cache:"immutable"}).then(function(be){for(var De=[],we=[],Ee=W?[]:null,Ie=[],Ce=0;Ce<ye;++Ce){var Te=be[Ce],Be={value:B(Te),primKey:re[pe+Ce]};R.call(Be,Be.value,Be)!==!1&&(Be.value==null?Ie.push(re[pe+Ce]):W||Ye(X(Te),X(Be.value))===0?(we.push(Be.value),W&&Ee.push(re[pe+Ce])):(Ie.push(re[pe+Ce]),De.push(Be.value)))}return Promise.resolve(0<De.length&&F.mutate({trans:m,type:"add",values:De}).then(function(We){for(var He in We.failures)Ie.splice(parseInt(He),1);ee(De.length,We)})).then(function(){return(0<we.length||le&&typeof o=="object")&&F.mutate({trans:m,type:"put",keys:Ee,values:we,criteria:le,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<pe}).then(function(We){return ee(we.length,We)})}).then(function(){return(0<Ie.length||le&&o===xi)&&F.mutate({trans:m,type:"delete",keys:Ie,criteria:le,isAdditionalChunk:0<pe}).then(function(We){return ee(Ie.length,We)})}).then(function(){return re.length>pe+ye&&se(pe+Z)})})}var le=Gn(g)&&g.limit===1/0&&(typeof o!="function"||o===xi)&&{index:g.index,range:g.range};return se(0).then(function(){if(0<Q.length)throw new _e("Error modifying one or more objects",Q,ie,ae);return re.length})})})},Xe.prototype.delete=function(){var o=this._ctx,u=o.range;return Gn(o)&&(o.isPrimKey||u.type===3)?this._write(function(g){var m=o.table.core.schema.primaryKey,_=u;return o.table.core.count({trans:g,query:{index:m,range:_}}).then(function(A){return o.table.core.mutate({trans:g,type:"deleteRange",range:_}).then(function(R){var F=R.failures;if(R.lastResult,R.results,R=R.numFailures,R)throw new _e("Could not delete some values",Object.keys(F).map(function(W){return F[W]}),A-R);return A-R})})}):this.modify(xi)},Xe);function Xe(){}var xi=function(o,u){return u.value=null};function po(o,u){return o<u?-1:o===u?0:1}function fa(o,u){return u<o?-1:o===u?0:1}function Tt(o,u,g){return o=o instanceof jr?new o.Collection(o):o,o._ctx.error=new(g||TypeError)(u),o}function nr(o){return new o.Collection(o,function(){return pa("")}).limit(0)}function vr(o,u,g,m){var _,A,R,F,W,X,Z,H=g.length;if(!g.every(function(ie){return typeof ie=="string"}))return Tt(o,ca);function ee(ie){_=ie==="next"?function(re){return re.toUpperCase()}:function(re){return re.toLowerCase()},A=ie==="next"?function(re){return re.toLowerCase()}:function(re){return re.toUpperCase()},R=ie==="next"?po:fa;var ae=g.map(function(re){return{lower:A(re),upper:_(re)}}).sort(function(re,se){return R(re.lower,se.lower)});F=ae.map(function(re){return re.upper}),W=ae.map(function(re){return re.lower}),Z=(X=ie)==="next"?"":m}ee("next"),o=new o.Collection(o,function(){return ln(F[0],W[H-1]+m)}),o._ondirectionchange=function(ie){ee(ie)};var Q=0;return o._addAlgorithm(function(ie,ae,re){var se=ie.key;if(typeof se!="string")return!1;var le=A(se);if(u(le,W,Q))return!0;for(var pe=null,ye=Q;ye<H;++ye){var be=function(De,we,Ee,Ie,Ce,Te){for(var Be=Math.min(De.length,Ie.length),We=-1,He=0;He<Be;++He){var Ht=we[He];if(Ht!==Ie[He])return Ce(De[He],Ee[He])<0?De.substr(0,He)+Ee[He]+Ee.substr(He+1):Ce(De[He],Ie[He])<0?De.substr(0,He)+Ie[He]+Ee.substr(He+1):0<=We?De.substr(0,We)+we[We]+Ee.substr(We+1):null;Ce(De[He],Ht)<0&&(We=He)}return Be<Ie.length&&Te==="next"?De+Ee.substr(De.length):Be<De.length&&Te==="prev"?De.substr(0,Ee.length):We<0?null:De.substr(0,We)+Ie[We]+Ee.substr(We+1)}(se,le,F[ye],W[ye],R,X);be===null&&pe===null?Q=ye+1:(pe===null||0<R(pe,be))&&(pe=be)}return ae(pe!==null?function(){ie.continue(pe+Z)}:re),!1}),o}function ln(o,u,g,m){return{type:2,lower:o,upper:u,lowerOpen:g,upperOpen:m}}function pa(o){return{type:1,lower:o,upper:o}}var jr=(Object.defineProperty(lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),lt.prototype.between=function(o,u,g,m){g=g!==!1,m=m===!0;try{return 0<this._cmp(o,u)||this._cmp(o,u)===0&&(g||m)&&(!g||!m)?nr(this):new this.Collection(this,function(){return ln(o,u,!g,!m)})}catch{return Tt(this,Vt)}},lt.prototype.equals=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return pa(o)})},lt.prototype.above=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return ln(o,void 0,!0)})},lt.prototype.aboveOrEqual=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return ln(o,void 0,!1)})},lt.prototype.below=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return ln(void 0,o,!1,!0)})},lt.prototype.belowOrEqual=function(o){return o==null?Tt(this,Vt):new this.Collection(this,function(){return ln(void 0,o)})},lt.prototype.startsWith=function(o){return typeof o!="string"?Tt(this,ca):this.between(o,o+zn,!0,!0)},lt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):vr(this,function(u,g){return u.indexOf(g[0])===0},[o],zn)},lt.prototype.equalsIgnoreCase=function(o){return vr(this,function(u,g){return u===g[0]},[o],"")},lt.prototype.anyOfIgnoreCase=function(){var o=de.apply(ne,arguments);return o.length===0?nr(this):vr(this,function(u,g){return g.indexOf(u)!==-1},o,"")},lt.prototype.startsWithAnyOfIgnoreCase=function(){var o=de.apply(ne,arguments);return o.length===0?nr(this):vr(this,function(u,g){return g.some(function(m){return u.indexOf(m)===0})},o,zn)},lt.prototype.anyOf=function(){var o=this,u=de.apply(ne,arguments),g=this._cmp;try{u.sort(g)}catch{return Tt(this,Vt)}if(u.length===0)return nr(this);var m=new this.Collection(this,function(){return ln(u[0],u[u.length-1])});m._ondirectionchange=function(A){g=A==="next"?o._ascending:o._descending,u.sort(g)};var _=0;return m._addAlgorithm(function(A,R,F){for(var W=A.key;0<g(W,u[_]);)if(++_===u.length)return R(F),!1;return g(W,u[_])===0||(R(function(){A.continue(u[_])}),!1)}),m},lt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},lt.prototype.noneOf=function(){var o=de.apply(ne,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Tt(this,Vt)}var u=o.reduce(function(g,m){return g?g.concat([[g[g.length-1][1],m]]):[[-1/0,m]]},null);return u.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},lt.prototype.inAnyRange=function(se,u){var g=this,m=this._cmp,_=this._ascending,A=this._descending,R=this._min,F=this._max;if(se.length===0)return nr(this);if(!se.every(function(le){return le[0]!==void 0&&le[1]!==void 0&&_(le[0],le[1])<=0}))return Tt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ce.InvalidArgument);var W=!u||u.includeLowers!==!1,X=u&&u.includeUppers===!0,Z,H=_;function ee(le,pe){return H(le[0],pe[0])}try{(Z=se.reduce(function(le,pe){for(var ye=0,be=le.length;ye<be;++ye){var De=le[ye];if(m(pe[0],De[1])<0&&0<m(pe[1],De[0])){De[0]=R(De[0],pe[0]),De[1]=F(De[1],pe[1]);break}}return ye===be&&le.push(pe),le},[])).sort(ee)}catch{return Tt(this,Vt)}var Q=0,ie=X?function(le){return 0<_(le,Z[Q][1])}:function(le){return 0<=_(le,Z[Q][1])},ae=W?function(le){return 0<A(le,Z[Q][0])}:function(le){return 0<=A(le,Z[Q][0])},re=ie,se=new this.Collection(this,function(){return ln(Z[0][0],Z[Z.length-1][1],!W,!X)});return se._ondirectionchange=function(le){H=le==="next"?(re=ie,_):(re=ae,A),Z.sort(ee)},se._addAlgorithm(function(le,pe,ye){for(var be,De=le.key;re(De);)if(++Q===Z.length)return pe(ye),!1;return!ie(be=De)&&!ae(be)||(g._cmp(De,Z[Q][1])===0||g._cmp(De,Z[Q][0])===0||pe(function(){H===_?le.continue(Z[Q][0]):le.continue(Z[Q][1])}),!1)}),se},lt.prototype.startsWithAnyOf=function(){var o=de.apply(ne,arguments);return o.every(function(u){return typeof u=="string"})?o.length===0?nr(this):this.inAnyRange(o.map(function(u){return[u,u+zn]})):Tt(this,"startsWithAnyOf() only works with strings")},lt);function lt(){}function Kt(o){return Je(function(u){return mr(u),o(u.target.error),!1})}function mr(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var An="storagemutated",Ei="x-storagemutated-1",dn=fr(null,An),ga=(Qt.prototype._lock=function(){return C(!ze.global),++this._reculock,this._reculock!==1||ze.global||(ze.lockOwnerFor=this),this},Qt.prototype._unlock=function(){if(C(!ze.global),--this._reculock==0)for(ze.global||(ze.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Bt(o[1],o[0])}catch{}}return this},Qt.prototype._locked=function(){return this._reculock&&ze.lockOwnerFor!==this},Qt.prototype.create=function(o){var u=this;if(!this.mode)return this;var g=this.db.idbdb,m=this.db._state.dbOpenError;if(C(!this.idbtrans),!o&&!g)switch(m&&m.name){case"DatabaseClosedError":throw new ce.DatabaseClosed(m);case"MissingAPIError":throw new ce.MissingAPI(m.message,m);default:throw new ce.OpenFailed(m)}if(!this.active)throw new ce.TransactionInactive;return C(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||g).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Je(function(_){mr(_),u._reject(o.error)}),o.onabort=Je(function(_){mr(_),u.active&&u._reject(new ce.Abort(o.error)),u.active=!1,u.on("abort").fire(_)}),o.oncomplete=Je(function(){u.active=!1,u._resolve(),"mutatedParts"in o&&dn.storagemutated.fire(o.mutatedParts)}),this},Qt.prototype._promise=function(o,u,g){var m=this;if(o==="readwrite"&&this.mode!=="readwrite")return et(new ce.ReadOnly("Transaction is readonly"));if(!this.active)return et(new ce.TransactionInactive);if(this._locked())return new Se(function(A,R){m._blockedFuncs.push([function(){m._promise(o,u,g).then(A,R)},ze])});if(g)return un(function(){var A=new Se(function(R,F){m._lock();var W=u(R,F,m);W&&W.then&&W.then(R,F)});return A.finally(function(){return m._unlock()}),A._lib=!0,A});var _=new Se(function(A,R){var F=u(A,R,m);F&&F.then&&F.then(A,R)});return _._lib=!0,_},Qt.prototype._root=function(){return this.parent?this.parent._root():this},Qt.prototype.waitFor=function(o){var u,g=this._root(),m=Se.resolve(o);g._waitingFor?g._waitingFor=g._waitingFor.then(function(){return m}):(g._waitingFor=m,g._waitingQueue=[],u=g.idbtrans.objectStore(g.storeNames[0]),function A(){for(++g._spinCount;g._waitingQueue.length;)g._waitingQueue.shift()();g._waitingFor&&(u.get(-1/0).onsuccess=A)}());var _=g._waitingFor;return new Se(function(A,R){m.then(function(F){return g._waitingQueue.push(Je(A.bind(null,F)))},function(F){return g._waitingQueue.push(Je(R.bind(null,F)))}).finally(function(){g._waitingFor===_&&(g._waitingFor=null)})})},Qt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new ce.Abort))},Qt.prototype.table=function(o){var u=this._memoizedTables||(this._memoizedTables={});if(b(u,o))return u[o];var g=this.schema[o];if(!g)throw new ce.NotFound("Table "+o+" not part of transaction");return g=new this.db.Table(o,g,this),g.core=this.db.core.table(o),u[o]=g},Qt);function Qt(){}function Br(o,u,g,m,_,A,R){return{name:o,keyPath:u,unique:g,multi:m,auto:_,compound:A,src:(g&&!R?"&":"")+(m?"*":"")+(_?"++":"")+_i(u)}}function _i(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Si(o,u,g){return{name:o,primKey:u,indexes:g,mappedClass:null,idxByName:(m=function(_){return[_.name,_]},g.reduce(function(_,A,R){return R=m(A,R),R&&(_[R[0]]=R[1]),_},{}))};var m}var hn=function(o){try{return o.only([[]]),hn=function(){return[[]]},[[]]}catch{return hn=function(){return zn},zn}};function rr(o){return o==null?function(){}:typeof o=="string"?(u=o).split(".").length===1?function(g){return g[u]}:function(g){return K(g,u)}:function(g){return K(g,o)};var u}function ya(o){return[].slice.call(o)}var Ai=0;function ir(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function go(o,u,W){function m(re){if(re.type===3)return null;if(re.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Q=re.lower,ie=re.upper,ae=re.lowerOpen,re=re.upperOpen;return Q===void 0?ie===void 0?null:u.upperBound(ie,!!re):ie===void 0?u.lowerBound(Q,!!ae):u.bound(Q,ie,!!ae,!!re)}function _(ee){var Q,ie=ee.name;return{name:ie,schema:ee,mutate:function(ae){var re=ae.trans,se=ae.type,le=ae.keys,pe=ae.values,ye=ae.range;return new Promise(function(be,De){be=Je(be);var we=re.objectStore(ie),Ee=we.keyPath==null,Ie=se==="put"||se==="add";if(!Ie&&se!=="delete"&&se!=="deleteRange")throw new Error("Invalid operation type: "+se);var Ce,Te=(le||pe||{length:1}).length;if(le&&pe&&le.length!==pe.length)throw new Error("Given keys array must have same length as given values array.");if(Te===0)return be({numFailures:0,failures:{},results:[],lastResult:void 0});function Be(Rt){++Ht,mr(Rt)}var We=[],He=[],Ht=0;if(se==="deleteRange"){if(ye.type===4)return be({numFailures:Ht,failures:He,results:[],lastResult:void 0});ye.type===3?We.push(Ce=we.clear()):We.push(Ce=we.delete(m(ye)))}else{var Ee=Ie?Ee?[pe,le]:[pe,null]:[le,null],je=Ee[0],At=Ee[1];if(Ie)for(var kt=0;kt<Te;++kt)We.push(Ce=At&&At[kt]!==void 0?we[se](je[kt],At[kt]):we[se](je[kt])),Ce.onerror=Be;else for(kt=0;kt<Te;++kt)We.push(Ce=we[se](je[kt])),Ce.onerror=Be}function ka(Rt){Rt=Rt.target.result,We.forEach(function(Cr,So){return Cr.error!=null&&(He[So]=Cr.error)}),be({numFailures:Ht,failures:He,results:se==="delete"?le:We.map(function(Cr){return Cr.result}),lastResult:Rt})}Ce.onerror=function(Rt){Be(Rt),ka(Rt)},Ce.onsuccess=ka})},getMany:function(ae){var re=ae.trans,se=ae.keys;return new Promise(function(le,pe){le=Je(le);for(var ye,be=re.objectStore(ie),De=se.length,we=new Array(De),Ee=0,Ie=0,Ce=function(We){We=We.target,we[We._pos]=We.result,++Ie===Ee&&le(we)},Te=Kt(pe),Be=0;Be<De;++Be)se[Be]!=null&&((ye=be.get(se[Be]))._pos=Be,ye.onsuccess=Ce,ye.onerror=Te,++Ee);Ee===0&&le(we)})},get:function(ae){var re=ae.trans,se=ae.key;return new Promise(function(le,pe){le=Je(le);var ye=re.objectStore(ie).get(se);ye.onsuccess=function(be){return le(be.target.result)},ye.onerror=Kt(pe)})},query:(Q=X,function(ae){return new Promise(function(re,se){re=Je(re);var le,pe,ye,Ee=ae.trans,be=ae.values,De=ae.limit,Ce=ae.query,we=De===1/0?void 0:De,Ie=Ce.index,Ce=Ce.range,Ee=Ee.objectStore(ie),Ie=Ie.isPrimaryKey?Ee:Ee.index(Ie.name),Ce=m(Ce);if(De===0)return re({result:[]});Q?((we=be?Ie.getAll(Ce,we):Ie.getAllKeys(Ce,we)).onsuccess=function(Te){return re({result:Te.target.result})},we.onerror=Kt(se)):(le=0,pe=!be&&"openKeyCursor"in Ie?Ie.openKeyCursor(Ce):Ie.openCursor(Ce),ye=[],pe.onsuccess=function(Te){var Be=pe.result;return Be?(ye.push(be?Be.value:Be.primaryKey),++le===De?re({result:ye}):void Be.continue()):re({result:ye})},pe.onerror=Kt(se))})}),openCursor:function(ae){var re=ae.trans,se=ae.values,le=ae.query,pe=ae.reverse,ye=ae.unique;return new Promise(function(be,De){be=Je(be);var Ie=le.index,we=le.range,Ee=re.objectStore(ie),Ee=Ie.isPrimaryKey?Ee:Ee.index(Ie.name),Ie=pe?ye?"prevunique":"prev":ye?"nextunique":"next",Ce=!se&&"openKeyCursor"in Ee?Ee.openKeyCursor(m(we),Ie):Ee.openCursor(m(we),Ie);Ce.onerror=Kt(De),Ce.onsuccess=Je(function(Te){var Be,We,He,Ht,je=Ce.result;je?(je.___id=++Ai,je.done=!1,Be=je.continue.bind(je),We=(We=je.continuePrimaryKey)&&We.bind(je),He=je.advance.bind(je),Ht=function(){throw new Error("Cursor not stopped")},je.trans=re,je.stop=je.continue=je.continuePrimaryKey=je.advance=function(){throw new Error("Cursor not started")},je.fail=Je(De),je.next=function(){var At=this,kt=1;return this.start(function(){return kt--?At.continue():At.stop()}).then(function(){return At})},je.start=function(At){function kt(){if(Ce.result)try{At()}catch(Rt){je.fail(Rt)}else je.done=!0,je.start=function(){throw new Error("Cursor behind last entry")},je.stop()}var ka=new Promise(function(Rt,Cr){Rt=Je(Rt),Ce.onerror=Kt(Cr),je.fail=Cr,je.stop=function(So){je.stop=je.continue=je.continuePrimaryKey=je.advance=Ht,Rt(So)}});return Ce.onsuccess=Je(function(Rt){Ce.onsuccess=kt,kt()}),je.continue=Be,je.continuePrimaryKey=We,je.advance=He,kt(),ka},be(je)):be(null)},De)})},count:function(ae){var re=ae.query,se=ae.trans,le=re.index,pe=re.range;return new Promise(function(ye,be){var De=se.objectStore(ie),we=le.isPrimaryKey?De:De.index(le.name),De=m(pe),we=De?we.count(De):we.count();we.onsuccess=Je(function(Ee){return ye(Ee.target.result)}),we.onerror=Kt(be)})}}}var A,R,F,Z=(R=W,F=ya((A=o).objectStoreNames),{schema:{name:A.name,tables:F.map(function(ee){return R.objectStore(ee)}).map(function(ee){var Q=ee.keyPath,re=ee.autoIncrement,ie=d(Q),ae={},re={name:ee.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Q==null,compound:ie,keyPath:Q,autoIncrement:re,unique:!0,extractKey:rr(Q)},indexes:ya(ee.indexNames).map(function(se){return ee.index(se)}).map(function(ye){var le=ye.name,pe=ye.unique,be=ye.multiEntry,ye=ye.keyPath,be={name:le,compound:d(ye),keyPath:ye,unique:pe,multiEntry:be,extractKey:rr(ye)};return ae[ir(ye)]=be}),getIndexByKeyPath:function(se){return ae[ir(se)]}};return ae[":id"]=re.primaryKey,Q!=null&&(ae[ir(Q)]=re.primaryKey),re})},hasGetAll:0<F.length&&"getAll"in R.objectStore(F[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),W=Z.schema,X=Z.hasGetAll,Z=W.tables.map(_),H={};return Z.forEach(function(ee){return H[ee.name]=ee}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(ee){if(!H[ee])throw new Error("Table '".concat(ee,"' not found"));return H[ee]},MIN_KEY:-1/0,MAX_KEY:hn(u),schema:W}}function ki(o,u,g,m){var _=g.IDBKeyRange;return g.indexedDB,{dbcore:(m=go(u,_,m),o.dbcore.reduce(function(A,R){return R=R.create,n(n({},A),R(A))},m))}}function br(o,m){var g=m.db,m=ki(o._middlewares,g,o._deps,m);o.core=m.dbcore,o.tables.forEach(function(_){var A=_.name;o.core.schema.tables.some(function(R){return R.name===A})&&(_.core=o.core.table(A),o[A]instanceof o.Table&&(o[A].core=_.core))})}function wr(o,u,g,m){g.forEach(function(_){var A=m[_];u.forEach(function(R){var F=function W(X,Z){return N(X,Z)||(X=h(X))&&W(X,Z)}(R,_);(!F||"value"in F&&F.value===void 0)&&(R===o.Transaction.prototype||R instanceof o.Transaction?I(R,_,{get:function(){return this.table(_)},set:function(W){E(this,_,{value:W,writable:!0,configurable:!0,enumerable:!0})}}):R[_]=new o.Table(_,A))})})}function xr(o,u){u.forEach(function(g){for(var m in g)g[m]instanceof o.Table&&delete g[m]})}function yo(o,u){return o._cfg.version-u._cfg.version}function vo(o,u,g,m){var _=o._dbSchema;g.objectStoreNames.contains("$meta")&&!_.$meta&&(_.$meta=Si("$meta",ma("")[0],[]),o._storeNames.push("$meta"));var A=o._createTransaction("readwrite",o._storeNames,_);A.create(g),A._completion.catch(m);var R=A._reject.bind(A),F=ze.transless||ze;un(function(){return ze.trans=A,ze.transless=F,u!==0?(br(o,g),X=u,((W=A).storeNames.includes("$meta")?W.table("$meta").get("version").then(function(Z){return Z??X}):Se.resolve(X)).then(function(Z){return ee=Z,Q=A,ie=g,ae=[],Z=(H=o)._versions,re=H._dbSchema=_r(0,H.idbdb,ie),(Z=Z.filter(function(se){return se._cfg.version>=ee})).length!==0?(Z.forEach(function(se){ae.push(function(){var le=re,pe=se._cfg.dbschema;dt(H,le,ie),dt(H,pe,ie),re=H._dbSchema=pe;var ye=Ci(le,pe);ye.add.forEach(function(Ie){Di(ie,Ie[0],Ie[1].primKey,Ie[1].indexes)}),ye.change.forEach(function(Ie){if(Ie.recreate)throw new ce.Upgrade("Not yet support for changing primary key");var Ce=ie.objectStore(Ie.name);Ie.add.forEach(function(Te){return Er(Ce,Te)}),Ie.change.forEach(function(Te){Ce.deleteIndex(Te.name),Er(Ce,Te)}),Ie.del.forEach(function(Te){return Ce.deleteIndex(Te)})});var be=se._cfg.contentUpgrade;if(be&&se._cfg.version>ee){br(H,ie),Q._memoizedTables={};var De=G(pe);ye.del.forEach(function(Ie){De[Ie]=le[Ie]}),xr(H,[H.Transaction.prototype]),wr(H,[H.Transaction.prototype],s(De),De),Q.schema=De;var we,Ee=oe(be);return Ee&&Ot(),ye=Se.follow(function(){var Ie;(we=be(Q))&&Ee&&(Ie=$e.bind(null,null),we.then(Ie,Ie))}),we&&typeof we.then=="function"?Se.resolve(we):ye.then(function(){return we})}}),ae.push(function(le){var pe,ye,be=se._cfg.dbschema;pe=be,ye=le,[].slice.call(ye.db.objectStoreNames).forEach(function(De){return pe[De]==null&&ye.db.deleteObjectStore(De)}),xr(H,[H.Transaction.prototype]),wr(H,[H.Transaction.prototype],H._storeNames,H._dbSchema),Q.schema=H._dbSchema}),ae.push(function(le){H.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(H.idbdb.version/10)===se._cfg.version?(H.idbdb.deleteObjectStore("$meta"),delete H._dbSchema.$meta,H._storeNames=H._storeNames.filter(function(pe){return pe!=="$meta"})):le.objectStore("$meta").put(se._cfg.version,"version"))})}),function se(){return ae.length?Se.resolve(ae.shift()(Q.idbtrans)).then(se):Se.resolve()}().then(function(){va(re,ie)})):Se.resolve();var H,ee,Q,ie,ae,re}).catch(R)):(s(_).forEach(function(Z){Di(g,Z,_[Z].primKey,_[Z].indexes)}),br(o,g),void Se.follow(function(){return o.on.populate.fire(A)}).catch(R));var W,X})}function kn(o,u){va(o._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var g=_r(0,o.idbdb,u);dt(o,o._dbSchema,u);for(var m=0,_=Ci(g,o._dbSchema).change;m<_.length;m++){var A=function(R){if(R.change.length||R.recreate)return console.warn("Unable to patch indexes of table ".concat(R.name," because it has changes on the type of index or primary key.")),{value:void 0};var F=u.objectStore(R.name);R.add.forEach(function(W){Ve&&console.debug("Dexie upgrade patch: Creating missing index ".concat(R.name,".").concat(W.src)),Er(F,W)})}(_[m]);if(typeof A=="object")return A.value}}function Ci(o,u){var g,m={del:[],add:[],change:[]};for(g in o)u[g]||m.del.push(g);for(g in u){var _=o[g],A=u[g];if(_){var R={name:g,def:A,recreate:!1,del:[],add:[],change:[]};if(""+(_.primKey.keyPath||"")!=""+(A.primKey.keyPath||"")||_.primKey.auto!==A.primKey.auto)R.recreate=!0,m.change.push(R);else{var F=_.idxByName,W=A.idxByName,X=void 0;for(X in F)W[X]||R.del.push(X);for(X in W){var Z=F[X],H=W[X];Z?Z.src!==H.src&&R.change.push(H):R.add.push(H)}(0<R.del.length||0<R.add.length||0<R.change.length)&&m.change.push(R)}}else m.add.push([g,A])}return m}function Di(o,u,g,m){var _=o.db.createObjectStore(u,g.keyPath?{keyPath:g.keyPath,autoIncrement:g.auto}:{autoIncrement:g.auto});return m.forEach(function(A){return Er(_,A)}),_}function va(o,u){s(o).forEach(function(g){u.db.objectStoreNames.contains(g)||(Ve&&console.debug("Dexie: Creating missing table",g),Di(u,g,o[g].primKey,o[g].indexes))})}function Er(o,u){o.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function _r(o,u,g){var m={};return P(u.objectStoreNames,0).forEach(function(_){for(var A=g.objectStore(_),R=Br(_i(X=A.keyPath),X||"",!0,!1,!!A.autoIncrement,X&&typeof X!="string",!0),F=[],W=0;W<A.indexNames.length;++W){var Z=A.index(A.indexNames[W]),X=Z.keyPath,Z=Br(Z.name,X,!!Z.unique,!!Z.multiEntry,!1,X&&typeof X!="string",!1);F.push(Z)}m[_]=Si(_,R,F)}),m}function dt(o,u,g){for(var m=g.db.objectStoreNames,_=0;_<m.length;++_){var A=m[_],R=g.objectStore(A);o._hasGetAll="getAll"in R;for(var F=0;F<R.indexNames.length;++F){var W=R.indexNames[F],X=R.index(W).keyPath,Z=typeof X=="string"?X:"["+P(X).join("+")+"]";!u[A]||(X=u[A].idxByName[Z])&&(X.name=W,delete u[A].idxByName[Z],u[A].idxByName[W]=X)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function ma(o){return o.split(",").map(function(u,g){var m=(u=u.trim()).replace(/([&*]|\+\+)/g,""),_=/^\[/.test(m)?m.match(/^\[(.*)\]$/)[1].split("+"):m;return Br(m,_||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),d(_),g===0)})}var mo=(Ur.prototype._parseStoresSpec=function(o,u){s(o).forEach(function(g){if(o[g]!==null){var m=ma(o[g]),_=m.shift();if(_.unique=!0,_.multi)throw new ce.Schema("Primary key cannot be multi-valued");m.forEach(function(A){if(A.auto)throw new ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!A.keyPath)throw new ce.Schema("Index must have a name and cannot be an empty string")}),u[g]=Si(g,_,m)}})},Ur.prototype.stores=function(g){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,g):g;var g=u._versions,m={},_={};return g.forEach(function(A){f(m,A._cfg.storesSource),_=A._cfg.dbschema={},A._parseStoresSpec(m,_)}),u._dbSchema=_,xr(u,[u._allTables,u,u.Transaction.prototype]),wr(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],s(_),_),u._storeNames=s(_),this},Ur.prototype.upgrade=function(o){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||ke,o),this},Ur);function Ur(){}function Ii(o,u){var g=o._dbNamesDB;return g||(g=o._dbNamesDB=new pn(hr,{addons:[],indexedDB:o,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),g.table("dbnames")}function Mi(o){return o&&typeof o.databases=="function"}function Pi(o){return un(function(){return ze.letThrough=!0,o()})}function Ni(o){return!("from"in o)}var yt=function(o,u){if(!this){var g=new yt;return o&&"d"in o&&f(g,o),g}f(this,arguments.length?{d:1,from:o,to:1<arguments.length?u:o}:{d:0})};function ar(o,u,g){var m=Ye(u,g);if(!isNaN(m)){if(0<m)throw RangeError();if(Ni(o))return f(o,{from:u,to:g,d:1});var _=o.l,m=o.r;if(Ye(g,o.from)<0)return _?ar(_,u,g):o.l={from:u,to:g,d:1,l:null,r:null},ba(o);if(0<Ye(u,o.to))return m?ar(m,u,g):o.r={from:u,to:g,d:1,l:null,r:null},ba(o);Ye(u,o.from)<0&&(o.from=u,o.l=null,o.d=m?m.d+1:1),0<Ye(g,o.to)&&(o.to=g,o.r=null,o.d=o.l?o.l.d+1:1),g=!o.r,_&&!o.l&&Cn(o,_),m&&g&&Cn(o,m)}}function Cn(o,u){Ni(u)||function g(m,W){var A=W.from,R=W.to,F=W.l,W=W.r;ar(m,A,R),F&&g(m,F),W&&g(m,W)}(o,u)}function Dn(o,u){var g=qn(u),m=g.next();if(m.done)return!1;for(var _=m.value,A=qn(o),R=A.next(_.from),F=R.value;!m.done&&!R.done;){if(Ye(F.from,_.to)<=0&&0<=Ye(F.to,_.from))return!0;Ye(_.from,F.from)<0?_=(m=g.next(F.from)).value:F=(R=A.next(_.from)).value}return!1}function qn(o){var u=Ni(o)?null:{s:0,n:o};return{next:function(g){for(var m=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,m)for(;u.n.l&&Ye(g,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!m||Ye(g,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function ba(o){var u,g,m=(((u=o.r)===null||u===void 0?void 0:u.d)||0)-(((g=o.l)===null||g===void 0?void 0:g.d)||0),_=1<m?"r":m<-1?"l":"";_&&(u=_=="r"?"l":"r",g=n({},o),m=o[_],o.from=m.from,o.to=m.to,o[_]=m[_],g[_]=m[u],(o[u]=g).d=Oi(g)),o.d=Oi(o)}function Oi(g){var u=g.r,g=g.l;return(u?g?Math.max(u.d,g.d):u.d:g?g.d:0)+1}function Sr(o,u){return s(u).forEach(function(g){o[g]?Cn(o[g],u[g]):o[g]=function m(_){var A,R,F={};for(A in _)b(_,A)&&(R=_[A],F[A]=!R||typeof R!="object"||Y.has(R.constructor)?R:m(R));return F}(u[g])}),o}function Kr(o,u){return o.all||u.all||Object.keys(o).some(function(g){return u[g]&&Dn(u[g],o[g])})}w(yt.prototype,((l={add:function(o){return Cn(this,o),this},addKey:function(o){return ar(this,o,o),this},addKeys:function(o){var u=this;return o.forEach(function(g){return ar(u,g,g)}),this},hasKey:function(o){var u=qn(this).next(o).value;return u&&Ye(u.from,o)<=0&&0<=Ye(u.to,o)}})[V]=function(){return qn(this)},l));var Wt={},Ti={},Ri=!1;function Wr(o){Sr(Ti,o),Ri||(Ri=!0,setTimeout(function(){Ri=!1,Li(Ti,!(Ti={}))},0))}function Li(o,u){u===void 0&&(u=!1);var g=new Set;if(o.all)for(var m=0,_=Object.values(Wt);m<_.length;m++)wa(R=_[m],o,g,u);else for(var A in o){var R,F=/^idb\:\/\/(.*)\/(.*)\//.exec(A);F&&(A=F[1],F=F[2],(R=Wt["idb://".concat(A,"/").concat(F)])&&wa(R,o,g,u))}g.forEach(function(W){return W()})}function wa(o,u,g,m){for(var _=[],A=0,R=Object.entries(o.queries.query);A<R.length;A++){for(var F=R[A],W=F[0],X=[],Z=0,H=F[1];Z<H.length;Z++){var ee=H[Z];Kr(u,ee.obsSet)?ee.subscribers.forEach(function(re){return g.add(re)}):m&&X.push(ee)}m&&_.push([W,X])}if(m)for(var Q=0,ie=_;Q<ie.length;Q++){var ae=ie[Q],W=ae[0],X=ae[1];o.queries.query[W]=X}}function bo(o){var u=o._state,g=o._deps.indexedDB;if(u.isBeingOpened||o.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?et(u.dbOpenError):o});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var m=u.openCanceller,_=Math.round(10*o.verno),A=!1;function R(){if(u.openCanceller!==m)throw new ce.DatabaseClosed("db.open() was cancelled")}function F(){return new Se(function(ee,Q){if(R(),!g)throw new ce.MissingAPI;var ie=o.name,ae=u.autoSchema||!_?g.open(ie):g.open(ie,_);if(!ae)throw new ce.MissingAPI;ae.onerror=Kt(Q),ae.onblocked=Je(o._fireOnBlocked),ae.onupgradeneeded=Je(function(re){var se;Z=ae.transaction,u.autoSchema&&!o._options.allowEmptyDB?(ae.onerror=mr,Z.abort(),ae.result.close(),(se=g.deleteDatabase(ie)).onsuccess=se.onerror=Je(function(){Q(new ce.NoSuchDatabase("Database ".concat(ie," doesnt exist")))})):(Z.onerror=Kt(Q),re=re.oldVersion>Math.pow(2,62)?0:re.oldVersion,H=re<1,o.idbdb=ae.result,A&&kn(o,Z),vo(o,re/10,Z,Q))},Q),ae.onsuccess=Je(function(){Z=null;var re,se,le,pe,ye,be=o.idbdb=ae.result,De=P(be.objectStoreNames);if(0<De.length)try{var we=be.transaction((pe=De).length===1?pe[0]:pe,"readonly");if(u.autoSchema)se=be,le=we,(re=o).verno=se.version/10,le=re._dbSchema=_r(0,se,le),re._storeNames=P(se.objectStoreNames,0),wr(re,[re._allTables],s(le),le);else if(dt(o,o._dbSchema,we),((ye=Ci(_r(0,(ye=o).idbdb,we),ye._dbSchema)).add.length||ye.change.some(function(Ee){return Ee.add.length||Ee.change.length}))&&!A)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),be.close(),_=be.version+1,A=!0,ee(F());br(o,we)}catch{}$n.push(o),be.onversionchange=Je(function(Ee){u.vcFired=!0,o.on("versionchange").fire(Ee)}),be.onclose=Je(function(Ee){o.on("close").fire(Ee)}),H&&(ye=o._deps,we=ie,be=ye.indexedDB,ye=ye.IDBKeyRange,Mi(be)||we===hr||Ii(be,ye).put({name:we}).catch(ke)),ee()},Q)}).catch(function(ee){switch(ee==null?void 0:ee.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),F();break;case"VersionError":if(0<_)return _=0,F()}return Se.reject(ee)})}var W,X=u.dbReadyResolve,Z=null,H=!1;return Se.race([m,(typeof navigator>"u"?Se.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ee){function Q(){return indexedDB.databases().finally(ee)}W=setInterval(Q,100),Q()}).finally(function(){return clearInterval(W)}):Promise.resolve()).then(F)]).then(function(){return R(),u.onReadyBeingFired=[],Se.resolve(Pi(function(){return o.on.ready.fire(o.vip)})).then(function ee(){if(0<u.onReadyBeingFired.length){var Q=u.onReadyBeingFired.reduce(at,ke);return u.onReadyBeingFired=[],Se.resolve(Pi(function(){return Q(o.vip)})).then(ee)}})}).finally(function(){u.openCanceller===m&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(ee){u.dbOpenError=ee;try{Z&&Z.abort()}catch{}return m===u.openCanceller&&o._close(),et(ee)}).finally(function(){u.openComplete=!0,X()}).then(function(){var ee;return H&&(ee={},o.tables.forEach(function(Q){Q.schema.indexes.forEach(function(ie){ie.name&&(ee["idb://".concat(o.name,"/").concat(Q.name,"/").concat(ie.name)]=new yt(-1/0,[[[]]]))}),ee["idb://".concat(o.name,"/").concat(Q.name,"/")]=ee["idb://".concat(o.name,"/").concat(Q.name,"/:dels")]=new yt(-1/0,[[[]]])}),dn(An).fire(ee),Li(ee,!0)),o})}function Ar(o){function u(A){return o.next(A)}var g=_(u),m=_(function(A){return o.throw(A)});function _(A){return function(W){var F=A(W),W=F.value;return F.done?W:W&&typeof W.then=="function"?W.then(g,m):d(W)?Promise.all(W).then(g,m):g(W)}}return _(u)()}function Hr(o,u,g){for(var m=d(o)?o.slice():[o],_=0;_<g;++_)m.push(u);return m}var Yr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return n(n({},o),{table:function(u){var g=o.table(u),m=g.schema,_={},A=[];function R(H,ee,Q){var ie=ir(H),ae=_[ie]=_[ie]||[],re=H==null?0:typeof H=="string"?1:H.length,se=0<ee,se=n(n({},Q),{name:se?"".concat(ie,"(virtual-from:").concat(Q.name,")"):Q.name,lowLevelIndex:Q,isVirtual:se,keyTail:ee,keyLength:re,extractKey:rr(H),unique:!se&&Q.unique});return ae.push(se),se.isPrimaryKey||A.push(se),1<re&&R(re===2?H[0]:H.slice(0,re-1),ee+1,Q),ae.sort(function(le,pe){return le.keyTail-pe.keyTail}),se}u=R(m.primaryKey.keyPath,0,m.primaryKey),_[":id"]=[u];for(var F=0,W=m.indexes;F<W.length;F++){var X=W[F];R(X.keyPath,0,X)}function Z(H){var ee,Q=H.query.index;return Q.isVirtual?n(n({},H),{query:{index:Q.lowLevelIndex,range:(ee=H.query.range,Q=Q.keyTail,{type:ee.type===1?2:ee.type,lower:Hr(ee.lower,ee.lowerOpen?o.MAX_KEY:o.MIN_KEY,Q),lowerOpen:!0,upper:Hr(ee.upper,ee.upperOpen?o.MIN_KEY:o.MAX_KEY,Q),upperOpen:!0})}}):H}return n(n({},g),{schema:n(n({},m),{primaryKey:u,indexes:A,getIndexByKeyPath:function(H){return(H=_[ir(H)])&&H[0]}}),count:function(H){return g.count(Z(H))},query:function(H){return g.query(Z(H))},openCursor:function(H){var ee=H.query.index,Q=ee.keyTail,ie=ee.isVirtual,ae=ee.keyLength;return ie?g.openCursor(Z(H)).then(function(se){return se&&re(se)}):g.openCursor(H);function re(se){return Object.create(se,{continue:{value:function(le){le!=null?se.continue(Hr(le,H.reverse?o.MAX_KEY:o.MIN_KEY,Q)):H.unique?se.continue(se.key.slice(0,ae).concat(H.reverse?o.MIN_KEY:o.MAX_KEY,Q)):se.continue()}},continuePrimaryKey:{value:function(le,pe){se.continuePrimaryKey(Hr(le,o.MAX_KEY,Q),pe)}},primaryKey:{get:function(){return se.primaryKey}},key:{get:function(){var le=se.key;return ae===1?le[0]:le.slice(0,ae)}},value:{get:function(){return se.value}}})}}})}})}};function zi(o,u,g,m){return g=g||{},m=m||"",s(o).forEach(function(_){var A,R,F;b(u,_)?(A=o[_],R=u[_],typeof A=="object"&&typeof R=="object"&&A&&R?(F=ge(A))!==ge(R)?g[m+_]=u[_]:F==="Object"?zi(A,R,g,m+_+"."):A!==R&&(g[m+_]=u[_]):A!==R&&(g[m+_]=u[_])):g[m+_]=void 0}),s(u).forEach(function(_){b(o,_)||(g[m+_]=u[_])}),g}function kr(o,u){return u.type==="delete"?u.keys:u.keys||u.values.map(o.extractKey)}var wo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return n(n({},o),{table:function(u){var g=o.table(u),m=g.schema.primaryKey;return n(n({},g),{mutate:function(_){var A=ze.trans,R=A.table(u).hook,F=R.deleting,W=R.creating,X=R.updating;switch(_.type){case"add":if(W.fire===ke)break;return A._promise("readwrite",function(){return Z(_)},!0);case"put":if(W.fire===ke&&X.fire===ke)break;return A._promise("readwrite",function(){return Z(_)},!0);case"delete":if(F.fire===ke)break;return A._promise("readwrite",function(){return Z(_)},!0);case"deleteRange":if(F.fire===ke)break;return A._promise("readwrite",function(){return function H(ee,Q,ie){return g.query({trans:ee,values:!1,query:{index:m,range:Q},limit:ie}).then(function(ae){var re=ae.result;return Z({type:"delete",keys:re,trans:ee}).then(function(se){return 0<se.numFailures?Promise.reject(se.failures[0]):re.length<ie?{failures:[],numFailures:0,lastResult:void 0}:H(ee,n(n({},Q),{lower:re[re.length-1],lowerOpen:!0}),ie)})})}(_.trans,_.range,1e4)},!0)}return g.mutate(_);function Z(H){var ee,Q,ie,ae=ze.trans,re=H.keys||kr(m,H);if(!re)throw new Error("Keys missing");return(H=H.type==="add"||H.type==="put"?n(n({},H),{keys:re}):n({},H)).type!=="delete"&&(H.values=i([],H.values)),H.keys&&(H.keys=i([],H.keys)),ee=g,ie=re,((Q=H).type==="add"?Promise.resolve([]):ee.getMany({trans:Q.trans,keys:ie,cache:"immutable"})).then(function(se){var le=re.map(function(pe,ye){var be,De,we,Ee=se[ye],Ie={onerror:null,onsuccess:null};return H.type==="delete"?F.fire.call(Ie,pe,Ee,ae):H.type==="add"||Ee===void 0?(be=W.fire.call(Ie,pe,H.values[ye],ae),pe==null&&be!=null&&(H.keys[ye]=pe=be,m.outbound||S(H.values[ye],m.keyPath,pe))):(be=zi(Ee,H.values[ye]),(De=X.fire.call(Ie,be,pe,Ee,ae))&&(we=H.values[ye],Object.keys(De).forEach(function(Ce){b(we,Ce)?we[Ce]=De[Ce]:S(we,Ce,De[Ce])}))),Ie});return g.mutate(H).then(function(pe){for(var ye=pe.failures,be=pe.results,De=pe.numFailures,pe=pe.lastResult,we=0;we<re.length;++we){var Ee=(be||re)[we],Ie=le[we];Ee==null?Ie.onerror&&Ie.onerror(ye[we]):Ie.onsuccess&&Ie.onsuccess(H.type==="put"&&se[we]?H.values[we]:Ee)}return{failures:ye,results:be,numFailures:De,lastResult:pe}}).catch(function(pe){return le.forEach(function(ye){return ye.onerror&&ye.onerror(pe)}),Promise.reject(pe)})})}}})}})}};function xa(o,u,g){try{if(!u||u.keys.length<o.length)return null;for(var m=[],_=0,A=0;_<u.keys.length&&A<o.length;++_)Ye(u.keys[_],o[A])===0&&(m.push(g?B(u.values[_]):u.values[_]),++A);return m.length===o.length?m:null}catch{return null}}var Ea={stack:"dbcore",level:-1,create:function(o){return{table:function(u){var g=o.table(u);return n(n({},g),{getMany:function(m){if(!m.cache)return g.getMany(m);var _=xa(m.keys,m.trans._cache,m.cache==="clone");return _?Se.resolve(_):g.getMany(m).then(function(A){return m.trans._cache={keys:m.keys,values:m.cache==="clone"?B(A):A},A})},mutate:function(m){return m.type!=="add"&&(m.trans._cache=null),g.mutate(m)}})}}}};function or(o,u){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function fn(o,u){switch(o){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _a={stack:"dbcore",level:0,name:"Observability",create:function(o){var u=o.schema.name,g=new yt(o.MIN_KEY,o.MAX_KEY);return n(n({},o),{transaction:function(m,_,A){if(ze.subscr&&_!=="readonly")throw new ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ze.querier));return o.transaction(m,_,A)},table:function(m){var _=o.table(m),A=_.schema,R=A.primaryKey,H=A.indexes,F=R.extractKey,W=R.outbound,X=R.autoIncrement&&H.filter(function(Q){return Q.compound&&Q.keyPath.includes(R.keyPath)}),Z=n(n({},_),{mutate:function(Q){function ie(Ce){return Ce="idb://".concat(u,"/").concat(m,"/").concat(Ce),pe[Ce]||(pe[Ce]=new yt)}var ae,re,se,le=Q.trans,pe=Q.mutatedParts||(Q.mutatedParts={}),ye=ie(""),be=ie(":dels"),De=Q.type,Ie=Q.type==="deleteRange"?[Q.range]:Q.type==="delete"?[Q.keys]:Q.values.length<50?[kr(R,Q).filter(function(Ce){return Ce}),Q.values]:[],we=Ie[0],Ee=Ie[1],Ie=Q.trans._cache;return d(we)?(ye.addKeys(we),(Ie=De==="delete"||we.length===Ee.length?xa(we,Ie):null)||be.addKeys(we),(Ie||Ee)&&(ae=ie,re=Ie,se=Ee,A.indexes.forEach(function(Ce){var Te=ae(Ce.name||"");function Be(He){return He!=null?Ce.extractKey(He):null}function We(He){return Ce.multiEntry&&d(He)?He.forEach(function(Ht){return Te.addKey(Ht)}):Te.addKey(He)}(re||se).forEach(function(He,At){var je=re&&Be(re[At]),At=se&&Be(se[At]);Ye(je,At)!==0&&(je!=null&&We(je),At!=null&&We(At))})}))):we?(Ee={from:(Ee=we.lower)!==null&&Ee!==void 0?Ee:o.MIN_KEY,to:(Ee=we.upper)!==null&&Ee!==void 0?Ee:o.MAX_KEY},be.add(Ee),ye.add(Ee)):(ye.add(g),be.add(g),A.indexes.forEach(function(Ce){return ie(Ce.name).add(g)})),_.mutate(Q).then(function(Ce){return!we||Q.type!=="add"&&Q.type!=="put"||(ye.addKeys(Ce.results),X&&X.forEach(function(Te){for(var Be=Q.values.map(function(je){return Te.extractKey(je)}),We=Te.keyPath.findIndex(function(je){return je===R.keyPath}),He=0,Ht=Ce.results.length;He<Ht;++He)Be[He][We]=Ce.results[He];ie(Te.name).addKeys(Be)})),le.mutatedParts=Sr(le.mutatedParts||{},pe),Ce})}}),H=function(ie){var ae=ie.query,ie=ae.index,ae=ae.range;return[ie,new yt((ie=ae.lower)!==null&&ie!==void 0?ie:o.MIN_KEY,(ae=ae.upper)!==null&&ae!==void 0?ae:o.MAX_KEY)]},ee={get:function(Q){return[R,new yt(Q.key)]},getMany:function(Q){return[R,new yt().addKeys(Q.keys)]},count:H,query:H,openCursor:H};return s(ee).forEach(function(Q){Z[Q]=function(ie){var ae=ze.subscr,re=!!ae,se=or(ze,_)&&fn(Q,ie)?ie.obsSet={}:ae;if(re){var le=function(Ee){return Ee="idb://".concat(u,"/").concat(m,"/").concat(Ee),se[Ee]||(se[Ee]=new yt)},pe=le(""),ye=le(":dels"),ae=ee[Q](ie),re=ae[0],ae=ae[1];if((Q==="query"&&re.isPrimaryKey&&!ie.values?ye:le(re.name||"")).add(ae),!re.isPrimaryKey){if(Q!=="count"){var be=Q==="query"&&W&&ie.values&&_.query(n(n({},ie),{values:!1}));return _[Q].apply(this,arguments).then(function(Ee){if(Q==="query"){if(W&&ie.values)return be.then(function(Be){return Be=Be.result,pe.addKeys(Be),Ee});var Ie=ie.values?Ee.result.map(F):Ee.result;(ie.values?pe:ye).addKeys(Ie)}else if(Q==="openCursor"){var Ce=Ee,Te=ie.values;return Ce&&Object.create(Ce,{key:{get:function(){return ye.addKey(Ce.primaryKey),Ce.key}},primaryKey:{get:function(){var Be=Ce.primaryKey;return ye.addKey(Be),Be}},value:{get:function(){return Te&&pe.addKey(Ce.primaryKey),Ce.value}}})}return Ee})}ye.add(g)}}return _[Q].apply(this,arguments)}}),Z}})}};function Xr(o,u,g){if(g.numFailures===0)return u;if(u.type==="deleteRange")return null;var m=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1;return g.numFailures===m?null:(u=n({},u),d(u.keys)&&(u.keys=u.keys.filter(function(_,A){return!(A in g.failures)})),"values"in u&&d(u.values)&&(u.values=u.values.filter(function(_,A){return!(A in g.failures)})),u)}function $i(o,u){return g=o,((m=u).lower===void 0||(m.lowerOpen?0<Ye(g,m.lower):0<=Ye(g,m.lower)))&&(o=o,(u=u).upper===void 0||(u.upperOpen?Ye(o,u.upper)<0:Ye(o,u.upper)<=0));var g,m}function Sa(o,u,ee,m,_,A){if(!ee||ee.length===0)return o;var R=u.query.index,F=R.multiEntry,W=u.query.range,X=m.schema.primaryKey.extractKey,Z=R.extractKey,H=(R.lowLevelIndex||R).extractKey,ee=ee.reduce(function(Q,ie){var ae=Q,re=[];if(ie.type==="add"||ie.type==="put")for(var se=new yt,le=ie.values.length-1;0<=le;--le){var pe,ye=ie.values[le],be=X(ye);se.hasKey(be)||(pe=Z(ye),(F&&d(pe)?pe.some(function(Ce){return $i(Ce,W)}):$i(pe,W))&&(se.addKey(be),re.push(ye)))}switch(ie.type){case"add":var De=new yt().addKeys(u.values?Q.map(function(Te){return X(Te)}):Q),ae=Q.concat(u.values?re.filter(function(Te){return Te=X(Te),!De.hasKey(Te)&&(De.addKey(Te),!0)}):re.map(function(Te){return X(Te)}).filter(function(Te){return!De.hasKey(Te)&&(De.addKey(Te),!0)}));break;case"put":var we=new yt().addKeys(ie.values.map(function(Te){return X(Te)}));ae=Q.filter(function(Te){return!we.hasKey(u.values?X(Te):Te)}).concat(u.values?re:re.map(function(Te){return X(Te)}));break;case"delete":var Ee=new yt().addKeys(ie.keys);ae=Q.filter(function(Te){return!Ee.hasKey(u.values?X(Te):Te)});break;case"deleteRange":var Ie=ie.range;ae=Q.filter(function(Te){return!$i(X(Te),Ie)})}return ae},o);return ee===o?o:(ee.sort(function(Q,ie){return Ye(H(Q),H(ie))||Ye(X(Q),X(ie))}),u.limit&&u.limit<1/0&&(ee.length>u.limit?ee.length=u.limit:o.length===u.limit&&ee.length<u.limit&&(_.dirty=!0)),A?Object.freeze(ee):ee)}function Aa(o,u){return Ye(o.lower,u.lower)===0&&Ye(o.upper,u.upper)===0&&!!o.lowerOpen==!!u.lowerOpen&&!!o.upperOpen==!!u.upperOpen}function xo(o,u){return function(g,m,_,A){if(g===void 0)return m!==void 0?-1:0;if(m===void 0)return 1;if((m=Ye(g,m))===0){if(_&&A)return 0;if(_)return 1;if(A)return-1}return m}(o.lower,u.lower,o.lowerOpen,u.lowerOpen)<=0&&0<=function(g,m,_,A){if(g===void 0)return m!==void 0?1:0;if(m===void 0)return-1;if((m=Ye(g,m))===0){if(_&&A)return 0;if(_)return-1;if(A)return 1}return m}(o.upper,u.upper,o.upperOpen,u.upperOpen)}function Eo(o,u,g,m){o.subscribers.add(g),m.addEventListener("abort",function(){var _,A;o.subscribers.delete(g),o.subscribers.size===0&&(_=o,A=u,setTimeout(function(){_.subscribers.size===0&&J(A,_)},3e3))})}var _o={stack:"dbcore",level:0,name:"Cache",create:function(o){var u=o.schema.name;return n(n({},o),{transaction:function(g,m,_){var A,R,F=o.transaction(g,m,_);return m==="readwrite"&&(R=(A=new AbortController).signal,_=function(W){return function(){if(A.abort(),m==="readwrite"){for(var X=new Set,Z=0,H=g;Z<H.length;Z++){var ee=H[Z],Q=Wt["idb://".concat(u,"/").concat(ee)];if(Q){var ie=o.table(ee),ae=Q.optimisticOps.filter(function(Te){return Te.trans===F});if(F._explicit&&W&&F.mutatedParts)for(var re=0,se=Object.values(Q.queries.query);re<se.length;re++)for(var le=0,pe=(De=se[re]).slice();le<pe.length;le++)Kr((we=pe[le]).obsSet,F.mutatedParts)&&(J(De,we),we.subscribers.forEach(function(Te){return X.add(Te)}));else if(0<ae.length){Q.optimisticOps=Q.optimisticOps.filter(function(Te){return Te.trans!==F});for(var ye=0,be=Object.values(Q.queries.query);ye<be.length;ye++)for(var De,we,Ee,Ie=0,Ce=(De=be[ye]).slice();Ie<Ce.length;Ie++)(we=Ce[Ie]).res!=null&&F.mutatedParts&&(W&&!we.dirty?(Ee=Object.isFrozen(we.res),Ee=Sa(we.res,we.req,ae,ie,we,Ee),we.dirty?(J(De,we),we.subscribers.forEach(function(Te){return X.add(Te)})):Ee!==we.res&&(we.res=Ee,we.promise=Se.resolve({result:Ee}))):(we.dirty&&J(De,we),we.subscribers.forEach(function(Te){return X.add(Te)})))}}}X.forEach(function(Te){return Te()})}}},F.addEventListener("abort",_(!1),{signal:R}),F.addEventListener("error",_(!1),{signal:R}),F.addEventListener("complete",_(!0),{signal:R})),F},table:function(g){var m=o.table(g),_=m.schema.primaryKey;return n(n({},m),{mutate:function(A){var R=ze.trans;if(_.outbound||R.db._options.cache==="disabled"||R.explicit||R.idbtrans.mode!=="readwrite")return m.mutate(A);var F=Wt["idb://".concat(u,"/").concat(g)];return F?(R=m.mutate(A),A.type!=="add"&&A.type!=="put"||!(50<=A.values.length||kr(_,A).some(function(W){return W==null}))?(F.optimisticOps.push(A),A.mutatedParts&&Wr(A.mutatedParts),R.then(function(W){0<W.numFailures&&(J(F.optimisticOps,A),(W=Xr(0,A,W))&&F.optimisticOps.push(W),A.mutatedParts&&Wr(A.mutatedParts))}),R.catch(function(){J(F.optimisticOps,A),A.mutatedParts&&Wr(A.mutatedParts)})):R.then(function(W){var X=Xr(0,n(n({},A),{values:A.values.map(function(Z,H){var ee;return W.failures[H]?Z:(Z=(ee=_.keyPath)!==null&&ee!==void 0&&ee.includes(".")?B(Z):n({},Z),S(Z,_.keyPath,W.results[H]),Z)})}),W);F.optimisticOps.push(X),queueMicrotask(function(){return A.mutatedParts&&Wr(A.mutatedParts)})}),R):m.mutate(A)},query:function(A){if(!or(ze,m)||!fn("query",A))return m.query(A);var R=((X=ze.trans)===null||X===void 0?void 0:X.db._options.cache)==="immutable",H=ze,F=H.requery,W=H.signal,X=function(ie,ae,re,se){var le=Wt["idb://".concat(ie,"/").concat(ae)];if(!le)return[];if(!(ae=le.queries[re]))return[null,!1,le,null];var pe=ae[(se.query?se.query.index.name:null)||""];if(!pe)return[null,!1,le,null];switch(re){case"query":var ye=pe.find(function(be){return be.req.limit===se.limit&&be.req.values===se.values&&Aa(be.req.query.range,se.query.range)});return ye?[ye,!0,le,pe]:[pe.find(function(be){return("limit"in be.req?be.req.limit:1/0)>=se.limit&&(!se.values||be.req.values)&&xo(be.req.query.range,se.query.range)}),!1,le,pe];case"count":return ye=pe.find(function(be){return Aa(be.req.query.range,se.query.range)}),[ye,!!ye,le,pe]}}(u,g,"query",A),Z=X[0],H=X[1],ee=X[2],Q=X[3];return Z&&H?Z.obsSet=A.obsSet:(H=m.query(A).then(function(ie){var ae=ie.result;if(Z&&(Z.res=ae),R){for(var re=0,se=ae.length;re<se;++re)Object.freeze(ae[re]);Object.freeze(ae)}else ie.result=B(ae);return ie}).catch(function(ie){return Q&&Z&&J(Q,Z),Promise.reject(ie)}),Z={obsSet:A.obsSet,promise:H,subscribers:new Set,type:"query",req:A,dirty:!1},Q?Q.push(Z):(Q=[Z],(ee=ee||(Wt["idb://".concat(u,"/").concat(g)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[A.query.index.name||""]=Q)),Eo(Z,Q,F,W),Z.promise.then(function(ie){return{result:Sa(ie.result,A,ee==null?void 0:ee.optimisticOps,m,Z,R)}})}})}})}};function Vr(o,u){return new Proxy(o,{get:function(g,m,_){return m==="db"?u:Reflect.get(g,m,_)}})}var pn=(tt.prototype.version=function(o){if(isNaN(o)||o<.1)throw new ce.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var u=this._versions,g=u.filter(function(m){return m._cfg.version===o})[0];return g||(g=new this.Version(o),u.push(g),u.sort(yo),g.stores({}),this._state.autoSchema=!1,g)},tt.prototype._whenReady=function(o){var u=this;return this.idbdb&&(this._state.openComplete||ze.letThrough||this._vip)?o():new Se(function(g,m){if(u._state.openComplete)return m(new ce.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void m(new ce.DatabaseClosed);u.open().catch(ke)}u._state.dbReadyPromise.then(g,m)}).then(o)},tt.prototype.use=function(o){var u=o.stack,g=o.create,m=o.level,_=o.name;return _&&this.unuse({stack:u,name:_}),o=this._middlewares[u]||(this._middlewares[u]=[]),o.push({stack:u,create:g,level:m??10,name:_}),o.sort(function(A,R){return A.level-R.level}),this},tt.prototype.unuse=function(o){var u=o.stack,g=o.name,m=o.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(_){return m?_.create!==m:!!g&&_.name!==g})),this},tt.prototype.open=function(){var o=this;return Bt(Nt,function(){return bo(o)})},tt.prototype._close=function(){var o=this._state,u=$n.indexOf(this);if(0<=u&&$n.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new Se(function(g){o.dbReadyResolve=g}),o.openCanceller=new Se(function(g,m){o.cancelOpen=m}))},tt.prototype.close=function(g){var u=(g===void 0?{disableAutoOpen:!0}:g).disableAutoOpen,g=this._state;u?(g.isBeingOpened&&g.cancelOpen(new ce.DatabaseClosed),this._close(),g.autoOpen=!1,g.dbOpenError=new ce.DatabaseClosed):(this._close(),g.autoOpen=this._options.autoOpen||g.isBeingOpened,g.openComplete=!1,g.dbOpenError=null)},tt.prototype.delete=function(o){var u=this;o===void 0&&(o={disableAutoOpen:!0});var g=0<arguments.length&&typeof arguments[0]!="object",m=this._state;return new Se(function(_,A){function R(){u.close(o);var F=u._deps.indexedDB.deleteDatabase(u.name);F.onsuccess=Je(function(){var W,X,Z;W=u._deps,X=u.name,Z=W.indexedDB,W=W.IDBKeyRange,Mi(Z)||X===hr||Ii(Z,W).delete(X).catch(ke),_()}),F.onerror=Kt(A),F.onblocked=u._fireOnBlocked}if(g)throw new ce.InvalidArgument("Invalid closeOptions argument to db.delete()");m.isBeingOpened?m.dbReadyPromise.then(R):R()})},tt.prototype.backendDB=function(){return this.idbdb},tt.prototype.isOpen=function(){return this.idbdb!==null},tt.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},tt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},tt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tt.prototype,"tables",{get:function(){var o=this;return s(this._allTables).map(function(u){return o._allTables[u]})},enumerable:!1,configurable:!0}),tt.prototype.transaction=function(){var o=(function(u,g,m){var _=arguments.length;if(_<2)throw new ce.InvalidArgument("Too few arguments");for(var A=new Array(_-1);--_;)A[_-1]=arguments[_];return m=A.pop(),[u,j(A),m]}).apply(this,arguments);return this._transaction.apply(this,o)},tt.prototype._transaction=function(o,u,g){var m=this,_=ze.trans;_&&_.db===this&&o.indexOf("!")===-1||(_=null);var A,R,F=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if(R=u.map(function(X){if(X=X instanceof m.Table?X.name:X,typeof X!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return X}),o=="r"||o===Zn)A=Zn;else{if(o!="rw"&&o!=$r)throw new ce.InvalidArgument("Invalid transaction mode: "+o);A=$r}if(_){if(_.mode===Zn&&A===$r){if(!F)throw new ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");_=null}_&&R.forEach(function(X){if(_&&_.storeNames.indexOf(X)===-1){if(!F)throw new ce.SubTransaction("Table "+X+" not included in parent transaction.");_=null}}),F&&_&&!_.active&&(_=null)}}catch(X){return _?_._promise(null,function(Z,H){H(X)}):et(X)}var W=(function X(Z,H,ee,Q,ie){return Se.resolve().then(function(){var ae=ze.transless||ze,re=Z._createTransaction(H,ee,Z._dbSchema,Q);if(re.explicit=!0,ae={trans:re,transless:ae},Q)re.idbtrans=Q.idbtrans;else try{re.create(),re.idbtrans._explicit=!0,Z._state.PR1398_maxLoop=3}catch(pe){return pe.name===Oe.InvalidState&&Z.isOpen()&&0<--Z._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),Z.close({disableAutoOpen:!1}),Z.open().then(function(){return X(Z,H,ee,null,ie)})):et(pe)}var se,le=oe(ie);return le&&Ot(),ae=Se.follow(function(){var pe;(se=ie.call(re,re))&&(le?(pe=$e.bind(null,null),se.then(pe,pe)):typeof se.next=="function"&&typeof se.throw=="function"&&(se=Ar(se)))},ae),(se&&typeof se.then=="function"?Se.resolve(se).then(function(pe){return re.active?pe:et(new ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ae.then(function(){return se})).then(function(pe){return Q&&re._resolve(),re._completion.then(function(){return pe})}).catch(function(pe){return re._reject(pe),et(pe)})})}).bind(null,this,A,R,_,g);return _?_._promise(A,W,"lock"):ze.trans?Bt(ze.transless,function(){return m._whenReady(W)}):this._whenReady(W)},tt.prototype.table=function(o){if(!b(this._allTables,o))throw new ce.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},tt);function tt(o,u){var g=this;this._middlewares={},this.verno=0;var m=tt.dependencies;this._options=u=n({addons:tt.addons,autoOpen:!0,indexedDB:m.indexedDB,IDBKeyRange:m.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},m=u.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var _,A,R,F,W,X={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};X.dbReadyPromise=new Se(function(H){X.dbReadyResolve=H}),X.openCanceller=new Se(function(H,ee){X.cancelOpen=ee}),this._state=X,this.name=o,this.on=fr(this,"populate","blocked","versionchange","close",{ready:[at,ke]}),this.on.ready.subscribe=z(this.on.ready.subscribe,function(H){return function(ee,Q){tt.vip(function(){var ie,ae=g._state;ae.openComplete?(ae.dbOpenError||Se.resolve().then(ee),Q&&H(ee)):ae.onReadyBeingFired?(ae.onReadyBeingFired.push(ee),Q&&H(ee)):(H(ee),ie=g,Q||H(function re(){ie.on.ready.unsubscribe(ee),ie.on.ready.unsubscribe(re)}))})}}),this.Collection=(_=this,pr(ha.prototype,function(se,re){this.db=_;var Q=bi,ie=null;if(re)try{Q=re()}catch(le){ie=le}var ae=se._ctx,re=ae.table,se=re.hook.reading.fire;this._ctx={table:re,index:ae.index,isPrimKey:!ae.index||re.schema.primKey.keyPath&&ae.index===re.schema.primKey.name,range:Q,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ie,or:ae.or,valueMapper:se!==Ke?se:null}})),this.Table=(A=this,pr(da.prototype,function(H,ee,Q){this.db=A,this._tx=Q,this.name=H,this.schema=ee,this.hook=A._allTables[H]?A._allTables[H].hook:fr(null,{creating:[fe,ke],reading:[Le,Ke],updating:[it,ke],deleting:[vt,ke]})})),this.Transaction=(R=this,pr(ga.prototype,function(H,ee,Q,ie,ae){var re=this;this.db=R,this.mode=H,this.storeNames=ee,this.schema=Q,this.chromeTransactionDurability=ie,this.idbtrans=null,this.on=fr(this,"complete","error","abort"),this.parent=ae||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Se(function(se,le){re._resolve=se,re._reject=le}),this._completion.then(function(){re.active=!1,re.on.complete.fire()},function(se){var le=re.active;return re.active=!1,re.on.error.fire(se),re.parent?re.parent._reject(se):le&&re.idbtrans&&re.idbtrans.abort(),et(se)})})),this.Version=(F=this,pr(mo.prototype,function(H){this.db=F,this._cfg={version:H,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(W=this,pr(jr.prototype,function(H,ee,Q){if(this.db=W,this._ctx={table:H,index:ee===":id"?null:ee,or:Q},this._cmp=this._ascending=Ye,this._descending=function(ie,ae){return Ye(ae,ie)},this._max=function(ie,ae){return 0<Ye(ie,ae)?ie:ae},this._min=function(ie,ae){return Ye(ie,ae)<0?ie:ae},this._IDBKeyRange=W._deps.IDBKeyRange,!this._IDBKeyRange)throw new ce.MissingAPI})),this.on("versionchange",function(H){0<H.newVersion?console.warn("Another connection wants to upgrade database '".concat(g.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(g.name,"'. Closing db now to resume the delete request.")),g.close({disableAutoOpen:!1})}),this.on("blocked",function(H){!H.newVersion||H.newVersion<H.oldVersion?console.warn("Dexie.delete('".concat(g.name,"') was blocked")):console.warn("Upgrade '".concat(g.name,"' blocked by other connection holding version ").concat(H.oldVersion/10))}),this._maxKey=hn(u.IDBKeyRange),this._createTransaction=function(H,ee,Q,ie){return new g.Transaction(H,ee,Q,g._options.chromeTransactionDurability,ie)},this._fireOnBlocked=function(H){g.on("blocked").fire(H),$n.filter(function(ee){return ee.name===g.name&&ee!==g&&!ee._state.vcFired}).map(function(ee){return ee.on("versionchange").fire(H)})},this.use(Ea),this.use(_o),this.use(_a),this.use(Yr),this.use(wo);var Z=new Proxy(this,{get:function(H,ee,Q){if(ee==="_vip")return!0;if(ee==="table")return function(ae){return Vr(g.table(ae),Z)};var ie=Reflect.get(H,ee,Q);return ie instanceof da?Vr(ie,Z):ee==="tables"?ie.map(function(ae){return Vr(ae,Z)}):ee==="_createTransaction"?function(){return Vr(ie.apply(this,arguments),Z)}:ie}});this.vip=Z,m.forEach(function(H){return H(g)})}var Qr,l=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",c=(p.prototype.subscribe=function(o,u,g){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:u,complete:g})},p.prototype[l]=function(){return this},p);function p(o){this._subscribe=o}try{Qr={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{Qr={indexedDB:null,IDBKeyRange:null}}function v(o){var u,g=!1,m=new c(function(_){var A=oe(o),R,F=!1,W={},X={},Z={get closed(){return F},unsubscribe:function(){F||(F=!0,R&&R.abort(),H&&dn.storagemutated.unsubscribe(Q))}};_.start&&_.start(Z);var H=!1,ee=function(){return mi(ie)},Q=function(ae){Sr(W,ae),Kr(X,W)&&ee()},ie=function(){var ae,re,se;!F&&Qr.indexedDB&&(W={},ae={},R&&R.abort(),R=new AbortController,se=function(le){var pe=Qn();try{A&&Ot();var ye=un(o,le);return ye=A?ye.finally($e):ye}finally{pe&&En()}}(re={subscr:ae,signal:R.signal,requery:ee,querier:o,trans:null}),Promise.resolve(se).then(function(le){g=!0,u=le,F||re.signal.aborted||(W={},function(pe){for(var ye in pe)if(b(pe,ye))return;return 1}(X=ae)||H||(dn(An,Q),H=!0),mi(function(){return!F&&_.next&&_.next(le)}))},function(le){g=!1,["DatabaseClosedError","AbortError"].includes(le==null?void 0:le.name)||F||mi(function(){F||_.error&&_.error(le)})}))};return setTimeout(ee,0),Z});return m.hasValue=function(){return g},m.getValue=function(){return u},m}var x=pn;function k(o){var u=$;try{$=!0,dn.storagemutated.fire(o),Li(o,!0)}finally{$=u}}w(x,n(n({},Re),{delete:function(o){return new x(o,{addons:[]}).delete()},exists:function(o){return new x(o,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return u=x.dependencies,g=u.indexedDB,u=u.IDBKeyRange,(Mi(g)?Promise.resolve(g.databases()).then(function(m){return m.map(function(_){return _.name}).filter(function(_){return _!==hr})}):Ii(g,u).toCollection().primaryKeys()).then(o)}catch{return et(new ce.MissingAPI)}var u,g},defineClass:function(){return function(o){f(this,o)}},ignoreTransaction:function(o){return ze.trans?Bt(ze.transless,o):o()},vip:Pi,async:function(o){return function(){try{var u=Ar(o.apply(this,arguments));return u&&typeof u.then=="function"?u:Se.resolve(u)}catch(g){return et(g)}}},spawn:function(o,u,g){try{var m=Ar(o.apply(g,u||[]));return m&&typeof m.then=="function"?m:Se.resolve(m)}catch(_){return et(_)}},currentTransaction:{get:function(){return ze.trans||null}},waitFor:function(o,u){return u=Se.resolve(typeof o=="function"?x.ignoreTransaction(o):o).timeout(u||6e4),ze.trans?ze.trans.waitFor(u):u},Promise:Se,debug:{get:function(){return Ve},set:function(o){ht(o)}},derive:D,extend:f,props:w,override:z,Events:fr,on:dn,liveQuery:v,extendObservabilitySet:Sr,getByKeyPath:K,setByKeyPath:S,delByKeyPath:function(o,u){typeof u=="string"?S(o,u,void 0):"length"in u&&[].map.call(u,function(g){S(o,g,void 0)})},shallowClone:G,deepClone:B,getObjectDiff:zi,cmp:Ye,asap:L,minKey:-1/0,addons:[],connections:$n,errnames:Oe,dependencies:Qr,cache:Wt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,u,g){return o+u/Math.pow(10,2*g)})})),x.maxKey=hn(x.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(dn(An,function(o){$||(o=new CustomEvent(Ei,{detail:o}),$=!0,dispatchEvent(o),$=!1)}),addEventListener(Ei,function(o){o=o.detail,$||k(o)}));var T,$=!1,U=function(){};return typeof BroadcastChannel<"u"&&((U=function(){(T=new BroadcastChannel(Ei)).onmessage=function(o){return o.data&&k(o.data)}})(),typeof T.unref=="function"&&T.unref(),dn(An,function(o){$||T.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!pn.disableBfCache&&o.persisted){Ve&&console.debug("Dexie: handling persisted pagehide"),T!=null&&T.close();for(var u=0,g=$n;u<g.length;u++)g[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!pn.disableBfCache&&o.persisted&&(Ve&&console.debug("Dexie: handling persisted pageshow"),U(),k({all:new yt(-1/0,[[]])}))})),Se.rejectionMapper=function(o,u){return!o||o instanceof ue||o instanceof TypeError||o instanceof SyntaxError||!o.name||!Pe[o.name]?o:(u=new Pe[o.name](u||o.message,o),"stack"in o&&I(u,"stack",{get:function(){return this.inner.stack}}),u)},ht(Ve),n(pn,Object.freeze({__proto__:null,Dexie:pn,liveQuery:v,Entity:qr,cmp:Ye,PropModification:yr,replacePrefix:function(o,u){return new yr({replacePrefix:[o,u]})},add:function(o){return new yr({add:o})},remove:function(o){return new yr({remove:o})},default:pn,RangeSet:yt,mergeRanges:Cn,rangesOverlap:Dn}),{default:pn}),pn})}(Xa)),Xa.exports}var rb=nb();const gu=Mt(rb),ad=Symbol.for("Dexie"),yu=globalThis[ad]||(globalThis[ad]=gu);if(gu.semVer!==yu.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${gu.semVer} and ${yu.semVer}`);const It=new yu("GraphStudioDB");It.version(1).stores({settings:"",history:"++id,timestamp"});class ib{constructor(e,t="mixed"){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.layout=e.layout,this.generator=new Z0(this),this.metric=new Sh(this),this.graphsPanel=new J0(this),this.facePanel=new eb(this),this.needsRedraw={node:!0,edge:!0,face:!0,rect:!1},this._saveQueue=Promise.resolve(),this.index=-1,this.cut=!1,this._cutNode=[],this.graphClass={directed:Jv,undirected:em,mixed:yi},this._graph=Bn.empty(this.graphClass[t],0),this._graph.updateAttributes(n=>({...n,label:"Graph",id:0,selected:!1})),this.graphs={index:0,all:[this._graph]},this.selectNodeIndex=0,this.selectEdgeIndex=0,this.subGraph=void 0,this.init()}init(){this.setupEventListeners(),this.graphsPanel.init(),this.facePanel.init()}get graph(){return this.graphs.all[this.graphs.index]}set graph(e){e.mergeAttributes(this.graphs.all[this.graphs.index].getAttributes()),this.graphs.all[this.graphs.index]=e}addNode(e,t){this.graph.addNode(e,t),this.saveGraphState("add node")}async updateIndex(e=null){const t=await It.history.count();if(e<0)return console.log("Nothing to Undo...",e,t),!1;if(e>=t)return console.log("Nothing to Redo...",e,t),!1;e===null?this.index=t-1:this.index=e;const n=await this.getSnapshot(this.index);return this.loadSnapshot(n),this.refresh(),!0}clearTo(e="mixed"){this.eventBus.emit("updateSetting",{key:"type",value:e}),this.graph=Bn.empty(this.graphClass[e],0),this.saveGraphState(`new ${e}`)}setupEventListeners(){this.eventBus.on("redo",async e=>{await this.updateIndex(this.index+1)}),this.eventBus.on("undo",async e=>{await this.updateIndex(this.index-1)})}saveGraphState(e="",t=!0){this._saveQueue=this._saveQueue.then(()=>this._performSaveGraphState(e,t)).catch(n=>{console.error("Error saving graph state:",n)})}async _performSaveGraphState(e="",t=!0){var i;const n=await this.getSnapshot(this.index);if(n&&await It.history.where("timestamp").above(n.timestamp).delete(),this.settings.saveHistory){const a=((i=this.settings)==null?void 0:i.historyLimit)||100,s={version:1,index:this.graphs.index,all:this.graphs.all.map(d=>d.export()),timestamp:Date.now(),action:e};await this.saveHistory(s),this.index++>=a&&(this.index=a-1),this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),t&&this.app.updateSimulation(),this.redraw()}}redraw(e={node:!0,edge:!0,face:!0,rect:!0}){this.needsRedraw=e,setTimeout(()=>{this.needsRedraw={node:!1,edge:!1,face:!1,rect:!1}},120)}makeGraphComplete(e="directed"){for(let t=0;t<this.graph.order;t++)for(let n=t+1;n<this.graph.order;n++){const i={color:this.settings.edge_color,selected:!1};this.graph.type=="mixed"?e=="undirected"?this.graph.mergeUndirectedEdge(t,n,i):this.graph.mergeDirectedEdge(t,n,i):this.graph.mergeEdge(t,n,i)}this.saveGraphState("connect all edges")}dropSelected(){const e=this.graph.getSelectedEdges(),t=this.graph.getSelectedNodes();this.graph.getSelectedFaces().forEach(i=>{this.graph.hasFace(i)&&this.graph.dropFace(i)}),e.forEach(i=>{this.graph.hasEdge(i)&&this.graph.dropEdge(i)}),t.forEach(i=>{this.graph.hasNode(i)&&this.graph.dropNode(i)}),this.app.rect.scale.active=!1,this.saveGraphState("remove selected")}connectSelectedNodes(e="directed"){this.graph.connectSelectedNodes(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge`)}connectSelectedNodesInOrder(e="directed"){this.graph.connectSelectedNodesInOrder(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge in order`)}updateSelectedColor(e=!0,t=!0,n=!0,i=!0,a=!0){this.graph.updateSelectedNodesColor(e?this.settings.node_color:!1,t?this.settings.stroke_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedEdgesColor(n?this.settings.edge_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedFacesColor(i?this.settings.face_color:!1,a?this.settings.label_color:!1),this.saveGraphState("update color",!1)}updateSelectedName(e){e?(this.graph.updateSelectedName(e),this.updateSelectedGarphsAttributes({label:e})):this.graph.updateSelectedName(""),this.saveGraphState("update name",!1)}getSelectedGraphs(){return this.graphs.all.filter(e=>e.getAttribute("selected"))}updateSelectedGarphsAttributes(e){this.getSelectedGraphs().forEach(t=>{t.mergeAttributes(e)})}updateSelectedInfo(e){if(e){const t={"":e};this.graph.updateSelectedInfo(t),this.updateSelectedGarphsAttributes({desc:t})}else this.graph.updateSelectedInfo({}),this.updateSelectedGarphsAttributes({desc:{}});this.saveGraphState("update info",!1)}updateSelectedWeight(e){const t=parseFloat(e);t?(this.graph.updateSelectedWeight(t),this.updateSelectedGarphsAttributes({weight:t})):(this.graph.updateSelectedWeight(void 0),this.updateSelectedGarphsAttributes({weight:void 0})),this.saveGraphState("update weight",!1)}deselectAll(){this.deselectAllNode(),this.deselectAllEdge(),this.deselectAllFace(),this.graphsPanel.deselectLis(),this.app.rect.scale.active=!1,this.redraw()}deselectAllNode(){this.graph.updateEachNodeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({node:!0})}deselectAllEdge(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({edge:!0})}deselectAllFace(){this.graph.forEachFace((e,t)=>this.graph.deselectFace(e)),this.app.rect.scale.active=!1,this.redraw({face:!0})}selectAll(e=null){this.selectAllNode(e),this.selectAllEdge(e),this.selectAllFace(e),this.redraw()}selectAllFace(e){this.deselectAllFace(),e?e.forEach(t=>{this.selectFace(t)}):this.graph.updateEachFaceAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({face:!0})}selectAllEdge(e){this.deselectAllEdge(),e?e.forEach(t=>{this.selectEdge(t)}):this.graph.updateEachEdgeAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({edge:!0})}selectAllNode(e){e?(this.deselectAllNode(),e.forEach(t=>{this.graph.hasNode(t)&&this.graph.updateNodeAttributes(t,n=>({...n,selected:n.id+1}))})):this.graph.updateEachNodeAttributes((t,n)=>({...n,selected:n.id+1})),this.redraw({node:!0})}selectNode(e){this.graph.selectNode(e)}selectFace(e){this.graph.selectFace(e)}selectEdge(e){this.graph.selectEdge(e)}selectNextNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=Na(this.selectNodeIndex+1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectPerviousNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=Na(this.selectNodeIndex-1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectNextEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=Na(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}selectPerviousEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=Na(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}copySubgraph(){const e=this.graph.getSelectedNodes();return e.length===0?null:(this.subGraph=this.graph.subgraph(e),this.cut=!1,this.subGraph)}cutSubgraph(){if(this._cutNode=this.graph.getSelectedNodes(),this._cutNode.length===0)return null;this.subGraph=this.graph.subgraph(this._cutNode),this.cut=!0,this.redraw()}pasteSubgraph(e=!1,t={x:150,y:100}){if(this.subGraph){this.subGraph.forEachNode((n,i)=>{const a={...i};"x"in a&&(a.x+=t.x),"y"in a&&(a.y+=t.y),this.subGraph.replaceNodeAttributes(n,a)}),this.deselectAll(),this.graph.mergeWith(this.subGraph);for(const n of this._cutNode)this.graph.dropNode(n);this.cut=!1,this._cutNode.length=0,this.saveGraphState()}}reverseGraph(){if(this.graph.type!=="undirected"){const e=ui.reverse(this.graph);this.graph.replace(e),this.saveGraphState()}}toDirectedGraph(){if(this.graph.type!=="directed"){const e=ui.toDirected(this.graph);this.clearTo("directed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"directed"}),this.saveGraphState()}}toMixedGraph(){if(this.graph.type!=="mixed"){const e=ui.toMixed(this.graph);this.clearTo("mixed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"mixed"}),this.saveGraphState()}}toUndirectedGraph(){if(this.graph.type!=="undirected"){const e=ui.toUndirected(this.graph);this.clearTo("undirected"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"undirected"}),this.saveGraphState()}}toWeighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:1})),this.saveGraphState("add weight to all edge")}toUnweighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:void 0})),this.saveGraphState("remove weight from all edge")}async saveHistory(e){var t;try{await It.history.add(e);const n=((t=this.settings)==null?void 0:t.historyLimit)||100,i=await It.history.count();if(i>n){const s=(await It.history.orderBy("id").limit(i-n).toArray()).map(d=>d.id);await It.history.bulkDelete(s),console.log(`Pruned ${s.length} old history snapshots.`)}}catch(n){console.error("Failed to save history snapshot:",n)}}async getLastSnapshot(){return await It.history.orderBy("id").reverse().first()}async getSnapshot(e){return await It.history.orderBy("id").offset(e).limit(1).first()}loadSnapshot(e){this.graphs={index:e.index,all:[]};for(const t of e.all){const n=Bn.empty(this.graphClass[t.options.type],0);this.graphs.all.push(n.import(t))}}refresh(){this.eventBus.emit("updateSetting",{key:"type",value:this.graphs.all[0].type}),this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),this.app.updateSimulation(),this.redraw()}async clearHistory(){await It.history.clear(),this.index=-1,console.log("History table cleared.")}subgraph(){if(!this.graph.getSelectedNodes().length){this.metric.addHeader("Graphs"),this.metric.addInfo("Select at least one node"),this.metric.addLine();return}this.subGraph=this.copySubgraph(),this.subGraph.removeAttribute("id"),this.subGraph.removeAttribute("label"),this.graphs.all.push(this.subGraph),this.subGraph.deselectAll(),this.deselectAll(),this.saveGraphState("add subgraph")}addFace(){const e=this.graph.getSelectedNodes(),t=ui.subgraph(this.graph,e);this.metric._isCycle(t)&&(this.graph.addFace(e),this.saveGraphState("add face"))}}const ab="Shortcuts",ob={n:{desc:"New graph",action:"new-mixed-btn"},o:{desc:"Import graph",action:"import-graph"},s:{desc:"Scale",action:"toggle-scale-btn",value:!0},u:{desc:"Undo",action:"undo-btn"},d:{desc:"Delete",action:"remove-selection-btn"},c:{desc:"Update color",action:"color-selection-btn"},e:{desc:"Add edge",action:"add-edge-btn"},"alt+e":{desc:"Add edge",action:"add-edge-in-order-btn"},a:{desc:"All node info",action:"all-node-info-btn"},q:{desc:"Clear panel",action:"clear-info-panel-btn"},y:{desc:"Copy",action:"copy-subgraph"},x:{desc:"Cut",action:"cut-subgraph"},p:{desc:"Paste",action:"paste-subgraph"},"ctrl+p":{desc:"Paste",action:"paste-subgraph-seprate"},r:{desc:"Rename",action:"rename-btn"},i:{desc:"Info",action:"desc-btn"},w:{desc:"weight",action:"weight-btn"},f:{desc:"Force Simulation",action:"toggle-force-btn",value:!0},"ctrl+f":{desc:"Force Simulation",action:"add-face-btn"},t:{desc:"Tree",action:"toggle-tree-btn",value:!0},F5:{desc:"Reload",action:"reload"},ArrowUp:{desc:"Select all node",action:"select-all-node"},ArrowDown:{desc:"Deselect all node",action:"deselect-all-node"},ArrowRight:{desc:"Select next node",action:"select-next-node"},ArrowLeft:{desc:"Select previous node",action:"select-pervious-node"},"shift+ArrowRight":{desc:"Select next node",action:"select-next-node"},"shift+ArrowLeft":{desc:"Select previous node",action:"select-pervious-node"},shift:{desc:"Select",action:"toggle-select-btn",value:!0},alt:{desc:"Component",action:"toggle-component-btn",value:!0},ctrl:{desc:"Panning",action:"toggle-panning-btn",value:!0},"alt+a":{desc:"All edge info",action:"all-edge-info-btn"},"alt+ArrowUp":{desc:"Select all edge",action:"select-all-edge"},"alt+ArrowDown":{desc:"Deselect all edge",action:"deselect-all-edge"},"alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"shift+alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"shift+alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"ctrl+r":{desc:"Redo",action:"redo-btn"},"ctrl+s":{desc:"Export graph",action:"export-graph"},C:{desc:"Complete",action:"complete-btn"},"alt+C":{desc:"Complete",action:"complete-directed-btn"},O:{desc:"Organize circle",action:"organize-circle"},E:{desc:"Add directed edge",action:"add-directed-edge-btn"},"alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},P:{desc:"Export PNG",action:"export-png"},"shift+C":{desc:"Complete",action:"complete-btn"},"shift+alt+C":{desc:"Complete",action:"complete-directed-btn"},"shift+O":{desc:"Organize circle",action:"organize-circle"},"shift+alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},"shift+E":{desc:"Add directed edge",action:"add-directed-edge-btn"},"shift+P":{desc:"Export PNG",action:"export-png"},space:{desc:"Home",action:{c:{desc:"+ Color",action:{c:{desc:"Color Picker",action:"color-picker-btn"},n:{desc:"Update Node Color",action:"update-node-color"},s:{desc:"Update Stroke Color",action:"update-stroke-color"},e:{desc:"Update Edge Color",action:"update-edge-color"},l:{desc:"Update Label Color",action:"update-label-color"}}},n:{desc:"+ New Graph",action:{m:{desc:"Mixed Graph",action:"new-mixed-btn"},d:{desc:"Directed Graph",action:"new-digraph-btn"},u:{desc:"Undirected Graph",action:"new-undirected-graph-btn"}}},"⇒":{desc:"Next Node (Alt for Edge)",action:""},"⇐":{desc:"Pervious Node (Alt for Edge)",action:""},"⇑":{desc:"Select all Nodes (Alt for Edges)",action:""},"⇓":{desc:"Deselect all Nodes (Alt for Edges)",action:""}}}},Ua={desc:ab,action:ob},Ft=document;class sb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.eventKeyMap={AltRight:"alt",ControlRight:"ctrl",ShiftRight:"shift",AltLeft:"alt",ControlLeft:"ctrl",ShiftLeft:"shift",Space:"space"},this.pressedKeys=new Set,this.lastChord=Ua.action.space.action,this.modalChord=Ft.querySelector(".modal-chord"),this.inputModal=Ft.querySelector(".modal-input"),this._input=!1,this.header=Ft.querySelector(".modal-chord .shortcut-chord .header"),this.fakeHeader=Ft.querySelector(".modal-chord  .shortcut-chord-fake .header"),this._Chord=Ft.querySelector(".shortcut-chord"),this.fakeChord=Ft.querySelector(".shortcut-chord-fake"),this.exceptionKey=["ArrowUp","ArrowDown","arrowLeft","ArrowRight"]}init(){this.chordGenerator(this.lastChord),Ft.addEventListener("keydown",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const n=this.updatePressedKeys(t,"add");if(this._input){if(n==="Escape"&&this.toggleInput("rename",!1),n==="Enter"){const i=Ft.querySelector(".input-chord input");this.app.menu.handleMenuAction(this._input,i.value),this.toggleInput("rename",!1)}}else{this.isChordVisible()&&this.eventBus.on("key:down",{key:this.pressedKeys});const i=this.findKey();i?t.preventDefault():this.pressedKeys.clear(),this.action(i)}}),Ft.addEventListener("keyup",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const n=this.updatePressedKeys(t,"delete");this._input||(t.preventDefault(),this.lastChord[n]&&typeof this.lastChord[n].value=="boolean"&&this.app.menu.handleMenuAction(this.lastChord[n].action,!this.lastChord[n].value)),this.eventBus.emit("key:up",{key:this.pressedKeys})});const e=Ft.querySelectorAll(".modal, .modal-chord, .modal-input");e.length>0&&e.forEach(t=>{t.addEventListener("click",n=>{n.target===t&&(t.style.display="none",this.lastChord=Ua.action,this._input=!1)})})}chordGenerator(e){const t=Ft.createElement("ul");for(const a in e){const s=e[a].desc,d=Ft.createElement("li");d.innerHTML=`
      <span class="title">${a}</span>
      <span class="arrow">→</span>
      <span class="desc">${s}</span>
    `,t.appendChild(d)}const n=this._Chord.querySelector("ul");n&&this._Chord.removeChild(n);const i=this.fakeChord.querySelector("ul");i&&this.fakeChord.removeChild(i),this._Chord.appendChild(t),this.fakeChord.appendChild(t.cloneNode(!0))}action(e){const t=this.lastChord[e];t?typeof t.action=="string"?(this.app.menu.handleMenuAction(t.action,t.value),this.lastChord=Ua.action,this.toggleChord(!1)):(this.lastChord=t.action,this.chordGenerator(this.lastChord),this.toggleChord(!0)):(this.toggleChord(!1),this.lastChord=Ua.action)}toggleChord(e=!0){e?this.modalChord.style.display="flex":this.modalChord.style.display="none"}toggleInput(e="rename",t=!0){const n=Ft.querySelector(".input-chord .header"),i=Ft.querySelector(".input-chord input");switch(e){case"rename":n.textContent="Rename",i.name="rename",i.placeholder="Enter New Name ...";break;case"desc":n.textContent="Description",i.name="desc",i.placeholder="Enter New Description ...";break;case"weight":n.textContent="Weight",i.name="weight",i.placeholder="Enter New Weight ...";break}t?(this.inputModal.style.display="flex",i.focus(),this._input=e):(this.inputModal.style.display="none",this._input=!1),setTimeout(()=>{i.value=""},1)}findKey(){return Object.keys(this.lastChord).find(n=>{const i=n.split("+");return this.isCombo(...i)})}isCombo(...e){return e.every(t=>this.pressedKeys.has(t))&&this.pressedKeys.size===e.length}updatePressedKeys(e,t="add"){const n=this.eventKeyMap[e.code]||e.key;return t==="add"&&n!=="meta"?this.pressedKeys.add(n):this.pressedKeys.delete(n),n}isShiftHold(){return this.pressedKeys.has("shift")}isCtrlHold(){return this.pressedKeys.has("ctrl")}isChordVisible(){return this.modalChord.style.display!=="none"}}const nt=document;function Va(r,e){nt.querySelector(".container").classList.toggle("grid-hidden",r.grid<=2),nt.getElementById("grid-size-1").value=r.grid,nt.getElementById("vertex-size-1").value=r.node_radius,nt.getElementById("edge-size-1").value=r.edge_size,nt.getElementById("label-size-1").value=r.label_size,nt.getElementById("history-limit-1").value=r.historyLimit,nt.querySelector("#vertex-label .check").classList.toggle("hidden",!r.vertexLabel),nt.querySelector("#edge-label .check").classList.toggle("hidden",!r.edgeLabel),nt.querySelector("#face-label .check").classList.toggle("hidden",!r.faceLabel),nt.querySelector("#weight-label .check").classList.toggle("hidden",!r.weightLabel),nt.querySelector("#performance .check").classList.toggle("hidden",!r.performance),nt.querySelector("#save-history .check").classList.toggle("hidden",!r.saveHistory),nt.querySelector("#component").classList.toggle("gray-background",!r.component),nt.querySelector("#scale").classList.toggle("gray-background",!r.scale),nt.querySelector("#force-edge-btn .check").classList.toggle("hidden",!r.force_edge),nt.querySelector("#tree").classList.toggle("gray-background",!r.tree),nt.querySelector("#force").classList.toggle("gray-background",!r.forceSimulation),nt.querySelector("#colorPicker").classList.toggle("gray-background",!r.colorPicker),nt.querySelector("#panning").classList.toggle("gray-background",!r.panning),nt.querySelector("#select").classList.toggle("gray-background",!r.select),e.style.cursor=r.panning?"move":"default";const t=nt.documentElement;nt.querySelector(".container").classList.toggle("grid-hidden",r.grid<=2),t.style.setProperty("--grid-size",`${r.grid}px`),t.style.setProperty("--grid-color",r.grid_color),nt.querySelector(".container").style.backgroundColor=r.background_color}var Pr;const ci=class ci{constructor(e){Uu(this,Pr,!0);if(this.app=e,this.eventBus=e.eventBus,ci.instance)return ci.instance;ci.instance=this,this.debounceTimer=null,this.defaultSettings={background_color:"#ffffff",colorPicker:!1,component:!1,console_panel:!0,directed:!0,directed_edge:!0,edgeLabel:!0,edge_color:"#4682b4",edge_size:2,forceSimulation:!0,force_edge:!0,grid:20,type:"mixed",grid_color:"#00000020",info_panel:!0,label_color:"#000000",label_pos:{x:0,y:0},label_size:15,node_color:"#ffffff",face_color:"#4682b455",node_radius:40,panning:!1,scale:!1,select:!1,stroke_color:"#4682b4",stroke_size:2,tools_panel:!0,tree:!0,vertexLabel:!0,faceLabel:!0,weightLabel:!0,saveHistory:!0,historyLimit:100,graphs_panel:!0,face_panel:!0,performance:!1},this.nightSkyTheme={background_color:"#0d1b2a",edge_color:"#60a5fa",edge_size:1,forceSimulation:!1,grid_color:"#ffffff10",label_color:"#d1d5db",label_pos:{x:-20,y:-20},node_color:"#ffffff",node_radius:10,stroke_color:"#ffffff",stroke_size:0},this.registerEventListeners()}async init(){return this.settings=await this.loadFromIndexDb(),this.settings}registerEventListeners(){this.eventBus.on("updateSetting",e=>{const{key:t,value:n}=e.detail;this.setSetting(t,n)}),this.eventBus.on("updateAllSettings",e=>{const t=e.detail;t&&typeof t=="object"&&this.setAllSettings(t)}),this.eventBus.on("resetSettings",()=>{this.resetToDefault()}),this.eventBus.on("toggleSetting",e=>{const{key:t,value:n}=e.detail;t&&(this.toggleSetting(t,n),this.app.graphManager.needsRedraw={node:t=="vertexLabel",edge:t=="directed_edge"||t=="edgeLabel"||t=="weightLabel",face:t=="faceLabel"})})}async loadFromIndexDb(){try{const e=await It.settings.get("appSettings"),t=this.validateSettings(e);return Object.keys(this.defaultSettings).some(i=>!e||!(i in e))?(await It.settings.put(t,"appSettings"),console.log("Missing or invalid keys found — defaults merged and saved.")):console.log("Settings loaded successfully from IndexedDB."),t}catch(e){return console.warn("Failed to load settings from IndexedDB. Using defaults.",e),{...this.defaultSettings}}}saveToIndexedDB(e=this.settings){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(async()=>{try{await It.settings.update("appSettings",e),console.log("Settings saved to IndexedDB"),this.app.graphManager.needsRedraw={node:!1,edge:!1,face:!1,rect:!1}}catch(t){console.error("Failed to save settings to IndexedDB",t)}},500)}resetToDefault(){this.setAllSettings(this.defaultSettings),this.app.colorPicker.resetColors()}getSetting(e){return this.settings[e]}getAllSettings(){return{...this.settings}}setSetting(e,t){const n=this.settings[e];if(e in this.settings){if(this.settings[e]!==t)switch(this.settings[e]=t,Ca(this,Pr)&&this.settings[e]!=n&&this.saveToIndexedDB({[e]:this.settings[e]}),Va(this.settings,this.app.canvas),e){case"node_radius":this.app.graphManager.needsRedraw={node:!0};break;case"stroke_size":this.app.graphManager.needsRedraw={node:!0};break;case"edge_size":this.app.graphManager.needsRedraw={edge:!0};break;case"label_size":this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0};break}}else console.warn(`Setting "${e}" does not exist.`)}setAllSettings(e){Object.keys(e).forEach(t=>{t in this.settings&&(this.settings[t]=e[t])}),Ca(this,Pr)&&this.saveToIndexedDB(),Va(this.settings,this.app.canvas)}toggleSetting(e,t=null){const n=["scale","panning","select","component"],i=this.settings[e];e in this.settings&&typeof this.settings[e]=="boolean"?(console.log(),t===null?this.settings[e]=!this.settings[e]:this.settings[e]=t,n.includes(e)&&(this.settings.forceSimulation=!1,n.forEach(a=>{a!=e&&this.settings[e]&&(this.settings[a]=!1)})),e==="forceSimulation"&&(this.settings.forceSimulation?(n.forEach(a=>{this.settings[e]&&(this.settings[a]=!1)}),this.app.startSimulation()):this.app.stopSimulation()),e==="force_edge"&&this.app.updateSimulation(),this.settings.performance&&(this.settings.forceSimulation=!1),Ca(this,Pr)&&this.settings[e]!=i&&!n.includes(e)&&this.saveToIndexedDB({[e]:this.settings[e]}),Va(this.settings,this.app.canvas),this.app.widget.init()):console.warn(`Setting "${e}" does not exist or is not a boolean.`)}setAutoSave(e){Ku(this,Pr,e)}validateSettings(e){const t=this.defaultSettings,n={};for(const i in t)n[i]=e!=null&&e.hasOwnProperty(i)?e[i]:t[i];return n}loadNightSkyTheme(){this.setAllSettings(this.nightSkyTheme)}};Pr=new WeakMap,Ct(ci,"instance",null);let vu=ci;const Ge=document;class ub{constructor(e,t,n="menu-bar"){if(this.app=e,this.eventBus=e.eventBus,this.graphManager=e.graphManager,this.appSettings=e.appSettings,this.layout=e.layout,this.menuData=t,this.container=Ge.getElementById(n),!this.container){console.error("Menu container not found!");return}this.spaceEvent=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,which:32,bubbles:!0})}init(){this.renderMenu(),this.attachEventListeners()}renderMenu(){this.container.innerHTML="";const e=Ge.createElement("ul");this.menuData.forEach(t=>{const n=this.createMenu(t);e.appendChild(n)}),this.container.appendChild(e)}createMenu(e){const t=Ge.createElement("li");if(e.id&&(t.id=e.id),e.title&&(t.textContent=e.title),e.submenu){const n=this.createSubmenu(e.submenu);t.appendChild(n)}return t}createSubmenu(e){const t=Ge.createElement("ul");return e.forEach(n=>{if(n.type==="divider"){t.appendChild(Ge.createElement("hr"));return}const i=Ge.createElement("li");if(n.id&&(i.id=n.id),n.title){const a=Ge.createElement("label");if(a.textContent=n.title,n.link){const s=Ge.createElement("a");s.href=n.link,s.target="_blank",n.label?s.textContent=n.label:(s.textContent="?",s.classList.add("border")),a.insertBefore(s,a.firstChild)}i.appendChild(a)}if(n.shortcut){const a=Ge.createElement("span");a.textContent=n.shortcut,i.appendChild(a)}if("check"in n&&!n.shortcut){const a=Ge.createElement("span");a.innerHTML="&#10004;",a.classList.add("check"),n.check||a.classList.add("hidden"),i.appendChild(a)}if(n.input)if(n.id==="import-graph")i.appendChild(this.createInput(n.input[0]));else{const a=Ge.createElement("div");n.input.forEach(s=>{a.appendChild(this.createInput(s))}),i.appendChild(a)}n.name&&i.setAttribute("name",n.name),n.submenu&&i.appendChild(this.createSubmenu(n.submenu)),t.appendChild(i)}),t}createInput(e){const t=Ge.createElement("input");return t.type=e.type||"text",t.id=e.id,"hidden"in e&&(t.hidden=e.hidden),e.name&&(t.name=e.name),e.placeholder&&(t.placeholder=e.placeholder),e.required&&(t.required=!0),["number","range","date"].includes(t.type)&&(e.min!==void 0&&(t.min=e.min),e.max!==void 0&&(t.max=e.max),e.step!==void 0&&(t.step=e.step)),e.value!==void 0&&(e.type==="checkbox"||e.type==="radio"?t.checked=e.value:t.value=e.value),t}handleMenuAction(e,t){const n={"new-mixed-btn":()=>{this.graphManager.clearTo("mixed")},"new-digraph-btn":()=>{this.graphManager.clearTo("directed")},"new-undirected-graph-btn":()=>{this.graphManager.clearTo("undirected")},"import-graph":()=>this.eventBus.emit("import"),"export-graph":()=>this.eventBus.emit("export",{type:"json"}),"export-png":()=>this.eventBus.emit("export",{type:"png"}),"default-settings-btn":()=>this.appSettings.resetToDefault(),"sky-night-theme-btn":()=>this.appSettings.loadNightSkyTheme(),reload:()=>location.reload(),"add-edge-btn":()=>this.graphManager.connectSelectedNodes("undirected"),"add-face-btn":()=>this.graphManager.addFace(),"add-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("undirected"),"add-directed-edge-btn":()=>this.graphManager.connectSelectedNodes("directed"),"add-directed-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("directed"),"remove-selection-btn":()=>this.graphManager.dropSelected(),"color-selection-btn":()=>this.graphManager.updateSelectedColor(!0,!0,!0,!0),"complete-btn":()=>this.graphManager.makeGraphComplete("undirected"),"complete-directed-btn":()=>this.graphManager.makeGraphComplete("directed"),"node-color":()=>this.eventBus.emit("updateSetting",{key:"node_color",value:t}),"edge-color":()=>this.eventBus.emit("updateSetting",{key:"edge_color",value:t}),"label-color":()=>this.eventBus.emit("updateSetting",{key:"label_color",value:t}),"stroke-color":()=>this.eventBus.emit("updateSetting",{key:"stroke_color",value:t}),"background-color":()=>{Ge.querySelector(".container").style.backgroundColor=t,this.eventBus.emit("updateSetting",{key:"background_color",value:t})},"grid-color":()=>{Ge.documentElement.style.setProperty("--grid-color",t),this.eventBus.emit("updateSetting",{key:"grid_color",value:t})},rename:()=>this.graphManager.updateSelectedName(t),"rename-btn":()=>this.app.keyHandler.toggleInput("rename"),desc:()=>this.graphManager.updateSelectedInfo(t),"desc-btn":()=>this.app.keyHandler.toggleInput("desc"),weight:()=>this.graphManager.updateSelectedWeight(t),"weight-btn":()=>this.app.keyHandler.toggleInput("weight"),"redo-btn":()=>this.eventBus.emit("redo"),"undo-btn":()=>this.eventBus.emit("undo"),"panel-btn":()=>this.eventBus.emit("toggleSetting",{key:"info_panel"}),"tools-btn":()=>this.eventBus.emit("toggleSetting",{key:"tools_panel"}),"graphs-btn":()=>this.eventBus.emit("toggleSetting",{key:"graphs_panel"}),"faces-btn":()=>this.eventBus.emit("toggleSetting",{key:"face_panel"}),"shortcut-chord-btn":()=>Ge.dispatchEvent(this.spaceEvent),"component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component"}),"scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale"}),"tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree"}),"force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation"}),"force-edge-btn":()=>this.eventBus.emit("toggleSetting",{key:"force_edge"}),"panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning"}),"select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select"}),"toggle-component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component",value:t}),"toggle-scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale",value:t}),"toggle-tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree",value:t}),"toggle-force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation",value:t}),"toggle-panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning",value:t}),"toggle-select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select",value:t}),"color-picker-btn":()=>this.eventBus.emit("toggleSetting",{key:"colorPicker"}),"vertex-label":()=>this.eventBus.emit("toggleSetting",{key:"vertexLabel"}),"edge-label":()=>this.eventBus.emit("toggleSetting",{key:"edgeLabel"}),"face-label":()=>this.eventBus.emit("toggleSetting",{key:"faceLabel"}),"weight-label":()=>this.eventBus.emit("toggleSetting",{key:"weightLabel"}),"vertex-size-1":()=>this.eventBus.emit("updateSetting",{key:"node_radius",value:t}),"edge-size-1":()=>this.eventBus.emit("updateSetting",{key:"edge_size",value:t}),"label-size-1":()=>this.eventBus.emit("updateSetting",{key:"label_size",value:t}),"grid-size-1":()=>this.eventBus.emit("updateSetting",{key:"grid",value:t}),"stroke-size-1":()=>this.eventBus.emit("updateSetting",{key:"stroke_size",value:t}),performance:()=>this.eventBus.emit("toggleSetting",{key:"performance"}),"save-history":()=>this.eventBus.emit("toggleSetting",{key:"saveHistory"}),"clear-histoory-btn":()=>this.graphManager.clearHistory(),"history-limit-1":()=>{this.graphManager.limit=t,this.eventBus.emit("updateSetting",{key:"historyLimit",value:t})},"basic-info-btn":()=>this.graphManager.metric.basicInfo(),"lies-on-cycle-btn":()=>this.graphManager.metric.liesOnCycle(),"list-degrees-btn":()=>this.graphManager.metric.degreeSequesnce(),"components-btn":()=>this.graphManager.metric.countComponents(),"neighbors-btn":()=>this.graphManager.metric.neighbors(),"shortest-path-btn":()=>this.graphManager.metric.shortestPath(),"density-btn":()=>this.graphManager.metric.density(),"diameter-btn":()=>this.graphManager.metric.diameter(),"eccentricity-btn":()=>this.graphManager.metric.eccentricity(),"simmelian-strength-btn":()=>this.graphManager.metric.simmelianStrength(),"betweenness-centrality-btn":()=>this.graphManager.metric.betweennessCentrality(),"closeness-centrality-btn":()=>this.graphManager.metric.closenessCentrality(),"degree-centrality-btn":()=>this.graphManager.metric.degreeCentrality(),"eigenvector-centrality-btn":()=>this.graphManager.metric.eigenvectorCentrality(),"pagerank-btn":()=>this.graphManager.metric.pagerank(),"edge-uniformity-btn":()=>this.graphManager.metric.edgeUniformity(),"neighborhood-preservation-btn":()=>this.graphManager.metric.neighborhoodPreservation(),"stress-btn":()=>this.graphManager.metric.stress(),"disparity-btn":()=>this.graphManager.metric.disparity(),"clear-info-panel-btn":()=>Ge.querySelector("#floating-panel .body-info").innerHTML="","all-node-info-btn":()=>this.graphManager.metric.allNodeInfo(),"all-edge-info-btn":()=>this.graphManager.metric.allEdgeInfo(),"all-face-info-btn":()=>this.graphManager.metric.allFaceInfo(),"all-graph-info-btn":()=>this.graphManager.metric.allGraphInfo(),empty:()=>this.graphManager.generator.empty(Ge.getElementById("g-empty-1").value),"g-empty-1":()=>this.graphManager.generator.empty(t),cycle:()=>this.graphManager.generator.cycle(Ge.getElementById("g-cycle-1").value),"g-cycle-1":()=>this.graphManager.generator.cycle(t),path:()=>this.graphManager.generator.path(Ge.getElementById("g-path-1").value),"g-path-1":()=>this.graphManager.generator.path(t),ladder:()=>this.graphManager.generator.ladder(Ge.getElementById("g-ladder-1").value),"g-ladder-1":()=>this.graphManager.generator.ladder(t),complete:()=>this.graphManager.generator.complete(Ge.getElementById("g-complete-1").value),"g-complete-1":()=>this.graphManager.generator.complete(t),"complete-bipartite":()=>this.graphManager.generator.completeBipartite(Ge.getElementById("g-complete-bipartite-1").value,Ge.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-1":()=>this.graphManager.generator.completeBipartite(t,Ge.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-2":()=>this.graphManager.generator.completeBipartite(Ge.getElementById("g-complete-bipartite-1").value,t),caveman:()=>this.graphManager.generator.caveman(Ge.getElementById("g-caveman-1").value,Ge.getElementById("g-caveman-2").value),"g-caveman-1":()=>this.graphManager.generator.caveman(t,Ge.getElementById("g-caveman-2").value),"g-caveman-2":()=>this.graphManager.generator.caveman(Ge.getElementById("g-caveman-1").value,t),"connected-caveman":()=>this.graphManager.generator.connectedCaveman(Ge.getElementById("g-connected-caveman-1").value,Ge.getElementById("g-connected-caveman-2").value),"g-connected-caveman-1":()=>this.graphManager.generator.connectedCaveman(t,Ge.getElementById("g-connected-caveman-2").value),"g-connected-caveman-2":()=>this.graphManager.generator.connectedCaveman(Ge.getElementById("g-connected-caveman-1").value,t),clusters:()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,Ge.getElementById("g-clusters-2").value,Ge.getElementById("g-clusters-3").value),"g-clusters-1":()=>this.graphManager.generator.clusters(t,Ge.getElementById("g-clusters-2").value,Ge.getElementById("g-clusters-3").value),"g-clusters-2":()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,t,Ge.getElementById("g-clusters-3").value),"g-clusters-3":()=>this.graphManager.generator.clusters(Ge.getElementById("g-clusters-1").value,Ge.getElementById("g-clusters-2").value,t),"erdos-renyi":()=>this.graphManager.generator.erdosRenyi(Ge.getElementById("g-erdos-renyi-1").value,Ge.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-1":()=>this.graphManager.generator.erdosRenyi(t,Ge.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-2":()=>this.graphManager.generator.erdosRenyi(Ge.getElementById("g-erdos-renyi-1").value,t),"griven-newmn":()=>this.graphManager.generator.girvanNewman(Ge.getElementById("g-girvan-newman-1").value),"g-girvan-newman-1":()=>this.graphManager.generator.girvanNewman(t),"krackhardt-kite":()=>this.graphManager.generator.krackhardtkite(),"florentine-families":()=>this.graphManager.generator.florentineFamilies(),"karate-club":()=>this.graphManager.generator.karateClub(),aries:()=>this.graphManager.generator.zodiac.aries(),taurus:()=>this.graphManager.generator.zodiac.taurus(),gemini:()=>this.graphManager.generator.zodiac.gemini(),cancer:()=>this.graphManager.generator.zodiac.cancer(),leo:()=>this.graphManager.generator.zodiac.leo(),virgo:()=>this.graphManager.generator.zodiac.virgo(),libra:()=>this.graphManager.generator.zodiac.libra(),scorpius:()=>this.graphManager.generator.zodiac.scorpius(),ophiuchus:()=>this.graphManager.generator.zodiac.ophiuchus(),sagittarius:()=>this.graphManager.generator.zodiac.sagittarius(),capricornus:()=>this.graphManager.generator.zodiac.capricornus(),aquarius:()=>this.graphManager.generator.zodiac.aquarius(),pisces:()=>this.graphManager.generator.zodiac.pisces(),"organize-circle":()=>this.layout.applyLayout("circle"),"center-layout":()=>this.layout.applyLayout("center"),"random-layout":()=>this.layout.applyLayout("random"),"rotate-layout-1":()=>this.layout.applyLayout("rotate",t),"rotate-layout":()=>{const i=Ge.getElementById("rotate-layout-1").value;return this.layout.applyLayout("rotate",i)},"hflip-layout":()=>this.layout.applyLayout("h-flip"),"vflip-layout":()=>this.layout.applyLayout("v-flip"),"force-layout":()=>this.layout.applyLayout("force",{itteration:Ge.getElementById("force-itteration").value,gravity:Ge.getElementById("force-gravity").value}),"froce-itteration":()=>this.layout.applyLayout("force",{val:t,gravity:Ge.getElementById("force-gravity").value}),"force-gravity":()=>this.layout.applyLayout("force",{itteration:Ge.getElementById("force-itteration").value,gravity:t}),"noverlap-layout":()=>this.layout.applyLayout("noverlap"),"reverse-direction":()=>this.graphManager.reverseGraph(),"to-undirected":()=>this.graphManager.toUndirectedGraph(),"to-directed":()=>this.graphManager.toDirectedGraph(),"to-mixed":()=>this.graphManager.toMixedGraph(),"to-weighted":()=>this.graphManager.toWeighted(),"to-unweighted":()=>this.graphManager.toUnweighted(),"subgraph-btn":()=>this.graphManager.subgraph(),graphs:()=>this.graphManager.graphsPanel.selectLis(t),faces:()=>this.graphManager.facePanel.selectLis(t),"how-to-use":()=>window.open("https://www.youtube.com/playlist?list=PLaa8UNGS4QED9DUhAZt7O963qkScAWah3","_blank"),command:()=>{Ge.querySelector(".modal").style.display="flex",Ge.querySelector(".modal .help-panel").style.display="block"},about:()=>window.open("http://picinfiniti.net/","_blank"),"select-all-node":()=>this.graphManager.selectAllNode(),"deselect-all-node":()=>this.graphManager.deselectAllNode(),"select-next-node":()=>this.graphManager.selectNextNode(),"select-pervious-node":()=>this.graphManager.selectPerviousNode(),"select-all-edge":()=>this.graphManager.selectAllEdge(),"deselect-all-edge":()=>this.graphManager.deselectAllEdge(),"select-next-edge":()=>this.graphManager.selectNextEdge(),"select-pervious-edge":()=>this.graphManager.selectPerviousEdge(),"copy-subgraph":()=>this.graphManager.copySubgraph(),"cut-subgraph":()=>this.graphManager.cutSubgraph(),"paste-subgraph":()=>this.graphManager.pasteSubgraph(),"paste-subgraph-seprate":()=>this.graphManager.pasteSubgraph(!0),"update-node-color":()=>this.graphManager.updateSelectedColor(!0,!1,!1,!1,!1),"update-stroke-color":()=>this.graphManager.updateSelectedColor(!1,!0,!1,!1,!1),"update-edge-color":()=>this.graphManager.updateSelectedColor(!1,!1,!0,!1,!1),"update-face-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!0,!1),"update-label-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!1,!0)};n[e]?n[e]():console.log(`No action defined for: ${e}`)}attachEventListeners(){Ge.addEventListener("click",e=>{if(e.target.tagName==="INPUT")return;const t=e.target.closest("li");if(!t)return;const n=t.getAttribute("name")||t.id;n&&this.handleMenuAction(n,t.id)}),Ge.addEventListener("input",e=>{const t=e.target;if(!t||t.name=="rename"||t.name=="desc"||t.name=="weight")return;const n=t.id||t.getAttribute("name");if(n){const i=t.value||1;this.handleMenuAction(n,i)}})}}const ii=document;class cb{constructor(e){this.app=e,this.eventBus=e.eventBus}init(){this.app.eventBus.on("import",e=>{ii.getElementById("file-input").click()}),this.app.eventBus.on("export",async e=>{const t=document;if(e.detail.type==="json")try{const n=[];n.push("[");let i=!0;await It.history.orderBy("id").each(f=>{i||n.push(`,
`),n.push(JSON.stringify(f,null,2)),i=!1}),n.push("]");const a=new Blob(n,{type:"application/json"}),s=URL.createObjectURL(a),d=t.createElement("a");d.href=s,d.download="graph-history.json",t.body.appendChild(d),d.click(),t.body.removeChild(d),URL.revokeObjectURL(s),console.log("Efficient history export completed.")}catch(n){console.error("Failed to stream-export history:",n)}e.detail.type==="png"&&this.exportGraphAsImage()}),ii.getElementById("file-input").addEventListener("change",async e=>{const t=e.target.files[0];if(t){try{const n=new FileReader;n.onload=async i=>{try{const a=JSON.parse(i.target.result);if(!Array.isArray(a)){alert("Invalid file format. Expected an array of snapshots.");return}if(a.length===0){alert("The file contains no history snapshots.");return}if(!confirm("Importing will erase your current history. Continue?"))return;a.sort((f,h)=>f.id-h.id),await It.history.clear(),await It.history.bulkAdd(a);const d=await this.app.graphManager.getLastSnapshot();d?(this.app.graphManager.loadSnapshot(d),this.app.graphManager.refresh(),console.log(`Imported ${a.length} snapshots into history.`)):alert("Import succeeded, but no usable snapshot was found.")}catch(a){console.error("Failed to import history:",a),alert("Import failed. The file may be corrupted or not valid JSON.")}},n.readAsText(t)}catch(n){console.error("File reading error:",n),alert("Failed to read the selected file.")}e.target.value=""}})}exportGraphAsImage(){const e=this.app.canvas.width,t=this.app.canvas.height,n=ii.createElement("canvas");n.width=e,n.height=t;const i=n.getContext("2d");i.drawImage(this.app._canvas._canvas.face.canvas,0,0),i.drawImage(this.app._canvas._canvas.edge.canvas,0,0),i.drawImage(this.app._canvas._canvas.node.canvas,0,0),n.toBlob(a=>{if(!a){console.error("Export failed: canvas may be empty or tainted.");return}const s=ii.createElement("a");s.href=URL.createObjectURL(a),s.download="graph-studio-export.png",ii.body.appendChild(s),s.click(),ii.body.removeChild(s)},"image/png")}}const lb=[{title:"File",id:"file",submenu:[{title:"🆕 New Graph",id:"new-mixed-btn",shortcut:"(n)"},{title:"📂 Import",id:"import-graph",shortcut:"(o)",input:[{type:"file",id:"file-input",hidden:!0}]},{title:"💾 Export",id:"export-graph",shortcut:"(Ctrl+s)"},{title:"🖼️ Export to PNG",id:"export-png",shortcut:"(P)"},{type:"divider"},{title:"⚙️ Default Setting",id:"default-settings-btn"},{title:"🌙 Sky Night",id:"sky-night-theme-btn"},{type:"divider"},{title:"🔄 Reload",id:"reload",shortcut:"(F5)"}]},{title:"Edit",id:"edit",submenu:[{title:"Delete",name:"remove-selection-btn",shortcut:"(d)"},{title:"Assign Color",name:"color-selection-btn",shortcut:"(c)"},{title:"Add Edge",name:"add-edge-btn",shortcut:"(alt-e)"},{title:"Add Directed Edge",name:"add-directed-edge-btn",shortcut:"(alt-E)"},{title:"Add Face",name:"add-face-btn",shortcut:"(ctrl+f)"},{type:"divider"},{title:"Copy",name:"copy-subgraph",shortcut:"(y)"},{title:"Cut",name:"cut-subgraph",shortcut:"(x)"},{title:"Paste",name:"paste-subgraph",shortcut:"(p)"},{type:"divider"},{title:"Rename",name:"rename-btn",shortcut:"(r)"},{title:"Edit Info",name:"desc-btn",shortcut:"(i)"},{title:"Edit Weight",name:"weight-btn",shortcut:"(w)"},{type:"divider"},{title:"Undo",name:"undo-btn",shortcut:"(u)"},{title:"Redo",name:"redo-btn",shortcut:"(Ctrl+r)"}]},{title:"Settings",id:"settings",submenu:[{title:"Graph",id:"graph-settings",shortcut:">",submenu:[{title:"Vertex",id:"vertex-label",check:!0},{title:"Edge",id:"edge-label",check:!0},{title:"Face",id:"face-label",check:!0},{title:"Weight",id:"weight-label",check:!0},{type:"divider"},{title:"Grid",id:"gride-size",input:[{type:"range",id:"grid-size-1",min:0,max:100,value:20}]},{title:"Node",id:"vertex-size",input:[{type:"range",id:"vertex-size-1",min:0,max:200,value:10,step:.1}]},{title:"Edge",id:"edge-size",input:[{type:"range",id:"edge-size-1",min:1,max:100,value:2}]},{title:"Label",id:"label-size",input:[{type:"range",id:"label-size-1",min:0,max:100,value:15}]},{title:"Stroke",id:"stroke-size",input:[{type:"range",id:"stroke-size-1",min:0,max:50,value:5,step:.1}]}]},{title:"View",id:"view",shortcut:">",submenu:[{title:"Info Panel",id:"panel-btn",check:!0},{title:"Tools Panel",id:"tools-btn",check:!0},{title:"Graphs Panel",id:"graphs-btn",check:!0},{title:"Face Panel",id:"faces-btn",check:!0},{type:"divider"},{title:"Key Chord",id:"shortcut-chord-btn",shortcut:"⎵"}]},{type:"divider"},{title:"Performance",id:"performance",check:!0},{title:"History",id:"History",shortcut:">",submenu:[{title:"History Limit",id:"history-limit",input:[{type:"number",id:"history-limit-1",min:5,max:1e4,value:5}]},{title:"Save History",id:"save-history",check:!0},{title:"Clear History",id:"clear-histoory-btn"}]}]},{title:"Tools",id:"tools",submenu:[{title:"Scale",id:"scale-btn",check:!1,shortcut:"(s)"},{title:"Panning",id:"panning-btn",check:!1,shortcut:"Ctrl"},{title:"Selecting",id:"select-btn",check:!1,shortcut:"Shift"},{title:"Component",id:"component-btn",check:!1,shortcut:"Alt"},{type:"divider"},{title:"Tree",id:"tree-btn",check:!1,shortcut:"(t)"},{title:"Force Simulation",id:"force-btn",check:!1,shortcut:"(f)"},{title:"Force Edge",id:"force-edge-btn",check:!0},{type:"divider"},{title:"Color Picker",id:"color-picker-btn",check:!1,shortcut:"⎵ cc"}]},{title:"Generator",id:"generator",submenu:[{title:"Classic",id:"classic",shortcut:">",submenu:[{title:"Empty",id:"empty",input:[{type:"number",id:"g-empty-1",min:1,max:500,value:5}]},{title:"Kₙ",id:"complete",link:"https://en.wikipedia.org/wiki/Complete_graph",input:[{type:"number",id:"g-complete-1",min:1,max:500,value:5}]},{title:"Kₙ,ₙ",id:"complete-bipartite",link:"https://en.wikipedia.org/wiki/Complete_bipartite_graph",input:[{type:"number",id:"g-complete-bipartite-1",min:1,max:500,value:5},{type:"number",id:"g-complete-bipartite-2",min:1,max:500,value:5}]},{title:"Pₙ",id:"path",link:"https://en.wikipedia.org/wiki/Path_graph",input:[{type:"number",id:"g-path-1",min:2,max:500,value:5}]},{title:"Cₙ",id:"cycle",link:"https://en.wikipedia.org/wiki/Cycle_graph",input:[{type:"number",id:"g-cycle-1",min:3,max:500,value:5}]},{title:"Lₙ",id:"ladder",link:"https://en.wikipedia.org/wiki/Ladder_graph",input:[{type:"number",id:"g-ladder-1",min:2,max:500,value:5}]}]},{title:"Community",id:"community",shortcut:">",submenu:[{title:"Cₙ,ₙ",id:"caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-caveman-2",min:1,max:500,value:5}]},{title:"Qₙ,ₙ",id:"connected-caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-connected-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-connected-caveman-2",min:1,max:500,value:5}]}]},{title:"Random",id:"random",shortcut:">",submenu:[{title:"Clusters",id:"clusters",input:[{type:"number",id:"g-clusters-1",min:2,max:500,value:20},{type:"number",id:"g-clusters-2",min:2,max:500,value:20},{type:"number",id:"g-clusters-3",min:2,max:500,value:10}]},{title:"erdos Renyi",id:"erdos-renyi",link:"https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model",input:[{type:"number",id:"g-erdos-renyi-1",min:1,max:500,value:10},{type:"number",id:"g-erdos-renyi-2",min:0,max:1,step:.1,value:.5}]},{title:"Girvan Newman",id:"griven-newmn",link:"https://www.pnas.org/doi/pdf/10.1073/pnas.122653799",input:[{type:"number",id:"g-girvan-newman-1",min:1,max:500,value:5}]}]},{title:"Small",id:"small",shortcut:">",submenu:[{title:"Krackhardt kite",id:"krackhardt-kite",link:"https://en.wikipedia.org/wiki/Krackhardt_kite_graph"}]},{title:"Social",id:"social",shortcut:">",submenu:[{title:"Florentine families",id:"florentine-families"},{title:"Zachary’s karate club",id:"karate-club",link:"https://en.wikipedia.org/wiki/Zachary%27s_karate_club"}]},{type:"divider"},{title:"Zodiac",id:"zodiac",shortcut:">",submenu:[{title:"Aries",id:"aries",label:"♈",link:"https://en.wikipedia.org/wiki/Aries_(astrology)"},{title:"Taurus",id:"taurus",label:"♉",link:"https://en.wikipedia.org/wiki/Taurus_(astrology)"},{title:"Gemini",id:"gemini",label:"♊",link:"https://en.wikipedia.org/wiki/Gemini_(astrology)"},{title:"Cancer",id:"cancer",label:"♋",link:"https://en.wikipedia.org/wiki/Cancer_(astrology)"},{title:"Leo",id:"leo",label:"♌",link:"https://en.wikipedia.org/wiki/Leo_(astrology)"},{title:"Virgo",id:"virgo",label:"♍",link:"https://en.wikipedia.org/wiki/Virgo_(astrology)"},{title:"Libra",id:"libra",label:"♎",link:"https://en.wikipedia.org/wiki/Libra_(astrology)"},{title:"Scorpius",id:"scorpius",label:"♏",link:"https://en.wikipedia.org/wiki/Scorpio_(astrology)"},{title:"Ophiuchus",id:"ophiuchus",label:"⛎",link:"https://en.wikipedia.org/wiki/Ophiuchus_(astrology)"},{title:"Sagittarius",id:"sagittarius",label:"♐",link:"https://en.wikipedia.org/wiki/Sagittarius_(astrology)"},{title:"Capricornus",id:"capricornus",label:"♑",link:"https://en.wikipedia.org/wiki/Capricorn_(astrology)"},{title:"Aquarius",id:"aquarius",label:"♒",link:"https://en.wikipedia.org/wiki/Aquarius_(astrology)"},{title:"Pisces",id:"pisces",label:"♓",link:"https://en.wikipedia.org/wiki/Pisces_(astrology)"}]}]},{title:"Metrics",id:"metrics",submenu:[{title:"Basic",id:"basic",shortcut:">",submenu:[{title:"Basic Information",id:"basic-info-btn"},{title:"Components",id:"components-btn"},{title:"Lies On Cycle",id:"lies-on-cycle-btn"},{title:"Degree Sequence",id:"list-degrees-btn"},{title:"Density",id:"density-btn"},{title:"Diameter",id:"diameter-btn"}]},{title:"Centrality",id:"centrality",shortcut:">",submenu:[{title:"Betweenness Centrality",id:"betweenness-centrality-btn"},{title:"Closeness Centrality",id:"closeness-centrality-btn"},{title:"Degree Centrality",id:"degree-centrality-btn"},{title:"Eccentricity",id:"eccentricity-btn"},{title:"Eigenvector Centrality",id:"eigenvector-centrality-btn"},{title:"PageRank",id:"pagerank-btn"}]},{title:"Layout Quality",id:"layout-quality",shortcut:">",submenu:[{title:"Edge Uniformity",id:"edge-uniformity-btn"},{title:"Neighborhood Preservation",id:"neighborhood-preservation-btn"},{title:"Stress",id:"stress-btn"}]},{title:"Other",shortcut:">",id:"other",submenu:[{title:"Simmelian Strength",id:"simmelian-strength-btn"},{title:"Disparity",id:"disparity-btn"}]},{type:"divider"},{title:"Neighbors",id:"neighbors-btn"},{title:"Shortest Path",id:"shortest-path-btn"},{title:"Selected Nodes Info",id:"all-node-info-btn",shortcut:"(a)"},{title:"Selected Edges Info",id:"all-edge-info-btn",shortcut:"(Alt+a)"},{title:"Selected Faces Info",id:"all-face-info-btn"},{title:"Selected Graphs Info",id:"all-graph-info-btn"},{type:"divider"},{title:"Clear Panel",id:"clear-info-panel-btn",shortcut:"(q)"}]},{title:"Operators",id:"help",submenu:[{title:"Layout",id:"layout",shortcut:">",submenu:[{title:"Center Nodes",name:"center-layout"},{title:"Organize Nodes",name:"organize-circle",shortcut:"(O)"},{title:"Random",name:"random-layout"},{title:"Vertical Flip",name:"vflip-layout"},{title:"Horizontal Flip",name:"hflip-layout"},{title:"Rotate",name:"rotate-layout",input:[{type:"number",id:"rotate-layout-1",min:-180,max:180,value:45}]},{type:"divider"},{title:"Force Atlas",name:"force-layout",input:[{type:"number",id:"force-itteration",min:0,max:500,value:50},{type:"number",id:"force-gravity",min:0,max:1,value:25}],link:"https://graphology.github.io/standard-library/layout-forceatlas2.html"}]},{title:"Converter",id:"converter",shortcut:">",submenu:[{title:"To Mixed",id:"to-mixed"},{title:"To Undirected",id:"to-undirected"},{title:"To Directed",id:"to-directed"},{title:"To Weighted",id:"to-weighted"},{title:"To Unweighted",id:"to-unweighted"}]},{title:"Reverse Direction",id:"reverse-direction"},{title:"Subgraph",id:"subgraph-btn"},{title:"Complete Graph",name:"complete-btn",shortcut:"(alt-C)"}]},{title:"Help",id:"help",submenu:[{title:"Mouse Commnads",id:"command",name:"command-btn"},{title:"How to use",id:"how-to-use"},{title:"About",id:"about",shortcut:"version: 1.9.11"}]}];var ai={},od;function db(){if(od)return ai;od=1;var r=Ue();function e(d){return typeof d=="number"&&!isNaN(d)}var t=["x","y"];function n(d,f){if(!r(d))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.exhaustive!==!1;h||(h=t);var b={},w=h.length;return d.forEachNode(function(E,I){var D=0,N={},O;for(O=0;O<w;O++){var P=h[O],z=I[P];e(z)&&(N[P]=z,D++)}y?D===w&&(b[E]=N):D&&(b[E]=N)}),b}function i(d,f,h){if(!r(d))throw new Error("graphology-layout/utils.assignLayout: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions||t,b=y.length,w;d.updateEachNodeAttributes(function(E,I){var D=f[E];if(!D)return I;for(var N=0;N<b;N++)w=y[N],I[w]=D[w];return I},{attributes:y})}function a(d,f){if(!r(d))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.type||Float64Array;h||(h=t);var b=h.length,w=new y(d.order*b),E=0;return d.forEachNode(function(I,D){var N;for(N=0;N<b;N++){var O=h[N],P=D[O];e(P)||(P=0),w[E++]=P}}),w}function s(d,f,h){if(!r(d))throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions;y||(y=t);var b=y.length;if(f.length!==d.order*b)throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: given layout has an incorrect length wrt number of nodes & dimenions.");var w=0;d.updateEachNodeAttributes(function(E,I){for(var D=0;D<b;D++)I[y[D]]=f[w++];return I},{attributes:y})}return ai.collectLayout=n,ai.assignLayout=i,ai.collectLayoutAsFlatArray=a,ai.assignLayoutAsFlatArray=s,ai}var Nn=db();let oi=null;const mu=[];let Ka=!1;const bu=new Map,hb=5e3;function fb(r,e,t,n={}){const i=e.export(),a=JSON.stringify({type:r,graph:i,payload:n});if(bu.has(a)){t(bu.get(a));return}mu.push({type:r,graph:i,payload:n,callback:t,key:a}),wu()}function wu(){if(Ka||mu.length===0)return;const r=mu.shift(),{type:e,graph:t,payload:n,callback:i,key:a}=r;Ka=!0,oi||(oi=new Worker(new URL("/assets/graph-algorithms.worker-BLR8NMch.js",import.meta.url),{type:"module"}));const s=setTimeout(()=>{console.warn(`[${e}] timed out. Restarting worker...`),oi.terminate(),oi=null,Ka=!1,wu()},hb);oi.onmessage=({data:d})=>{clearTimeout(s),Ka=!1,d.error?console.error(`[Worker Error] ${e}:`,d.error):(bu.set(a,d.result),i(d.result)),wu()},oi.postMessage({type:e,graph:t,payload:n})}var si={},Ks,sd;function pb(){if(sd)return Ks;sd=1;function r(t){return function(n,i){return n+Math.floor(t()*(i-n+1))}}var e=r(Math.random);return e.createRandom=r,Ks=e,Ks}var Ws,ud;function gb(){if(ud)return Ws;ud=1;var r=pb().createRandom;function e(n){var i=r(n);return function(a){for(var s=a.length,d=s-1,f=-1;++f<s;){var h=i(f,d),y=a[h];a[h]=a[f],a[f]=y}}}var t=e(Math.random);return t.createShuffleInPlace=e,Ws=t,Ws}var Hs,cd;function yb(){if(cd)return Hs;cd=1;var r=Rn(),e=Ue(),t=gb(),n={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function i(S,G,q,j,Y){this.wrappedCircle=Y||null,this.children={},this.countChildren=0,this.id=S||null,this.next=null,this.previous=null,this.x=G||null,this.y=q||null,Y?this.r=1010101:this.r=j||999}i.prototype.hasChildren=function(){return this.countChildren>0},i.prototype.addChild=function(S,G){this.children[S]=G,++this.countChildren},i.prototype.getChild=function(S){if(!this.children.hasOwnProperty(S)){var G=new i;this.children[S]=G,++this.countChildren}return this.children[S]},i.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var S=this;for(var G in S.children){var q=S.children[G];q.x+=S.x,q.y+=S.y,q.applyPositionToChildren()}}};function a(S,G,q){for(var j in G.children){var Y=G.children[j];Y.hasChildren()?a(S,Y,q):q[Y.id]={x:Y.x,y:Y.y}}}function s(S,G){var q=S.r-G.r,j=G.x-S.x,Y=G.y-S.y;return q<0||q*q<j*j+Y*Y}function d(S,G){var q=S.r-G.r+1e-6,j=G.x-S.x,Y=G.y-S.y;return q>0&&q*q>j*j+Y*Y}function f(S,G){for(var q=0;q<G.length;++q)if(!d(S,G[q]))return!1;return!0}function h(S){return new i(null,S.x,S.y,S.r)}function y(S,G){var q=S.x,j=S.y,Y=S.r,te=G.x,B=G.y,me=G.r,ge=te-q,V=B-j,M=me-Y,J=Math.sqrt(ge*ge+V*V);return new i(null,(q+te+ge/J*M)/2,(j+B+V/J*M)/2,(J+Y+me)/2)}function b(S,G,q){var j=S.x,Y=S.y,te=S.r,B=G.x,me=G.y,ge=G.r,V=q.x,M=q.y,J=q.r,ne=j-B,de=j-V,oe=Y-me,he=Y-M,ue=ge-te,ve=J-te,_e=j*j+Y*Y-te*te,Me=_e-B*B-me*me+ge*ge,Oe=_e-V*V-M*M+J*J,qe=de*oe-ne*he,ce=(oe*Oe-he*Me)/(qe*2)-j,Pe=(he*ue-oe*ve)/qe,Re=(de*Me-ne*Oe)/(qe*2)-Y,ke=(ne*ve-de*ue)/qe,Ke=Pe*Pe+ke*ke-1,Le=2*(te+ce*Pe+Re*ke),xe=ce*ce+Re*Re-te*te,fe=-(Ke?(Le+Math.sqrt(Le*Le-4*Ke*xe))/(2*Ke):xe/Le);return new i(null,j+ce+Pe*fe,Y+Re+ke*fe,fe)}function w(S){switch(S.length){case 1:return h(S[0]);case 2:return y(S[0],S[1]);case 3:return b(S[0],S[1],S[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+S.length)}}function E(S,G){var q,j;if(f(G,S))return[G];for(q=0;q<S.length;++q)if(s(G,S[q])&&f(y(S[q],G),S))return[S[q],G];for(q=0;q<S.length-1;++q)for(j=q+1;j<S.length;++j)if(s(y(S[q],S[j]),G)&&s(y(S[q],G),S[j])&&s(y(S[j],G),S[q])&&f(b(S[q],S[j],G),S))return[S[q],S[j],G];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function I(S){var G=S.wrappedCircle,q=S.next.wrappedCircle,j=G.r+q.r,Y=(G.x*q.r+q.x*G.r)/j,te=(G.y*q.r+q.y*G.r)/j;return Y*Y+te*te}function D(S,G){var q=0,j=S.slice(),Y=S.length,te=[],B,me;for(G(j);q<Y;)B=j[q],me&&d(me,B)?++q:(te=E(te,B),me=w(te),q=0);return me}function N(S,G,q){var j=S.x-G.x,Y,te,B=S.y-G.y,me,ge,V=j*j+B*B;V?(te=G.r+q.r,te*=te,ge=S.r+q.r,ge*=ge,te>ge?(Y=(V+ge-te)/(2*V),me=Math.sqrt(Math.max(0,ge/V-Y*Y)),q.x=S.x-Y*j-me*B,q.y=S.y-Y*B+me*j):(Y=(V+te-ge)/(2*V),me=Math.sqrt(Math.max(0,te/V-Y*Y)),q.x=G.x+Y*j-me*B,q.y=G.y+Y*B+me*j)):(q.x=G.x+q.r,q.y=G.y)}function O(S,G){var q=S.r+G.r-1e-6,j=G.x-S.x,Y=G.y-S.y;return q>0&&q*q>j*j+Y*Y}function P(S,G){var q=S.length;if(q===0)return 0;var j,Y,te,B,me,ge,V,M,J,ne;if(j=S[0],j.x=0,j.y=0,q<=1)return j.r;if(Y=S[1],j.x=-Y.r,Y.x=j.r,Y.y=0,q<=2)return j.r+Y.r;te=S[2],N(Y,j,te),j=new i(null,null,null,null,j),Y=new i(null,null,null,null,Y),te=new i(null,null,null,null,te),j.next=te.previous=Y,Y.next=j.previous=te,te.next=Y.previous=j;e:for(ge=3;ge<q;++ge){te=S[ge],N(j.wrappedCircle,Y.wrappedCircle,te),te=new i(null,null,null,null,te),V=Y.next,M=j.previous,J=Y.wrappedCircle.r,ne=j.wrappedCircle.r;do if(J<=ne){if(O(V.wrappedCircle,te.wrappedCircle)){Y=V,j.next=Y,Y.previous=j,--ge;continue e}J+=V.wrappedCircle.r,V=V.next}else{if(O(M.wrappedCircle,te.wrappedCircle)){j=M,j.next=Y,Y.previous=j,--ge;continue e}ne+=M.wrappedCircle.r,M=M.previous}while(V!==M.next);for(te.previous=j,te.next=Y,j.next=Y.previous=Y=te,B=I(j);(te=te.next)!==Y;)(me=I(te))<B&&(j=te,B=me);Y=j.next}j=[Y.wrappedCircle],te=Y;for(var de=1e4;(te=te.next)!==Y&&--de!==0;)j.push(te.wrappedCircle);for(te=D(j,G),ge=0;ge<q;++ge)j=S[ge],j.x-=te.x,j.y-=te.y;return te.r}function z(S,G){var q=0;if(S.hasChildren()){for(var j in S.children){var Y=S.children[j];Y.hasChildren()&&(Y.r=z(Y,G))}q=P(Object.values(S.children),G)}return q}function C(S,G){z(S,G);for(var q in S.children){var j=S.children[q];j.applyPositionToChildren()}}function L(S,G,q){if(!e(G))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");q=r(q,n);var j={},Y={},te=G.nodes(),B=q.center,me=q.hierarchyAttributes,ge=t.createShuffleInPlace(q.rng),V=q.scale,M=new i;G.forEachNode(function(ue,ve){var _e=ve.size?ve.size:1,Me=new i(ue,null,null,_e),Oe=M;me.forEach(function(qe){var ce=ve[qe];Oe=Oe.getChild(ce)}),Oe.addChild(ue,Me)}),C(M,ge),a(G,M,j);var J=te.length,ne,de,oe;for(oe=0;oe<J;oe++){var he=te[oe];ne=B+V*j[he].x,de=B+V*j[he].y,Y[he]={x:ne,y:de},S&&(G.setNodeAttribute(he,q.attributes.x,ne),G.setNodeAttribute(he,q.attributes.y,de))}return Y}var K=L.bind(null,!1);return K.assign=L.bind(null,!0),Hs=K,Hs}var Ys,ld;function vb(){if(ld)return Ys;ld=1;var r=Rn(),e=Ue(),t={dimensions:["x","y"],center:.5,scale:1};function n(a,s,d){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");d=r(d,t);var f=d.dimensions;if(!Array.isArray(f)||f.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=d.center,y=d.scale,b=Math.PI*2,w=(h-.5)*y,E=s.order,I=f[0],D=f[1];function N(z,C){return C[I]=y*Math.cos(z*b/E)+w,C[D]=y*Math.sin(z*b/E)+w,C}var O=0;if(!a){var P={};return s.forEachNode(function(z){P[z]=N(O++,{})}),P}s.updateEachNodeAttributes(function(z,C){return N(O++,C),C},{attributes:f})}var i=n.bind(null,!1);return i.assign=n.bind(null,!0),Ys=i,Ys}var Xs,dd;function mb(){if(dd)return Xs;dd=1;var r=Rn(),e=Ue(),t={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function n(a,s,d){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");d=r(d,t);var f=d.dimensions;if(!Array.isArray(f)||f.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=f.length,y=d.center,b=d.rng,w=d.scale,E=(y-.5)*w;function I(N){for(var O=0;O<h;O++)N[f[O]]=b()*w+E;return N}if(!a){var D={};return s.forEachNode(function(N){D[N]=I({})}),D}s.updateEachNodeAttributes(function(N,O){return I(O),O},{attributes:f})}var i=n.bind(null,!1);return i.assign=n.bind(null,!0),Xs=i,Xs}var Vs,hd;function bb(){if(hd)return Vs;hd=1;var r=Rn(),e=Ue(),t=Math.PI/180,n={dimensions:["x","y"],centeredOnZero:!1,degrees:!1};function i(s,d,f,h){if(!e(d))throw new Error("graphology-layout/rotation: the given graph is not a valid graphology instance.");h=r(h,n),h.degrees&&(f*=t);var y=h.dimensions;if(!Array.isArray(y)||y.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");if(d.order===0)return s?void 0:{};var b=y[0],w=y[1],E=0,I=0;if(!h.centeredOnZero){var D=1/0,N=-1/0,O=1/0,P=-1/0;d.forEachNode(function(S,G){var q=G[b],j=G[w];q<D&&(D=q),q>N&&(N=q),j<O&&(O=j),j>P&&(P=j)}),E=(D+N)/2,I=(O+P)/2}var z=Math.cos(f),C=Math.sin(f);function L(S){var G=S[b],q=S[w];return S[b]=E+(G-E)*z-(q-I)*C,S[w]=I+(G-E)*C+(q-I)*z,S}if(!s){var K={};return d.forEachNode(function(S,G){var q={};q[b]=G[b],q[w]=G[w],K[S]=L(q)}),K}d.updateEachNodeAttributes(function(S,G){return L(G),G},{attributes:y})}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),Vs=a,Vs}var fd;function wb(){return fd||(fd=1,si.circlepack=yb(),si.circular=vb(),si.random=mb(),si.rotation=bb()),si}var Qs,pd;function xb(){return pd||(pd=1,Qs=wb()),Qs}var Zs=xb(),Js,gd;function Eb(){if(gd)return Js;gd=1;var r=0,e=1,t=2,n=3,i=4,a=5,s=6,d=7,f=8,h=9,y=0,b=1,w=2,E=0,I=1,D=2,N=3,O=4,P=5,z=6,C=7,L=8,K=3,S=10,G=3,q=9,j=10;return Js=function(te,B,me){var ge,V,M,J,ne,de,oe,he,ue,ve,_e=B.length,Me=me.length,Oe=te.adjustSizes,qe=te.barnesHutTheta*te.barnesHutTheta,ce,Pe,Re,ke,Ke,Le,xe,fe=[];for(M=0;M<_e;M+=S)B[M+i]=B[M+t],B[M+a]=B[M+n],B[M+t]=0,B[M+n]=0;if(te.outboundAttractionDistribution){for(ce=0,M=0;M<_e;M+=S)ce+=B[M+s];ce/=_e/S}if(te.barnesHutOptimize){var vt=1/0,it=-1/0,xt=1/0,at=-1/0,Ve,ht,ot;for(M=0;M<_e;M+=S)vt=Math.min(vt,B[M+r]),it=Math.max(it,B[M+r]),xt=Math.min(xt,B[M+e]),at=Math.max(at,B[M+e]);var gt=it-vt,Et=at-xt;for(gt>Et?(xt-=(gt-Et)/2,at=xt+gt):(vt-=(Et-gt)/2,it=vt+Et),fe[0+E]=-1,fe[0+I]=(vt+it)/2,fe[0+D]=(xt+at)/2,fe[0+N]=Math.max(it-vt,at-xt),fe[0+O]=-1,fe[0+P]=-1,fe[0+z]=0,fe[0+C]=0,fe[0+L]=0,ge=1,M=0;M<_e;M+=S)for(V=0,ot=K;;)if(fe[V+P]>=0){B[M+r]<fe[V+I]?B[M+e]<fe[V+D]?Ve=fe[V+P]:Ve=fe[V+P]+q:B[M+e]<fe[V+D]?Ve=fe[V+P]+q*2:Ve=fe[V+P]+q*3,fe[V+C]=(fe[V+C]*fe[V+z]+B[M+r]*B[M+s])/(fe[V+z]+B[M+s]),fe[V+L]=(fe[V+L]*fe[V+z]+B[M+e]*B[M+s])/(fe[V+z]+B[M+s]),fe[V+z]+=B[M+s],V=Ve;continue}else if(fe[V+E]<0){fe[V+E]=M;break}else{if(fe[V+P]=ge*q,he=fe[V+N]/2,ue=fe[V+P],fe[ue+E]=-1,fe[ue+I]=fe[V+I]-he,fe[ue+D]=fe[V+D]-he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+P]=-1,fe[ue+z]=0,fe[ue+C]=0,fe[ue+L]=0,ue+=q,fe[ue+E]=-1,fe[ue+I]=fe[V+I]-he,fe[ue+D]=fe[V+D]+he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+P]=-1,fe[ue+z]=0,fe[ue+C]=0,fe[ue+L]=0,ue+=q,fe[ue+E]=-1,fe[ue+I]=fe[V+I]+he,fe[ue+D]=fe[V+D]-he,fe[ue+N]=he,fe[ue+O]=ue+q,fe[ue+P]=-1,fe[ue+z]=0,fe[ue+C]=0,fe[ue+L]=0,ue+=q,fe[ue+E]=-1,fe[ue+I]=fe[V+I]+he,fe[ue+D]=fe[V+D]+he,fe[ue+N]=he,fe[ue+O]=fe[V+O],fe[ue+P]=-1,fe[ue+z]=0,fe[ue+C]=0,fe[ue+L]=0,ge+=4,B[fe[V+E]+r]<fe[V+I]?B[fe[V+E]+e]<fe[V+D]?Ve=fe[V+P]:Ve=fe[V+P]+q:B[fe[V+E]+e]<fe[V+D]?Ve=fe[V+P]+q*2:Ve=fe[V+P]+q*3,fe[V+z]=B[fe[V+E]+s],fe[V+C]=B[fe[V+E]+r],fe[V+L]=B[fe[V+E]+e],fe[Ve+E]=fe[V+E],fe[V+E]=-1,B[M+r]<fe[V+I]?B[M+e]<fe[V+D]?ht=fe[V+P]:ht=fe[V+P]+q:B[M+e]<fe[V+D]?ht=fe[V+P]+q*2:ht=fe[V+P]+q*3,Ve===ht)if(ot--){V=Ve;continue}else{ot=K;break}fe[ht+E]=M;break}}if(te.barnesHutOptimize)for(Pe=te.scalingRatio,M=0;M<_e;M+=S)for(V=0;;)if(fe[V+P]>=0)if(Le=Math.pow(B[M+r]-fe[V+C],2)+Math.pow(B[M+e]-fe[V+L],2),ve=fe[V+N],4*ve*ve/Le<qe){if(Re=B[M+r]-fe[V+C],ke=B[M+e]-fe[V+L],Oe===!0?Le>0?(xe=Pe*B[M+s]*fe[V+z]/Le,B[M+t]+=Re*xe,B[M+n]+=ke*xe):Le<0&&(xe=-Pe*B[M+s]*fe[V+z]/Math.sqrt(Le),B[M+t]+=Re*xe,B[M+n]+=ke*xe):Le>0&&(xe=Pe*B[M+s]*fe[V+z]/Le,B[M+t]+=Re*xe,B[M+n]+=ke*xe),V=fe[V+O],V<0)break;continue}else{V=fe[V+P];continue}else{if(de=fe[V+E],de>=0&&de!==M&&(Re=B[M+r]-B[de+r],ke=B[M+e]-B[de+e],Le=Re*Re+ke*ke,Oe===!0?Le>0?(xe=Pe*B[M+s]*B[de+s]/Le,B[M+t]+=Re*xe,B[M+n]+=ke*xe):Le<0&&(xe=-Pe*B[M+s]*B[de+s]/Math.sqrt(Le),B[M+t]+=Re*xe,B[M+n]+=ke*xe):Le>0&&(xe=Pe*B[M+s]*B[de+s]/Le,B[M+t]+=Re*xe,B[M+n]+=ke*xe)),V=fe[V+O],V<0)break;continue}else for(Pe=te.scalingRatio,J=0;J<_e;J+=S)for(ne=0;ne<J;ne+=S)Re=B[J+r]-B[ne+r],ke=B[J+e]-B[ne+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-B[J+f]-B[ne+f],Le>0?(xe=Pe*B[J+s]*B[ne+s]/Le/Le,B[J+t]+=Re*xe,B[J+n]+=ke*xe,B[ne+t]-=Re*xe,B[ne+n]-=ke*xe):Le<0&&(xe=100*Pe*B[J+s]*B[ne+s],B[J+t]+=Re*xe,B[J+n]+=ke*xe,B[ne+t]-=Re*xe,B[ne+n]-=ke*xe)):(Le=Math.sqrt(Re*Re+ke*ke),Le>0&&(xe=Pe*B[J+s]*B[ne+s]/Le/Le,B[J+t]+=Re*xe,B[J+n]+=ke*xe,B[ne+t]-=Re*xe,B[ne+n]-=ke*xe));for(ue=te.gravity/te.scalingRatio,Pe=te.scalingRatio,M=0;M<_e;M+=S)xe=0,Re=B[M+r],ke=B[M+e],Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),te.strongGravityMode?Le>0&&(xe=Pe*B[M+s]*ue):Le>0&&(xe=Pe*B[M+s]*ue/Le),B[M+t]-=Re*xe,B[M+n]-=ke*xe;for(Pe=1*(te.outboundAttractionDistribution?ce:1),oe=0;oe<Me;oe+=G)J=me[oe+y],ne=me[oe+b],he=me[oe+w],Ke=Math.pow(he,te.edgeWeightInfluence),Re=B[J+r]-B[ne+r],ke=B[J+e]-B[ne+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-B[J+f]-B[ne+f],te.linLogMode?te.outboundAttractionDistribution?Le>0&&(xe=-Pe*Ke*Math.log(1+Le)/Le/B[J+s]):Le>0&&(xe=-Pe*Ke*Math.log(1+Le)/Le):te.outboundAttractionDistribution?Le>0&&(xe=-Pe*Ke/B[J+s]):Le>0&&(xe=-Pe*Ke)):(Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),te.linLogMode?te.outboundAttractionDistribution?Le>0&&(xe=-Pe*Ke*Math.log(1+Le)/Le/B[J+s]):Le>0&&(xe=-Pe*Ke*Math.log(1+Le)/Le):te.outboundAttractionDistribution?(Le=1,xe=-Pe*Ke/B[J+s]):(Le=1,xe=-Pe*Ke)),Le>0&&(B[J+t]+=Re*xe,B[J+n]+=ke*xe,B[ne+t]-=Re*xe,B[ne+n]-=ke*xe);var st,ut,ft,rt,_t,mt;if(Oe===!0)for(M=0;M<_e;M+=S)B[M+h]!==1&&(st=Math.sqrt(Math.pow(B[M+t],2)+Math.pow(B[M+n],2)),st>j&&(B[M+t]=B[M+t]*j/st,B[M+n]=B[M+n]*j/st),ut=B[M+s]*Math.sqrt((B[M+i]-B[M+t])*(B[M+i]-B[M+t])+(B[M+a]-B[M+n])*(B[M+a]-B[M+n])),ft=Math.sqrt((B[M+i]+B[M+t])*(B[M+i]+B[M+t])+(B[M+a]+B[M+n])*(B[M+a]+B[M+n]))/2,rt=.1*Math.log(1+ft)/(1+Math.sqrt(ut)),_t=B[M+r]+B[M+t]*(rt/te.slowDown),B[M+r]=_t,mt=B[M+e]+B[M+n]*(rt/te.slowDown),B[M+e]=mt);else for(M=0;M<_e;M+=S)B[M+h]!==1&&(ut=B[M+s]*Math.sqrt((B[M+i]-B[M+t])*(B[M+i]-B[M+t])+(B[M+a]-B[M+n])*(B[M+a]-B[M+n])),ft=Math.sqrt((B[M+i]+B[M+t])*(B[M+i]+B[M+t])+(B[M+a]+B[M+n])*(B[M+a]+B[M+n]))/2,rt=B[M+d]*Math.log(1+ft)/(1+Math.sqrt(ut)),B[M+d]=Math.min(1,Math.sqrt(rt*(Math.pow(B[M+t],2)+Math.pow(B[M+n],2))/(1+Math.sqrt(ut)))),_t=B[M+r]+B[M+t]*(rt/te.slowDown),B[M+r]=_t,mt=B[M+e]+B[M+n]*(rt/te.slowDown),B[M+e]=mt);return{}},Js}var jn={},yd;function _b(){if(yd)return jn;yd=1;var r=10,e=3;return jn.assign=function(t){t=t||{};var n=Array.prototype.slice.call(arguments).slice(1),i,a,s;for(i=0,s=n.length;i<s;i++)if(n[i])for(a in n[i])t[a]=n[i][a];return t},jn.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},jn.graphToByteArrays=function(t,n){var i=t.order,a=t.size,s={},d,f=new Float32Array(i*r),h=new Float32Array(a*e);return d=0,t.forEachNode(function(y,b){s[y]=d,f[d]=b.x,f[d+1]=b.y,f[d+2]=0,f[d+3]=0,f[d+4]=0,f[d+5]=0,f[d+6]=1,f[d+7]=1,f[d+8]=b.size||1,f[d+9]=b.fixed?1:0,d+=r}),d=0,t.forEachEdge(function(y,b,w,E,I,D,N){var O=s[w],P=s[E],z=n(y,b,w,E,I,D,N);f[O+6]+=z,f[P+6]+=z,h[d]=O,h[d+1]=P,h[d+2]=z,d+=e}),{nodes:f,edges:h}},jn.assignLayoutChanges=function(t,n,i){var a=0;t.updateEachNodeAttributes(function(s,d){return d.x=n[a],d.y=n[a+1],a+=r,i?i(s,d):d})},jn.readGraphPositions=function(t,n){var i=0;t.forEachNode(function(a,s){n[i]=s.x,n[i+1]=s.y,i+=r})},jn.collectLayoutChanges=function(t,n,i){for(var a=t.nodes(),s={},d=0,f=0,h=n.length;d<h;d+=r){if(i){var y=Object.assign({},t.getNodeAttributes(a[f]));y.x=n[d],y.y=n[d+1],y=i(a[f],y),s[a[f]]={x:y.x,y:y.y}}else s[a[f]]={x:n[d],y:n[d+1]};f++}return s},jn.createWorker=function(n){var i=window.URL||window.webkitURL,a=n.toString(),s=i.createObjectURL(new Blob(["("+a+").call(this);"],{type:"text/javascript"})),d=new Worker(s);return i.revokeObjectURL(s),d},jn}var eu,vd;function Sb(){return vd||(vd=1,eu={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),eu}var tu,md;function Ab(){if(md)return tu;md=1;var r=Ue(),e=vi().createEdgeWeightGetter,t=Eb(),n=_b(),i=Sb();function a(f,h,y){if(!r(h))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof y=="number"&&(y={iterations:y});var b=y.iterations;if(typeof b!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(b<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var w=e("getEdgeWeight"in y?y.getEdgeWeight:"weight").fromEntry,E=typeof y.outputReducer=="function"?y.outputReducer:null,I=n.assign({},i,y.settings),D=n.validateSettings(I);if(D)throw new Error("graphology-layout-forceatlas2: "+D.message);var N=n.graphToByteArrays(h,w),O;for(O=0;O<b;O++)t(I,N.nodes,N.edges);if(f){n.assignLayoutChanges(h,N.nodes,E);return}return n.collectLayoutChanges(h,N.nodes)}function s(f){var h=typeof f=="number"?f:f.order;return{barnesHutOptimize:h>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(h)}}var d=a.bind(null,!1);return d.assign=a.bind(null,!0),d.inferSettings=s,tu=d,tu}var kb=Ab();const Cb=Mt(kb);var nu,bd;function Db(){if(bd)return nu;bd=1;var r=0,e=1,t=2,n=3;function i(s,d){return s+"§"+d}function a(){return .01*(.5-Math.random())}return nu=function(d,f){var h=d.margin,y=d.ratio,b=d.expansion,w=d.gridSize,E=d.speed,I,D,N,O,P,z,C=!0,L=f.length,K=L/n|0,S=new Float32Array(K),G=new Float32Array(K),q=1/0,j=1/0,Y=-1/0,te=-1/0;for(I=0;I<L;I+=n)N=f[I+r],O=f[I+e],z=f[I+t]*y+h,q=Math.min(q,N-z),Y=Math.max(Y,N+z),j=Math.min(j,O-z),te=Math.max(te,O+z);var B=Y-q,me=te-j,ge=(q+Y)/2,V=(j+te)/2;q=ge-b*B/2,Y=ge+b*B/2,j=V-b*me/2,te=V+b*me/2;var M=new Array(w*w),J=M.length,ne;for(ne=0;ne<J;ne++)M[ne]=[];var de,oe,he,ue,ve,_e,Me,Oe,qe,ce;for(I=0;I<L;I+=n)for(N=f[I+r],O=f[I+e],z=f[I+t]*y+h,de=N-z,oe=N+z,he=O-z,ue=O+z,ve=Math.floor(w*(de-q)/(Y-q)),_e=Math.floor(w*(oe-q)/(Y-q)),Me=Math.floor(w*(he-j)/(te-j)),Oe=Math.floor(w*(ue-j)/(te-j)),qe=ve;qe<=_e;qe++)for(ce=Me;ce<=Oe;ce++)M[qe*w+ce].push(I);var Pe,Re=new Set,ke,Ke,Le,xe,fe,vt,it,xt,at,Ve,ht,ot,gt;for(ne=0;ne<J;ne++)for(Pe=M[ne],I=0,P=Pe.length;I<P;I++)for(ke=Pe[I],Le=f[ke+r],fe=f[ke+e],it=f[ke+t],D=I+1;D<P;D++)Ke=Pe[D],at=i(ke,Ke),!(J>1&&Re.has(at))&&(J>1&&Re.add(at),xe=f[Ke+r],vt=f[Ke+e],xt=f[Ke+t],Ve=xe-Le,ht=vt-fe,ot=Math.sqrt(Ve*Ve+ht*ht),gt=ot<it*y+h+(xt*y+h),gt&&(C=!1,Ke=Ke/n|0,ot>0?(S[Ke]+=Ve/ot*(1+it),G[Ke]+=ht/ot*(1+it)):(S[Ke]+=B*a(),G[Ke]+=me*a())));for(I=0,D=0;I<L;I+=n,D++)f[I+r]+=S[D]*.1*E,f[I+e]+=G[D]*.1*E;return{converged:C}},nu}var Ir={},wd;function Ib(){if(wd)return Ir;wd=1;var r=3;return Ir.validateSettings=function(e){return"gridSize"in e&&typeof e.gridSize!="number"||e.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in e&&typeof e.margin!="number"||e.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in e&&typeof e.expansion!="number"||e.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in e&&typeof e.ratio!="number"||e.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in e&&typeof e.speed!="number"||e.speed<=0?{message:"the `speed` setting should be a positive number."}:null},Ir.graphToByteArray=function(e,t){var n=e.order,i=new Float32Array(n*r),a=0;return e.forEachNode(function(s,d){typeof t=="function"&&(d=t(s,d)),i[a]=d.x,i[a+1]=d.y,i[a+2]=d.size||1,a+=r}),i},Ir.assignLayoutChanges=function(e,t,n){var i=0;e.forEachNode(function(a){var s={x:t[i],y:t[i+1]};typeof n=="function"&&(s=n(a,s)),e.mergeNodeAttributes(a,s),i+=r})},Ir.collectLayoutChanges=function(e,t,n){var i={},a=0;return e.forEachNode(function(s){var d={x:t[a],y:t[a+1]};typeof n=="function"&&(d=n(s,d)),i[s]=d,a+=r}),i},Ir.createWorker=function(t){var n=window.URL||window.webkitURL,i=t.toString(),a=n.createObjectURL(new Blob(["("+i+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return n.revokeObjectURL(a),s},Ir}var ru,xd;function Mb(){return xd||(xd=1,ru={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3}),ru}var iu,Ed;function Pb(){if(Ed)return iu;Ed=1;var r=Ue(),e=Db(),t=Ib(),n=Mb(),i=500;function a(d,f,h){if(!r(f))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof h=="number"?h={maxIterations:h}:h=h||{};var y=h.maxIterations||i;if(typeof y!="number"||y<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var b=Object.assign({},n,h.settings),w=t.validateSettings(b);if(w)throw new Error("graphology-layout-noverlap: "+w.message);var E=t.graphToByteArray(f,h.inputReducer),I=!1,D;for(D=0;D<y&&!I;D++)I=e(b,E).converged;if(d){t.assignLayoutChanges(f,E,h.outputReducer);return}return t.collectLayoutChanges(f,E,h.outputReducer)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),iu=s,iu}var Nb=Pb();const Ob=Mt(Nb);class Tb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.canvas=e.canvas}init(){}applyLayout(e,t){let n=!0;switch(e){case"force":this.force(t.itteration,t.gravity);break;case"noverlap":this.noverlap();break;case"rotate180":this.rotate180();break;case"rotate":this.rotate(t);break;case"h-flip":this.hFlip();break;case"v-flip":this.vFlip();break;case"center":this.center();break;case"random":this.random();break;case"circle":this.organizeNodesInCircle();break;case"oneLine":this.organizeNodesInLine();break;case"twoLine":this.organizeNodesInTwoLines(t.line1Count,t.Y);break;default:n=!1;break}n&&this.app.graphManager.saveGraphState()}noverlap(){const e=this.app.graphManager.graph,t=Ob(e,{maxIterations:50,settings:{ratio:100,expansion:1.5,gridSize:5}});this.center(t)}force(e=50,t=25){const n=this.app.graphManager.graph;if(n.order<250){const i=Cb(n,{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}});this.center(i)}else fb("force",n,i=>{this.center(i)},{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}})}hFlip(){const e=this.canvas.width/2,t=this.app.graphManager.graph,n=Nn.collectLayout(t);Object.values(n).forEach(i=>{const a=e-i.x;i.x+=2*a}),Nn.assignLayout(t,n)}vFlip(){const e=this.canvas.height/2,t=this.app.graphManager.graph,n=Nn.collectLayout(t);Object.values(n).forEach(i=>{const a=e-i.y;i.y+=2*a}),Nn.assignLayout(t,n)}rotate(e=90){const t=this.app.graphManager.graph,n=e*Math.PI/-180,i=Zs.rotation(t,n);this.center(i)}center(e=void 0){const t=this.canvas.width/2,n=this.canvas.height/2,i=this.app.graphManager.graph;e||(e=Nn.collectLayout(i));const a={x:Qa(Object.values(e),f=>f.x),y:Qa(Object.values(e),f=>f.y)},s=t-a.x,d=n-a.y;Object.values(e).forEach(f=>{f.x+=s,f.y+=d}),Nn.assignLayout(i,e)}random(){const e=this.canvas.width/2,t=this.canvas.height/2,n=this.app.graphManager.graph,i=Zs.random(n,{scale:Math.max(e,t)});this.center(i)}organizeNodesInCircle(){const e=this.canvas.width/2,t=this.canvas.height/2,n=this.app.graphManager.graph,i=Math.min(e*.5,t*.5),a=Zs.circular(n,{scale:i,dimensions:["x","y"]});Object.values(a).forEach(s=>{s.x+=e,s.y+=t}),Nn.assignLayout(n,a)}organizeNodesInLine(){const e=this.canvas.width/2,t=this.canvas.height/2,n=e*.1,i=this.app.graphManager.graph,a=this.app.graphManager.graph.nodes(),s={};if(i.order===0)return;const d=(this.canvas.width-2*n)/Math.max(1,i.order-1);a.forEach((f,h)=>{s[f]={x:n+h*d,y:t}}),Nn.assignLayout(i,s)}organizeNodesInTwoLines(e,t=50){const n=this.canvas.width/2,i=this.canvas.height/2,a=n*.1,s=t,d=this.app.graphManager.graph,f=this.app.graphManager.graph.nodes(),h={};if(d.order===0)return;if(e>d.order){console.error("Line1 count exceeds total nodes.");return}const y=f.slice(0,e),b=f.slice(e),w=y.length,E=b.length,I=w>1?(this.canvas.width-2*a)/(w-1):0,D=E>1?(this.canvas.width-2*a)/(E-1):0,N=i-s,O=i+s;y.forEach((P,z)=>{h[P]={x:a+z*I,y:N}}),b.forEach((P,z)=>{h[P]={x:a+z*D,y:O}}),Nn.assignLayout(d,h)}rotate180(){const e=this.canvas.width,t=this.canvas.height,n=e*.15,i=this.app.graphManager.graph,a=i.nodes(),s={};if(i.order===0)return;let d=1/0,f=1/0,h=-1/0,y=-1/0;a.forEach(P=>{const{x:z,y:C}=i.getNodeAttributes(P);z<d&&(d=z),C<f&&(f=C),z>h&&(h=z),C>y&&(y=C)});const b=h-d,w=y-f,E=(e-2*n)/b,I=(t-2*n)/w,D=Math.min(E,I),N=(e-b*D)/2,O=(t-w*D)/2;i.forEachNode((P,z)=>{const C=e-((z.x-d)*D+N),L=t-((z.y-f)*D+O);s[P]={x:C,y:L}}),Nn.assignLayout(i,s)}}var Xi={exports:{}},Rb=Xi.exports,_d;function Lb(){return _d||(_d=1,function(r,e){(function(t,n){r.exports=n()})(Rb,function(){function t(l,c){var p=Object.keys(l);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(l);c&&(v=v.filter(function(x){return Object.getOwnPropertyDescriptor(l,x).enumerable})),p.push.apply(p,v)}return p}function n(l){for(var c=1;c<arguments.length;c++){var p=arguments[c]!=null?arguments[c]:{};c%2?t(Object(p),!0).forEach(function(v){f(l,v,p[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(l,Object.getOwnPropertyDescriptors(p)):t(Object(p)).forEach(function(v){Object.defineProperty(l,v,Object.getOwnPropertyDescriptor(p,v))})}return l}function i(l){return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},i(l)}function a(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")}function s(l,c){for(var p=0;p<c.length;p++){var v=c[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(l,D(v.key),v)}}function d(l,c,p){return c&&s(l.prototype,c),Object.defineProperty(l,"prototype",{writable:!1}),l}function f(l,c,p){return(c=D(c))in l?Object.defineProperty(l,c,{value:p,enumerable:!0,configurable:!0,writable:!0}):l[c]=p,l}function h(l,c){if(typeof c!="function"&&c!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(c&&c.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),c&&b(l,c)}function y(l){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(c){return c.__proto__||Object.getPrototypeOf(c)},y(l)}function b(l,c){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(p,v){return p.__proto__=v,p},b(l,c)}function w(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function E(l){var c=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var p,v=y(l);if(c){var x=y(this).constructor;p=Reflect.construct(v,arguments,x)}else p=v.apply(this,arguments);return function(k,T){if(T&&(typeof T=="object"||typeof T=="function"))return T;if(T!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w(k)}(this,p)}}function I(){return I=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(l,c,p){var v=function(k,T){for(;!Object.prototype.hasOwnProperty.call(k,T)&&(k=y(k))!==null;);return k}(l,c);if(v){var x=Object.getOwnPropertyDescriptor(v,c);return x.get?x.get.call(arguments.length<3?l:p):x.value}},I.apply(this,arguments)}function D(l){var c=function(p,v){if(typeof p!="object"||p===null)return p;var x=p[Symbol.toPrimitive];if(x!==void 0){var k=x.call(p,v);if(typeof k!="object")return k;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}(l,"string");return typeof c=="symbol"?c:c+""}var N=function(l){return!(!l||!l.Window)&&l instanceof l.Window},O=void 0,P=void 0;function z(l){O=l;var c=l.document.createTextNode("");c.ownerDocument!==l.document&&typeof l.wrap=="function"&&l.wrap(c)===c&&(l=l.wrap(l)),P=l}function C(l){return N(l)?l:(l.ownerDocument||l).defaultView||P.window}typeof window<"u"&&window&&z(window);var L=function(l){return!!l&&i(l)==="object"},K=function(l){return typeof l=="function"},S={window:function(l){return l===P||N(l)},docFrag:function(l){return L(l)&&l.nodeType===11},object:L,func:K,number:function(l){return typeof l=="number"},bool:function(l){return typeof l=="boolean"},string:function(l){return typeof l=="string"},element:function(l){if(!l||i(l)!=="object")return!1;var c=C(l)||P;return/object|function/.test(typeof Element>"u"?"undefined":i(Element))?l instanceof Element||l instanceof c.Element:l.nodeType===1&&typeof l.nodeName=="string"},plainObject:function(l){return L(l)&&!!l.constructor&&/function Object\b/.test(l.constructor.toString())},array:function(l){return L(l)&&l.length!==void 0&&K(l.splice)}};function G(l){var c=l.interaction;if(c.prepared.name==="drag"){var p=c.prepared.axis;p==="x"?(c.coords.cur.page.y=c.coords.start.page.y,c.coords.cur.client.y=c.coords.start.client.y,c.coords.velocity.client.y=0,c.coords.velocity.page.y=0):p==="y"&&(c.coords.cur.page.x=c.coords.start.page.x,c.coords.cur.client.x=c.coords.start.client.x,c.coords.velocity.client.x=0,c.coords.velocity.page.x=0)}}function q(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="drag"){var v=p.prepared.axis;if(v==="x"||v==="y"){var x=v==="x"?"y":"x";c.page[x]=p.coords.start.page[x],c.client[x]=p.coords.start.client[x],c.delta[x]=0}}}var j={id:"actions/drag",install:function(l){var c=l.actions,p=l.Interactable,v=l.defaults;p.prototype.draggable=j.draggable,c.map.drag=j,c.methodDict.drag="draggable",v.actions.drag=j.defaults},listeners:{"interactions:before-action-move":G,"interactions:action-resume":G,"interactions:action-move":q,"auto-start:check":function(l){var c=l.interaction,p=l.interactable,v=l.buttons,x=p.options.drag;if(x&&x.enabled&&(!c.pointerIsDown||!/mouse|pointer/.test(c.pointerType)||v&p.options.drag.mouseButtons))return l.action={name:"drag",axis:x.lockAxis==="start"?x.startAxis:x.lockAxis},!1}},draggable:function(l){return S.object(l)?(this.options.drag.enabled=l.enabled!==!1,this.setPerAction("drag",l),this.setOnEvents("drag",l),/^(xy|x|y|start)$/.test(l.lockAxis)&&(this.options.drag.lockAxis=l.lockAxis),/^(xy|x|y)$/.test(l.startAxis)&&(this.options.drag.startAxis=l.startAxis),this):S.bool(l)?(this.options.drag.enabled=l,this):this.options.drag},beforeMove:G,move:q,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(l){return l.search("drag")===0}},Y=j,te={init:function(l){var c=l;te.document=c.document,te.DocumentFragment=c.DocumentFragment||B,te.SVGElement=c.SVGElement||B,te.SVGSVGElement=c.SVGSVGElement||B,te.SVGElementInstance=c.SVGElementInstance||B,te.Element=c.Element||B,te.HTMLElement=c.HTMLElement||te.Element,te.Event=c.Event,te.Touch=c.Touch||B,te.PointerEvent=c.PointerEvent||c.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function B(){}var me=te,ge={init:function(l){var c=me.Element,p=l.navigator||{};ge.supportsTouch="ontouchstart"in l||S.func(l.DocumentTouch)&&me.document instanceof l.DocumentTouch,ge.supportsPointerEvent=p.pointerEnabled!==!1&&!!me.PointerEvent,ge.isIOS=/iP(hone|od|ad)/.test(p.platform),ge.isIOS7=/iP(hone|od|ad)/.test(p.platform)&&/OS 7[^\d]/.test(p.appVersion),ge.isIe9=/MSIE 9/.test(p.userAgent),ge.isOperaMobile=p.appName==="Opera"&&ge.supportsTouch&&/Presto/.test(p.userAgent),ge.prefixedMatchesSelector="matches"in c.prototype?"matches":"webkitMatchesSelector"in c.prototype?"webkitMatchesSelector":"mozMatchesSelector"in c.prototype?"mozMatchesSelector":"oMatchesSelector"in c.prototype?"oMatchesSelector":"msMatchesSelector",ge.pEventTypes=ge.supportsPointerEvent?me.PointerEvent===l.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,ge.wheelEvent=me.document&&"onmousewheel"in me.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},V=ge;function M(l,c){if(l.contains)return l.contains(c);for(;c;){if(c===l)return!0;c=c.parentNode}return!1}function J(l,c){for(;S.element(l);){if(de(l,c))return l;l=ne(l)}return null}function ne(l){var c=l.parentNode;if(S.docFrag(c)){for(;(c=c.host)&&S.docFrag(c););return c}return c}function de(l,c){return P!==O&&(c=c.replace(/\/deep\//g," ")),l[V.prefixedMatchesSelector](c)}var oe=function(l){return l.parentNode||l.host};function he(l,c){for(var p,v=[],x=l;(p=oe(x))&&x!==c&&p!==x.ownerDocument;)v.unshift(x),x=p;return v}function ue(l,c,p){for(;S.element(l);){if(de(l,c))return!0;if((l=ne(l))===p)return de(l,c)}return!1}function ve(l){return l.correspondingUseElement||l}function _e(l){var c=l instanceof me.SVGElement?l.getBoundingClientRect():l.getClientRects()[0];return c&&{left:c.left,right:c.right,top:c.top,bottom:c.bottom,width:c.width||c.right-c.left,height:c.height||c.bottom-c.top}}function Me(l){var c,p=_e(l);if(!V.isIOS7&&p){var v={x:(c=(c=C(l))||P).scrollX||c.document.documentElement.scrollLeft,y:c.scrollY||c.document.documentElement.scrollTop};p.left+=v.x,p.right+=v.x,p.top+=v.y,p.bottom+=v.y}return p}function Oe(l){for(var c=[];l;)c.push(l),l=ne(l);return c}function qe(l){return!!S.string(l)&&(me.document.querySelector(l),!0)}function ce(l,c){for(var p in c)l[p]=c[p];return l}function Pe(l,c,p){return l==="parent"?ne(p):l==="self"?c.getRect(p):J(p,l)}function Re(l,c,p,v){var x=l;return S.string(x)?x=Pe(x,c,p):S.func(x)&&(x=x.apply(void 0,v)),S.element(x)&&(x=Me(x)),x}function ke(l){return l&&{x:"x"in l?l.x:l.left,y:"y"in l?l.y:l.top}}function Ke(l){return!l||"x"in l&&"y"in l||((l=ce({},l)).x=l.left||0,l.y=l.top||0,l.width=l.width||(l.right||0)-l.x,l.height=l.height||(l.bottom||0)-l.y),l}function Le(l,c,p){l.left&&(c.left+=p.x),l.right&&(c.right+=p.x),l.top&&(c.top+=p.y),l.bottom&&(c.bottom+=p.y),c.width=c.right-c.left,c.height=c.bottom-c.top}function xe(l,c,p){var v=p&&l.options[p];return ke(Re(v&&v.origin||l.options.origin,l,c,[l&&c]))||{x:0,y:0}}function fe(l,c){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(U){return!0},v=arguments.length>3?arguments[3]:void 0;if(v=v||{},S.string(l)&&l.search(" ")!==-1&&(l=vt(l)),S.array(l))return l.forEach(function(U){return fe(U,c,p,v)}),v;if(S.object(l)&&(c=l,l=""),S.func(c)&&p(l))v[l]=v[l]||[],v[l].push(c);else if(S.array(c))for(var x=0,k=c;x<k.length;x++){var T=k[x];fe(l,T,p,v)}else if(S.object(c))for(var $ in c)fe(vt($).map(function(U){return"".concat(l).concat(U)}),c[$],p,v);return v}function vt(l){return l.trim().split(/ +/)}var it=function(l,c){return Math.sqrt(l*l+c*c)},xt=["webkit","moz"];function at(l,c){l.__set||(l.__set={});var p=function(x){if(xt.some(function(k){return x.indexOf(k)===0}))return 1;typeof l[x]!="function"&&x!=="__set"&&Object.defineProperty(l,x,{get:function(){return x in l.__set?l.__set[x]:l.__set[x]=c[x]},set:function(k){l.__set[x]=k},configurable:!0})};for(var v in c)p(v);return l}function Ve(l,c){l.page=l.page||{},l.page.x=c.page.x,l.page.y=c.page.y,l.client=l.client||{},l.client.x=c.client.x,l.client.y=c.client.y,l.timeStamp=c.timeStamp}function ht(l){l.page.x=0,l.page.y=0,l.client.x=0,l.client.y=0}function ot(l){return l instanceof me.Event||l instanceof me.Touch}function gt(l,c,p){return l=l||"page",(p=p||{}).x=c[l+"X"],p.y=c[l+"Y"],p}function Et(l,c){return c=c||{x:0,y:0},V.isOperaMobile&&ot(l)?(gt("screen",l,c),c.x+=window.scrollX,c.y+=window.scrollY):gt("page",l,c),c}function st(l){return S.number(l.pointerId)?l.pointerId:l.identifier}function ut(l,c,p){var v=c.length>1?rt(c):c[0];Et(v,l.page),function(x,k){k=k||{},V.isOperaMobile&&ot(x)?gt("screen",x,k):gt("client",x,k)}(v,l.client),l.timeStamp=p}function ft(l){var c=[];return S.array(l)?(c[0]=l[0],c[1]=l[1]):l.type==="touchend"?l.touches.length===1?(c[0]=l.touches[0],c[1]=l.changedTouches[0]):l.touches.length===0&&(c[0]=l.changedTouches[0],c[1]=l.changedTouches[1]):(c[0]=l.touches[0],c[1]=l.touches[1]),c}function rt(l){for(var c={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},p=0;p<l.length;p++){var v=l[p];for(var x in c)c[x]+=v[x]}for(var k in c)c[k]/=l.length;return c}function _t(l){if(!l.length)return null;var c=ft(l),p=Math.min(c[0].pageX,c[1].pageX),v=Math.min(c[0].pageY,c[1].pageY),x=Math.max(c[0].pageX,c[1].pageX),k=Math.max(c[0].pageY,c[1].pageY);return{x:p,y:v,left:p,top:v,right:x,bottom:k,width:x-p,height:k-v}}function mt(l,c){var p=c+"X",v=c+"Y",x=ft(l),k=x[0][p]-x[1][p],T=x[0][v]-x[1][v];return it(k,T)}function Pt(l,c){var p=c+"X",v=c+"Y",x=ft(l),k=x[1][p]-x[0][p],T=x[1][v]-x[0][v];return 180*Math.atan2(T,k)/Math.PI}function an(l){return S.string(l.pointerType)?l.pointerType:S.number(l.pointerType)?[void 0,void 0,"touch","pen","mouse"][l.pointerType]:/touch/.test(l.type||"")||l instanceof me.Touch?"touch":"mouse"}function Yn(l){var c=S.func(l.composedPath)?l.composedPath():l.path;return[ve(c?c[0]:l.target),ve(l.currentTarget)]}var Nt=function(){function l(c){a(this,l),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=c}return d(l,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),l}();Object.defineProperty(Nt.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var ze=function(l,c){for(var p=0;p<c.length;p++){var v=c[p];l.push(v)}return l},xn=function(l){return ze([],l)},bt=function(l,c){for(var p=0;p<l.length;p++)if(c(l[p],p,l))return p;return-1},St=function(l,c){return l[bt(l,c)]},Se=function(l){h(p,l);var c=E(p);function p(v,x,k){var T;a(this,p),(T=c.call(this,x._interaction)).dropzone=void 0,T.dragEvent=void 0,T.relatedTarget=void 0,T.draggable=void 0,T.propagationStopped=!1,T.immediatePropagationStopped=!1;var $=k==="dragleave"?v.prev:v.cur,U=$.element,o=$.dropzone;return T.type=k,T.target=U,T.currentTarget=U,T.dropzone=o,T.dragEvent=x,T.relatedTarget=x.target,T.draggable=x.interactable,T.timeStamp=x.timeStamp,T}return d(p,[{key:"reject",value:function(){var v=this,x=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&x.cur.dropzone===this.dropzone&&x.cur.element===this.target)if(x.prev.dropzone=this.dropzone,x.prev.element=this.target,x.rejected=!0,x.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var k=x.activeDrops,T=bt(k,function(U){var o=U.dropzone,u=U.element;return o===v.dropzone&&u===v.target});x.activeDrops.splice(T,1);var $=new p(x,this.dragEvent,"dropdeactivate");$.dropzone=this.dropzone,$.target=this.target,this.dropzone.fire($)}else this.dropzone.fire(new p(x,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),p}(Nt);function on(l,c){for(var p=0,v=l.slice();p<v.length;p++){var x=v[p],k=x.dropzone,T=x.element;c.dropzone=k,c.target=T,k.fire(c),c.propagationStopped=c.immediatePropagationStopped=!1}}function Ln(l,c){for(var p=function(k,T){for(var $=[],U=0,o=k.interactables.list;U<o.length;U++){var u=o[U];if(u.options.drop.enabled){var g=u.options.drop.accept;if(!(S.element(g)&&g!==T||S.string(g)&&!de(T,g)||S.func(g)&&!g({dropzone:u,draggableElement:T})))for(var m=0,_=u.getAllElements();m<_.length;m++){var A=_[m];A!==T&&$.push({dropzone:u,element:A,rect:u.getRect(A)})}}}return $}(l,c),v=0;v<p.length;v++){var x=p[v];x.rect=x.dropzone.getRect(x.element)}return p}function Xn(l,c,p){for(var v=l.dropState,x=l.interactable,k=l.element,T=[],$=0,U=v.activeDrops;$<U.length;$++){var o=U[$],u=o.dropzone,g=o.element,m=o.rect,_=u.dropCheck(c,p,x,k,g,m);T.push(_?g:null)}var A=function(R){for(var F,W,X,Z=[],H=0;H<R.length;H++){var ee=R[H],Q=R[F];if(ee&&H!==F)if(Q){var ie=oe(ee),ae=oe(Q);if(ie!==ee.ownerDocument)if(ae!==ee.ownerDocument)if(ie!==ae){Z=Z.length?Z:he(Q);var re=void 0;if(Q instanceof me.HTMLElement&&ee instanceof me.SVGElement&&!(ee instanceof me.SVGSVGElement)){if(ee===ae)continue;re=ee.ownerSVGElement}else re=ee;for(var se=he(re,Q.ownerDocument),le=0;se[le]&&se[le]===Z[le];)le++;var pe=[se[le-1],se[le],Z[le]];if(pe[0])for(var ye=pe[0].lastChild;ye;){if(ye===pe[1]){F=H,Z=se;break}if(ye===pe[2])break;ye=ye.previousSibling}}else X=Q,(parseInt(C(W=ee).getComputedStyle(W).zIndex,10)||0)>=(parseInt(C(X).getComputedStyle(X).zIndex,10)||0)&&(F=H);else F=H}else F=H}return F}(T);return v.activeDrops[A]||null}function Vn(l,c,p){var v=l.dropState,x={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return p.type==="dragstart"&&(x.activate=new Se(v,p,"dropactivate"),x.activate.target=null,x.activate.dropzone=null),p.type==="dragend"&&(x.deactivate=new Se(v,p,"dropdeactivate"),x.deactivate.target=null,x.deactivate.dropzone=null),v.rejected||(v.cur.element!==v.prev.element&&(v.prev.dropzone&&(x.leave=new Se(v,p,"dragleave"),p.dragLeave=x.leave.target=v.prev.element,p.prevDropzone=x.leave.dropzone=v.prev.dropzone),v.cur.dropzone&&(x.enter=new Se(v,p,"dragenter"),p.dragEnter=v.cur.element,p.dropzone=v.cur.dropzone)),p.type==="dragend"&&v.cur.dropzone&&(x.drop=new Se(v,p,"drop"),p.dropzone=v.cur.dropzone,p.relatedTarget=v.cur.element),p.type==="dragmove"&&v.cur.dropzone&&(x.move=new Se(v,p,"dropmove"),p.dropzone=v.cur.dropzone)),x}function cr(l,c){var p=l.dropState,v=p.activeDrops,x=p.cur,k=p.prev;c.leave&&k.dropzone.fire(c.leave),c.enter&&x.dropzone.fire(c.enter),c.move&&x.dropzone.fire(c.move),c.drop&&x.dropzone.fire(c.drop),c.deactivate&&on(v,c.deactivate),p.prev.dropzone=x.dropzone,p.prev.element=x.element}function aa(l,c){var p=l.interaction,v=l.iEvent,x=l.event;if(v.type==="dragmove"||v.type==="dragend"){var k=p.dropState;c.dynamicDrop&&(k.activeDrops=Ln(c,p.element));var T=v,$=Xn(p,T,x);k.rejected=k.rejected&&!!$&&$.dropzone===k.cur.dropzone&&$.element===k.cur.element,k.cur.dropzone=$&&$.dropzone,k.cur.element=$&&$.element,k.events=Vn(p,0,T)}}var oa={id:"actions/drop",install:function(l){var c=l.actions,p=l.interactStatic,v=l.Interactable,x=l.defaults;l.usePlugin(Y),v.prototype.dropzone=function(k){return function(T,$){if(S.object($)){if(T.options.drop.enabled=$.enabled!==!1,$.listeners){var U=fe($.listeners),o=Object.keys(U).reduce(function(g,m){return g[/^(enter|leave)/.test(m)?"drag".concat(m):/^(activate|deactivate|move)/.test(m)?"drop".concat(m):m]=U[m],g},{}),u=T.options.drop.listeners;u&&T.off(u),T.on(o),T.options.drop.listeners=o}return S.func($.ondrop)&&T.on("drop",$.ondrop),S.func($.ondropactivate)&&T.on("dropactivate",$.ondropactivate),S.func($.ondropdeactivate)&&T.on("dropdeactivate",$.ondropdeactivate),S.func($.ondragenter)&&T.on("dragenter",$.ondragenter),S.func($.ondragleave)&&T.on("dragleave",$.ondragleave),S.func($.ondropmove)&&T.on("dropmove",$.ondropmove),/^(pointer|center)$/.test($.overlap)?T.options.drop.overlap=$.overlap:S.number($.overlap)&&(T.options.drop.overlap=Math.max(Math.min(1,$.overlap),0)),"accept"in $&&(T.options.drop.accept=$.accept),"checker"in $&&(T.options.drop.checker=$.checker),T}return S.bool($)?(T.options.drop.enabled=$,T):T.options.drop}(this,k)},v.prototype.dropCheck=function(k,T,$,U,o,u){return function(g,m,_,A,R,F,W){var X=!1;if(!(W=W||g.getRect(F)))return!!g.options.drop.checker&&g.options.drop.checker(m,_,X,g,F,A,R);var Z=g.options.drop.overlap;if(Z==="pointer"){var H=xe(A,R,"drag"),ee=Et(m);ee.x+=H.x,ee.y+=H.y;var Q=ee.x>W.left&&ee.x<W.right,ie=ee.y>W.top&&ee.y<W.bottom;X=Q&&ie}var ae=A.getRect(R);if(ae&&Z==="center"){var re=ae.left+ae.width/2,se=ae.top+ae.height/2;X=re>=W.left&&re<=W.right&&se>=W.top&&se<=W.bottom}return ae&&S.number(Z)&&(X=Math.max(0,Math.min(W.right,ae.right)-Math.max(W.left,ae.left))*Math.max(0,Math.min(W.bottom,ae.bottom)-Math.max(W.top,ae.top))/(ae.width*ae.height)>=Z),g.options.drop.checker&&(X=g.options.drop.checker(m,_,X,g,F,A,R)),X}(this,k,T,$,U,o,u)},p.dynamicDrop=function(k){return S.bool(k)?(l.dynamicDrop=k,p):l.dynamicDrop},ce(c.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),c.methodDict.drop="dropzone",l.dynamicDrop=!1,x.actions.drop=oa.defaults},listeners:{"interactions:before-action-start":function(l){var c=l.interaction;c.prepared.name==="drag"&&(c.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(l,c){var p=l.interaction,v=(l.event,l.iEvent);if(p.prepared.name==="drag"){var x=p.dropState;x.activeDrops=[],x.events={},x.activeDrops=Ln(c,p.element),x.events=Vn(p,0,v),x.events.activate&&(on(x.activeDrops,x.events.activate),c.fire("actions/drop:start",{interaction:p,dragEvent:v}))}},"interactions:action-move":aa,"interactions:after-action-move":function(l,c){var p=l.interaction,v=l.iEvent;if(p.prepared.name==="drag"){var x=p.dropState;cr(p,x.events),c.fire("actions/drop:move",{interaction:p,dragEvent:v}),x.events={}}},"interactions:action-end":function(l,c){if(l.interaction.prepared.name==="drag"){var p=l.interaction,v=l.iEvent;aa(l,c),cr(p,p.dropState.events),c.fire("actions/drop:end",{interaction:p,dragEvent:v})}},"interactions:stop":function(l){var c=l.interaction;if(c.prepared.name==="drag"){var p=c.dropState;p&&(p.activeDrops=null,p.events=null,p.cur.dropzone=null,p.cur.element=null,p.prev.dropzone=null,p.prev.element=null,p.rejected=!1)}}},getActiveDrops:Ln,getDrop:Xn,getDropEvents:Vn,fireDropEvents:cr,filterEventType:function(l){return l.search("drag")===0||l.search("drop")===0},defaults:{enabled:!1,accept:null,overlap:"pointer"}},Qn=oa;function En(l){var c=l.interaction,p=l.iEvent,v=l.phase;if(c.prepared.name==="gesture"){var x=c.pointers.map(function(o){return o.pointer}),k=v==="start",T=v==="end",$=c.interactable.options.deltaSource;if(p.touches=[x[0],x[1]],k)p.distance=mt(x,$),p.box=_t(x),p.scale=1,p.ds=0,p.angle=Pt(x,$),p.da=0,c.gesture.startDistance=p.distance,c.gesture.startAngle=p.angle;else if(T||c.pointers.length<2){var U=c.prevEvent;p.distance=U.distance,p.box=U.box,p.scale=U.scale,p.ds=0,p.angle=U.angle,p.da=0}else p.distance=mt(x,$),p.box=_t(x),p.scale=p.distance/c.gesture.startDistance,p.angle=Pt(x,$),p.ds=p.scale-c.gesture.scale,p.da=p.angle-c.gesture.angle;c.gesture.distance=p.distance,c.gesture.angle=p.angle,S.number(p.scale)&&p.scale!==1/0&&!isNaN(p.scale)&&(c.gesture.scale=p.scale)}}var lr={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(l){var c=l.actions,p=l.Interactable,v=l.defaults;p.prototype.gesturable=function(x){return S.object(x)?(this.options.gesture.enabled=x.enabled!==!1,this.setPerAction("gesture",x),this.setOnEvents("gesture",x),this):S.bool(x)?(this.options.gesture.enabled=x,this):this.options.gesture},c.map.gesture=lr,c.methodDict.gesture="gesturable",v.actions.gesture=lr.defaults},listeners:{"interactions:action-start":En,"interactions:action-move":En,"interactions:action-end":En,"interactions:new":function(l){l.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(l){if(!(l.interaction.pointers.length<2)){var c=l.interactable.options.gesture;if(c&&c.enabled)return l.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(l){return l.search("gesture")===0}},Rr=lr;function Je(l,c,p,v,x,k,T){if(!c)return!1;if(c===!0){var $=S.number(k.width)?k.width:k.right-k.left,U=S.number(k.height)?k.height:k.bottom-k.top;if(T=Math.min(T,Math.abs((l==="left"||l==="right"?$:U)/2)),$<0&&(l==="left"?l="right":l==="right"&&(l="left")),U<0&&(l==="top"?l="bottom":l==="bottom"&&(l="top")),l==="left"){var o=$>=0?k.left:k.right;return p.x<o+T}if(l==="top"){var u=U>=0?k.top:k.bottom;return p.y<u+T}if(l==="right")return p.x>($>=0?k.right:k.left)-T;if(l==="bottom")return p.y>(U>=0?k.bottom:k.top)-T}return!!S.element(v)&&(S.element(c)?c===v:ue(v,c,x))}function ct(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="resize"&&p.resizeAxes){var v=c;p.interactable.options.resize.square?(p.resizeAxes==="y"?v.delta.x=v.delta.y:v.delta.y=v.delta.x,v.axes="xy"):(v.axes=p.resizeAxes,p.resizeAxes==="x"?v.delta.y=0:p.resizeAxes==="y"&&(v.delta.x=0))}}var sn,Xt,qt={id:"actions/resize",before:["actions/drag"],install:function(l){var c=l.actions,p=l.browser,v=l.Interactable,x=l.defaults;qt.cursors=function(k){return k.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(p),qt.defaultMargin=p.supportsTouch||p.supportsPointerEvent?20:10,v.prototype.resizable=function(k){return function(T,$,U){return S.object($)?(T.options.resize.enabled=$.enabled!==!1,T.setPerAction("resize",$),T.setOnEvents("resize",$),S.string($.axis)&&/^x$|^y$|^xy$/.test($.axis)?T.options.resize.axis=$.axis:$.axis===null&&(T.options.resize.axis=U.defaults.actions.resize.axis),S.bool($.preserveAspectRatio)?T.options.resize.preserveAspectRatio=$.preserveAspectRatio:S.bool($.square)&&(T.options.resize.square=$.square),T):S.bool($)?(T.options.resize.enabled=$,T):T.options.resize}(this,k,l)},c.map.resize=qt,c.methodDict.resize="resizable",x.actions.resize=qt.defaults},listeners:{"interactions:new":function(l){l.interaction.resizeAxes="xy"},"interactions:action-start":function(l){(function(c){var p=c.iEvent,v=c.interaction;if(v.prepared.name==="resize"&&v.prepared.edges){var x=p,k=v.rect;v._rects={start:ce({},k),corrected:ce({},k),previous:ce({},k),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},x.edges=v.prepared.edges,x.rect=v._rects.corrected,x.deltaRect=v._rects.delta}})(l),ct(l)},"interactions:action-move":function(l){(function(c){var p=c.iEvent,v=c.interaction;if(v.prepared.name==="resize"&&v.prepared.edges){var x=p,k=v.interactable.options.resize.invert,T=k==="reposition"||k==="negate",$=v.rect,U=v._rects,o=U.start,u=U.corrected,g=U.delta,m=U.previous;if(ce(m,u),T){if(ce(u,$),k==="reposition"){if(u.top>u.bottom){var _=u.top;u.top=u.bottom,u.bottom=_}if(u.left>u.right){var A=u.left;u.left=u.right,u.right=A}}}else u.top=Math.min($.top,o.bottom),u.bottom=Math.max($.bottom,o.top),u.left=Math.min($.left,o.right),u.right=Math.max($.right,o.left);for(var R in u.width=u.right-u.left,u.height=u.bottom-u.top,u)g[R]=u[R]-m[R];x.edges=v.prepared.edges,x.rect=u,x.deltaRect=g}})(l),ct(l)},"interactions:action-end":function(l){var c=l.iEvent,p=l.interaction;if(p.prepared.name==="resize"&&p.prepared.edges){var v=c;v.edges=p.prepared.edges,v.rect=p._rects.corrected,v.deltaRect=p._rects.delta}},"auto-start:check":function(l){var c=l.interaction,p=l.interactable,v=l.element,x=l.rect,k=l.buttons;if(x){var T=ce({},c.coords.cur.page),$=p.options.resize;if($&&$.enabled&&(!c.pointerIsDown||!/mouse|pointer/.test(c.pointerType)||k&$.mouseButtons)){if(S.object($.edges)){var U={left:!1,right:!1,top:!1,bottom:!1};for(var o in U)U[o]=Je(o,$.edges[o],T,c._latestPointer.eventTarget,v,x,$.margin||qt.defaultMargin);U.left=U.left&&!U.right,U.top=U.top&&!U.bottom,(U.left||U.right||U.top||U.bottom)&&(l.action={name:"resize",edges:U})}else{var u=$.axis!=="y"&&T.x>x.right-qt.defaultMargin,g=$.axis!=="x"&&T.y>x.bottom-qt.defaultMargin;(u||g)&&(l.action={name:"resize",axes:(u?"x":"")+(g?"y":"")})}return!l.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(l){var c=l.edges,p=l.axis,v=l.name,x=qt.cursors,k=null;if(p)k=x[v+p];else if(c){for(var T="",$=0,U=["top","bottom","left","right"];$<U.length;$++){var o=U[$];c[o]&&(T+=o)}k=x[T]}return k},filterEventType:function(l){return l.search("resize")===0},defaultMargin:null},Lr=qt,fo={id:"actions",install:function(l){l.usePlugin(Rr),l.usePlugin(Lr),l.usePlugin(Y),l.usePlugin(Qn)}},un=0,Ot={request:function(l){return sn(l)},cancel:function(l){return Xt(l)},init:function(l){if(sn=l.requestAnimationFrame,Xt=l.cancelAnimationFrame,!sn)for(var c=["ms","moz","webkit","o"],p=0;p<c.length;p++){var v=c[p];sn=l["".concat(v,"RequestAnimationFrame")],Xt=l["".concat(v,"CancelAnimationFrame")]||l["".concat(v,"CancelRequestAnimationFrame")]}sn=sn&&sn.bind(l),Xt=Xt&&Xt.bind(l),sn||(sn=function(x){var k=Date.now(),T=Math.max(0,16-(k-un)),$=l.setTimeout(function(){x(k+T)},T);return un=k+T,$},Xt=function(x){return clearTimeout(x)})}},$e={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(l){$e.isScrolling=!0,Ot.cancel($e.i),l.autoScroll=$e,$e.interaction=l,$e.prevTime=$e.now(),$e.i=Ot.request($e.scroll)},stop:function(){$e.isScrolling=!1,$e.interaction&&($e.interaction.autoScroll=null),Ot.cancel($e.i)},scroll:function(){var l=$e.interaction,c=l.interactable,p=l.element,v=l.prepared.name,x=c.options[v].autoScroll,k=dr(x.container,c,p),T=$e.now(),$=(T-$e.prevTime)/1e3,U=x.speed*$;if(U>=1){var o={x:$e.x*U,y:$e.y*U};if(o.x||o.y){var u=sa(k);S.window(k)?k.scrollBy(o.x,o.y):k&&(k.scrollLeft+=o.x,k.scrollTop+=o.y);var g=sa(k),m={x:g.x-u.x,y:g.y-u.y};(m.x||m.y)&&c.fire({type:"autoscroll",target:p,interactable:c,delta:m,interaction:l,container:k})}$e.prevTime=T}$e.isScrolling&&(Ot.cancel($e.i),$e.i=Ot.request($e.scroll))},check:function(l,c){var p;return(p=l.options[c].autoScroll)==null?void 0:p.enabled},onInteractionMove:function(l){var c=l.interaction,p=l.pointer;if(c.interacting()&&$e.check(c.interactable,c.prepared.name))if(c.simulation)$e.x=$e.y=0;else{var v,x,k,T,$=c.interactable,U=c.element,o=c.prepared.name,u=$.options[o].autoScroll,g=dr(u.container,$,U);if(S.window(g))T=p.clientX<$e.margin,v=p.clientY<$e.margin,x=p.clientX>g.innerWidth-$e.margin,k=p.clientY>g.innerHeight-$e.margin;else{var m=_e(g);T=p.clientX<m.left+$e.margin,v=p.clientY<m.top+$e.margin,x=p.clientX>m.right-$e.margin,k=p.clientY>m.bottom-$e.margin}$e.x=x?1:T?-1:0,$e.y=k?1:v?-1:0,$e.isScrolling||($e.margin=u.margin,$e.speed=u.speed,$e.start(c))}}};function dr(l,c,p){return(S.string(l)?Pe(l,c,p):l)||C(p)}function sa(l){return S.window(l)&&(l=window.document.body),{x:l.scrollLeft,y:l.scrollTop}}var _n={id:"auto-scroll",install:function(l){var c=l.defaults,p=l.actions;l.autoScroll=$e,$e.now=function(){return l.now()},p.phaselessTypes.autoscroll=!0,c.perAction.autoScroll=$e.defaults},listeners:{"interactions:new":function(l){l.interaction.autoScroll=null},"interactions:destroy":function(l){l.interaction.autoScroll=null,$e.stop(),$e.interaction&&($e.interaction=null)},"interactions:stop":$e.stop,"interactions:action-move":function(l){return $e.onInteractionMove(l)}}},ua=_n;function Bt(l,c){var p=!1;return function(){return p||(P.console.warn(c),p=!0),l.apply(this,arguments)}}function zr(l,c){return l.name=c.name,l.axis=c.axis,l.edges=c.edges,l}function mi(l){return S.bool(l)?(this.options.styleCursor=l,this):l===null?(delete this.options.styleCursor,this):this.options.styleCursor}function et(l){return S.func(l)?(this.options.actionChecker=l,this):l===null?(delete this.options.actionChecker,this):this.options.actionChecker}var zn={id:"auto-start/interactableMethods",install:function(l){var c=l.Interactable;c.prototype.getAction=function(p,v,x,k){var T=function($,U,o,u,g){var m=$.getRect(u),_=U.buttons||{0:1,1:4,3:8,4:16}[U.button],A={action:null,interactable:$,interaction:o,element:u,rect:m,buttons:_};return g.fire("auto-start:check",A),A.action}(this,v,x,k,l);return this.options.actionChecker?this.options.actionChecker(p,v,T,this,k,x):T},c.prototype.ignoreFrom=Bt(function(p){return this._backCompatOption("ignoreFrom",p)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),c.prototype.allowFrom=Bt(function(p){return this._backCompatOption("allowFrom",p)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),c.prototype.actionChecker=et,c.prototype.styleCursor=mi}};function Vt(l,c,p,v,x){return c.testIgnoreAllow(c.options[l.name],p,v)&&c.options[l.name].enabled&&Zn(c,p,l,x)?l:null}function ca(l,c,p,v,x,k,T){for(var $=0,U=v.length;$<U;$++){var o=v[$],u=x[$],g=o.getAction(c,p,l,u);if(g){var m=Vt(g,o,u,k,T);if(m)return{action:m,interactable:o,element:u}}}return{action:null,interactable:null,element:null}}function $n(l,c,p,v,x){var k=[],T=[],$=v;function U(u){k.push(u),T.push($)}for(;S.element($);){k=[],T=[],x.interactables.forEachMatch($,U);var o=ca(l,c,p,k,T,v,x);if(o.action&&!o.interactable.options[o.action.name].manualStart)return o;$=ne($)}return{action:null,interactable:null,element:null}}function hr(l,c,p){var v=c.action,x=c.interactable,k=c.element;v=v||{name:null},l.interactable=x,l.element=k,zr(l.prepared,v),l.rect=x&&v.name?x.getRect(k):null,bi(l,p),p.fire("autoStart:prepared",{interaction:l})}function Zn(l,c,p,v){var x=l.options,k=x[p.name].max,T=x[p.name].maxPerElement,$=v.autoStart.maxInteractions,U=0,o=0,u=0;if(!(k&&T&&$))return!1;for(var g=0,m=v.interactions.list;g<m.length;g++){var _=m[g],A=_.prepared.name;if(_.interacting()&&(++U>=$||_.interactable===l&&((o+=A===p.name?1:0)>=k||_.element===c&&(u++,A===p.name&&u>=T))))return!1}return $>0}function $r(l,c){return S.number(l)?(c.autoStart.maxInteractions=l,this):c.autoStart.maxInteractions}function cn(l,c,p){var v=p.autoStart.cursorElement;v&&v!==l&&(v.style.cursor=""),l.ownerDocument.documentElement.style.cursor=c,l.style.cursor=c,p.autoStart.cursorElement=c?l:null}function bi(l,c){var p=l.interactable,v=l.element,x=l.prepared;if(l.pointerType==="mouse"&&p&&p.options.styleCursor){var k="";if(x.name){var T=p.options[x.name].cursorChecker;k=S.func(T)?T(x,p,v,l._interacting):c.actions.map[x.name].getCursor(x)}cn(l.element,k||"",c)}else c.autoStart.cursorElement&&cn(c.autoStart.cursorElement,"",c)}var Gr={id:"auto-start/base",before:["actions"],install:function(l){var c=l.interactStatic,p=l.defaults;l.usePlugin(zn),p.base.actionChecker=null,p.base.styleCursor=!0,ce(p.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),c.maxInteractions=function(v){return $r(v,l)},l.autoStart={maxInteractions:1/0,withinInteractionLimit:Zn,cursorElement:null}},listeners:{"interactions:down":function(l,c){var p=l.interaction,v=l.pointer,x=l.event,k=l.eventTarget;p.interacting()||hr(p,$n(p,v,x,k,c),c)},"interactions:move":function(l,c){(function(p,v){var x=p.interaction,k=p.pointer,T=p.event,$=p.eventTarget;x.pointerType!=="mouse"||x.pointerIsDown||x.interacting()||hr(x,$n(x,k,T,$,v),v)})(l,c),function(p,v){var x=p.interaction;if(x.pointerIsDown&&!x.interacting()&&x.pointerWasMoved&&x.prepared.name){v.fire("autoStart:before-start",p);var k=x.interactable,T=x.prepared.name;T&&k&&(k.options[T].manualStart||!Zn(k,x.element,x.prepared,v)?x.stop():(x.start(x.prepared,k,x.element),bi(x,v)))}}(l,c)},"interactions:stop":function(l,c){var p=l.interaction,v=p.interactable;v&&v.options.styleCursor&&cn(p.element,"",c)}},maxInteractions:$r,withinInteractionLimit:Zn,validateAction:Vt},qr=Gr,Ye={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(l,c){var p=l.interaction,v=l.eventTarget,x=l.dx,k=l.dy;if(p.prepared.name==="drag"){var T=Math.abs(x),$=Math.abs(k),U=p.interactable.options.drag,o=U.startAxis,u=T>$?"x":T<$?"y":"xy";if(p.prepared.axis=U.lockAxis==="start"?u[0]:U.lockAxis,u!=="xy"&&o!=="xy"&&o!==u){p.prepared.name=null;for(var g=v,m=function(A){if(A!==p.interactable){var R=p.interactable.options.drag;if(!R.manualStart&&A.testIgnoreAllow(R,g,v)){var F=A.getAction(p.downPointer,p.downEvent,p,g);if(F&&F.name==="drag"&&function(W,X){if(!X)return!1;var Z=X.options.drag.startAxis;return W==="xy"||Z==="xy"||Z===W}(u,A)&&qr.validateAction(F,A,g,v,c))return A}}};S.element(g);){var _=c.interactables.forEachMatch(g,m);if(_){p.prepared.name="drag",p.interactable=_,p.element=g;break}g=ne(g)}}}}}};function Fr(l){var c=l.prepared&&l.prepared.name;if(!c)return null;var p=l.interactable.options;return p[c].hold||p[c].delay}var la={id:"auto-start/hold",install:function(l){var c=l.defaults;l.usePlugin(qr),c.perAction.hold=0,c.perAction.delay=0},listeners:{"interactions:new":function(l){l.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(l){var c=l.interaction,p=Fr(c);p>0&&(c.autoStartHoldTimer=setTimeout(function(){c.start(c.prepared,c.interactable,c.element)},p))},"interactions:move":function(l){var c=l.interaction,p=l.duplicate;c.autoStartHoldTimer&&c.pointerWasMoved&&!p&&(clearTimeout(c.autoStartHoldTimer),c.autoStartHoldTimer=null)},"autoStart:before-start":function(l){var c=l.interaction;Fr(c)>0&&(c.prepared.name=null)}},getHoldDuration:Fr},da=la,Ze={id:"auto-start",install:function(l){l.usePlugin(qr),l.usePlugin(da),l.usePlugin(Ye)}},fr=function(l){return/^(always|never|auto)$/.test(l)?(this.options.preventDefault=l,this):S.bool(l)?(this.options.preventDefault=l?"always":"never",this):this.options.preventDefault};function pr(l){var c=l.interaction,p=l.event;c.interactable&&c.interactable.checkAndPreventDefault(p)}var Gn={id:"core/interactablePreventDefault",install:function(l){var c=l.Interactable;c.prototype.preventDefault=fr,c.prototype.checkAndPreventDefault=function(p){return function(v,x,k){var T=v.options.preventDefault;if(T!=="never")if(T!=="always"){if(x.events.supportsPassive&&/^touch(start|move)$/.test(k.type)){var $=C(k.target).document,U=x.getDocOptions($);if(!U||!U.events||U.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(k.type)||S.element(k.target)&&de(k.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||k.preventDefault()}else k.preventDefault()}(this,l,p)},l.interactions.docEvents.push({type:"dragstart",listener:function(p){for(var v=0,x=l.interactions.list;v<x.length;v++){var k=x[v];if(k.element&&(k.element===p.target||M(k.element,p.target)))return void k.interactable.checkAndPreventDefault(p)}}})},listeners:["down","move","up","cancel"].reduce(function(l,c){return l["interactions:".concat(c)]=pr,l},{})};function Jn(l,c){if(c.phaselessTypes[l])return!0;for(var p in c.map)if(l.indexOf(p)===0&&l.substr(p.length)in c.phases)return!0;return!1}function Sn(l){var c={};for(var p in l){var v=l[p];S.plainObject(v)?c[p]=Sn(v):S.array(v)?c[p]=xn(v):c[p]=v}return c}var er=function(){function l(c){a(this,l),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=c,this.result=gr(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return d(l,[{key:"start",value:function(c,p){var v,x,k=c.phase,T=this.interaction,$=function(o){var u=o.interactable.options[o.prepared.name],g=u.modifiers;return g&&g.length?g:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(m){var _=u[m];return _&&_.enabled&&{options:_,methods:_._methods}}).filter(function(m){return!!m})}(T);this.prepareStates($),this.startEdges=ce({},T.edges),this.edges=ce({},this.startEdges),this.startOffset=(v=T.rect,x=p,v?{left:x.x-v.left,top:x.y-v.top,right:v.right-x.x,bottom:v.bottom-x.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var U=this.fillArg({phase:k,pageCoords:p,preEnd:!1});return this.result=gr(),this.startAll(U),this.result=this.setAll(U)}},{key:"fillArg",value:function(c){var p=this.interaction;return c.interaction=p,c.interactable=p.interactable,c.element=p.element,c.rect||(c.rect=p.rect),c.edges||(c.edges=this.startEdges),c.startOffset=this.startOffset,c}},{key:"startAll",value:function(c){for(var p=0,v=this.states;p<v.length;p++){var x=v[p];x.methods.start&&(c.state=x,x.methods.start(c))}}},{key:"setAll",value:function(c){var p=c.phase,v=c.preEnd,x=c.skipModifiers,k=c.rect,T=c.edges;c.coords=ce({},c.pageCoords),c.rect=ce({},k),c.edges=ce({},T);for(var $=x?this.states.slice(x):this.states,U=gr(c.coords,c.rect),o=0;o<$.length;o++){var u,g=$[o],m=g.options,_=ce({},c.coords),A=null;(u=g.methods)!=null&&u.set&&this.shouldDo(m,v,p)&&(c.state=g,A=g.methods.set(c),Le(c.edges,c.rect,{x:c.coords.x-_.x,y:c.coords.y-_.y})),U.eventProps.push(A)}ce(this.edges,c.edges),U.delta.x=c.coords.x-c.pageCoords.x,U.delta.y=c.coords.y-c.pageCoords.y,U.rectDelta.left=c.rect.left-k.left,U.rectDelta.right=c.rect.right-k.right,U.rectDelta.top=c.rect.top-k.top,U.rectDelta.bottom=c.rect.bottom-k.bottom;var R=this.result.coords,F=this.result.rect;if(R&&F){var W=U.rect.left!==F.left||U.rect.right!==F.right||U.rect.top!==F.top||U.rect.bottom!==F.bottom;U.changed=W||R.x!==U.coords.x||R.y!==U.coords.y}return U}},{key:"applyToInteraction",value:function(c){var p=this.interaction,v=c.phase,x=p.coords.cur,k=p.coords.start,T=this.result,$=this.startDelta,U=T.delta;v==="start"&&ce(this.startDelta,T.delta);for(var o=0,u=[[k,$],[x,U]];o<u.length;o++){var g=u[o],m=g[0],_=g[1];m.page.x+=_.x,m.page.y+=_.y,m.client.x+=_.x,m.client.y+=_.y}var A=this.result.rectDelta,R=c.rect||p.rect;R.left+=A.left,R.right+=A.right,R.top+=A.top,R.bottom+=A.bottom,R.width=R.right-R.left,R.height=R.bottom-R.top}},{key:"setAndApply",value:function(c){var p=this.interaction,v=c.phase,x=c.preEnd,k=c.skipModifiers,T=this.setAll(this.fillArg({preEnd:x,phase:v,pageCoords:c.modifiedCoords||p.coords.cur.page}));if(this.result=T,!T.changed&&(!k||k<this.states.length)&&p.interacting())return!1;if(c.modifiedCoords){var $=p.coords.cur.page,U={x:c.modifiedCoords.x-$.x,y:c.modifiedCoords.y-$.y};T.coords.x+=U.x,T.coords.y+=U.y,T.delta.x+=U.x,T.delta.y+=U.y}this.applyToInteraction(c)}},{key:"beforeEnd",value:function(c){var p=c.interaction,v=c.event,x=this.states;if(x&&x.length){for(var k=!1,T=0;T<x.length;T++){var $=x[T];c.state=$;var U=$.options,o=$.methods,u=o.beforeEnd&&o.beforeEnd(c);if(u)return this.endResult=u,!1;k=k||!k&&this.shouldDo(U,!0,c.phase,!0)}k&&p.move({event:v,preEnd:!0})}}},{key:"stop",value:function(c){var p=c.interaction;if(this.states&&this.states.length){var v=ce({states:this.states,interactable:p.interactable,element:p.element,rect:null},c);this.fillArg(v);for(var x=0,k=this.states;x<k.length;x++){var T=k[x];v.state=T,T.methods.stop&&T.methods.stop(v)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(c){this.states=[];for(var p=0;p<c.length;p++){var v=c[p],x=v.options,k=v.methods,T=v.name;this.states.push({options:x,methods:k,index:p,name:T})}return this.states}},{key:"restoreInteractionCoords",value:function(c){var p=c.interaction,v=p.coords,x=p.rect,k=p.modification;if(k.result){for(var T=k.startDelta,$=k.result,U=$.delta,o=$.rectDelta,u=0,g=[[v.start,T],[v.cur,U]];u<g.length;u++){var m=g[u],_=m[0],A=m[1];_.page.x-=A.x,_.page.y-=A.y,_.client.x-=A.x,_.client.y-=A.y}x.left-=o.left,x.right-=o.right,x.top-=o.top,x.bottom-=o.bottom}}},{key:"shouldDo",value:function(c,p,v,x){return!(!c||c.enabled===!1||x&&!c.endOnly||c.endOnly&&!p||v==="start"&&!c.setStart)}},{key:"copyFrom",value:function(c){this.startOffset=c.startOffset,this.startDelta=c.startDelta,this.startEdges=c.startEdges,this.edges=c.edges,this.states=c.states.map(function(p){return Sn(p)}),this.result=gr(ce({},c.result.coords),ce({},c.result.rect))}},{key:"destroy",value:function(){for(var c in this)this[c]=null}}]),l}();function gr(l,c){return{rect:c,coords:l,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Ut(l,c){var p=l.defaults,v={start:l.start,set:l.set,beforeEnd:l.beforeEnd,stop:l.stop},x=function(k){var T=k||{};for(var $ in T.enabled=T.enabled!==!1,p)$ in T||(T[$]=p[$]);var U={options:T,methods:v,name:c,enable:function(){return T.enabled=!0,U},disable:function(){return T.enabled=!1,U}};return U};return c&&typeof c=="string"&&(x._defaults=p,x._methods=v),x}function tr(l){var c=l.iEvent,p=l.interaction.modification.result;p&&(c.modifiers=p.eventProps)}var yr={id:"modifiers/base",before:["actions"],install:function(l){l.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(l){var c=l.interaction;c.modification=new er(c)},"interactions:before-action-start":function(l){var c=l.interaction,p=l.interaction.modification;p.start(l,c.coords.start.page),c.edges=p.edges,p.applyToInteraction(l)},"interactions:before-action-move":function(l){var c=l.interaction,p=c.modification,v=p.setAndApply(l);return c.edges=p.edges,v},"interactions:before-action-end":function(l){var c=l.interaction,p=c.modification,v=p.beforeEnd(l);return c.edges=p.startEdges,v},"interactions:action-start":tr,"interactions:action-move":tr,"interactions:action-end":tr,"interactions:after-action-start":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:after-action-move":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:stop":function(l){return l.interaction.modification.stop(l)}}},wi=yr,ha={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},Xe=function(l){h(p,l);var c=E(p);function p(v,x,k,T,$,U,o){var u;a(this,p),(u=c.call(this,v)).relatedTarget=null,u.screenX=void 0,u.screenY=void 0,u.button=void 0,u.buttons=void 0,u.ctrlKey=void 0,u.shiftKey=void 0,u.altKey=void 0,u.metaKey=void 0,u.page=void 0,u.client=void 0,u.delta=void 0,u.rect=void 0,u.x0=void 0,u.y0=void 0,u.t0=void 0,u.dt=void 0,u.duration=void 0,u.clientX0=void 0,u.clientY0=void 0,u.velocity=void 0,u.speed=void 0,u.swipe=void 0,u.axes=void 0,u.preEnd=void 0,$=$||v.element;var g=v.interactable,m=(g&&g.options||ha).deltaSource,_=xe(g,$,k),A=T==="start",R=T==="end",F=A?w(u):v.prevEvent,W=A?v.coords.start:R?{page:F.page,client:F.client,timeStamp:v.coords.cur.timeStamp}:v.coords.cur;return u.page=ce({},W.page),u.client=ce({},W.client),u.rect=ce({},v.rect),u.timeStamp=W.timeStamp,R||(u.page.x-=_.x,u.page.y-=_.y,u.client.x-=_.x,u.client.y-=_.y),u.ctrlKey=x.ctrlKey,u.altKey=x.altKey,u.shiftKey=x.shiftKey,u.metaKey=x.metaKey,u.button=x.button,u.buttons=x.buttons,u.target=$,u.currentTarget=$,u.preEnd=U,u.type=o||k+(T||""),u.interactable=g,u.t0=A?v.pointers[v.pointers.length-1].downTime:F.t0,u.x0=v.coords.start.page.x-_.x,u.y0=v.coords.start.page.y-_.y,u.clientX0=v.coords.start.client.x-_.x,u.clientY0=v.coords.start.client.y-_.y,u.delta=A||R?{x:0,y:0}:{x:u[m].x-F[m].x,y:u[m].y-F[m].y},u.dt=v.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=ce({},v.coords.velocity[m]),u.speed=it(u.velocity.x,u.velocity.y),u.swipe=R||T==="inertiastart"?u.getSwipe():null,u}return d(p,[{key:"getSwipe",value:function(){var v=this._interaction;if(v.prevEvent.speed<600||this.timeStamp-v.prevEvent.timeStamp>150)return null;var x=180*Math.atan2(v.prevEvent.velocityY,v.prevEvent.velocityX)/Math.PI;x<0&&(x+=360);var k=112.5<=x&&x<247.5,T=202.5<=x&&x<337.5;return{up:T,down:!T&&22.5<=x&&x<157.5,left:k,right:!k&&(292.5<=x||x<67.5),angle:x,speed:v.prevEvent.speed,velocity:{x:v.prevEvent.velocityX,y:v.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),p}(Nt);Object.defineProperties(Xe.prototype,{pageX:{get:function(){return this.page.x},set:function(l){this.page.x=l}},pageY:{get:function(){return this.page.y},set:function(l){this.page.y=l}},clientX:{get:function(){return this.client.x},set:function(l){this.client.x=l}},clientY:{get:function(){return this.client.y},set:function(l){this.client.y=l}},dx:{get:function(){return this.delta.x},set:function(l){this.delta.x=l}},dy:{get:function(){return this.delta.y},set:function(l){this.delta.y=l}},velocityX:{get:function(){return this.velocity.x},set:function(l){this.velocity.x=l}},velocityY:{get:function(){return this.velocity.y},set:function(l){this.velocity.y=l}}});var xi=d(function l(c,p,v,x,k){a(this,l),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=c,this.pointer=p,this.event=v,this.downTime=x,this.downTarget=k}),po=function(l){return l.interactable="",l.element="",l.prepared="",l.pointerIsDown="",l.pointerWasMoved="",l._proxy="",l}({}),fa=function(l){return l.start="",l.move="",l.end="",l.stop="",l.interacting="",l}({}),Tt=0,nr=function(){function l(c){var p=this,v=c.pointerType,x=c.scopeFire;a(this,l),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=Bt(function(u){this.move(u)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=Tt++,this._scopeFire=x,this.pointerType=v;var k=this;this._proxy={};var T=function(u){Object.defineProperty(p._proxy,u,{get:function(){return k[u]}})};for(var $ in po)T($);var U=function(u){Object.defineProperty(p._proxy,u,{value:function(){return k[u].apply(k,arguments)}})};for(var o in fa)U(o);this._scopeFire("interactions:new",{interaction:this})}return d(l,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(c,p,v){var x=this.updatePointer(c,p,v,!0),k=this.pointers[x];this._scopeFire("interactions:down",{pointer:c,event:p,eventTarget:v,pointerIndex:x,pointerInfo:k,type:"down",interaction:this})}},{key:"start",value:function(c,p,v){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(c.name==="gesture"?2:1)||!p.options[c.name].enabled)&&(zr(this.prepared,c),this.interactable=p,this.element=v,this.rect=p.getRect(v),this.edges=this.prepared.edges?ce({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(c,p,v){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(c,p,v,!1);var x,k,T=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(x=this.coords.cur.client.x-this.coords.start.client.x,k=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=it(x,k)>this.pointerMoveTolerance);var $,U,o,u=this.getPointerIndex(c),g={pointer:c,pointerIndex:u,pointerInfo:this.pointers[u],event:p,type:"move",eventTarget:v,dx:x,dy:k,duplicate:T,interaction:this};T||($=this.coords.velocity,U=this.coords.delta,o=Math.max(U.timeStamp/1e3,.001),$.page.x=U.page.x/o,$.page.y=U.page.y/o,$.client.x=U.client.x/o,$.client.y=U.client.y/o,$.timeStamp=o),this._scopeFire("interactions:move",g),T||this.simulation||(this.interacting()&&(g.type=null,this.move(g)),this.pointerWasMoved&&Ve(this.coords.prev,this.coords.cur))}},{key:"move",value:function(c){c&&c.event||ht(this.coords.delta),(c=ce({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},c||{})).phase="move",this._doPhase(c)}},{key:"pointerUp",value:function(c,p,v,x){var k=this.getPointerIndex(c);k===-1&&(k=this.updatePointer(c,p,v,!1));var T=/cancel$/i.test(p.type)?"cancel":"up";this._scopeFire("interactions:".concat(T),{pointer:c,pointerIndex:k,pointerInfo:this.pointers[k],event:p,eventTarget:v,type:T,curEventTarget:x,interaction:this}),this.simulation||this.end(p),this.removePointer(c,p)}},{key:"documentBlur",value:function(c){this.end(c),this._scopeFire("interactions:blur",{event:c,type:"blur",interaction:this})}},{key:"end",value:function(c){var p;this._ending=!0,c=c||this._latestPointer.event,this.interacting()&&(p=this._doPhase({event:c,interaction:this,phase:"end"})),this._ending=!1,p===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(c){var p=st(c);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:bt(this.pointers,function(v){return v.id===p})}},{key:"getPointerInfo",value:function(c){return this.pointers[this.getPointerIndex(c)]}},{key:"updatePointer",value:function(c,p,v,x){var k,T,$,U=st(c),o=this.getPointerIndex(c),u=this.pointers[o];return x=x!==!1&&(x||/(down|start)$/i.test(p.type)),u?u.pointer=c:(u=new xi(U,c,p,null,null),o=this.pointers.length,this.pointers.push(u)),ut(this.coords.cur,this.pointers.map(function(g){return g.pointer}),this._now()),k=this.coords.delta,T=this.coords.prev,$=this.coords.cur,k.page.x=$.page.x-T.page.x,k.page.y=$.page.y-T.page.y,k.client.x=$.client.x-T.client.x,k.client.y=$.client.y-T.client.y,k.timeStamp=$.timeStamp-T.timeStamp,x&&(this.pointerIsDown=!0,u.downTime=this.coords.cur.timeStamp,u.downTarget=v,at(this.downPointer,c),this.interacting()||(Ve(this.coords.start,this.coords.cur),Ve(this.coords.prev,this.coords.cur),this.downEvent=p,this.pointerWasMoved=!1)),this._updateLatestPointer(c,p,v),this._scopeFire("interactions:update-pointer",{pointer:c,event:p,eventTarget:v,down:x,pointerInfo:u,pointerIndex:o,interaction:this}),o}},{key:"removePointer",value:function(c,p){var v=this.getPointerIndex(c);if(v!==-1){var x=this.pointers[v];this._scopeFire("interactions:remove-pointer",{pointer:c,event:p,eventTarget:null,pointerIndex:v,pointerInfo:x,interaction:this}),this.pointers.splice(v,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(c,p,v){this._latestPointer.pointer=c,this._latestPointer.event=p,this._latestPointer.eventTarget=v}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(c,p,v,x){return new Xe(this,c,this.prepared.name,p,this.element,v,x)}},{key:"_fireEvent",value:function(c){var p;(p=this.interactable)==null||p.fire(c),(!this.prevEvent||c.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=c)}},{key:"_doPhase",value:function(c){var p=c.event,v=c.phase,x=c.preEnd,k=c.type,T=this.rect;if(T&&v==="move"&&(Le(this.edges,T,this.coords.delta[this.interactable.options.deltaSource]),T.width=T.right-T.left,T.height=T.bottom-T.top),this._scopeFire("interactions:before-action-".concat(v),c)===!1)return!1;var $=c.iEvent=this._createPreparedEvent(p,v,x,k);return this._scopeFire("interactions:action-".concat(v),c),v==="start"&&(this.prevEvent=$),this._fireEvent($),this._scopeFire("interactions:after-action-".concat(v),c),!0}},{key:"_now",value:function(){return Date.now()}}]),l}();function vr(l){ln(l.interaction)}function ln(l){if(!function(p){return!(!p.offset.pending.x&&!p.offset.pending.y)}(l))return!1;var c=l.offset.pending;return jr(l.coords.cur,c),jr(l.coords.delta,c),Le(l.edges,l.rect,c),c.x=0,c.y=0,!0}function pa(l){var c=l.x,p=l.y;this.offset.pending.x+=c,this.offset.pending.y+=p,this.offset.total.x+=c,this.offset.total.y+=p}function jr(l,c){var p=l.page,v=l.client,x=c.x,k=c.y;p.x+=x,p.y+=k,v.x+=x,v.y+=k}fa.offsetBy="";var lt={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(l){l.Interaction.prototype.offsetBy=pa},listeners:{"interactions:new":function(l){l.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(l){return function(c){c.pointerIsDown&&(jr(c.coords.cur,c.offset.total),c.offset.pending.x=0,c.offset.pending.y=0)}(l.interaction)},"interactions:before-action-start":vr,"interactions:before-action-move":vr,"interactions:before-action-end":function(l){var c=l.interaction;if(ln(c))return c.move({offset:!0}),c.end(),!1},"interactions:stop":function(l){var c=l.interaction;c.offset.total.x=0,c.offset.total.y=0,c.offset.pending.x=0,c.offset.pending.y=0}}},Kt=lt,mr=function(){function l(c){a(this,l),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=c}return d(l,[{key:"start",value:function(c){var p=this.interaction,v=An(p);if(!v||!v.enabled)return!1;var x=p.coords.velocity.client,k=it(x.x,x.y),T=this.modification||(this.modification=new er(p));if(T.copyFrom(p.modification),this.t0=p._now(),this.allowResume=v.allowResume,this.v0=k,this.currentOffset={x:0,y:0},this.startCoords=p.coords.cur.page,this.modifierArg=T.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-p.coords.cur.timeStamp<50&&k>v.minSpeed&&k>v.endSpeed)this.startInertia();else{if(T.result=T.setAll(this.modifierArg),!T.result.changed)return!1;this.startSmoothEnd()}return p.modification.result.rect=null,p.offsetBy(this.targetOffset),p._doPhase({interaction:p,event:c,phase:"inertiastart"}),p.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),p.modification.result.rect=null,this.active=!0,p.simulation=this,!0}},{key:"startInertia",value:function(){var c=this,p=this.interaction.coords.velocity.client,v=An(this.interaction),x=v.resistance,k=-Math.log(v.endSpeed/this.v0)/x;this.targetOffset={x:(p.x-k)/x,y:(p.y-k)/x},this.te=k,this.lambda_v0=x/this.v0,this.one_ve_v0=1-v.endSpeed/this.v0;var T=this.modification,$=this.modifierArg;$.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},T.result=T.setAll($),T.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+T.result.delta.x,y:this.targetOffset.y+T.result.delta.y}),this.onNextFrame(function(){return c.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var c=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return c.smoothEndTick()})}},{key:"onNextFrame",value:function(c){var p=this;this.timeout=Ot.request(function(){p.active&&c()})}},{key:"inertiaTick",value:function(){var c,p,v,x,k,T,$,U=this,o=this.interaction,u=An(o).resistance,g=(o._now()-this.t0)/1e3;if(g<this.te){var m,_=1-(Math.exp(-u*g)-this.lambda_v0)/this.one_ve_v0;this.isModified?(c=0,p=0,v=this.targetOffset.x,x=this.targetOffset.y,k=this.modifiedOffset.x,T=this.modifiedOffset.y,m={x:dn($=_,c,v,k),y:dn($,p,x,T)}):m={x:this.targetOffset.x*_,y:this.targetOffset.y*_};var A={x:m.x-this.currentOffset.x,y:m.y-this.currentOffset.y};this.currentOffset.x+=A.x,this.currentOffset.y+=A.y,o.offsetBy(A),o.move(),this.onNextFrame(function(){return U.inertiaTick()})}else o.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var c=this,p=this.interaction,v=p._now()-this.t0,x=An(p).smoothEndDuration;if(v<x){var k={x:ga(v,0,this.targetOffset.x,x),y:ga(v,0,this.targetOffset.y,x)},T={x:k.x-this.currentOffset.x,y:k.y-this.currentOffset.y};this.currentOffset.x+=T.x,this.currentOffset.y+=T.y,p.offsetBy(T),p.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return c.smoothEndTick()})}else p.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(c){var p=c.pointer,v=c.event,x=c.eventTarget,k=this.interaction;k.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),k.updatePointer(p,v,x,!0),k._doPhase({interaction:k,event:v,phase:"resume"}),Ve(k.coords.prev,k.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Ot.cancel(this.timeout)}}]),l}();function An(l){var c=l.interactable,p=l.prepared;return c&&c.options&&p.name&&c.options[p.name].inertia}var Ei={id:"inertia",before:["modifiers","actions"],install:function(l){var c=l.defaults;l.usePlugin(Kt),l.usePlugin(wi),l.actions.phases.inertiastart=!0,l.actions.phases.resume=!0,c.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(l){var c=l.interaction;c.inertia=new mr(c)},"interactions:before-action-end":function(l){var c=l.interaction,p=l.event;return(!c._interacting||c.simulation||!c.inertia.start(p))&&null},"interactions:down":function(l){var c=l.interaction,p=l.eventTarget,v=c.inertia;if(v.active)for(var x=p;S.element(x);){if(x===c.element){v.resume(l);break}x=ne(x)}},"interactions:stop":function(l){var c=l.interaction.inertia;c.active&&c.stop()},"interactions:before-action-resume":function(l){var c=l.interaction.modification;c.stop(l),c.start(l,l.interaction.coords.cur.page),c.applyToInteraction(l)},"interactions:before-action-inertiastart":function(l){return l.interaction.modification.setAndApply(l)},"interactions:action-resume":tr,"interactions:action-inertiastart":tr,"interactions:after-action-inertiastart":function(l){return l.interaction.modification.restoreInteractionCoords(l)},"interactions:after-action-resume":function(l){return l.interaction.modification.restoreInteractionCoords(l)}}};function dn(l,c,p,v){var x=1-l;return x*x*c+2*x*l*p+l*l*v}function ga(l,c,p,v){return-p*(l/=v)*(l-2)+c}var Qt=Ei;function Br(l,c){for(var p=0;p<c.length;p++){var v=c[p];if(l.immediatePropagationStopped)break;v(l)}}var _i=function(){function l(c){a(this,l),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=ce({},c||{})}return d(l,[{key:"fire",value:function(c){var p,v=this.global;(p=this.types[c.type])&&Br(c,p),!c.propagationStopped&&v&&(p=v[c.type])&&Br(c,p)}},{key:"on",value:function(c,p){var v=fe(c,p);for(c in v)this.types[c]=ze(this.types[c]||[],v[c])}},{key:"off",value:function(c,p){var v=fe(c,p);for(c in v){var x=this.types[c];if(x&&x.length)for(var k=0,T=v[c];k<T.length;k++){var $=T[k],U=x.indexOf($);U!==-1&&x.splice(U,1)}}}},{key:"getRect",value:function(c){return null}}]),l}(),Si=function(){function l(c){a(this,l),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=c,at(this,c)}return d(l,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),l}();function hn(l){return S.object(l)?{capture:!!l.capture,passive:!!l.passive}:{capture:!!l,passive:!1}}function rr(l,c){return l===c||(typeof l=="boolean"?!!c.capture===l&&!c.passive:!!l.capture==!!c.capture&&!!l.passive==!!c.passive)}var ya={id:"events",install:function(l){var c,p=[],v={},x=[],k={add:T,remove:$,addDelegate:function(u,g,m,_,A){var R=hn(A);if(!v[m]){v[m]=[];for(var F=0;F<x.length;F++){var W=x[F];T(W,m,U),T(W,m,o,!0)}}var X=v[m],Z=St(X,function(H){return H.selector===u&&H.context===g});Z||(Z={selector:u,context:g,listeners:[]},X.push(Z)),Z.listeners.push({func:_,options:R})},removeDelegate:function(u,g,m,_,A){var R,F=hn(A),W=v[m],X=!1;if(W)for(R=W.length-1;R>=0;R--){var Z=W[R];if(Z.selector===u&&Z.context===g){for(var H=Z.listeners,ee=H.length-1;ee>=0;ee--){var Q=H[ee];if(Q.func===_&&rr(Q.options,F)){H.splice(ee,1),H.length||(W.splice(R,1),$(g,m,U),$(g,m,o,!0)),X=!0;break}}if(X)break}}},delegateListener:U,delegateUseCapture:o,delegatedEvents:v,documents:x,targets:p,supportsOptions:!1,supportsPassive:!1};function T(u,g,m,_){if(u.addEventListener){var A=hn(_),R=St(p,function(F){return F.eventTarget===u});R||(R={eventTarget:u,events:{}},p.push(R)),R.events[g]||(R.events[g]=[]),St(R.events[g],function(F){return F.func===m&&rr(F.options,A)})||(u.addEventListener(g,m,k.supportsOptions?A:A.capture),R.events[g].push({func:m,options:A}))}}function $(u,g,m,_){if(u.addEventListener&&u.removeEventListener){var A=bt(p,function(ie){return ie.eventTarget===u}),R=p[A];if(R&&R.events)if(g!=="all"){var F=!1,W=R.events[g];if(W){if(m==="all"){for(var X=W.length-1;X>=0;X--){var Z=W[X];$(u,g,Z.func,Z.options)}return}for(var H=hn(_),ee=0;ee<W.length;ee++){var Q=W[ee];if(Q.func===m&&rr(Q.options,H)){u.removeEventListener(g,m,k.supportsOptions?H:H.capture),W.splice(ee,1),W.length===0&&(delete R.events[g],F=!0);break}}}F&&!Object.keys(R.events).length&&p.splice(A,1)}else for(g in R.events)R.events.hasOwnProperty(g)&&$(u,g,"all")}}function U(u,g){for(var m=hn(g),_=new Si(u),A=v[u.type],R=Yn(u)[0],F=R;S.element(F);){for(var W=0;W<A.length;W++){var X=A[W],Z=X.selector,H=X.context;if(de(F,Z)&&M(H,R)&&M(H,F)){var ee=X.listeners;_.currentTarget=F;for(var Q=0;Q<ee.length;Q++){var ie=ee[Q];rr(ie.options,m)&&ie.func(_)}}}F=ne(F)}}function o(u){return U(u,!0)}return(c=l.document)==null||c.createElement("div").addEventListener("test",null,{get capture(){return k.supportsOptions=!0},get passive(){return k.supportsPassive=!0}}),l.events=k,k}},Ai={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(l){for(var c=0,p=Ai.methodOrder;c<p.length;c++){var v=p[c],x=Ai[v](l);if(x)return x}return null},simulationResume:function(l){var c=l.pointerType,p=l.eventType,v=l.eventTarget,x=l.scope;if(!/down|start/i.test(p))return null;for(var k=0,T=x.interactions.list;k<T.length;k++){var $=T[k],U=v;if($.simulation&&$.simulation.allowResume&&$.pointerType===c)for(;U;){if(U===$.element)return $;U=ne(U)}}return null},mouseOrPen:function(l){var c,p=l.pointerId,v=l.pointerType,x=l.eventType,k=l.scope;if(v!=="mouse"&&v!=="pen")return null;for(var T=0,$=k.interactions.list;T<$.length;T++){var U=$[T];if(U.pointerType===v){if(U.simulation&&!ir(U,p))continue;if(U.interacting())return U;c||(c=U)}}if(c)return c;for(var o=0,u=k.interactions.list;o<u.length;o++){var g=u[o];if(!(g.pointerType!==v||/down/i.test(x)&&g.simulation))return g}return null},hasPointer:function(l){for(var c=l.pointerId,p=0,v=l.scope.interactions.list;p<v.length;p++){var x=v[p];if(ir(x,c))return x}return null},idle:function(l){for(var c=l.pointerType,p=0,v=l.scope.interactions.list;p<v.length;p++){var x=v[p];if(x.pointers.length===1){var k=x.interactable;if(k&&(!k.options.gesture||!k.options.gesture.enabled))continue}else if(x.pointers.length>=2)continue;if(!x.interacting()&&c===x.pointerType)return x}return null}};function ir(l,c){return l.pointers.some(function(p){return p.id===c})}var go=Ai,ki=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function br(l,c){return function(p){var v=c.interactions.list,x=an(p),k=Yn(p),T=k[0],$=k[1],U=[];if(/^touch/.test(p.type)){c.prevTouchTime=c.now();for(var o=0,u=p.changedTouches;o<u.length;o++){var g=u[o],m={pointer:g,pointerId:st(g),pointerType:x,eventType:p.type,eventTarget:T,curEventTarget:$,scope:c},_=wr(m);U.push([m.pointer,m.eventTarget,m.curEventTarget,_])}}else{var A=!1;if(!V.supportsPointerEvent&&/mouse/.test(p.type)){for(var R=0;R<v.length&&!A;R++)A=v[R].pointerType!=="mouse"&&v[R].pointerIsDown;A=A||c.now()-c.prevTouchTime<500||p.timeStamp===0}if(!A){var F={pointer:p,pointerId:st(p),pointerType:x,eventType:p.type,curEventTarget:$,eventTarget:T,scope:c},W=wr(F);U.push([F.pointer,F.eventTarget,F.curEventTarget,W])}}for(var X=0;X<U.length;X++){var Z=U[X],H=Z[0],ee=Z[1],Q=Z[2];Z[3][l](H,p,ee,Q)}}}function wr(l){var c=l.pointerType,p=l.scope,v={interaction:go.search(l),searchDetails:l};return p.fire("interactions:find",v),v.interaction||p.interactions.new({pointerType:c})}function xr(l,c){var p=l.doc,v=l.scope,x=l.options,k=v.interactions.docEvents,T=v.events,$=T[c];for(var U in v.browser.isIOS&&!x.events&&(x.events={passive:!1}),T.delegatedEvents)$(p,U,T.delegateListener),$(p,U,T.delegateUseCapture,!0);for(var o=x&&x.events,u=0;u<k.length;u++){var g=k[u];$(p,g.type,g.listener,o)}}var yo={id:"core/interactions",install:function(l){for(var c={},p=0;p<ki.length;p++){var v=ki[p];c[v]=br(v,l)}var x,k=V.pEventTypes;function T(){for(var $=0,U=l.interactions.list;$<U.length;$++){var o=U[$];if(o.pointerIsDown&&o.pointerType==="touch"&&!o._interacting)for(var u=function(){var _=m[g];l.documents.some(function(A){return M(A.doc,_.downTarget)})||o.removePointer(_.pointer,_.event)},g=0,m=o.pointers;g<m.length;g++)u()}}(x=me.PointerEvent?[{type:k.down,listener:T},{type:k.down,listener:c.pointerDown},{type:k.move,listener:c.pointerMove},{type:k.up,listener:c.pointerUp},{type:k.cancel,listener:c.pointerUp}]:[{type:"mousedown",listener:c.pointerDown},{type:"mousemove",listener:c.pointerMove},{type:"mouseup",listener:c.pointerUp},{type:"touchstart",listener:T},{type:"touchstart",listener:c.pointerDown},{type:"touchmove",listener:c.pointerMove},{type:"touchend",listener:c.pointerUp},{type:"touchcancel",listener:c.pointerUp}]).push({type:"blur",listener:function($){for(var U=0,o=l.interactions.list;U<o.length;U++)o[U].documentBlur($)}}),l.prevTouchTime=0,l.Interaction=function($){h(o,$);var U=E(o);function o(){return a(this,o),U.apply(this,arguments)}return d(o,[{key:"pointerMoveTolerance",get:function(){return l.interactions.pointerMoveTolerance},set:function(u){l.interactions.pointerMoveTolerance=u}},{key:"_now",value:function(){return l.now()}}]),o}(nr),l.interactions={list:[],new:function($){$.scopeFire=function(o,u){return l.fire(o,u)};var U=new l.Interaction($);return l.interactions.list.push(U),U},listeners:c,docEvents:x,pointerMoveTolerance:1},l.usePlugin(Gn)},listeners:{"scope:add-document":function(l){return xr(l,"add")},"scope:remove-document":function(l){return xr(l,"remove")},"interactable:unset":function(l,c){for(var p=l.interactable,v=c.interactions.list.length-1;v>=0;v--){var x=c.interactions.list[v];x.interactable===p&&(x.stop(),c.fire("interactions:destroy",{interaction:x}),x.destroy(),c.interactions.list.length>2&&c.interactions.list.splice(v,1))}}},onDocSignal:xr,doOnInteractions:br,methodNames:ki},vo=yo,kn=function(l){return l[l.On=0]="On",l[l.Off=1]="Off",l}(kn||{}),Ci=function(){function l(c,p,v,x){a(this,l),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new _i,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=p.actions,this.target=c,this._context=p.context||v,this._win=C(qe(c)?this._context:c),this._doc=this._win.document,this._scopeEvents=x,this.set(p)}return d(l,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(c,p){return S.func(p.onstart)&&this.on("".concat(c,"start"),p.onstart),S.func(p.onmove)&&this.on("".concat(c,"move"),p.onmove),S.func(p.onend)&&this.on("".concat(c,"end"),p.onend),S.func(p.oninertiastart)&&this.on("".concat(c,"inertiastart"),p.oninertiastart),this}},{key:"updatePerActionListeners",value:function(c,p,v){var x,k=this,T=(x=this._actions.map[c])==null?void 0:x.filterEventType,$=function(U){return(T==null||T(U))&&Jn(U,k._actions)};(S.array(p)||S.object(p))&&this._onOff(kn.Off,c,p,void 0,$),(S.array(v)||S.object(v))&&this._onOff(kn.On,c,v,void 0,$)}},{key:"setPerAction",value:function(c,p){var v=this._defaults;for(var x in p){var k=x,T=this.options[c],$=p[k];k==="listeners"&&this.updatePerActionListeners(c,T.listeners,$),S.array($)?T[k]=xn($):S.plainObject($)?(T[k]=ce(T[k]||{},Sn($)),S.object(v.perAction[k])&&"enabled"in v.perAction[k]&&(T[k].enabled=$.enabled!==!1)):S.bool($)&&S.object(v.perAction[k])?T[k].enabled=$:T[k]=$}}},{key:"getRect",value:function(c){return c=c||(S.element(this.target)?this.target:null),S.string(this.target)&&(c=c||this._context.querySelector(this.target)),Me(c)}},{key:"rectChecker",value:function(c){var p=this;return S.func(c)?(this.getRect=function(v){var x=ce({},c.apply(p,v));return"width"in x||(x.width=x.right-x.left,x.height=x.bottom-x.top),x},this):c===null?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(c,p){if(qe(p)||S.object(p)){for(var v in this.options[c]=p,this._actions.map)this.options[v][c]=p;return this}return this.options[c]}},{key:"origin",value:function(c){return this._backCompatOption("origin",c)}},{key:"deltaSource",value:function(c){return c==="page"||c==="client"?(this.options.deltaSource=c,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var c=this.target;return S.string(c)?Array.from(this._context.querySelectorAll(c)):S.func(c)&&c.getAllElements?c.getAllElements():S.element(c)?[c]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(c){return this._context===c.ownerDocument||M(this._context,c)}},{key:"testIgnoreAllow",value:function(c,p,v){return!this.testIgnore(c.ignoreFrom,p,v)&&this.testAllow(c.allowFrom,p,v)}},{key:"testAllow",value:function(c,p,v){return!c||!!S.element(v)&&(S.string(c)?ue(v,c,p):!!S.element(c)&&M(c,v))}},{key:"testIgnore",value:function(c,p,v){return!(!c||!S.element(v))&&(S.string(c)?ue(v,c,p):!!S.element(c)&&M(c,v))}},{key:"fire",value:function(c){return this.events.fire(c),this}},{key:"_onOff",value:function(c,p,v,x,k){S.object(p)&&!S.array(p)&&(x=v,v=null);var T=fe(p,v,k);for(var $ in T){$==="wheel"&&($=V.wheelEvent);for(var U=0,o=T[$];U<o.length;U++){var u=o[U];Jn($,this._actions)?this.events[c===kn.On?"on":"off"]($,u):S.string(this.target)?this._scopeEvents[c===kn.On?"addDelegate":"removeDelegate"](this.target,this._context,$,u,x):this._scopeEvents[c===kn.On?"add":"remove"](this.target,$,u,x)}}return this}},{key:"on",value:function(c,p,v){return this._onOff(kn.On,c,p,v)}},{key:"off",value:function(c,p,v){return this._onOff(kn.Off,c,p,v)}},{key:"set",value:function(c){var p=this._defaults;for(var v in S.object(c)||(c={}),this.options=Sn(p.base),this._actions.methodDict){var x=v,k=this._actions.methodDict[x];this.options[x]={},this.setPerAction(x,ce(ce({},p.perAction),p.actions[x])),this[k](c[x])}for(var T in c)T!=="getRect"?S.func(this[T])&&this[T](c[T]):this.rectChecker(c.getRect);return this}},{key:"unset",value:function(){if(S.string(this.target))for(var c in this._scopeEvents.delegatedEvents)for(var p=this._scopeEvents.delegatedEvents[c],v=p.length-1;v>=0;v--){var x=p[v],k=x.selector,T=x.context,$=x.listeners;k===this.target&&T===this._context&&p.splice(v,1);for(var U=$.length-1;U>=0;U--)this._scopeEvents.removeDelegate(this.target,this._context,c,$[U][0],$[U][1])}else this._scopeEvents.remove(this.target,"all")}}]),l}(),Di=function(){function l(c){var p=this;a(this,l),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=c,c.addListeners({"interactable:unset":function(v){var x=v.interactable,k=x.target,T=S.string(k)?p.selectorMap[k]:k[p.scope.id],$=bt(T,function(U){return U===x});T.splice($,1)}})}return d(l,[{key:"new",value:function(c,p){p=ce(p||{},{actions:this.scope.actions});var v=new this.scope.Interactable(c,p,this.scope.document,this.scope.events);return this.scope.addDocument(v._doc),this.list.push(v),S.string(c)?(this.selectorMap[c]||(this.selectorMap[c]=[]),this.selectorMap[c].push(v)):(v.target[this.scope.id]||Object.defineProperty(c,this.scope.id,{value:[],configurable:!0}),c[this.scope.id].push(v)),this.scope.fire("interactable:new",{target:c,options:p,interactable:v,win:this.scope._win}),v}},{key:"getExisting",value:function(c,p){var v=p&&p.context||this.scope.document,x=S.string(c),k=x?this.selectorMap[c]:c[this.scope.id];if(k)return St(k,function(T){return T._context===v&&(x||T.inContext(c))})}},{key:"forEachMatch",value:function(c,p){for(var v=0,x=this.list;v<x.length;v++){var k=x[v],T=void 0;if((S.string(k.target)?S.element(c)&&de(c,k.target):c===k.target)&&k.inContext(c)&&(T=p(k)),T!==void 0)return T}}}]),l}(),va=function(){function l(){var c=this;a(this,l),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=V,this.defaults=Sn(ha),this.Eventable=_i,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(v){var x=function k(T,$){var U=v.interactables.getExisting(T,$);return U||((U=v.interactables.new(T,$)).events.global=k.globalEvents),U};return x.getPointerAverage=rt,x.getTouchBBox=_t,x.getTouchDistance=mt,x.getTouchAngle=Pt,x.getElementRect=Me,x.getElementClientRect=_e,x.matchesSelector=de,x.closest=J,x.globalEvents={},x.version="1.10.27",x.scope=v,x.use=function(k,T){return this.scope.usePlugin(k,T),this},x.isSet=function(k,T){return!!this.scope.interactables.get(k,T&&T.context)},x.on=Bt(function(k,T,$){if(S.string(k)&&k.search(" ")!==-1&&(k=k.trim().split(/ +/)),S.array(k)){for(var U=0,o=k;U<o.length;U++){var u=o[U];this.on(u,T,$)}return this}if(S.object(k)){for(var g in k)this.on(g,k[g],T);return this}return Jn(k,this.scope.actions)?this.globalEvents[k]?this.globalEvents[k].push(T):this.globalEvents[k]=[T]:this.scope.events.add(this.scope.document,k,T,{options:$}),this},"The interact.on() method is being deprecated"),x.off=Bt(function(k,T,$){if(S.string(k)&&k.search(" ")!==-1&&(k=k.trim().split(/ +/)),S.array(k)){for(var U=0,o=k;U<o.length;U++){var u=o[U];this.off(u,T,$)}return this}if(S.object(k)){for(var g in k)this.off(g,k[g],T);return this}var m;return Jn(k,this.scope.actions)?k in this.globalEvents&&(m=this.globalEvents[k].indexOf(T))!==-1&&this.globalEvents[k].splice(m,1):this.scope.events.remove(this.scope.document,k,T,$),this},"The interact.off() method is being deprecated"),x.debug=function(){return this.scope},x.supportsTouch=function(){return V.supportsTouch},x.supportsPointerEvent=function(){return V.supportsPointerEvent},x.stop=function(){for(var k=0,T=this.scope.interactions.list;k<T.length;k++)T[k].stop();return this},x.pointerMoveTolerance=function(k){return S.number(k)?(this.scope.interactions.pointerMoveTolerance=k,this):this.scope.interactions.pointerMoveTolerance},x.addDocument=function(k,T){this.scope.addDocument(k,T)},x.removeDocument=function(k){this.scope.removeDocument(k)},x}(this),this.InteractEvent=Xe,this.Interactable=void 0,this.interactables=new Di(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(v){return c.removeDocument(v.target)};var p=this;this.Interactable=function(v){h(k,v);var x=E(k);function k(){return a(this,k),x.apply(this,arguments)}return d(k,[{key:"_defaults",get:function(){return p.defaults}},{key:"set",value:function(T){return I(y(k.prototype),"set",this).call(this,T),p.fire("interactable:set",{options:T,interactable:this}),this}},{key:"unset",value:function(){I(y(k.prototype),"unset",this).call(this);var T=p.interactables.list.indexOf(this);T<0||(p.interactables.list.splice(T,1),p.fire("interactable:unset",{interactable:this}))}}]),k}(Ci)}return d(l,[{key:"addListeners",value:function(c,p){this.listenerMaps.push({id:p,map:c})}},{key:"fire",value:function(c,p){for(var v=0,x=this.listenerMaps;v<x.length;v++){var k=x[v].map[c];if(k&&k(p,this,c)===!1)return!1}}},{key:"init",value:function(c){return this.isInitialized?this:function(p,v){return p.isInitialized=!0,S.window(v)&&z(v),me.init(v),V.init(v),Ot.init(v),p.window=v,p.document=v.document,p.usePlugin(vo),p.usePlugin(ya),p}(this,c)}},{key:"pluginIsInstalled",value:function(c){var p=c.id;return p?!!this._plugins.map[p]:this._plugins.list.indexOf(c)!==-1}},{key:"usePlugin",value:function(c,p){if(!this.isInitialized)return this;if(this.pluginIsInstalled(c))return this;if(c.id&&(this._plugins.map[c.id]=c),this._plugins.list.push(c),c.install&&c.install(this,p),c.listeners&&c.before){for(var v=0,x=this.listenerMaps.length,k=c.before.reduce(function($,U){return $[U]=!0,$[Er(U)]=!0,$},{});v<x;v++){var T=this.listenerMaps[v].id;if(T&&(k[T]||k[Er(T)]))break}this.listenerMaps.splice(v,0,{id:c.id,map:c.listeners})}else c.listeners&&this.listenerMaps.push({id:c.id,map:c.listeners});return this}},{key:"addDocument",value:function(c,p){if(this.getDocIndex(c)!==-1)return!1;var v=C(c);p=p?ce({},p):{},this.documents.push({doc:c,options:p}),this.events.documents.push(c),c!==this.document&&this.events.add(v,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:c,window:v,scope:this,options:p})}},{key:"removeDocument",value:function(c){var p=this.getDocIndex(c),v=C(c),x=this.documents[p].options;this.events.remove(v,"unload",this.onWindowUnload),this.documents.splice(p,1),this.events.documents.splice(p,1),this.fire("scope:remove-document",{doc:c,window:v,scope:this,options:x})}},{key:"getDocIndex",value:function(c){for(var p=0;p<this.documents.length;p++)if(this.documents[p].doc===c)return p;return-1}},{key:"getDocOptions",value:function(c){var p=this.getDocIndex(c);return p===-1?null:this.documents[p].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),l}();function Er(l){return l&&l.replace(/\/.*$/,"")}var _r=new va,dt=_r.interactStatic,ma=typeof globalThis<"u"?globalThis:window;_r.init(ma);var mo=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(l){var c=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(v){var x=v[0],k=v[1];return x in l||k in l}),p=function(v,x){for(var k=l.range,T=l.limits,$=T===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:T,U=l.offset,o=U===void 0?{x:0,y:0}:U,u={range:k,grid:l,x:null,y:null},g=0;g<c.length;g++){var m=c[g],_=m[0],A=m[1],R=Math.round((v-o.x)/l[_]),F=Math.round((x-o.y)/l[A]);u[_]=Math.max($.left,Math.min($.right,R*l[_]+o.x)),u[A]=Math.max($.top,Math.min($.bottom,F*l[A]+o.y))}return u};return p.grid=l,p.coordFields=c,p}}),Ur={id:"snappers",install:function(l){var c=l.interactStatic;c.snappers=ce(c.snappers||{},mo),c.createSnapGrid=c.snappers.grid}},Ii=Ur,Mi={start:function(l){var c=l.state,p=l.rect,v=l.edges,x=l.pageCoords,k=c.options,T=k.ratio,$=k.enabled,U=c.options,o=U.equalDelta,u=U.modifiers;T==="preserve"&&(T=p.width/p.height),c.startCoords=ce({},x),c.startRect=ce({},p),c.ratio=T,c.equalDelta=o;var g=c.linkedEdges={top:v.top||v.left&&!v.bottom,left:v.left||v.top&&!v.right,bottom:v.bottom||v.right&&!v.top,right:v.right||v.bottom&&!v.left};if(c.xIsPrimaryAxis=!(!v.left&&!v.right),c.equalDelta){var m=(g.left?1:-1)*(g.top?1:-1);c.edgeSign={x:m,y:m}}else c.edgeSign={x:g.left?-1:1,y:g.top?-1:1};if($!==!1&&ce(v,g),u!=null&&u.length){var _=new er(l.interaction);_.copyFrom(l.interaction.modification),_.prepareStates(u),c.subModification=_,_.startAll(n({},l))}},set:function(l){var c=l.state,p=l.rect,v=l.coords,x=c.linkedEdges,k=ce({},v),T=c.equalDelta?Pi:Ni;if(ce(l.edges,x),T(c,c.xIsPrimaryAxis,v,p),!c.subModification)return null;var $=ce({},p);Le(x,$,{x:v.x-k.x,y:v.y-k.y});var U=c.subModification.setAll(n(n({},l),{},{rect:$,edges:x,pageCoords:v,prevCoords:v,prevRect:$})),o=U.delta;return U.changed&&(T(c,Math.abs(o.x)>Math.abs(o.y),U.coords,U.rect),ce(v,U.coords)),U.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function Pi(l,c,p){var v=l.startCoords,x=l.edgeSign;c?p.y=v.y+(p.x-v.x)*x.y:p.x=v.x+(p.y-v.y)*x.x}function Ni(l,c,p,v){var x=l.startRect,k=l.startCoords,T=l.ratio,$=l.edgeSign;if(c){var U=v.width/T;p.y=k.y+(U-x.height)*$.y}else{var o=v.height*T;p.x=k.x+(o-x.width)*$.x}}var yt=Ut(Mi,"aspectRatio"),ar=function(){};ar._defaults={};var Cn=ar;function Dn(l,c,p){return S.func(l)?Re(l,c.interactable,c.element,[p.x,p.y,c]):Re(l,c.interactable,c.element)}var qn={start:function(l){var c=l.rect,p=l.startOffset,v=l.state,x=l.interaction,k=l.pageCoords,T=v.options,$=T.elementRect,U=ce({left:0,top:0,right:0,bottom:0},T.offset||{});if(c&&$){var o=Dn(T.restriction,x,k);if(o){var u=o.right-o.left-c.width,g=o.bottom-o.top-c.height;u<0&&(U.left+=u,U.right+=u),g<0&&(U.top+=g,U.bottom+=g)}U.left+=p.left-c.width*$.left,U.top+=p.top-c.height*$.top,U.right+=p.right-c.width*(1-$.right),U.bottom+=p.bottom-c.height*(1-$.bottom)}v.offset=U},set:function(l){var c=l.coords,p=l.interaction,v=l.state,x=v.options,k=v.offset,T=Dn(x.restriction,p,c);if(T){var $=function(U){return!U||"left"in U&&"top"in U||((U=ce({},U)).left=U.x||0,U.top=U.y||0,U.right=U.right||U.left+U.width,U.bottom=U.bottom||U.top+U.height),U}(T);c.x=Math.max(Math.min($.right-k.right,c.x),$.left+k.left),c.y=Math.max(Math.min($.bottom-k.bottom,c.y),$.top+k.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},ba=Ut(qn,"restrict"),Oi={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Sr={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function Kr(l,c){for(var p=0,v=["top","left","bottom","right"];p<v.length;p++){var x=v[p];x in l||(l[x]=c[x])}return l}var Wt={noInner:Oi,noOuter:Sr,start:function(l){var c,p=l.interaction,v=l.startOffset,x=l.state,k=x.options;k&&(c=ke(Dn(k.offset,p,p.coords.start.page))),c=c||{x:0,y:0},x.offset={top:c.y+v.top,left:c.x+v.left,bottom:c.y-v.bottom,right:c.x-v.right}},set:function(l){var c=l.coords,p=l.edges,v=l.interaction,x=l.state,k=x.offset,T=x.options;if(p){var $=ce({},c),U=Dn(T.inner,v,$)||{},o=Dn(T.outer,v,$)||{};Kr(U,Oi),Kr(o,Sr),p.top?c.y=Math.min(Math.max(o.top+k.top,$.y),U.top+k.top):p.bottom&&(c.y=Math.max(Math.min(o.bottom+k.bottom,$.y),U.bottom+k.bottom)),p.left?c.x=Math.min(Math.max(o.left+k.left,$.x),U.left+k.left):p.right&&(c.x=Math.max(Math.min(o.right+k.right,$.x),U.right+k.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},Ti=Ut(Wt,"restrictEdges"),Ri=ce({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(l){}},qn.defaults),Wr=Ut({start:qn.start,set:qn.set,defaults:Ri},"restrictRect"),Li={width:-1/0,height:-1/0},wa={width:1/0,height:1/0},bo=Ut({start:function(l){return Wt.start(l)},set:function(l){var c=l.interaction,p=l.state,v=l.rect,x=l.edges,k=p.options;if(x){var T=Ke(Dn(k.min,c,l.coords))||Li,$=Ke(Dn(k.max,c,l.coords))||wa;p.options={endOnly:k.endOnly,inner:ce({},Wt.noInner),outer:ce({},Wt.noOuter)},x.top?(p.options.inner.top=v.bottom-T.height,p.options.outer.top=v.bottom-$.height):x.bottom&&(p.options.inner.bottom=v.top+T.height,p.options.outer.bottom=v.top+$.height),x.left?(p.options.inner.left=v.right-T.width,p.options.outer.left=v.right-$.width):x.right&&(p.options.inner.right=v.left+T.width,p.options.outer.right=v.left+$.width),Wt.set(l),p.options=k}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Ar={start:function(l){var c,p=l.interaction,v=l.interactable,x=l.element,k=l.rect,T=l.state,$=l.startOffset,U=T.options,o=U.offsetWithOrigin?function(m){var _=m.interaction.element,A=ke(Re(m.state.options.origin,null,null,[_])),R=A||xe(m.interactable,_,m.interaction.prepared.name);return R}(l):{x:0,y:0};if(U.offset==="startCoords")c={x:p.coords.start.page.x,y:p.coords.start.page.y};else{var u=Re(U.offset,v,x,[p]);(c=ke(u)||{x:0,y:0}).x+=o.x,c.y+=o.y}var g=U.relativePoints;T.offsets=k&&g&&g.length?g.map(function(m,_){return{index:_,relativePoint:m,x:$.left-k.width*m.x+c.x,y:$.top-k.height*m.y+c.y}}):[{index:0,relativePoint:null,x:c.x,y:c.y}]},set:function(l){var c=l.interaction,p=l.coords,v=l.state,x=v.options,k=v.offsets,T=xe(c.interactable,c.element,c.prepared.name),$=ce({},p),U=[];x.offsetWithOrigin||($.x-=T.x,$.y-=T.y);for(var o=0,u=k;o<u.length;o++)for(var g=u[o],m=$.x-g.x,_=$.y-g.y,A=0,R=x.targets.length;A<R;A++){var F=x.targets[A],W=void 0;(W=S.func(F)?F(m,_,c._proxy,g,A):F)&&U.push({x:(S.number(W.x)?W.x:m)+g.x,y:(S.number(W.y)?W.y:_)+g.y,range:S.number(W.range)?W.range:x.range,source:F,index:A,offset:g})}for(var X={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},Z=0;Z<U.length;Z++){var H=U[Z],ee=H.range,Q=H.x-$.x,ie=H.y-$.y,ae=it(Q,ie),re=ae<=ee;ee===1/0&&X.inRange&&X.range!==1/0&&(re=!1),X.target&&!(re?X.inRange&&ee!==1/0?ae/ee<X.distance/X.range:ee===1/0&&X.range!==1/0||ae<X.distance:!X.inRange&&ae<X.distance)||(X.target=H,X.distance=ae,X.range=ee,X.inRange=re,X.delta.x=Q,X.delta.y=ie)}return X.inRange&&(p.x=X.target.x,p.y=X.target.y),v.closest=X,X},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},Hr=Ut(Ar,"snap"),Yr={start:function(l){var c=l.state,p=l.edges,v=c.options;if(!p)return null;l.state={options:{targets:null,relativePoints:[{x:p.left?0:1,y:p.top?0:1}],offset:v.offset||"self",origin:{x:0,y:0},range:v.range}},c.targetFields=c.targetFields||[["width","height"],["x","y"]],Ar.start(l),c.offsets=l.state.offsets,l.state=c},set:function(l){var c=l.interaction,p=l.state,v=l.coords,x=p.options,k=p.offsets,T={x:v.x-k[0].x,y:v.y-k[0].y};p.options=ce({},x),p.options.targets=[];for(var $=0,U=x.targets||[];$<U.length;$++){var o=U[$],u=void 0;if(u=S.func(o)?o(T.x,T.y,c):o){for(var g=0,m=p.targetFields;g<m.length;g++){var _=m[g],A=_[0],R=_[1];if(A in u||R in u){u.x=u[A],u.y=u[R];break}}p.options.targets.push(u)}}var F=Ar.set(l);return p.options=x,F},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},zi=Ut(Yr,"snapSize"),kr={aspectRatio:yt,restrictEdges:Ti,restrict:ba,restrictRect:Wr,restrictSize:bo,snapEdges:Ut({start:function(l){var c=l.edges;return c?(l.state.targetFields=l.state.targetFields||[[c.left?"left":"right",c.top?"top":"bottom"]],Yr.start(l)):null},set:Yr.set,defaults:ce(Sn(Yr.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:Hr,snapSize:zi,spring:Cn,avoid:Cn,transform:Cn,rubberband:Cn},wo={id:"modifiers",install:function(l){var c=l.interactStatic;for(var p in l.usePlugin(wi),l.usePlugin(Ii),c.modifiers=kr,kr){var v=kr[p],x=v._defaults,k=v._methods;x._methods=k,l.defaults.perAction[p]=x}}},xa=wo,Ea=function(l){h(p,l);var c=E(p);function p(v,x,k,T,$,U){var o;if(a(this,p),at(w(o=c.call(this,$)),k),k!==x&&at(w(o),x),o.timeStamp=U,o.originalEvent=k,o.type=v,o.pointerId=st(x),o.pointerType=an(x),o.target=T,o.currentTarget=null,v==="tap"){var u=$.getPointerIndex(x);o.dt=o.timeStamp-$.pointers[u].downTime;var g=o.timeStamp-$.tapTime;o.double=!!$.prevTap&&$.prevTap.type!=="doubletap"&&$.prevTap.target===o.target&&g<500}else v==="doubletap"&&(o.dt=x.timeStamp-$.tapTime,o.double=!0);return o}return d(p,[{key:"_subtractOrigin",value:function(v){var x=v.x,k=v.y;return this.pageX-=x,this.pageY-=k,this.clientX-=x,this.clientY-=k,this}},{key:"_addOrigin",value:function(v){var x=v.x,k=v.y;return this.pageX+=x,this.pageY+=k,this.clientX+=x,this.clientY+=k,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),p}(Nt),or={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(l){l.pointerEvents=or,l.defaults.actions.pointerEvents=or.defaults,ce(l.actions.phaselessTypes,or.types)},listeners:{"interactions:new":function(l){var c=l.interaction;c.prevTap=null,c.tapTime=0},"interactions:update-pointer":function(l){var c=l.down,p=l.pointerInfo;!c&&p.hold||(p.hold={duration:1/0,timeout:null})},"interactions:move":function(l,c){var p=l.interaction,v=l.pointer,x=l.event,k=l.eventTarget;l.duplicate||p.pointerIsDown&&!p.pointerWasMoved||(p.pointerIsDown&&Xr(l),fn({interaction:p,pointer:v,event:x,eventTarget:k,type:"move"},c))},"interactions:down":function(l,c){(function(p,v){for(var x=p.interaction,k=p.pointer,T=p.event,$=p.eventTarget,U=p.pointerIndex,o=x.pointers[U].hold,u=Oe($),g={interaction:x,pointer:k,event:T,eventTarget:$,type:"hold",targets:[],path:u,node:null},m=0;m<u.length;m++){var _=u[m];g.node=_,v.fire("pointerEvents:collect-targets",g)}if(g.targets.length){for(var A=1/0,R=0,F=g.targets;R<F.length;R++){var W=F[R].eventable.options.holdDuration;W<A&&(A=W)}o.duration=A,o.timeout=setTimeout(function(){fn({interaction:x,eventTarget:$,pointer:k,event:T,type:"hold"},v)},A)}})(l,c),fn(l,c)},"interactions:up":function(l,c){Xr(l),fn(l,c),function(p,v){var x=p.interaction,k=p.pointer,T=p.event,$=p.eventTarget;x.pointerWasMoved||fn({interaction:x,eventTarget:$,pointer:k,event:T,type:"tap"},v)}(l,c)},"interactions:cancel":function(l,c){Xr(l),fn(l,c)}},PointerEvent:Ea,fire:fn,collectEventTargets:_a,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function fn(l,c){var p=l.interaction,v=l.pointer,x=l.event,k=l.eventTarget,T=l.type,$=l.targets,U=$===void 0?_a(l,c):$,o=new Ea(T,v,x,k,p,c.now());c.fire("pointerEvents:new",{pointerEvent:o});for(var u={interaction:p,pointer:v,event:x,eventTarget:k,targets:U,type:T,pointerEvent:o},g=0;g<U.length;g++){var m=U[g];for(var _ in m.props||{})o[_]=m.props[_];var A=xe(m.eventable,m.node);if(o._subtractOrigin(A),o.eventable=m.eventable,o.currentTarget=m.node,m.eventable.fire(o),o._addOrigin(A),o.immediatePropagationStopped||o.propagationStopped&&g+1<U.length&&U[g+1].node!==o.currentTarget)break}if(c.fire("pointerEvents:fired",u),T==="tap"){var R=o.double?fn({interaction:p,pointer:v,event:x,eventTarget:k,type:"doubletap"},c):o;p.prevTap=R,p.tapTime=R.timeStamp}return o}function _a(l,c){var p=l.interaction,v=l.pointer,x=l.event,k=l.eventTarget,T=l.type,$=p.getPointerIndex(v),U=p.pointers[$];if(T==="tap"&&(p.pointerWasMoved||!U||U.downTarget!==k))return[];for(var o=Oe(k),u={interaction:p,pointer:v,event:x,eventTarget:k,type:T,path:o,targets:[],node:null},g=0;g<o.length;g++){var m=o[g];u.node=m,c.fire("pointerEvents:collect-targets",u)}return T==="hold"&&(u.targets=u.targets.filter(function(_){var A,R;return _.eventable.options.holdDuration===((A=p.pointers[$])==null||(R=A.hold)==null?void 0:R.duration)})),u.targets}function Xr(l){var c=l.interaction,p=l.pointerIndex,v=c.pointers[p].hold;v&&v.timeout&&(clearTimeout(v.timeout),v.timeout=null)}var $i=Object.freeze({__proto__:null,default:or});function Sa(l){var c=l.interaction;c.holdIntervalHandle&&(clearInterval(c.holdIntervalHandle),c.holdIntervalHandle=null)}var Aa={id:"pointer-events/holdRepeat",install:function(l){l.usePlugin(or);var c=l.pointerEvents;c.defaults.holdRepeatInterval=0,c.types.holdrepeat=l.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(l,c){return l["pointerEvents:".concat(c)]=Sa,l},{"pointerEvents:new":function(l){var c=l.pointerEvent;c.type==="hold"&&(c.count=(c.count||0)+1)},"pointerEvents:fired":function(l,c){var p=l.interaction,v=l.pointerEvent,x=l.eventTarget,k=l.targets;if(v.type==="hold"&&k.length){var T=k[0].eventable.options.holdRepeatInterval;T<=0||(p.holdIntervalHandle=setTimeout(function(){c.pointerEvents.fire({interaction:p,eventTarget:x,type:"hold",pointer:v,event:v},c)},T))}}})},xo=Aa,Eo={id:"pointer-events/interactableTargets",install:function(l){var c=l.Interactable;c.prototype.pointerEvents=function(v){return ce(this.events.options,v),this};var p=c.prototype._backCompatOption;c.prototype._backCompatOption=function(v,x){var k=p.call(this,v,x);return k===this&&(this.events.options[v]=x),k}},listeners:{"pointerEvents:collect-targets":function(l,c){var p=l.targets,v=l.node,x=l.type,k=l.eventTarget;c.interactables.forEachMatch(v,function(T){var $=T.events,U=$.options;$.types[x]&&$.types[x].length&&T.testIgnoreAllow(U,v,k)&&p.push({node:v,eventable:$,props:{interactable:T}})})},"interactable:new":function(l){var c=l.interactable;c.events.getRect=function(p){return c.getRect(p)}},"interactable:set":function(l,c){var p=l.interactable,v=l.options;ce(p.events.options,c.pointerEvents.defaults),ce(p.events.options,v.pointerEvents||{})}}},_o=Eo,Vr={id:"pointer-events",install:function(l){l.usePlugin($i),l.usePlugin(xo),l.usePlugin(_o)}},pn=Vr,tt={id:"reflow",install:function(l){var c=l.Interactable;l.actions.phases.reflow=!0,c.prototype.reflow=function(p){return function(v,x,k){for(var T=v.getAllElements(),$=k.window.Promise,U=$?[]:null,o=function(){var g=T[u],m=v.getRect(g);if(!m)return 1;var _,A=St(k.interactions.list,function(W){return W.interacting()&&W.interactable===v&&W.element===g&&W.prepared.name===x.name});if(A)A.move(),U&&(_=A._reflowPromise||new $(function(W){A._reflowResolve=W}));else{var R=Ke(m),F=function(W){return{coords:W,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:R.x,y:R.y},client:{x:R.x,y:R.y},timeStamp:k.now()});_=function(W,X,Z,H,ee){var Q=W.interactions.new({pointerType:"reflow"}),ie={interaction:Q,event:ee,pointer:ee,eventTarget:Z,phase:"reflow"};Q.interactable=X,Q.element=Z,Q.prevEvent=ee,Q.updatePointer(ee,ee,Z,!0),ht(Q.coords.delta),zr(Q.prepared,H),Q._doPhase(ie);var ae=W.window,re=ae.Promise,se=re?new re(function(le){Q._reflowResolve=le}):void 0;return Q._reflowPromise=se,Q.start(H,X,Z),Q._interacting?(Q.move(ie),Q.end(ee)):(Q.stop(),Q._reflowResolve()),Q.removePointer(ee,ee),se}(k,v,g,x,F)}U&&U.push(_)},u=0;u<T.length&&!o();u++);return U&&$.all(U).then(function(){return v})}(this,p,l)}},listeners:{"interactions:stop":function(l,c){var p=l.interaction;p.pointerType==="reflow"&&(p._reflowResolve&&p._reflowResolve(),function(v,x){v.splice(v.indexOf(x),1)}(c.interactions.list,p))}}},Qr=tt;if(dt.use(Gn),dt.use(Kt),dt.use(pn),dt.use(Qt),dt.use(xa),dt.use(Ze),dt.use(fo),dt.use(ua),dt.use(Qr),dt.default=dt,i(r)==="object"&&r)try{r.exports=dt}catch{}return dt.default=dt,dt})}(Xi,Xi.exports)),Xi.exports}var zb=Lb();const $b=Mt(zb),en=document;class Gb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.metric=new Sh(e),this.panels={info:en.getElementById("floating-panel"),tools:en.getElementById("tools-panel"),graphs:en.getElementById("graphs-panel"),faces:en.getElementById("face-panel")},this.handles={info:"#info",tools:"#tools",graphs:"#graphs",faces:"#faces"},this.addEventListeners(),this.makePanelsDraggable(),this.registerToolListeners(),this.setupContextMenu()}init(){this.togglePanel("info","#panel-btn .check",this.settings.info_panel),this.togglePanel("tools","#tools-btn .check",this.settings.tools_panel),this.togglePanel("graphs","#graphs-btn .check",this.settings.graphs_panel),this.togglePanel("faces","#faces-btn .check",this.settings.face_panel)}setupContextMenu(){const e=en.getElementById("custom-context-menu");en.addEventListener("contextmenu",t=>{t.preventDefault();const{offsetWidth:n,offsetHeight:i}=e,{innerWidth:a,innerHeight:s}=window;let{pageX:d,pageY:f}=t;d+n>a&&(d-=n),f+i>s&&(f-=i),Object.assign(e.style,{left:`${d}px`,top:`${f}px`,display:"block"})}),en.addEventListener("click",()=>e.style.display="none")}togglePanel(e,t,n){const i=this.panels[e],a=en.querySelector(t);a==null||a.classList.toggle("hidden",!n),i&&(i.style.display=n?"flex":"none",n||this.resetPanel(i))}resetPanel(e){e.style.transform="translate(0px, 0px)",e.setAttribute("data-x",0),e.setAttribute("data-y",0)}addEventListeners(){const e=(n,i)=>{var a;(a=en.querySelector(n))==null||a.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:i})})};e("#floating-panel .close","info_panel"),e("#tools-panel .close","tools_panel"),e("#graphs-panel .close","graphs_panel"),e("#face-panel .close","face_panel");const t=en.querySelector("#floating-panel .max");t==null||t.addEventListener("click",()=>{var n;this.resetPanel(this.panels.info),(n=en.getElementById("floating-panel"))==null||n.classList.toggle("MAX")})}makePanelsDraggable(){Object.entries(this.panels).forEach(([e,t])=>{const n=this.handles[e];t&&n&&this.makeDraggable(t,n)})}makeDraggable(e,t){$b(e).draggable({allowFrom:t,listeners:{move(n){const i=n.target,a=(parseFloat(i.getAttribute("data-x"))||0)+n.dx,s=(parseFloat(i.getAttribute("data-y"))||0)+n.dy;i.style.transform=`translate(${a}px, ${s}px)`,i.setAttribute("data-x",a),i.setAttribute("data-y",s)}}})}registerToolListeners(){Object.entries({scale:"scale",tree:"tree",force:"forceSimulation",panning:"panning",select:"select",component:"component","color-picker":"colorPicker"}).forEach(([t,n])=>{var i;(i=en.querySelector(`widgets #tools-panel .${t}`))==null||i.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:n})})})}}class qb{constructor(e,t){this.app=e,this.settings=e.settings,this.canvas=e.canvas,this.ctx=e._canvas.ctx,this.selection={x:0,y:0,width:0,height:0,active:!1},this.mouseDown=!1,this.scale={isDragging:!1,active:!1,activeHandle:null,scaleData:{},rect:{x:100,y:100,width:200,height:150},prevMouse:{x:0,y:0},offsetX:0,offsetY:0,handleSize:10,handles:["nw","n","ne","e","se","s","sw","w"],cursorMap:{nw:"nwse-resize",n:"ns-resize",ne:"nesw-resize",e:"ew-resize",se:"nwse-resize",s:"ns-resize",sw:"nesw-resize",w:"ew-resize"}}}init(){this.canvas.addEventListener("mousedown",this.startSelection.bind(this)),this.canvas.addEventListener("mousemove",this.updateSelection.bind(this)),this.canvas.addEventListener("mouseup",this.endSelection.bind(this))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),(this.settings.select||this.settings.scale)&&(this.selection.active&&this.drawSelect(this.selection),this.settings.scale&&this.drawScale())}drawSelect(e){if(!e)return;const t=this.ctx;t.fillStyle="rgba(0, 0, 0, 0.1)",t.fillRect(e.x,e.y,e.width,e.height),t.strokeStyle="rgba(0, 0, 255, 0.7)",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(e.x,e.y,e.width,e.height),t.setLineDash([])}drawScale(){this.scale.active&&this.drawScaleBox(this.scale.rect,this.ctx)}startSelection(e){if(this.mouseDown=!0,this.settings.performance?this.app.graphManager.needsRedraw={rect:!0,node:!0}:this.app.graphManager.needsRedraw={rect:!0,node:!0,edge:!0,face:!0},this.settings.select||this.settings.scale){const[t,n]=tn(e,this.canvas);if(this.selection.x=t,this.selection.y=n,this.selection.width=0,this.selection.height=0,this.selection.active=!this.scale.active,this.settings.scale&&this.scale.active){const[i,a]=tn(e);if(this.scale.prevMouse={x:i,y:a},this.scale.activeHandle=this.hitTestHandle(i,a),this.scale.activeHandle)return;i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height&&(this.scale.isDragging=!0,this.scale.offsetX=i-this.scale.rect.x,this.scale.offsetY=a-this.scale.rect.y)}}else this.selection.active=!1,this.scale.active=!1}updateSelection(e){if(this.selection.active&&!this.scale.active){const[t,n]=tn(e,this.canvas);this.selection.width=t-this.selection.x,this.selection.height=n-this.selection.y;return}if(this.scale.active){const t=this.scale.rect,n=this.app.graphManager.graph.getSelectedNodes(),[i,a]=tn(e);if(this.scale.activeHandle){this.resizeRect(this.scale.activeHandle,i,a);for(let d of n)this.app.graphManager.graph.updateNodeAttributes(d,f=>({...f,x:t.x+t.width*this.scale.scaleData[d].x,y:t.y+t.height*this.scale.scaleData[d].y}));return}if(this.scale.isDragging){this.scale.rect.x=i-this.scale.offsetX,this.scale.rect.y=a-this.scale.offsetY;const d=i-this.scale.prevMouse.x,f=a-this.scale.prevMouse.y;for(let h of n)this.app.graphManager.graph.updateNodeAttributes(h,y=>({...y,x:y.x+d,y:y.y+f}));this.scale.prevMouse={x:i,y:a};return}const s=this.hitTestHandle(i,a);s?this.canvas.style.cursor=this.scale.cursorMap[s]:i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height?this.canvas.style.cursor="move":this.canvas.style.cursor="default"}}endSelection(e){this.mouseDown=!1,this.selection.active=!1,this.scale.isDragging=!1,this.scale.activeHandle=null,this.pointsInRect(this.selection).forEach(i=>{this.app.graphManager.graph.toggleNodeSelection(i)}),this.settings.scale||this.linesInRect(this.selection).forEach(a=>{this.app.graphManager.graph.toggleEdgeSelection(a)});const n=this.app.graphManager.graph.getSelectedNodes();this.settings.scale&&n.length>0&&!this.scale.active&&(this.scale.active=!0,this.scale.rect=Fb(this.app.graphManager.graph,n,this.settings.node_radius),this.scaleData={},n.forEach(i=>{const a=this.app.graphManager.graph.getNodeAttributes(i);this.scale.scaleData[i]={id:i,x:(a.x-this.scale.rect.x)/this.scale.rect.width,y:(a.y-this.scale.rect.y)/this.scale.rect.height}})),this.app.graphManager.redraw()}pointsInRect(e){const[t,n,i,a]=Sd(e);return this.app.graphManager.graph.filterNodes((s,d)=>au(d.x,d.y,t,n,i,a))}linesInRect(e){const t=Sd(e);return this.app.graphManager.graph.filterEdges((n,i,a,s,d,f)=>this.lineIntersectsRect([d.x,d.y,f.x,f.y],t))}lineIntersectsRect(e,t){let[n,i,a,s]=e,[d,f,h,y]=t;const b=this.settings.node_radius/2+20;return!!(Ad([n,i,a,s],[d,f,h,y])||Ad([n,i,a,s],[d,y,h,f])||au(n,i,d+b,f+b,h-b,y-b)||au(a,s,d+b,f+b,h-b,y-b))}drawScaleBox(e,t){e&&(t.fillStyle="#cce5ff20",t.strokeStyle="#3399ff",t.lineWidth=2,t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height),t.fillStyle="#fff",t.strokeStyle="#000",this.scale.handles.forEach(n=>{const[i,a]=this.getHandlePosition(n);t.fillRect(i,a,this.scale.handleSize,this.scale.handleSize),t.strokeRect(i,a,this.scale.handleSize,this.scale.handleSize)}))}getHandlePosition(e){const{x:t,y:n,width:i,height:a}=this.scale.rect,s=this.scale.handleSize/2;switch(e){case"nw":return[t-s,n-s];case"n":return[t+i/2-s,n-s];case"ne":return[t+i-s,n-s];case"e":return[t+i-s,n+a/2-s];case"se":return[t+i-s,n+a-s];case"s":return[t+i/2-s,n+a-s];case"sw":return[t-s,n+a-s];case"w":return[t-s,n+a/2-s]}}hitTestHandle(e,t){return this.scale.handles.find(n=>{const[i,a]=this.getHandlePosition(n);return e>=i&&e<=i+this.scale.handleSize&&t>=a&&t<=a+this.scale.handleSize})}resizeRect(e,t,n){const a=t-this.scale.prevMouse.x,s=n-this.scale.prevMouse.y;let{x:d,y:f,width:h,height:y}=this.scale.rect;switch(e){case"nw":d+=a,f+=s,h-=a,y-=s;break;case"n":f+=s,y-=s;break;case"ne":f+=s,h+=a,y-=s;break;case"e":h+=a;break;case"se":h+=a,y+=s;break;case"s":y+=s;break;case"sw":d+=a,h-=a,y+=s;break;case"w":d+=a,h-=a;break}if(h<20){const b=20-h;e.includes("w")&&(d-=b),h=20}if(y<20){const b=20-y;e.includes("n")&&(f-=b),y=20}this.scale.rect.x=d,this.scale.rect.y=f,this.scale.rect.width=h,this.scale.rect.height=y,this.scale.prevMouse={x:t,y:n}}}function au(r,e,t,n,i,a){return r>=t&&r<=i&&e>=n&&e<=a}function Sd(r){const e=Math.min(r.x,r.x+r.width),t=Math.min(r.y,r.y+r.height),n=Math.max(r.x,r.x+r.width),i=Math.max(r.y,r.y+r.height);return[e,t,n,i]}function Ad(r,e){var t,n,i;const[a,s,d,f]=r,[h,y,b,w]=e;return t=(d-a)*(w-y)-(b-h)*(f-s),t===0?!1:(i=((w-y)*(b-a)+(h-b)*(w-s))/t,n=((s-f)*(b-a)+(d-a)*(w-s))/t,0<i&&i<1&&0<n&&n<1)}function Fb(r,e,t){if(!e.length)return null;let n=1/0,i=1/0,a=-1/0,s=-1/0;e.forEach(f=>{const h=r.getNodeAttributes(f);h.x<n&&(n=h.x),h.y<i&&(i=h.y),h.x>a&&(a=h.x),h.y>s&&(s=h.y)});const d=t*1.5;return{x:n-d,y:i-d,width:a-n+2*d,height:s-i+2*d}}var ou={exports:{}};/*! Pickr 1.9.1 MIT | https://github.com/Simonwep/pickr */var kd;function jb(){return kd||(kd=1,function(r,e){(function(t,n){r.exports=n()})(self,()=>(()=>{var t={d:(V,M)=>{for(var J in M)t.o(M,J)&&!t.o(V,J)&&Object.defineProperty(V,J,{enumerable:!0,get:M[J]})},o:(V,M)=>Object.prototype.hasOwnProperty.call(V,M),r:V=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(V,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(V,"__esModule",{value:!0})}},n={};t.d(n,{default:()=>me});var i={};function a(V,M,J,ne,de={}){M instanceof HTMLCollection||M instanceof NodeList?M=Array.from(M):Array.isArray(M)||(M=[M]),Array.isArray(J)||(J=[J]);for(const oe of M)for(const he of J)oe[V](he,ne,{capture:!1,...de});return Array.prototype.slice.call(arguments,1)}t.r(i),t.d(i,{adjustableInputNumbers:()=>w,createElementFromString:()=>f,createFromTemplate:()=>h,eventPath:()=>y,off:()=>d,on:()=>s,resolveElement:()=>b});const s=a.bind(null,"addEventListener"),d=a.bind(null,"removeEventListener");function f(V){const M=document.createElement("div");return M.innerHTML=V.trim(),M.firstElementChild}function h(V){const M=(ne,de)=>{const oe=ne.getAttribute(de);return ne.removeAttribute(de),oe},J=(ne,de={})=>{const oe=M(ne,":obj"),he=M(ne,":ref"),ue=oe?de[oe]={}:de;he&&(de[he]=ne);for(const ve of Array.from(ne.children)){const _e=M(ve,":arr"),Me=J(ve,_e?{}:ue);_e&&(ue[_e]||(ue[_e]=[])).push(Object.keys(Me).length?Me:ve)}return de};return J(f(V))}function y(V){let M=V.path||V.composedPath&&V.composedPath();if(M)return M;let J=V.target.parentElement;for(M=[V.target,J];J=J.parentElement;)M.push(J);return M.push(document,window),M}function b(V){return V instanceof Element?V:typeof V=="string"?V.split(/>>/g).reduce((M,J,ne,de)=>(M=M.querySelector(J),ne<de.length-1?M.shadowRoot:M),document):null}function w(V,M=J=>J){function J(ne){const de=[.001,.01,.1][Number(ne.shiftKey||2*ne.ctrlKey)]*(ne.deltaY<0?1:-1);let oe=0,he=V.selectionStart;V.value=V.value.replace(/[\d.]+/g,(ue,ve)=>ve<=he&&ve+ue.length>=he?(he=ve,M(Number(ue),de,oe)):(oe++,ue)),V.focus(),V.setSelectionRange(he,he),ne.preventDefault(),V.dispatchEvent(new Event("input"))}s(V,"focus",()=>s(window,"wheel",J,{passive:!1})),s(V,"blur",()=>d(window,"wheel",J))}const{min:E,max:I,floor:D,round:N}=Math;function O(V,M,J){M/=100,J/=100;const ne=D(V=V/360*6),de=V-ne,oe=J*(1-M),he=J*(1-de*M),ue=J*(1-(1-de)*M),ve=ne%6;return[255*[J,he,oe,oe,ue,J][ve],255*[ue,J,J,he,oe,oe][ve],255*[oe,oe,ue,J,J,he][ve]]}function P(V,M,J){const ne=(2-(M/=100))*(J/=100)/2;return ne!==0&&(M=ne===1?0:ne<.5?M*J/(2*ne):M*J/(2-2*ne)),[V,100*M,100*ne]}function z(V,M,J){const ne=E(V/=255,M/=255,J/=255),de=I(V,M,J),oe=de-ne;let he,ue;if(oe===0)he=ue=0;else{ue=oe/de;const ve=((de-V)/6+oe/2)/oe,_e=((de-M)/6+oe/2)/oe,Me=((de-J)/6+oe/2)/oe;V===de?he=Me-_e:M===de?he=1/3+ve-Me:J===de&&(he=2/3+_e-ve),he<0?he+=1:he>1&&(he-=1)}return[360*he,100*ue,100*de]}function C(V,M,J,ne){return M/=100,J/=100,[...z(255*(1-E(1,(V/=100)*(1-(ne/=100))+ne)),255*(1-E(1,M*(1-ne)+ne)),255*(1-E(1,J*(1-ne)+ne)))]}function L(V,M,J){M/=100;const ne=2*(M*=(J/=100)<.5?J:1-J)/(J+M)*100,de=100*(J+M);return[V,isNaN(ne)?0:ne,de]}function K(V){return z(...V.match(/.{2}/g).map(M=>parseInt(M,16)))}function S(V){V=V.match(/^[a-zA-Z]+$/)?function(de){if(de.toLowerCase()==="black")return"#000";const oe=document.createElement("canvas").getContext("2d");return oe.fillStyle=de,oe.fillStyle==="#000"?null:oe.fillStyle}(V):V;const M={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},J=de=>de.map(oe=>/^(|\d+)\.\d+|\d+$/.test(oe)?Number(oe):void 0);let ne;e:for(const de in M)if(ne=M[de].exec(V))switch(de){case"cmyk":{const[,oe,he,ue,ve]=J(ne);if(oe>100||he>100||ue>100||ve>100)break e;return{values:C(oe,he,ue,ve),type:de}}case"rgba":{let[,oe,,he,,ue,,,ve]=J(ne);if(oe=ne[2]==="%"?oe/100*255:oe,he=ne[4]==="%"?he/100*255:he,ue=ne[6]==="%"?ue/100*255:ue,ve=ne[9]==="%"?ve/100:ve,oe>255||he>255||ue>255||ve<0||ve>1)break e;return{values:[...z(oe,he,ue),ve],a:ve,type:de}}case"hexa":{let[,oe]=ne;oe.length!==4&&oe.length!==3||(oe=oe.split("").map(ve=>ve+ve).join(""));const he=oe.substring(0,6);let ue=oe.substring(6);return ue=ue?parseInt(ue,16)/255:void 0,{values:[...K(he),ue],a:ue,type:de}}case"hsla":{let[,oe,he,ue,,ve]=J(ne);if(ve=ne[6]==="%"?ve/100:ve,oe>360||he>100||ue>100||ve<0||ve>1)break e;return{values:[...L(oe,he,ue),ve],a:ve,type:de}}case"hsva":{let[,oe,he,ue,,ve]=J(ne);if(ve=ne[6]==="%"?ve/100:ve,oe>360||he>100||ue>100||ve<0||ve>1)break e;return{values:[oe,he,ue,ve],a:ve,type:de}}}return{values:null,type:null}}function G(V=0,M=0,J=0,ne=1){const de=(he,ue)=>(ve=-1)=>ue(~ve?he.map(_e=>Number(_e.toFixed(ve))):he),oe={h:V,s:M,v:J,a:ne,toHSVA(){const he=[oe.h,oe.s,oe.v,oe.a];return he.toString=de(he,ue=>`hsva(${ue[0]}, ${ue[1]}%, ${ue[2]}%, ${oe.a})`),he},toHSLA(){const he=[...P(oe.h,oe.s,oe.v),oe.a];return he.toString=de(he,ue=>`hsla(${ue[0]}, ${ue[1]}%, ${ue[2]}%, ${oe.a})`),he},toRGBA(){const he=[...O(oe.h,oe.s,oe.v),oe.a];return he.toString=de(he,ue=>`rgba(${ue[0]}, ${ue[1]}, ${ue[2]}, ${oe.a})`),he},toCMYK(){const he=function(ue,ve,_e){const Me=O(ue,ve,_e),Oe=Me[0]/255,qe=Me[1]/255,ce=Me[2]/255,Pe=E(1-Oe,1-qe,1-ce);return[100*(Pe===1?0:(1-Oe-Pe)/(1-Pe)),100*(Pe===1?0:(1-qe-Pe)/(1-Pe)),100*(Pe===1?0:(1-ce-Pe)/(1-Pe)),100*Pe]}(oe.h,oe.s,oe.v);return he.toString=de(he,ue=>`cmyk(${ue[0]}%, ${ue[1]}%, ${ue[2]}%, ${ue[3]}%)`),he},toHEXA(){const he=function(ve,_e,Me){return O(ve,_e,Me).map(Oe=>N(Oe).toString(16).padStart(2,"0"))}(oe.h,oe.s,oe.v),ue=oe.a>=1?"":Number((255*oe.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return ue&&he.push(ue),he.toString=()=>`#${he.join("").toUpperCase()}`,he},clone:()=>G(oe.h,oe.s,oe.v,oe.a)};return oe}const q=V=>Math.max(Math.min(V,1),0);function j(V){const M={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},V),_keyboard(oe){const{options:he}=M,{type:ue,key:ve}=oe;if(document.activeElement===he.wrapper){const{lock:_e}=M.options,Me=ve==="ArrowUp",Oe=ve==="ArrowRight",qe=ve==="ArrowDown",ce=ve==="ArrowLeft";if(ue==="keydown"&&(Me||Oe||qe||ce)){let Pe=0,Re=0;_e==="v"?Pe=Me||Oe?1:-1:_e==="h"?Pe=Me||Oe?-1:1:(Re=Me?-1:qe?1:0,Pe=ce?-1:Oe?1:0),M.update(q(M.cache.x+.01*Pe),q(M.cache.y+.01*Re)),oe.preventDefault()}else ve.startsWith("Arrow")&&(M.options.onstop(),oe.preventDefault())}},_tapstart(oe){s(document,["mouseup","touchend","touchcancel"],M._tapstop),s(document,["mousemove","touchmove"],M._tapmove),oe.cancelable&&oe.preventDefault(),M._tapmove(oe)},_tapmove(oe){const{options:he,cache:ue}=M,{lock:ve,element:_e,wrapper:Me}=he,Oe=Me.getBoundingClientRect();let qe=0,ce=0;if(oe){const ke=oe&&oe.touches&&oe.touches[0];qe=oe?(ke||oe).clientX:0,ce=oe?(ke||oe).clientY:0,qe<Oe.left?qe=Oe.left:qe>Oe.left+Oe.width&&(qe=Oe.left+Oe.width),ce<Oe.top?ce=Oe.top:ce>Oe.top+Oe.height&&(ce=Oe.top+Oe.height),qe-=Oe.left,ce-=Oe.top}else ue&&(qe=ue.x*Oe.width,ce=ue.y*Oe.height);ve!=="h"&&(_e.style.left=`calc(${qe/Oe.width*100}% - ${_e.offsetWidth/2}px)`),ve!=="v"&&(_e.style.top=`calc(${ce/Oe.height*100}% - ${_e.offsetHeight/2}px)`),M.cache={x:qe/Oe.width,y:ce/Oe.height};const Pe=q(qe/Oe.width),Re=q(ce/Oe.height);switch(ve){case"v":return he.onchange(Pe);case"h":return he.onchange(Re);default:return he.onchange(Pe,Re)}},_tapstop(){M.options.onstop(),d(document,["mouseup","touchend","touchcancel"],M._tapstop),d(document,["mousemove","touchmove"],M._tapmove)},trigger(){M._tapmove()},update(oe=0,he=0){const{left:ue,top:ve,width:_e,height:Me}=M.options.wrapper.getBoundingClientRect();M.options.lock==="h"&&(he=oe),M._tapmove({clientX:ue+_e*oe,clientY:ve+Me*he})},destroy(){const{options:oe,_tapstart:he,_keyboard:ue}=M;d(document,["keydown","keyup"],ue),d([oe.wrapper,oe.element],"mousedown",he),d([oe.wrapper,oe.element],"touchstart",he,{passive:!1})}},{options:J,_tapstart:ne,_keyboard:de}=M;return s([J.wrapper,J.element],"mousedown",ne),s([J.wrapper,J.element],"touchstart",ne,{passive:!1}),s(document,["keydown","keyup"],de),M}function Y(V={}){V=Object.assign({onchange:()=>0,className:"",elements:[]},V);const M=s(V.elements,"click",J=>{V.elements.forEach(ne=>ne.classList[J.target===ne?"add":"remove"](V.className)),V.onchange(J),J.stopPropagation()});return{destroy:()=>d(...M)}}const te={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},B=(V,M,J)=>{const ne=typeof V!="object"||V instanceof HTMLElement?{reference:V,popper:M,...J}:V;return{update(de=ne){const{reference:oe,popper:he}=Object.assign(ne,de);if(!he||!oe)throw new Error("Popper- or reference-element missing.");return((ue,ve,_e)=>{const{container:Me,arrow:Oe,margin:qe,padding:ce,position:Pe,variantFlipOrder:Re,positionFlipOrder:ke}={container:document.documentElement.getBoundingClientRect(),...te,..._e},{left:Ke,top:Le}=ve.style;ve.style.left="0",ve.style.top="0";const xe=ue.getBoundingClientRect(),fe=ve.getBoundingClientRect(),vt={t:xe.top-fe.height-qe,b:xe.bottom+qe,r:xe.right+qe,l:xe.left-fe.width-qe},it={vs:xe.left,vm:xe.left+xe.width/2-fe.width/2,ve:xe.left+xe.width-fe.width,hs:xe.top,hm:xe.bottom-xe.height/2-fe.height/2,he:xe.bottom-fe.height},[xt,at="middle"]=Pe.split("-"),Ve=ke[xt],ht=Re[at],{top:ot,left:gt,bottom:Et,right:st}=Me;for(const ut of Ve){const ft=ut==="t"||ut==="b";let rt=vt[ut];const[_t,mt]=ft?["top","left"]:["left","top"],[Pt,an]=ft?[fe.height,fe.width]:[fe.width,fe.height],[Yn,Nt]=ft?[Et,st]:[st,Et],[ze,xn]=ft?[ot,gt]:[gt,ot];if(!(rt<ze||rt+Pt+ce>Yn))for(const bt of ht){let St=it[(ft?"v":"h")+bt];if(!(St<xn||St+an+ce>Nt)){if(St-=fe[mt],rt-=fe[_t],ve.style[mt]=`${St}px`,ve.style[_t]=`${rt}px`,Oe){const Se=ft?xe.width/2:xe.height/2,on=an/2,Ln=Se>on,Xn=St+{s:Ln?on:Se,m:on,e:Ln?on:an-Se}[bt],Vn=rt+{t:Pt,b:0,r:0,l:Pt}[ut];Oe.style[mt]=`${Xn}px`,Oe.style[_t]=`${Vn}px`}return ut+bt}}}return ve.style.left=Ke,ve.style.top=Le,null})(oe,he,ne)}}},ge=class ge{constructor(M){Ct(this,"_initializingActive",!0);Ct(this,"_recalc",!0);Ct(this,"_nanopop",null);Ct(this,"_root",null);Ct(this,"_color",G());Ct(this,"_lastColor",G());Ct(this,"_swatchColors",[]);Ct(this,"_setupAnimationFrame",null);Ct(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]});this.options=M=Object.assign({...ge.DEFAULT_OPTIONS},M);const{swatches:J,components:ne,theme:de,sliders:oe,lockOpacity:he,padding:ue}=M;["nano","monolith"].includes(de)&&!oe&&(M.sliders="h"),ne.interaction||(ne.interaction={});const{preview:ve,opacity:_e,hue:Me,palette:Oe}=ne;ne.opacity=!he&&_e,ne.palette=Oe||ve||_e||Me,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),J&&J.length&&J.forEach(Re=>this.addSwatch(Re));const{button:qe,app:ce}=this._root;this._nanopop=B(qe,ce,{margin:ue}),qe.setAttribute("role","button"),qe.setAttribute("aria-label",this._t("btn:toggle"));const Pe=this;this._setupAnimationFrame=requestAnimationFrame(function Re(){if(!ce.offsetWidth)return requestAnimationFrame(Re);Pe.setColor(M.default),Pe._rePositioningPicker(),M.defaultRepresentation&&(Pe._representation=M.defaultRepresentation,Pe.setColorRepresentation(Pe._representation)),M.showAlways&&Pe.show(),Pe._initializingActive=!1,Pe._emit("init")})}_preBuild(){const{options:M}=this;for(const J of["el","container"])M[J]=b(M[J]);this._root=(J=>{const{components:ne,useAsButton:de,inline:oe,appClass:he,theme:ue,lockOpacity:ve}=J.options,_e=ce=>ce?"":'style="display:none" hidden',Me=ce=>J._t(ce),Oe=h(`
      <div :ref="root" class="pickr">

        ${de?"":'<button type="button" :ref="button" class="pcr-button"></button>'}

        <div :ref="app" class="pcr-app ${he||""}" data-theme="${ue}" ${oe?'style="position: unset"':""} aria-label="${Me("ui:dialog")}" role="window">
          <div class="pcr-selection" ${_e(ne.palette)}>
            <div :obj="preview" class="pcr-color-preview" ${_e(ne.preview)}>
              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${Me("btn:last-color")}"></button>
              <div :ref="currentColor" class="pcr-current-color"></div>
            </div>

            <div :obj="palette" class="pcr-color-palette">
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${Me("aria:palette")}" role="listbox"></div>
            </div>

            <div :obj="hue" class="pcr-color-chooser" ${_e(ne.hue)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${Me("aria:hue")}" role="slider"></div>
            </div>

            <div :obj="opacity" class="pcr-color-opacity" ${_e(ne.opacity)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${Me("aria:opacity")}" role="slider"></div>
            </div>
          </div>

          <div class="pcr-swatches ${ne.palette?"":"pcr-last"}" :ref="swatches"></div>

          <div :obj="interaction" class="pcr-interaction" ${_e(Object.keys(ne.interaction).length)}>
            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${_e(ne.interaction.input)} aria-label="${Me("aria:input")}">

            <input :arr="options" class="pcr-type" data-type="HEXA" value="${ve?"HEX":"HEXA"}" type="button" ${_e(ne.interaction.hex)}>
            <input :arr="options" class="pcr-type" data-type="RGBA" value="${ve?"RGB":"RGBA"}" type="button" ${_e(ne.interaction.rgba)}>
            <input :arr="options" class="pcr-type" data-type="HSLA" value="${ve?"HSL":"HSLA"}" type="button" ${_e(ne.interaction.hsla)}>
            <input :arr="options" class="pcr-type" data-type="HSVA" value="${ve?"HSV":"HSVA"}" type="button" ${_e(ne.interaction.hsva)}>
            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${_e(ne.interaction.cmyk)}>

            <input :ref="save" class="pcr-save" value="${Me("btn:save")}" type="button" ${_e(ne.interaction.save)} aria-label="${Me("aria:btn:save")}">
            <input :ref="cancel" class="pcr-cancel" value="${Me("btn:cancel")}" type="button" ${_e(ne.interaction.cancel)} aria-label="${Me("aria:btn:cancel")}">
            <input :ref="clear" class="pcr-clear" value="${Me("btn:clear")}" type="button" ${_e(ne.interaction.clear)} aria-label="${Me("aria:btn:clear")}">
          </div>
        </div>
      </div>
    `),qe=Oe.interaction;return qe.options.find(ce=>!ce.hidden&&!ce.classList.add("active")),qe.type=()=>qe.options.find(ce=>ce.classList.contains("active")),Oe})(this),M.useAsButton&&(this._root.button=M.el),M.container.appendChild(this._root.root)}_finalBuild(){const M=this.options,J=this._root;if(M.container.removeChild(J.root),M.inline){const ne=M.el.parentElement;M.el.nextSibling?ne.insertBefore(J.app,M.el.nextSibling):ne.appendChild(J.app)}else M.container.appendChild(J.app);M.useAsButton?M.inline&&M.el.remove():M.el.parentNode.replaceChild(J.root,M.el),M.disabled&&this.disable(),M.comparison||(J.button.style.transition="none",M.useAsButton||(J.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const M=this,J=this.options.components,ne=(M.options.sliders||"v").repeat(2),[de,oe]=ne.match(/^[vh]+$/g)?ne:[],he=()=>this._color||(this._color=this._lastColor.clone()),ue={palette:j({element:M._root.palette.picker,wrapper:M._root.palette.palette,onstop:()=>M._emit("changestop","slider",M),onchange(ve,_e){if(!J.palette)return;const Me=he(),{_root:Oe,options:qe}=M,{lastColor:ce,currentColor:Pe}=Oe.preview;M._recalc&&(Me.s=100*ve,Me.v=100-100*_e,Me.v<0&&(Me.v=0),M._updateOutput("slider"));const Re=Me.toRGBA().toString(0);this.element.style.background=Re,this.wrapper.style.background=`
                        linear-gradient(to top, rgba(0, 0, 0, ${Me.a}), transparent),
                        linear-gradient(to left, hsla(${Me.h}, 100%, 50%, ${Me.a}), rgba(255, 255, 255, ${Me.a}))
                    `,qe.comparison?qe.useAsButton||M._lastColor||ce.style.setProperty("--pcr-color",Re):(Oe.button.style.setProperty("--pcr-color",Re),Oe.button.classList.remove("clear"));const ke=Me.toHEXA().toString();for(const{el:Ke,color:Le}of M._swatchColors)Ke.classList[ke===Le.toHEXA().toString()?"add":"remove"]("pcr-active");Pe.style.setProperty("--pcr-color",Re)}}),hue:j({lock:oe==="v"?"h":"v",element:M._root.hue.picker,wrapper:M._root.hue.slider,onstop:()=>M._emit("changestop","slider",M),onchange(ve){if(!J.hue||!J.palette)return;const _e=he();M._recalc&&(_e.h=360*ve),this.element.style.backgroundColor=`hsl(${_e.h}, 100%, 50%)`,ue.palette.trigger()}}),opacity:j({lock:de==="v"?"h":"v",element:M._root.opacity.picker,wrapper:M._root.opacity.slider,onstop:()=>M._emit("changestop","slider",M),onchange(ve){if(!J.opacity||!J.palette)return;const _e=he();M._recalc&&(_e.a=Math.round(100*ve)/100),this.element.style.background=`rgba(0, 0, 0, ${_e.a})`,ue.palette.trigger()}}),selectable:Y({elements:M._root.interaction.options,className:"active",onchange(ve){M._representation=ve.target.getAttribute("data-type").toUpperCase(),M._recalc&&M._updateOutput("swatch")}})};this._components=ue}_bindEvents(){const{_root:M,options:J}=this,ne=[s(M.interaction.clear,"click",()=>this._clearColor()),s([M.interaction.cancel,M.preview.lastColor],"click",()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")}),s(M.interaction.save,"click",()=>{!this.applyColor()&&!J.showAlways&&this.hide()}),s(M.interaction.result,["keyup","input"],de=>{this.setColor(de.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),de.stopImmediatePropagation()}),s(M.interaction.result,["focus","blur"],de=>{this._recalc=de.type==="blur",this._recalc&&this._updateOutput(null)}),s([M.palette.palette,M.palette.picker,M.hue.slider,M.hue.picker,M.opacity.slider,M.opacity.picker],["mousedown","touchstart"],()=>this._recalc=!0,{passive:!0})];if(!J.showAlways){const de=J.closeWithKey;ne.push(s(M.button,"click",()=>this.isOpen()?this.hide():this.show()),s(document,"keyup",oe=>this.isOpen()&&(oe.key===de||oe.code===de)&&this.hide()),s(document,["touchstart","mousedown"],oe=>{this.isOpen()&&!y(oe).some(he=>he===M.app||he===M.button)&&this.hide()},{capture:!0}))}if(J.adjustableNumbers){const de={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};w(M.interaction.result,(oe,he,ue)=>{const ve=de[this.getColorRepresentation().toLowerCase()];if(ve){const _e=ve[ue],Me=oe+(_e>=100?1e3*he:he);return Me<=0?0:Number((Me<_e?Me:_e).toPrecision(3))}return oe})}if(J.autoReposition&&!J.inline){let de=null;const oe=this;ne.push(s(window,["scroll","resize"],()=>{oe.isOpen()&&(J.closeOnScroll&&oe.hide(),de===null?(de=setTimeout(()=>de=null,100),requestAnimationFrame(function he(){oe._rePositioningPicker(),de!==null&&requestAnimationFrame(he)})):(clearTimeout(de),de=setTimeout(()=>de=null,100)))},{capture:!0}))}this._eventBindings=ne}_rePositioningPicker(){const{options:M}=this;if(!M.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:M.position})){const J=this._root.app,ne=J.getBoundingClientRect();J.style.top=(window.innerHeight-ne.height)/2+"px",J.style.left=(window.innerWidth-ne.width)/2+"px"}}_updateOutput(M){const{_root:J,_color:ne,options:de}=this;if(J.interaction.type()){const oe=`to${J.interaction.type().getAttribute("data-type")}`;J.interaction.result.value=typeof ne[oe]=="function"?ne[oe]().toString(de.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",ne,M,this)}_clearColor(M=!1){const{_root:J,options:ne}=this;ne.useAsButton||J.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),J.button.classList.add("clear"),ne.showAlways||this.hide(),this._lastColor=null,this._initializingActive||M||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(M){const{values:J,type:ne,a:de}=S(M),{lockOpacity:oe}=this.options,he=de!==void 0&&de!==1;return J&&J.length===3&&(J[3]=void 0),{values:!J||oe&&he?null:J,type:ne}}_t(M){return this.options.i18n[M]||ge.I18N_DEFAULTS[M]}_emit(M,...J){this._eventListener[M].forEach(ne=>ne(...J,this))}on(M,J){return this._eventListener[M].push(J),this}off(M,J){const ne=this._eventListener[M]||[],de=ne.indexOf(J);return~de&&ne.splice(de,1),this}addSwatch(M){const{values:J}=this._parseLocalColor(M);if(J){const{_swatchColors:ne,_root:de}=this,oe=G(...J),he=f(`<button type="button" style="--pcr-color: ${oe.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return de.swatches.appendChild(he),ne.push({el:he,color:oe}),this._eventBindings.push(s(he,"click",()=>{this.setHSVA(...oe.toHSVA(),!0),this._emit("swatchselect",oe),this._emit("change",oe,"swatch",this)})),!0}return!1}removeSwatch(M){const J=this._swatchColors[M];if(J){const{el:ne}=J;return this._root.swatches.removeChild(ne),this._swatchColors.splice(M,1),!0}return!1}applyColor(M=!1){const{preview:J,button:ne}=this._root,de=this._color.toRGBA().toString(0);return J.lastColor.style.setProperty("--pcr-color",de),this.options.useAsButton||ne.style.setProperty("--pcr-color",de),ne.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||M||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach(M=>d(...M)),Object.keys(this._components).forEach(M=>this._components[M].destroy())}destroyAndRemove(){this.destroy();const{root:M,app:J}=this._root;M.parentElement&&M.parentElement.removeChild(M),J.parentElement.removeChild(J),Object.keys(this).forEach(ne=>this[ne]=null)}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(M=360,J=0,ne=0,de=1,oe=!1){const he=this._recalc;if(this._recalc=!1,M<0||M>360||J<0||J>100||ne<0||ne>100||de<0||de>1)return!1;this._color=G(M,J,ne,de);const{hue:ue,opacity:ve,palette:_e}=this._components;return ue.update(M/360),ve.update(de),_e.update(J/100,1-ne/100),oe||this.applyColor(),he&&this._updateOutput(),this._recalc=he,!0}setColor(M,J=!1){if(M===null)return this._clearColor(J),!0;const{values:ne,type:de}=this._parseLocalColor(M);if(ne){const oe=de.toUpperCase(),{options:he}=this._root.interaction,ue=he.find(ve=>ve.getAttribute("data-type")===oe);if(ue&&!ue.hidden)for(const ve of he)ve.classList[ve===ue?"add":"remove"]("active");return!!this.setHSVA(...ne,J)&&this.setColorRepresentation(oe)}return!1}setColorRepresentation(M){return M=M.toUpperCase(),!!this._root.interaction.options.find(J=>J.getAttribute("data-type").startsWith(M)&&!J.click())}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}};Ct(ge,"utils",i),Ct(ge,"version","1.9.1"),Ct(ge,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),Ct(ge,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),Ct(ge,"create",M=>new ge(M));let me=ge;return n=n.default})())}(ou)),ou.exports}var Bb=jb();const Ub=Mt(Bb),Kb=document;class Wb{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.pickrs={},["node","stroke","edge","face","label","background","grid"].forEach(n=>{const i=`#${n}-color`;this.pickrs[n]=Ub.create({el:i,theme:"nano",default:this.settings[`${n}_color`],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,input:!0,save:!0}}})})}init(){for(const e in this.pickrs){const t=this.pickrs[e];t.on("change",n=>{const i=n.toHEXA().toString().toLowerCase();t.setColor(i),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:i})})}}setColor(e,t){const n=this.pickrs[e];n&&(n.setColor(this.ToHex(t)),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:this.ToHex(t)}))}getColor(e){const t=this.pickrs[e];return t?t.getColor().toHEXA().toString().toLowerCase():null}resetColors(){for(const e in this.pickrs)this.setColor(e,this.settings[`${e}_color`])}ToHex(e){if(typeof e!="string")return null;const t=e.trim().toLowerCase();if(/^#([0-9a-f]{3,8})$/i.test(t))return t.length===4?"#"+[...t.slice(1)].map(b=>b+b).join(""):t;const n=Kb.createElement("canvas").getContext("2d");n.fillStyle=t;const i=n.fillStyle.match(/\d+(\.\d+)?/g).map(Number),[a,s,d,f=1]=i,h=b=>Math.round(b).toString(16).padStart(2,"0"),y=Math.round(f*255).toString(16).padStart(2,"0");return"#"+h(a)+h(s)+h(d)+(f<1?y:"")}}class Hb{constructor(e){this.app=e,this.graphManager=e.graphManager,this.mainCanvas=e._canvas._canvas.main,this.nodeCanvas=e._canvas._canvas.node,this.edgeCanvas=e._canvas._canvas.edge,this.faceCanvas=e._canvas._canvas.face,this.settings=e.settings,this.rect=e.rect}drawGraph(e={node:!0,edge:!0,face:!0,rect:!0}){if(!e.node&&!e.edge&&!e.face&&!e.rect)return;const t=this.graphManager.graph,n=this.settings,i=+n.edge_size,s=`${n.label_size}px sans-serif`,d=n.label_pos.x,f=n.label_pos.y,h=n.node_radius,y=n.stroke_size;e.face&&this.drawFaces(this.faceCanvas,t,n,s,d,f),e.edge&&this.drawEdges(this.edgeCanvas,t,n,i,h,s,d,f),e.node&&this.drawNodes(this.nodeCanvas,t,n,h,y,s,d,f),e.rect&&this.rect.draw()}drawArrowhead(e,t,n,i,a,s){s.beginPath(),s.moveTo(e,t),s.lineTo(e-i*Math.cos(n-Math.PI/6),t-i*Math.sin(n-Math.PI/6)),s.lineTo(e-i*Math.cos(n+Math.PI/6),t-i*Math.sin(n+Math.PI/6)),s.closePath(),s.fillStyle=a,s.fill()}drawLabel(e,t,n,i,a,s){t!=null&&t.trim()&&(e.fillStyle=a||"#000",e.font=s,e.textAlign="center",e.textBaseline="middle",e.fillText(t,n,i))}drawFaces(e,t,n,i,a,s){const d=e.ctx,f=e.canvas.width,h=e.canvas.height;d.clearRect(0,0,f,h);let y=!1;t.forEachFace((b,w)=>{const E=w.nodes.map(I=>{const D=t.getNodeAttributes(I);return[D.x,D.y]});for(const I of E)if(this.check(I[0],I[1],f,h)){y=!0;break}if(y){y=!1;const I={x:Qa(E,D=>D[0]),y:Qa(E,D=>D[1])};if(E){d.fillStyle=w.selected?"#FFA50055":w.color,d.beginPath(),d.moveTo(E[0][0],E[0][1]);for(let D=1;D<E.length;D++)d.lineTo(E[D][0],E[D][1]);d.closePath(),d.fill()}n.faceLabel&&this.drawLabel(d,w.label,I.x,I.y,w.labelColor,i)}})}drawEdges(e,t,n,i,a,s,d,f){const h=e.ctx,y=e.canvas.width,b=e.canvas.height;h.clearRect(0,0,y,b),t.forEachEdge((w,E,I,D,N,O)=>{if(!this.check(N.x,N.y,y,b)&&!this.check(O.x,O.y,y,b))return;const P=O.x-N.x,z=O.y-N.y,C=Math.hypot(P,z),L=P/C*(12+i),K=z/C*(12+i),S=t.hasEdge(D,I),G=S?N.x+L:N.x,q=S?N.y+K:N.y,j=O.x-L,Y=O.y-K;h.beginPath(),h.moveTo(G,q),h.lineTo(j,Y);let te;if(E.selected?this.graphManager.cut?te=Io(E.color,.5):te="orange":te=E.color,h.strokeStyle=te,h.lineWidth=i,h.stroke(),h.closePath(),t.isDirected(w)){const B=Math.atan2(z,P),me=O.x-Math.cos(B)*a/4,ge=O.y-Math.sin(B)*a/4;this.drawArrowhead(me,ge,B,14+i,te,h)}if((n.edgeLabel||n.weightLabel)&&(E.label||E.weight!=null)){const B=(N.x+O.x)/2,me=(N.y+O.y)/2,ge=-z/C,V=P/C,M=B+ge*10+d,J=me+V*10+f,ne=[];n.edgeLabel&&E.label&&ne.push(E.label),n.weightLabel&&E.weight!=null&&ne.push(E.weight),ne.length&&this.drawLabel(h,ne.join(", "),M,J,E.labelColor,s)}})}drawNodes(e,t,n,i,a,s,d,f){const h=e.ctx,y=e.canvas.width,b=e.canvas.height;h.clearRect(0,0,y,b),t.forEachNode((w,E)=>{this.check(E.x,E.y,y,b)&&(h.beginPath(),h.arc(E.x,E.y,i*E.size,0,2*Math.PI),E.selected?this.graphManager.cut?h.fillStyle=Io(E.color,.5):h.fillStyle="orange":h.fillStyle=E.color,h.fill(),a!==0&&(h.lineWidth=a,E.selected?this.graphManager.cut?h.strokeStyle=Io(E.stroke,.4):h.strokeStyle="orange":h.strokeStyle=E.stroke,h.stroke()),h.closePath(),n.vertexLabel&&this.drawLabel(h,E.label,E.x+d,E.y+f,E.labelColor,s))})}check(e,t,n,i){return e>=0&&e<=n&&t>=0&&t<=i}}class Yb{constructor(){this.eventBus=Py,this.appSettings=new vu(this),this._canvas=null,this.layout=null,this.graphManager=null,this.rect=null,this.graphRenderer=null,this.menu=null,this.widget=null,this.keyHandler=null,this.eventHanders=null,this.colorPicker=null,this.simulation=null,this.nodes=[],this.links=[],this.init()}async init(){this.settings=await this.appSettings.init(),this._canvas=new Oy(this),this.canvas=this._canvas.canvas,this.layout=new Tb(this),this.graphManager=new ib(this,this.settings.type),this.rect=new qb(this),this.graphRenderer=new Hb(this),this.menu=new ub(this,lb),this.widget=new Gb(this),this.keyHandler=new sb(this),this.eventHanders=new cb(this),this.colorPicker=new Wb(this),this.menu.init(),Va(this.settings,this.canvas),this.widget.init(),this._canvas.init(),this.rect.init(),this.keyHandler.init(),this.eventHanders.init(),this.initSimulation(),this.loadInitialGraph(),this.colorPicker.init(),this.startAnimationLoop()}initSimulation(){this.nodes.length=0,this.nodes=this.graphManager.graph.getNodesForD3(),this.links.length=0,this.settings.force_edge&&(this.links=this.graphManager.graph.getEdgesForD3()),this.simulation=Cy(this.nodes).force("link",by(this.links).id(e=>e.id).distance(10).strength(.5)).force("charge",Dy().strength(-300)).force("collide",vy(20)).force("center",Zg(this.canvas.width/2,this.canvas.height/2)).force("x",Iy(this.canvas.width/2).strength(.05)).force("y",My(this.canvas.height/1).strength(.05)).velocityDecay(.3).alphaDecay(.02),this.appSettings.settings.forceSimulation||this.simulation.stop()}async loadInitialGraph(){const e=await this.graphManager.getLastSnapshot();e?(this.graphManager.loadSnapshot(e),await this.graphManager.updateIndex()):this.graphManager.generator.clusters(20,20,10)}ticked(){this.nodes.forEach(e=>{this.graphManager.graph.hasNode(e.id)&&this.graphManager.graph.updateNodeAttributes(e.id,t=>({...t,x:e.x,y:e.y}))})}startSimulation(){this.simulation.alpha(.3).restart()}stopSimulation(){this.simulation.stop()}updateSimulation(){this.nodes.length=0,this.nodes=this.graphManager.graph.getNodesForD3(),this.links.length=0,this.settings.force_edge&&(this.links=this.graphManager.graph.getEdgesForD3()),this.simulation.nodes(this.nodes),this.simulation.force("link").links(this.links),this.settings.forceSimulation?this.startSimulation():this.stopSimulation()}startAnimationLoop(){const e=()=>{this.settings.forceSimulation?(this.simulation.tick(),this.ticked(),this.graphRenderer.drawGraph({node:!0,edge:!0,face:!0})):this.graphRenderer.drawGraph(this.graphManager.needsRedraw),requestAnimationFrame(e)};requestAnimationFrame(e)}}document.addEventListener("DOMContentLoaded",()=>{const r=new Yb;window.graphStudio=r,window.addEventListener("resize",()=>{r._canvas.updateCanvasSize(window.innerWidth,window.innerHeight)}),document.querySelectorAll("img").forEach(e=>{e.setAttribute("draggable","false")})});
