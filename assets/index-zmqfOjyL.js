var If=Object.defineProperty;var yc=n=>{throw TypeError(n)};var Mf=(n,e,t)=>e in n?If(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Ct=(n,e,t)=>Mf(n,typeof e!="symbol"?e+"":e,t),vc=(n,e,t)=>e.has(n)||yc("Cannot "+t);var $a=(n,e,t)=>(vc(n,e,"read from private field"),t?t.call(n):e.get(n)),mc=(n,e,t)=>e.has(n)?yc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),bc=(n,e,t,r)=>(vc(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function lo(n,e){let t=0,r=0;if(e===void 0)for(let i of n)i!=null&&(i=+i)>=i&&(++t,r+=i);else{let i=-1;for(let a of n)(a=e(a,++i,n))!=null&&(a=+a)>=a&&(++t,r+=a)}if(t)return r/t}var Nf={value:()=>{}};function bo(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new ao(t)}function ao(n){this._=n}function Pf(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}ao.prototype=bo.prototype={constructor:ao,on:function(n,e){var t=this._,r=Pf(n+"",t),i,a=-1,s=r.length;if(arguments.length<2){for(;++a<s;)if((i=(n=r[a]).type)&&(i=Of(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<s;)if(i=(n=r[a]).type)t[i]=wc(t[i],n.name,e);else if(e==null)for(i in t)t[i]=wc(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new ao(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,a;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(a=this._[n],r=0,i=a.length;r<i;++r)a[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,a=r.length;i<a;++i)r[i].value.apply(e,t)}};function Of(n,e){for(var t=0,r=n.length,i;t<r;++t)if((i=n[t]).name===e)return i.value}function wc(n,e,t){for(var r=0,i=n.length;r<i;++r)if(n[r].name===e){n[r]=Nf,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var Lu="http://www.w3.org/1999/xhtml";const Ec={svg:"http://www.w3.org/2000/svg",xhtml:Lu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wo(n){var e=n+="",t=e.indexOf(":");return t>=0&&(e=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),Ec.hasOwnProperty(e)?{space:Ec[e],local:n}:n}function Tf(n){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===Lu&&e.documentElement.namespaceURI===Lu?e.createElement(n):e.createElementNS(t,n)}}function Rf(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function Dh(n){var e=wo(n);return(e.local?Rf:Tf)(e)}function Lf(){}function Vu(n){return n==null?Lf:function(){return this.querySelector(n)}}function zf(n){typeof n!="function"&&(n=Vu(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,c=r[i]=new Array(s),f,h,y=0;y<s;++y)(f=a[y])&&(h=n.call(f,f.__data__,y,a))&&("__data__"in f&&(h.__data__=f.__data__),c[y]=h);return new Vt(r,this._parents)}function $f(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Gf(){return[]}function Ch(n){return n==null?Gf:function(){return this.querySelectorAll(n)}}function qf(n){return function(){return $f(n.apply(this,arguments))}}function Ff(n){typeof n=="function"?n=qf(n):n=Ch(n);for(var e=this._groups,t=e.length,r=[],i=[],a=0;a<t;++a)for(var s=e[a],c=s.length,f,h=0;h<c;++h)(f=s[h])&&(r.push(n.call(f,f.__data__,h,s)),i.push(f));return new Vt(r,i)}function Ih(n){return function(){return this.matches(n)}}function Mh(n){return function(e){return e.matches(n)}}var jf=Array.prototype.find;function Bf(n){return function(){return jf.call(this.children,n)}}function Uf(){return this.firstElementChild}function Kf(n){return this.select(n==null?Uf:Bf(typeof n=="function"?n:Mh(n)))}var Wf=Array.prototype.filter;function Hf(){return Array.from(this.children)}function Yf(n){return function(){return Wf.call(this.children,n)}}function Xf(n){return this.selectAll(n==null?Hf:Yf(typeof n=="function"?n:Mh(n)))}function Vf(n){typeof n!="function"&&(n=Ih(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,c=r[i]=[],f,h=0;h<s;++h)(f=a[h])&&n.call(f,f.__data__,h,a)&&c.push(f);return new Vt(r,this._parents)}function Nh(n){return new Array(n.length)}function Qf(){return new Vt(this._enter||this._groups.map(Nh),this._parents)}function ho(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}ho.prototype={constructor:ho,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function Zf(n){return function(){return n}}function Jf(n,e,t,r,i,a){for(var s=0,c,f=e.length,h=a.length;s<h;++s)(c=e[s])?(c.__data__=a[s],r[s]=c):t[s]=new ho(n,a[s]);for(;s<f;++s)(c=e[s])&&(i[s]=c)}function ep(n,e,t,r,i,a,s){var c,f,h=new Map,y=e.length,v=a.length,w=new Array(y),E;for(c=0;c<y;++c)(f=e[c])&&(w[c]=E=s.call(f,f.__data__,c,e)+"",h.has(E)?i[c]=f:h.set(E,f));for(c=0;c<v;++c)E=s.call(n,a[c],c,a)+"",(f=h.get(E))?(r[c]=f,f.__data__=a[c],h.delete(E)):t[c]=new ho(n,a[c]);for(c=0;c<y;++c)(f=e[c])&&h.get(w[c])===f&&(i[c]=f)}function tp(n){return n.__data__}function rp(n,e){if(!arguments.length)return Array.from(this,tp);var t=e?ep:Jf,r=this._parents,i=this._groups;typeof n!="function"&&(n=Zf(n));for(var a=i.length,s=new Array(a),c=new Array(a),f=new Array(a),h=0;h<a;++h){var y=r[h],v=i[h],w=v.length,E=np(n.call(y,y&&y.__data__,h,r)),D=E.length,k=c[h]=new Array(D),I=s[h]=new Array(D),P=f[h]=new Array(w);t(y,v,k,I,P,E,e);for(var C=0,R=0,_,T;C<D;++C)if(_=k[C]){for(C>=R&&(R=C+1);!(T=I[R])&&++R<D;);_._next=T||null}}return s=new Vt(s,r),s._enter=c,s._exit=f,s}function np(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function ip(){return new Vt(this._exit||this._groups.map(Nh),this._parents)}function ap(n,e,t){var r=this.enter(),i=this,a=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?a.remove():t(a),r&&i?r.merge(i).order():i}function op(n){for(var e=n.selection?n.selection():n,t=this._groups,r=e._groups,i=t.length,a=r.length,s=Math.min(i,a),c=new Array(i),f=0;f<s;++f)for(var h=t[f],y=r[f],v=h.length,w=c[f]=new Array(v),E,D=0;D<v;++D)(E=h[D]||y[D])&&(w[D]=E);for(;f<i;++f)c[f]=t[f];return new Vt(c,this._parents)}function sp(){for(var n=this._groups,e=-1,t=n.length;++e<t;)for(var r=n[e],i=r.length-1,a=r[i],s;--i>=0;)(s=r[i])&&(a&&s.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(s,a),a=s);return this}function up(n){n||(n=cp);function e(v,w){return v&&w?n(v.__data__,w.__data__):!v-!w}for(var t=this._groups,r=t.length,i=new Array(r),a=0;a<r;++a){for(var s=t[a],c=s.length,f=i[a]=new Array(c),h,y=0;y<c;++y)(h=s[y])&&(f[y]=h);f.sort(e)}return new Vt(i,this._parents).order()}function cp(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function lp(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function dp(){return Array.from(this)}function hp(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null}function fp(){let n=0;for(const e of this)++n;return n}function pp(){return!this.node()}function gp(n){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],a=0,s=i.length,c;a<s;++a)(c=i[a])&&n.call(c,c.__data__,a,i);return this}function yp(n){return function(){this.removeAttribute(n)}}function vp(n){return function(){this.removeAttributeNS(n.space,n.local)}}function mp(n,e){return function(){this.setAttribute(n,e)}}function bp(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function wp(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}}function Ep(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function xp(n,e){var t=wo(n);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((e==null?t.local?vp:yp:typeof e=="function"?t.local?Ep:wp:t.local?bp:mp)(t,e))}function Ph(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function _p(n){return function(){this.style.removeProperty(n)}}function Sp(n,e,t){return function(){this.style.setProperty(n,e,t)}}function Ap(n,e,t){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,t)}}function kp(n,e,t){return arguments.length>1?this.each((e==null?_p:typeof e=="function"?Ap:Sp)(n,e,t??"")):Ei(this.node(),n)}function Ei(n,e){return n.style.getPropertyValue(e)||Ph(n).getComputedStyle(n,null).getPropertyValue(e)}function Dp(n){return function(){delete this[n]}}function Cp(n,e){return function(){this[n]=e}}function Ip(n,e){return function(){var t=e.apply(this,arguments);t==null?delete this[n]:this[n]=t}}function Mp(n,e){return arguments.length>1?this.each((e==null?Dp:typeof e=="function"?Ip:Cp)(n,e)):this.node()[n]}function Oh(n){return n.trim().split(/^|\s+/)}function Qu(n){return n.classList||new Th(n)}function Th(n){this._node=n,this._names=Oh(n.getAttribute("class")||"")}Th.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function Rh(n,e){for(var t=Qu(n),r=-1,i=e.length;++r<i;)t.add(e[r])}function Lh(n,e){for(var t=Qu(n),r=-1,i=e.length;++r<i;)t.remove(e[r])}function Np(n){return function(){Rh(this,n)}}function Pp(n){return function(){Lh(this,n)}}function Op(n,e){return function(){(e.apply(this,arguments)?Rh:Lh)(this,n)}}function Tp(n,e){var t=Oh(n+"");if(arguments.length<2){for(var r=Qu(this.node()),i=-1,a=t.length;++i<a;)if(!r.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?Op:e?Np:Pp)(t,e))}function Rp(){this.textContent=""}function Lp(n){return function(){this.textContent=n}}function zp(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function $p(n){return arguments.length?this.each(n==null?Rp:(typeof n=="function"?zp:Lp)(n)):this.node().textContent}function Gp(){this.innerHTML=""}function qp(n){return function(){this.innerHTML=n}}function Fp(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function jp(n){return arguments.length?this.each(n==null?Gp:(typeof n=="function"?Fp:qp)(n)):this.node().innerHTML}function Bp(){this.nextSibling&&this.parentNode.appendChild(this)}function Up(){return this.each(Bp)}function Kp(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wp(){return this.each(Kp)}function Hp(n){var e=typeof n=="function"?n:Dh(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Yp(){return null}function Xp(n,e){var t=typeof n=="function"?n:Dh(n),r=e==null?Yp:typeof e=="function"?e:Vu(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function Vp(){var n=this.parentNode;n&&n.removeChild(this)}function Qp(){return this.each(Vp)}function Zp(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function Jp(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function eg(n){return this.select(n?Jp:Zp)}function tg(n){return arguments.length?this.property("__data__",n):this.node().__data__}function rg(n){return function(e){n.call(this,e,this.__data__)}}function ng(n){return n.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}function ig(n){return function(){var e=this.__on;if(e){for(var t=0,r=-1,i=e.length,a;t<i;++t)a=e[t],(!n.type||a.type===n.type)&&a.name===n.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function ag(n,e,t){return function(){var r=this.__on,i,a=rg(e);if(r){for(var s=0,c=r.length;s<c;++s)if((i=r[s]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=t),i.value=e;return}}this.addEventListener(n.type,a,t),i={type:n.type,name:n.name,value:e,listener:a,options:t},r?r.push(i):this.__on=[i]}}function og(n,e,t){var r=ng(n+""),i,a=r.length,s;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,h=c.length,y;f<h;++f)for(i=0,y=c[f];i<a;++i)if((s=r[i]).type===y.type&&s.name===y.name)return y.value}return}for(c=e?ag:ig,i=0;i<a;++i)this.each(c(r[i],e,t));return this}function zh(n,e,t){var r=Ph(n),i=r.CustomEvent;typeof i=="function"?i=new i(e,t):(i=r.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),n.dispatchEvent(i)}function sg(n,e){return function(){return zh(this,n,e)}}function ug(n,e){return function(){return zh(this,n,e.apply(this,arguments))}}function cg(n,e){return this.each((typeof e=="function"?ug:sg)(n,e))}function*lg(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,a=r.length,s;i<a;++i)(s=r[i])&&(yield s)}var $h=[null];function Vt(n,e){this._groups=n,this._parents=e}function da(){return new Vt([[document.documentElement]],$h)}function dg(){return this}Vt.prototype=da.prototype={constructor:Vt,select:zf,selectAll:Ff,selectChild:Kf,selectChildren:Xf,filter:Vf,data:rp,enter:Qf,exit:ip,join:ap,merge:op,selection:dg,order:sp,sort:up,call:lp,nodes:dp,node:hp,size:fp,empty:pp,each:gp,attr:xp,style:kp,property:Mp,classed:Tp,text:$p,html:jp,raise:Up,lower:Wp,append:Hp,insert:Xp,remove:Qp,clone:eg,datum:tg,on:og,dispatch:cg,[Symbol.iterator]:lg};function $t(n){return typeof n=="string"?new Vt([[document.querySelector(n)]],[document.documentElement]):new Vt([[n]],$h)}function hg(n){let e;for(;e=n.sourceEvent;)n=e;return n}function nr(n,e){if(n=hg(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var r=t.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop]}}return[n.pageX,n.pageY]}const fg={passive:!1},oa={capture:!0,passive:!1};function $o(n){n.stopImmediatePropagation()}function bi(n){n.preventDefault(),n.stopImmediatePropagation()}function pg(n){var e=n.document.documentElement,t=$t(n).on("dragstart.drag",bi,oa);"onselectstart"in e?t.on("selectstart.drag",bi,oa):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function gg(n,e){var t=n.document.documentElement,r=$t(n).on("dragstart.drag",null);e&&(r.on("click.drag",bi,oa),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in t?r.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const Ga=n=>()=>n;function zu(n,{sourceEvent:e,subject:t,target:r,identifier:i,active:a,x:s,y:c,dx:f,dy:h,dispatch:y}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:h,enumerable:!0,configurable:!0},_:{value:y}})}zu.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function yg(n){return!n.ctrlKey&&!n.button}function vg(){return this.parentNode}function mg(n,e){return e??{x:n.x,y:n.y}}function bg(){return navigator.maxTouchPoints||"ontouchstart"in this}function wg(){var n=yg,e=vg,t=mg,r=bg,i={},a=bo("start","drag","end"),s=0,c,f,h,y,v=0;function w(_){_.on("mousedown.drag",E).filter(r).on("touchstart.drag",I).on("touchmove.drag",P,fg).on("touchend.drag touchcancel.drag",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function E(_,T){if(!(y||!n.call(this,_,T))){var B=R(this,e.call(this,_,T),_,T,"mouse");B&&($t(_.view).on("mousemove.drag",D,oa).on("mouseup.drag",k,oa),pg(_.view),$o(_),h=!1,c=_.clientX,f=_.clientY,B("start",_))}}function D(_){if(bi(_),!h){var T=_.clientX-c,B=_.clientY-f;h=T*T+B*B>v}i.mouse("drag",_)}function k(_){$t(_.view).on("mousemove.drag mouseup.drag",null),gg(_.view,h),bi(_),i.mouse("end",_)}function I(_,T){if(n.call(this,_,T)){var B=_.changedTouches,S=e.call(this,_,T),z=B.length,G,F;for(G=0;G<z;++G)(F=R(this,S,_,T,B[G].identifier,B[G]))&&($o(_),F("start",_,B[G]))}}function P(_){var T=_.changedTouches,B=T.length,S,z;for(S=0;S<B;++S)(z=i[T[S].identifier])&&(bi(_),z("drag",_,T[S]))}function C(_){var T=_.changedTouches,B=T.length,S,z;for(y&&clearTimeout(y),y=setTimeout(function(){y=null},500),S=0;S<B;++S)(z=i[T[S].identifier])&&($o(_),z("end",_,T[S]))}function R(_,T,B,S,z,G){var F=a.copy(),U=nr(G||B,T),V,j,ye;if((ye=t.call(_,new zu("beforestart",{sourceEvent:B,target:w,identifier:z,active:s,x:U[0],y:U[1],dx:0,dy:0,dispatch:F}),S))!=null)return V=ye.x-U[0]||0,j=ye.y-U[1]||0,function fe(Y,O,J){var ee=U,ce;switch(Y){case"start":i[z]=fe,ce=s++;break;case"end":delete i[z],--s;case"drag":U=nr(J||O,T),ce=s;break}F.call(Y,_,new zu(Y,{sourceEvent:O,subject:ye,target:w,identifier:z,active:ce,x:U[0]+V,y:U[1]+j,dx:U[0]-ee[0],dy:U[1]-ee[1],dispatch:F}),S)}}return w.filter=function(_){return arguments.length?(n=typeof _=="function"?_:Ga(!!_),w):n},w.container=function(_){return arguments.length?(e=typeof _=="function"?_:Ga(_),w):e},w.subject=function(_){return arguments.length?(t=typeof _=="function"?_:Ga(_),w):t},w.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:Ga(!!_),w):r},w.on=function(){var _=a.on.apply(a,arguments);return _===a?w:_},w.clickDistance=function(_){return arguments.length?(v=(_=+_)*_,w):Math.sqrt(v)},w}function Zu(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function Gh(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function ha(){}var sa=.7,fo=1/sa,wi="\\s*([+-]?\\d+)\\s*",ua="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Eg=/^#([0-9a-f]{3,8})$/,xg=new RegExp(`^rgb\\(${wi},${wi},${wi}\\)$`),_g=new RegExp(`^rgb\\(${zr},${zr},${zr}\\)$`),Sg=new RegExp(`^rgba\\(${wi},${wi},${wi},${ua}\\)$`),Ag=new RegExp(`^rgba\\(${zr},${zr},${zr},${ua}\\)$`),kg=new RegExp(`^hsl\\(${ua},${zr},${zr}\\)$`),Dg=new RegExp(`^hsla\\(${ua},${zr},${zr},${ua}\\)$`),xc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zu(ha,ca,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:_c,formatHex:_c,formatHex8:Cg,formatHsl:Ig,formatRgb:Sc,toString:Sc});function _c(){return this.rgb().formatHex()}function Cg(){return this.rgb().formatHex8()}function Ig(){return qh(this).formatHsl()}function Sc(){return this.rgb().formatRgb()}function ca(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=Eg.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?Ac(e):t===3?new Ut(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?qa(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?qa(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=xg.exec(n))?new Ut(e[1],e[2],e[3],1):(e=_g.exec(n))?new Ut(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Sg.exec(n))?qa(e[1],e[2],e[3],e[4]):(e=Ag.exec(n))?qa(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=kg.exec(n))?Cc(e[1],e[2]/100,e[3]/100,1):(e=Dg.exec(n))?Cc(e[1],e[2]/100,e[3]/100,e[4]):xc.hasOwnProperty(n)?Ac(xc[n]):n==="transparent"?new Ut(NaN,NaN,NaN,0):null}function Ac(n){return new Ut(n>>16&255,n>>8&255,n&255,1)}function qa(n,e,t,r){return r<=0&&(n=e=t=NaN),new Ut(n,e,t,r)}function Mg(n){return n instanceof ha||(n=ca(n)),n?(n=n.rgb(),new Ut(n.r,n.g,n.b,n.opacity)):new Ut}function $u(n,e,t,r){return arguments.length===1?Mg(n):new Ut(n,e,t,r??1)}function Ut(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}Zu(Ut,$u,Gh(ha,{brighter(n){return n=n==null?fo:Math.pow(fo,n),new Ut(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?sa:Math.pow(sa,n),new Ut(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Ut(qn(this.r),qn(this.g),qn(this.b),po(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kc,formatHex:kc,formatHex8:Ng,formatRgb:Dc,toString:Dc}));function kc(){return`#${$n(this.r)}${$n(this.g)}${$n(this.b)}`}function Ng(){return`#${$n(this.r)}${$n(this.g)}${$n(this.b)}${$n((isNaN(this.opacity)?1:this.opacity)*255)}`}function Dc(){const n=po(this.opacity);return`${n===1?"rgb(":"rgba("}${qn(this.r)}, ${qn(this.g)}, ${qn(this.b)}${n===1?")":`, ${n})`}`}function po(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function qn(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function $n(n){return n=qn(n),(n<16?"0":"")+n.toString(16)}function Cc(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new br(n,e,t,r)}function qh(n){if(n instanceof br)return new br(n.h,n.s,n.l,n.opacity);if(n instanceof ha||(n=ca(n)),!n)return new br;if(n instanceof br)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),a=Math.max(e,t,r),s=NaN,c=a-i,f=(a+i)/2;return c?(e===a?s=(t-r)/c+(t<r)*6:t===a?s=(r-e)/c+2:s=(e-t)/c+4,c/=f<.5?a+i:2-a-i,s*=60):c=f>0&&f<1?0:s,new br(s,c,f,n.opacity)}function Pg(n,e,t,r){return arguments.length===1?qh(n):new br(n,e,t,r??1)}function br(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}Zu(br,Pg,Gh(ha,{brighter(n){return n=n==null?fo:Math.pow(fo,n),new br(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?sa:Math.pow(sa,n),new br(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new Ut(Go(n>=240?n-240:n+120,i,r),Go(n,i,r),Go(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new br(Ic(this.h),Fa(this.s),Fa(this.l),po(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=po(this.opacity);return`${n===1?"hsl(":"hsla("}${Ic(this.h)}, ${Fa(this.s)*100}%, ${Fa(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Ic(n){return n=(n||0)%360,n<0?n+360:n}function Fa(n){return Math.max(0,Math.min(1,n||0))}function Go(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Fh=n=>()=>n;function Og(n,e){return function(t){return n+t*e}}function Tg(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function Rg(n){return(n=+n)==1?jh:function(e,t){return t-e?Tg(e,t,n):Fh(isNaN(e)?t:e)}}function jh(n,e){var t=e-n;return t?Og(n,t):Fh(isNaN(n)?e:n)}const Mc=function n(e){var t=Rg(e);function r(i,a){var s=t((i=$u(i)).r,(a=$u(a)).r),c=t(i.g,a.g),f=t(i.b,a.b),h=jh(i.opacity,a.opacity);return function(y){return i.r=s(y),i.g=c(y),i.b=f(y),i.opacity=h(y),i+""}}return r.gamma=n,r}(1);function fn(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}var Gu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qo=new RegExp(Gu.source,"g");function Lg(n){return function(){return n}}function zg(n){return function(e){return n(e)+""}}function $g(n,e){var t=Gu.lastIndex=qo.lastIndex=0,r,i,a,s=-1,c=[],f=[];for(n=n+"",e=e+"";(r=Gu.exec(n))&&(i=qo.exec(e));)(a=i.index)>t&&(a=e.slice(t,a),c[s]?c[s]+=a:c[++s]=a),(r=r[0])===(i=i[0])?c[s]?c[s]+=i:c[++s]=i:(c[++s]=null,f.push({i:s,x:fn(r,i)})),t=qo.lastIndex;return t<e.length&&(a=e.slice(t),c[s]?c[s]+=a:c[++s]=a),c.length<2?f[0]?zg(f[0].x):Lg(e):(e=f.length,function(h){for(var y=0,v;y<e;++y)c[(v=f[y]).i]=v.x(h);return c.join("")})}var Nc=180/Math.PI,qu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Bh(n,e,t,r,i,a){var s,c,f;return(s=Math.sqrt(n*n+e*e))&&(n/=s,e/=s),(f=n*t+e*r)&&(t-=n*f,r-=e*f),(c=Math.sqrt(t*t+r*r))&&(t/=c,r/=c,f/=c),n*r<e*t&&(n=-n,e=-e,f=-f,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(e,n)*Nc,skewX:Math.atan(f)*Nc,scaleX:s,scaleY:c}}var ja;function Gg(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?qu:Bh(e.a,e.b,e.c,e.d,e.e,e.f)}function qg(n){return n==null||(ja||(ja=document.createElementNS("http://www.w3.org/2000/svg","g")),ja.setAttribute("transform",n),!(n=ja.transform.baseVal.consolidate()))?qu:(n=n.matrix,Bh(n.a,n.b,n.c,n.d,n.e,n.f))}function Uh(n,e,t,r){function i(h){return h.length?h.pop()+" ":""}function a(h,y,v,w,E,D){if(h!==v||y!==w){var k=E.push("translate(",null,e,null,t);D.push({i:k-4,x:fn(h,v)},{i:k-2,x:fn(y,w)})}else(v||w)&&E.push("translate("+v+e+w+t)}function s(h,y,v,w){h!==y?(h-y>180?y+=360:y-h>180&&(h+=360),w.push({i:v.push(i(v)+"rotate(",null,r)-2,x:fn(h,y)})):y&&v.push(i(v)+"rotate("+y+r)}function c(h,y,v,w){h!==y?w.push({i:v.push(i(v)+"skewX(",null,r)-2,x:fn(h,y)}):y&&v.push(i(v)+"skewX("+y+r)}function f(h,y,v,w,E,D){if(h!==v||y!==w){var k=E.push(i(E)+"scale(",null,",",null,")");D.push({i:k-4,x:fn(h,v)},{i:k-2,x:fn(y,w)})}else(v!==1||w!==1)&&E.push(i(E)+"scale("+v+","+w+")")}return function(h,y){var v=[],w=[];return h=n(h),y=n(y),a(h.translateX,h.translateY,y.translateX,y.translateY,v,w),s(h.rotate,y.rotate,v,w),c(h.skewX,y.skewX,v,w),f(h.scaleX,h.scaleY,y.scaleX,y.scaleY,v,w),h=y=null,function(E){for(var D=-1,k=w.length,I;++D<k;)v[(I=w[D]).i]=I.x(E);return v.join("")}}}var Fg=Uh(Gg,"px, ","px)","deg)"),jg=Uh(qg,", ",")",")"),xi=0,ta=0,Wi=0,Kh=1e3,go,ra,yo=0,Fn=0,Eo=0,la=typeof performance=="object"&&performance.now?performance:Date,Wh=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Ju(){return Fn||(Wh(Bg),Fn=la.now()+Eo)}function Bg(){Fn=0}function vo(){this._call=this._time=this._next=null}vo.prototype=ec.prototype={constructor:vo,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?Ju():+t)+(e==null?0:+e),!this._next&&ra!==this&&(ra?ra._next=this:go=this,ra=this),this._call=n,this._time=t,Fu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fu())}};function ec(n,e,t){var r=new vo;return r.restart(n,e,t),r}function Ug(){Ju(),++xi;for(var n=go,e;n;)(e=Fn-n._time)>=0&&n._call.call(void 0,e),n=n._next;--xi}function Pc(){Fn=(yo=la.now())+Eo,xi=ta=0;try{Ug()}finally{xi=0,Wg(),Fn=0}}function Kg(){var n=la.now(),e=n-yo;e>Kh&&(Eo-=e,yo=n)}function Wg(){for(var n,e=go,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:go=t);ra=n,Fu(r)}function Fu(n){if(!xi){ta&&(ta=clearTimeout(ta));var e=n-Fn;e>24?(n<1/0&&(ta=setTimeout(Pc,n-la.now()-Eo)),Wi&&(Wi=clearInterval(Wi))):(Wi||(yo=la.now(),Wi=setInterval(Kg,Kh)),xi=1,Wh(Pc))}}function Oc(n,e,t){var r=new vo;return e=e==null?0:+e,r.restart(i=>{r.stop(),n(i+e)},e,t),r}var Hg=bo("start","end","cancel","interrupt"),Yg=[],Hh=0,Tc=1,ju=2,oo=3,Rc=4,Bu=5,so=6;function xo(n,e,t,r,i,a){var s=n.__transition;if(!s)n.__transition={};else if(t in s)return;Xg(n,t,{name:e,index:r,group:i,on:Hg,tween:Yg,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:Hh})}function tc(n,e){var t=wr(n,e);if(t.state>Hh)throw new Error("too late; already scheduled");return t}function $r(n,e){var t=wr(n,e);if(t.state>oo)throw new Error("too late; already running");return t}function wr(n,e){var t=n.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function Xg(n,e,t){var r=n.__transition,i;r[e]=t,t.timer=ec(a,0,t.time);function a(h){t.state=Tc,t.timer.restart(s,t.delay,t.time),t.delay<=h&&s(h-t.delay)}function s(h){var y,v,w,E;if(t.state!==Tc)return f();for(y in r)if(E=r[y],E.name===t.name){if(E.state===oo)return Oc(s);E.state===Rc?(E.state=so,E.timer.stop(),E.on.call("interrupt",n,n.__data__,E.index,E.group),delete r[y]):+y<e&&(E.state=so,E.timer.stop(),E.on.call("cancel",n,n.__data__,E.index,E.group),delete r[y])}if(Oc(function(){t.state===oo&&(t.state=Rc,t.timer.restart(c,t.delay,t.time),c(h))}),t.state=ju,t.on.call("start",n,n.__data__,t.index,t.group),t.state===ju){for(t.state=oo,i=new Array(w=t.tween.length),y=0,v=-1;y<w;++y)(E=t.tween[y].value.call(n,n.__data__,t.index,t.group))&&(i[++v]=E);i.length=v+1}}function c(h){for(var y=h<t.duration?t.ease.call(null,h/t.duration):(t.timer.restart(f),t.state=Bu,1),v=-1,w=i.length;++v<w;)i[v].call(n,y);t.state===Bu&&(t.on.call("end",n,n.__data__,t.index,t.group),f())}function f(){t.state=so,t.timer.stop(),delete r[e];for(var h in r)return;delete n.__transition}}function Vg(n,e){var t=n.__transition,r,i,a=!0,s;if(t){e=e==null?null:e+"";for(s in t){if((r=t[s]).name!==e){a=!1;continue}i=r.state>ju&&r.state<Bu,r.state=so,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete t[s]}a&&delete n.__transition}}function Qg(n){return this.each(function(){Vg(this,n)})}function Zg(n,e){var t,r;return function(){var i=$r(this,n),a=i.tween;if(a!==t){r=t=a;for(var s=0,c=r.length;s<c;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}i.tween=r}}function Jg(n,e,t){var r,i;if(typeof t!="function")throw new Error;return function(){var a=$r(this,n),s=a.tween;if(s!==r){i=(r=s).slice();for(var c={name:e,value:t},f=0,h=i.length;f<h;++f)if(i[f].name===e){i[f]=c;break}f===h&&i.push(c)}a.tween=i}}function ey(n,e){var t=this._id;if(n+="",arguments.length<2){for(var r=wr(this.node(),t).tween,i=0,a=r.length,s;i<a;++i)if((s=r[i]).name===n)return s.value;return null}return this.each((e==null?Zg:Jg)(t,n,e))}function rc(n,e,t){var r=n._id;return n.each(function(){var i=$r(this,r);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return wr(i,r).value[e]}}function Yh(n,e){var t;return(typeof e=="number"?fn:e instanceof ca?Mc:(t=ca(e))?(e=t,Mc):$g)(n,e)}function ty(n){return function(){this.removeAttribute(n)}}function ry(n){return function(){this.removeAttributeNS(n.space,n.local)}}function ny(n,e,t){var r,i=t+"",a;return function(){var s=this.getAttribute(n);return s===i?null:s===r?a:a=e(r=s,t)}}function iy(n,e,t){var r,i=t+"",a;return function(){var s=this.getAttributeNS(n.space,n.local);return s===i?null:s===r?a:a=e(r=s,t)}}function ay(n,e,t){var r,i,a;return function(){var s,c=t(this),f;return c==null?void this.removeAttribute(n):(s=this.getAttribute(n),f=c+"",s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,c)))}}function oy(n,e,t){var r,i,a;return function(){var s,c=t(this),f;return c==null?void this.removeAttributeNS(n.space,n.local):(s=this.getAttributeNS(n.space,n.local),f=c+"",s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,c)))}}function sy(n,e){var t=wo(n),r=t==="transform"?jg:Yh;return this.attrTween(n,typeof e=="function"?(t.local?oy:ay)(t,r,rc(this,"attr."+n,e)):e==null?(t.local?ry:ty)(t):(t.local?iy:ny)(t,r,e))}function uy(n,e){return function(t){this.setAttribute(n,e.call(this,t))}}function cy(n,e){return function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))}}function ly(n,e){var t,r;function i(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&cy(n,a)),t}return i._value=e,i}function dy(n,e){var t,r;function i(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&uy(n,a)),t}return i._value=e,i}function hy(n,e){var t="attr."+n;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var r=wo(n);return this.tween(t,(r.local?ly:dy)(r,e))}function fy(n,e){return function(){tc(this,n).delay=+e.apply(this,arguments)}}function py(n,e){return e=+e,function(){tc(this,n).delay=e}}function gy(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?fy:py)(e,n)):wr(this.node(),e).delay}function yy(n,e){return function(){$r(this,n).duration=+e.apply(this,arguments)}}function vy(n,e){return e=+e,function(){$r(this,n).duration=e}}function my(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?yy:vy)(e,n)):wr(this.node(),e).duration}function by(n,e){if(typeof e!="function")throw new Error;return function(){$r(this,n).ease=e}}function wy(n){var e=this._id;return arguments.length?this.each(by(e,n)):wr(this.node(),e).ease}function Ey(n,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;$r(this,n).ease=t}}function xy(n){if(typeof n!="function")throw new Error;return this.each(Ey(this._id,n))}function _y(n){typeof n!="function"&&(n=Ih(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],s=a.length,c=r[i]=[],f,h=0;h<s;++h)(f=a[h])&&n.call(f,f.__data__,h,a)&&c.push(f);return new Vr(r,this._parents,this._name,this._id)}function Sy(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,t=n._groups,r=e.length,i=t.length,a=Math.min(r,i),s=new Array(r),c=0;c<a;++c)for(var f=e[c],h=t[c],y=f.length,v=s[c]=new Array(y),w,E=0;E<y;++E)(w=f[E]||h[E])&&(v[E]=w);for(;c<r;++c)s[c]=e[c];return new Vr(s,this._parents,this._name,this._id)}function Ay(n){return(n+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function ky(n,e,t){var r,i,a=Ay(e)?tc:$r;return function(){var s=a(this,n),c=s.on;c!==r&&(i=(r=c).copy()).on(e,t),s.on=i}}function Dy(n,e){var t=this._id;return arguments.length<2?wr(this.node(),t).on.on(n):this.each(ky(t,n,e))}function Cy(n){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}}function Iy(){return this.on("end.remove",Cy(this._id))}function My(n){var e=this._name,t=this._id;typeof n!="function"&&(n=Vu(n));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var c=r[s],f=c.length,h=a[s]=new Array(f),y,v,w=0;w<f;++w)(y=c[w])&&(v=n.call(y,y.__data__,w,c))&&("__data__"in y&&(v.__data__=y.__data__),h[w]=v,xo(h[w],e,t,w,h,wr(y,t)));return new Vr(a,this._parents,e,t)}function Ny(n){var e=this._name,t=this._id;typeof n!="function"&&(n=Ch(n));for(var r=this._groups,i=r.length,a=[],s=[],c=0;c<i;++c)for(var f=r[c],h=f.length,y,v=0;v<h;++v)if(y=f[v]){for(var w=n.call(y,y.__data__,v,f),E,D=wr(y,t),k=0,I=w.length;k<I;++k)(E=w[k])&&xo(E,e,t,k,w,D);a.push(w),s.push(y)}return new Vr(a,s,e,t)}var Py=da.prototype.constructor;function Oy(){return new Py(this._groups,this._parents)}function Ty(n,e){var t,r,i;return function(){var a=Ei(this,n),s=(this.style.removeProperty(n),Ei(this,n));return a===s?null:a===t&&s===r?i:i=e(t=a,r=s)}}function Xh(n){return function(){this.style.removeProperty(n)}}function Ry(n,e,t){var r,i=t+"",a;return function(){var s=Ei(this,n);return s===i?null:s===r?a:a=e(r=s,t)}}function Ly(n,e,t){var r,i,a;return function(){var s=Ei(this,n),c=t(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(n),Ei(this,n))),s===f?null:s===r&&f===i?a:(i=f,a=e(r=s,c))}}function zy(n,e){var t,r,i,a="style."+e,s="end."+a,c;return function(){var f=$r(this,n),h=f.on,y=f.value[a]==null?c||(c=Xh(e)):void 0;(h!==t||i!==y)&&(r=(t=h).copy()).on(s,i=y),f.on=r}}function $y(n,e,t){var r=(n+="")=="transform"?Fg:Yh;return e==null?this.styleTween(n,Ty(n,r)).on("end.style."+n,Xh(n)):typeof e=="function"?this.styleTween(n,Ly(n,r,rc(this,"style."+n,e))).each(zy(this._id,n)):this.styleTween(n,Ry(n,r,e),t).on("end.style."+n,null)}function Gy(n,e,t){return function(r){this.style.setProperty(n,e.call(this,r),t)}}function qy(n,e,t){var r,i;function a(){var s=e.apply(this,arguments);return s!==i&&(r=(i=s)&&Gy(n,s,t)),r}return a._value=e,a}function Fy(n,e,t){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,qy(n,e,t??""))}function jy(n){return function(){this.textContent=n}}function By(n){return function(){var e=n(this);this.textContent=e??""}}function Uy(n){return this.tween("text",typeof n=="function"?By(rc(this,"text",n)):jy(n==null?"":n+""))}function Ky(n){return function(e){this.textContent=n.call(this,e)}}function Wy(n){var e,t;function r(){var i=n.apply(this,arguments);return i!==t&&(e=(t=i)&&Ky(i)),e}return r._value=n,r}function Hy(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,Wy(n))}function Yy(){for(var n=this._name,e=this._id,t=Vh(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],c=s.length,f,h=0;h<c;++h)if(f=s[h]){var y=wr(f,e);xo(f,n,t,h,s,{time:y.time+y.delay+y.duration,delay:0,duration:y.duration,ease:y.ease})}return new Vr(r,this._parents,n,t)}function Xy(){var n,e,t=this,r=t._id,i=t.size();return new Promise(function(a,s){var c={value:s},f={value:function(){--i===0&&a()}};t.each(function(){var h=$r(this,r),y=h.on;y!==n&&(e=(n=y).copy(),e._.cancel.push(c),e._.interrupt.push(c),e._.end.push(f)),h.on=e}),i===0&&a()})}var Vy=0;function Vr(n,e,t,r){this._groups=n,this._parents=e,this._name=t,this._id=r}function Vh(){return++Vy}var Kr=da.prototype;Vr.prototype={constructor:Vr,select:My,selectAll:Ny,selectChild:Kr.selectChild,selectChildren:Kr.selectChildren,filter:_y,merge:Sy,selection:Oy,transition:Yy,call:Kr.call,nodes:Kr.nodes,node:Kr.node,size:Kr.size,empty:Kr.empty,each:Kr.each,on:Dy,attr:sy,attrTween:hy,style:$y,styleTween:Fy,text:Uy,textTween:Hy,remove:Iy,tween:ey,delay:gy,duration:my,ease:wy,easeVarying:xy,end:Xy,[Symbol.iterator]:Kr[Symbol.iterator]};function Qy(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var Zy={time:null,delay:0,duration:250,ease:Qy};function Jy(n,e){for(var t;!(t=n.__transition)||!(t=t[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return t}function ev(n){var e,t;n instanceof Vr?(e=n._id,n=n._name):(e=Vh(),(t=Zy).time=Ju(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s=r[a],c=s.length,f,h=0;h<c;++h)(f=s[h])&&xo(f,n,e,h,s,t||Jy(f,e));return new Vr(r,this._parents,n,e)}da.prototype.interrupt=Qg;da.prototype.transition=ev;function tv(n,e){var t,r=1;n==null&&(n=0),e==null&&(e=0);function i(){var a,s=t.length,c,f=0,h=0;for(a=0;a<s;++a)c=t[a],f+=c.x,h+=c.y;for(f=(f/s-n)*r,h=(h/s-e)*r,a=0;a<s;++a)c=t[a],c.x-=f,c.y-=h}return i.initialize=function(a){t=a},i.x=function(a){return arguments.length?(n=+a,i):n},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function rv(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return Qh(this.cover(e,t),e,t,n)}function Qh(n,e,t,r){if(isNaN(e)||isNaN(t))return n;var i,a=n._root,s={data:r},c=n._x0,f=n._y0,h=n._x1,y=n._y1,v,w,E,D,k,I,P,C;if(!a)return n._root=s,n;for(;a.length;)if((k=e>=(v=(c+h)/2))?c=v:h=v,(I=t>=(w=(f+y)/2))?f=w:y=w,i=a,!(a=a[P=I<<1|k]))return i[P]=s,n;if(E=+n._x.call(null,a.data),D=+n._y.call(null,a.data),e===E&&t===D)return s.next=a,i?i[P]=s:n._root=s,n;do i=i?i[P]=new Array(4):n._root=new Array(4),(k=e>=(v=(c+h)/2))?c=v:h=v,(I=t>=(w=(f+y)/2))?f=w:y=w;while((P=I<<1|k)===(C=(D>=w)<<1|E>=v));return i[C]=a,i[P]=s,n}function nv(n){var e,t,r=n.length,i,a,s=new Array(r),c=new Array(r),f=1/0,h=1/0,y=-1/0,v=-1/0;for(t=0;t<r;++t)isNaN(i=+this._x.call(null,e=n[t]))||isNaN(a=+this._y.call(null,e))||(s[t]=i,c[t]=a,i<f&&(f=i),i>y&&(y=i),a<h&&(h=a),a>v&&(v=a));if(f>y||h>v)return this;for(this.cover(f,h).cover(y,v),t=0;t<r;++t)Qh(this,s[t],c[t],n[t]);return this}function iv(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(t))i=(t=Math.floor(n))+1,a=(r=Math.floor(e))+1;else{for(var s=i-t||1,c=this._root,f,h;t>n||n>=i||r>e||e>=a;)switch(h=(e<r)<<1|n<t,f=new Array(4),f[h]=c,c=f,s*=2,h){case 0:i=t+s,a=r+s;break;case 1:t=i-s,a=r+s;break;case 2:i=t+s,r=a-s;break;case 3:t=i-s,r=a-s;break}this._root&&this._root.length&&(this._root=c)}return this._x0=t,this._y0=r,this._x1=i,this._y1=a,this}function av(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function ov(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Gt(n,e,t,r,i){this.node=n,this.x0=e,this.y0=t,this.x1=r,this.y1=i}function sv(n,e,t){var r,i=this._x0,a=this._y0,s,c,f,h,y=this._x1,v=this._y1,w=[],E=this._root,D,k;for(E&&w.push(new Gt(E,i,a,y,v)),t==null?t=1/0:(i=n-t,a=e-t,y=n+t,v=e+t,t*=t);D=w.pop();)if(!(!(E=D.node)||(s=D.x0)>y||(c=D.y0)>v||(f=D.x1)<i||(h=D.y1)<a))if(E.length){var I=(s+f)/2,P=(c+h)/2;w.push(new Gt(E[3],I,P,f,h),new Gt(E[2],s,P,I,h),new Gt(E[1],I,c,f,P),new Gt(E[0],s,c,I,P)),(k=(e>=P)<<1|n>=I)&&(D=w[w.length-1],w[w.length-1]=w[w.length-1-k],w[w.length-1-k]=D)}else{var C=n-+this._x.call(null,E.data),R=e-+this._y.call(null,E.data),_=C*C+R*R;if(_<t){var T=Math.sqrt(t=_);i=n-T,a=e-T,y=n+T,v=e+T,r=E.data}}return r}function uv(n){if(isNaN(y=+this._x.call(null,n))||isNaN(v=+this._y.call(null,n)))return this;var e,t=this._root,r,i,a,s=this._x0,c=this._y0,f=this._x1,h=this._y1,y,v,w,E,D,k,I,P;if(!t)return this;if(t.length)for(;;){if((D=y>=(w=(s+f)/2))?s=w:f=w,(k=v>=(E=(c+h)/2))?c=E:h=E,e=t,!(t=t[I=k<<1|D]))return this;if(!t.length)break;(e[I+1&3]||e[I+2&3]||e[I+3&3])&&(r=e,P=I)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,i?(a?i.next=a:delete i.next,this):e?(a?e[I]=a:delete e[I],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[P]=t:this._root=t),this):(this._root=a,this)}function cv(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function lv(){return this._root}function dv(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function hv(n){var e=[],t,r=this._root,i,a,s,c,f;for(r&&e.push(new Gt(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(r=t.node,a=t.x0,s=t.y0,c=t.x1,f=t.y1)&&r.length){var h=(a+c)/2,y=(s+f)/2;(i=r[3])&&e.push(new Gt(i,h,y,c,f)),(i=r[2])&&e.push(new Gt(i,a,y,h,f)),(i=r[1])&&e.push(new Gt(i,h,s,c,y)),(i=r[0])&&e.push(new Gt(i,a,s,h,y))}return this}function fv(n){var e=[],t=[],r;for(this._root&&e.push(new Gt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,s=r.x0,c=r.y0,f=r.x1,h=r.y1,y=(s+f)/2,v=(c+h)/2;(a=i[0])&&e.push(new Gt(a,s,c,y,v)),(a=i[1])&&e.push(new Gt(a,y,c,f,v)),(a=i[2])&&e.push(new Gt(a,s,v,y,h)),(a=i[3])&&e.push(new Gt(a,y,v,f,h))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function pv(n){return n[0]}function gv(n){return arguments.length?(this._x=n,this):this._x}function yv(n){return n[1]}function vv(n){return arguments.length?(this._y=n,this):this._y}function nc(n,e,t){var r=new ic(e??pv,t??yv,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function ic(n,e,t,r,i,a){this._x=n,this._y=e,this._x0=t,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Lc(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var Ft=nc.prototype=ic.prototype;Ft.copy=function(){var n=new ic(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=Lc(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Lc(r));return n};Ft.add=rv;Ft.addAll=nv;Ft.cover=iv;Ft.data=av;Ft.extent=ov;Ft.find=sv;Ft.remove=uv;Ft.removeAll=cv;Ft.root=lv;Ft.size=dv;Ft.visit=hv;Ft.visitAfter=fv;Ft.x=gv;Ft.y=vv;function qt(n){return function(){return n}}function pn(n){return(n()-.5)*1e-6}function mv(n){return n.x+n.vx}function bv(n){return n.y+n.vy}function wv(n){var e,t,r,i=1,a=1;typeof n!="function"&&(n=qt(n==null?1:+n));function s(){for(var h,y=e.length,v,w,E,D,k,I,P=0;P<a;++P)for(v=nc(e,mv,bv).visitAfter(c),h=0;h<y;++h)w=e[h],k=t[w.index],I=k*k,E=w.x+w.vx,D=w.y+w.vy,v.visit(C);function C(R,_,T,B,S){var z=R.data,G=R.r,F=k+G;if(z){if(z.index>w.index){var U=E-z.x-z.vx,V=D-z.y-z.vy,j=U*U+V*V;j<F*F&&(U===0&&(U=pn(r),j+=U*U),V===0&&(V=pn(r),j+=V*V),j=(F-(j=Math.sqrt(j)))/j*i,w.vx+=(U*=j)*(F=(G*=G)/(I+G)),w.vy+=(V*=j)*F,z.vx-=U*(F=1-F),z.vy-=V*F)}return}return _>E+F||B<E-F||T>D+F||S<D-F}}function c(h){if(h.data)return h.r=t[h.data.index];for(var y=h.r=0;y<4;++y)h[y]&&h[y].r>h.r&&(h.r=h[y].r)}function f(){if(e){var h,y=e.length,v;for(t=new Array(y),h=0;h<y;++h)v=e[h],t[v.index]=+n(v,h,e)}}return s.initialize=function(h,y){e=h,r=y,f()},s.iterations=function(h){return arguments.length?(a=+h,s):a},s.strength=function(h){return arguments.length?(i=+h,s):i},s.radius=function(h){return arguments.length?(n=typeof h=="function"?h:qt(+h),f(),s):n},s}function Ev(n){return n.index}function zc(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function xv(n){var e=Ev,t=v,r,i=qt(30),a,s,c,f,h,y=1;n==null&&(n=[]);function v(I){return 1/Math.min(c[I.source.index],c[I.target.index])}function w(I){for(var P=0,C=n.length;P<y;++P)for(var R=0,_,T,B,S,z,G,F;R<C;++R)_=n[R],T=_.source,B=_.target,S=B.x+B.vx-T.x-T.vx||pn(h),z=B.y+B.vy-T.y-T.vy||pn(h),G=Math.sqrt(S*S+z*z),G=(G-a[R])/G*I*r[R],S*=G,z*=G,B.vx-=S*(F=f[R]),B.vy-=z*F,T.vx+=S*(F=1-F),T.vy+=z*F}function E(){if(s){var I,P=s.length,C=n.length,R=new Map(s.map((T,B)=>[e(T,B,s),T])),_;for(I=0,c=new Array(P);I<C;++I)_=n[I],_.index=I,typeof _.source!="object"&&(_.source=zc(R,_.source)),typeof _.target!="object"&&(_.target=zc(R,_.target)),c[_.source.index]=(c[_.source.index]||0)+1,c[_.target.index]=(c[_.target.index]||0)+1;for(I=0,f=new Array(C);I<C;++I)_=n[I],f[I]=c[_.source.index]/(c[_.source.index]+c[_.target.index]);r=new Array(C),D(),a=new Array(C),k()}}function D(){if(s)for(var I=0,P=n.length;I<P;++I)r[I]=+t(n[I],I,n)}function k(){if(s)for(var I=0,P=n.length;I<P;++I)a[I]=+i(n[I],I,n)}return w.initialize=function(I,P){s=I,h=P,E()},w.links=function(I){return arguments.length?(n=I,E(),w):n},w.id=function(I){return arguments.length?(e=I,w):e},w.iterations=function(I){return arguments.length?(y=+I,w):y},w.strength=function(I){return arguments.length?(t=typeof I=="function"?I:qt(+I),D(),w):t},w.distance=function(I){return arguments.length?(i=typeof I=="function"?I:qt(+I),k(),w):i},w}const _v=1664525,Sv=1013904223,$c=4294967296;function Av(){let n=1;return()=>(n=(_v*n+Sv)%$c)/$c}function kv(n){return n.x}function Dv(n){return n.y}var Cv=10,Iv=Math.PI*(3-Math.sqrt(5));function Mv(n){var e,t=1,r=.001,i=1-Math.pow(r,1/300),a=0,s=.6,c=new Map,f=ec(v),h=bo("tick","end"),y=Av();n==null&&(n=[]);function v(){w(),h.call("tick",e),t<r&&(f.stop(),h.call("end",e))}function w(k){var I,P=n.length,C;k===void 0&&(k=1);for(var R=0;R<k;++R)for(t+=(a-t)*i,c.forEach(function(_){_(t)}),I=0;I<P;++I)C=n[I],C.fx==null?C.x+=C.vx*=s:(C.x=C.fx,C.vx=0),C.fy==null?C.y+=C.vy*=s:(C.y=C.fy,C.vy=0);return e}function E(){for(var k=0,I=n.length,P;k<I;++k){if(P=n[k],P.index=k,P.fx!=null&&(P.x=P.fx),P.fy!=null&&(P.y=P.fy),isNaN(P.x)||isNaN(P.y)){var C=Cv*Math.sqrt(.5+k),R=k*Iv;P.x=C*Math.cos(R),P.y=C*Math.sin(R)}(isNaN(P.vx)||isNaN(P.vy))&&(P.vx=P.vy=0)}}function D(k){return k.initialize&&k.initialize(n,y),k}return E(),e={tick:w,restart:function(){return f.restart(v),e},stop:function(){return f.stop(),e},nodes:function(k){return arguments.length?(n=k,E(),c.forEach(D),e):n},alpha:function(k){return arguments.length?(t=+k,e):t},alphaMin:function(k){return arguments.length?(r=+k,e):r},alphaDecay:function(k){return arguments.length?(i=+k,e):+i},alphaTarget:function(k){return arguments.length?(a=+k,e):a},velocityDecay:function(k){return arguments.length?(s=1-k,e):1-s},randomSource:function(k){return arguments.length?(y=k,c.forEach(D),e):y},force:function(k,I){return arguments.length>1?(I==null?c.delete(k):c.set(k,D(I)),e):c.get(k)},find:function(k,I,P){var C=0,R=n.length,_,T,B,S,z;for(P==null?P=1/0:P*=P,C=0;C<R;++C)S=n[C],_=k-S.x,T=I-S.y,B=_*_+T*T,B<P&&(z=S,P=B);return z},on:function(k,I){return arguments.length>1?(h.on(k,I),e):h.on(k)}}}function Nv(){var n,e,t,r,i=qt(-30),a,s=1,c=1/0,f=.81;function h(E){var D,k=n.length,I=nc(n,kv,Dv).visitAfter(v);for(r=E,D=0;D<k;++D)e=n[D],I.visit(w)}function y(){if(n){var E,D=n.length,k;for(a=new Array(D),E=0;E<D;++E)k=n[E],a[k.index]=+i(k,E,n)}}function v(E){var D=0,k,I,P=0,C,R,_;if(E.length){for(C=R=_=0;_<4;++_)(k=E[_])&&(I=Math.abs(k.value))&&(D+=k.value,P+=I,C+=I*k.x,R+=I*k.y);E.x=C/P,E.y=R/P}else{k=E,k.x=k.data.x,k.y=k.data.y;do D+=a[k.data.index];while(k=k.next)}E.value=D}function w(E,D,k,I){if(!E.value)return!0;var P=E.x-e.x,C=E.y-e.y,R=I-D,_=P*P+C*C;if(R*R/f<_)return _<c&&(P===0&&(P=pn(t),_+=P*P),C===0&&(C=pn(t),_+=C*C),_<s&&(_=Math.sqrt(s*_)),e.vx+=P*E.value*r/_,e.vy+=C*E.value*r/_),!0;if(E.length||_>=c)return;(E.data!==e||E.next)&&(P===0&&(P=pn(t),_+=P*P),C===0&&(C=pn(t),_+=C*C),_<s&&(_=Math.sqrt(s*_)));do E.data!==e&&(R=a[E.data.index]*r/_,e.vx+=P*R,e.vy+=C*R);while(E=E.next)}return h.initialize=function(E,D){n=E,t=D,y()},h.strength=function(E){return arguments.length?(i=typeof E=="function"?E:qt(+E),y(),h):i},h.distanceMin=function(E){return arguments.length?(s=E*E,h):Math.sqrt(s)},h.distanceMax=function(E){return arguments.length?(c=E*E,h):Math.sqrt(c)},h.theta=function(E){return arguments.length?(f=E*E,h):Math.sqrt(f)},h}function Pv(n){var e=qt(.1),t,r,i;typeof n!="function"&&(n=qt(n==null?0:+n));function a(c){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vx+=(i[f]-y.x)*r[f]*c}function s(){if(t){var c,f=t.length;for(r=new Array(f),i=new Array(f),c=0;c<f;++c)r[c]=isNaN(i[c]=+n(t[c],c,t))?0:+e(t[c],c,t)}}return a.initialize=function(c){t=c,s()},a.strength=function(c){return arguments.length?(e=typeof c=="function"?c:qt(+c),s(),a):e},a.x=function(c){return arguments.length?(n=typeof c=="function"?c:qt(+c),s(),a):n},a}function Ov(n){var e=qt(.1),t,r,i;typeof n!="function"&&(n=qt(n==null?0:+n));function a(c){for(var f=0,h=t.length,y;f<h;++f)y=t[f],y.vy+=(i[f]-y.y)*r[f]*c}function s(){if(t){var c,f=t.length;for(r=new Array(f),i=new Array(f),c=0;c<f;++c)r[c]=isNaN(i[c]=+n(t[c],c,t))?0:+e(t[c],c,t)}}return a.initialize=function(c){t=c,s()},a.strength=function(c){return arguments.length?(e=typeof c=="function"?c:qt(+c),s(),a):e},a.y=function(c){return arguments.length?(n=typeof c=="function"?c:qt(+c),s(),a):n},a}function na(n,e,t){this.k=n,this.x=e,this.y=t}na.prototype={constructor:na,scale:function(n){return n===1?this:new na(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new na(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};na.prototype;const Tv={listeners:new Map,emit(n,e={}){document.dispatchEvent(new CustomEvent(n,{detail:e}))},on(n,e){if(typeof e!="function"){console.warn(`EventBus: Tried to register a non-function listener for event: ${n}`);return}this.listeners.has(n)||this.listeners.set(n,new Set);const t=this.listeners.get(n);if(t.has(e)){console.warn(`EventBus: Listener for event "${n}" is already registered.`);return}document.addEventListener(n,e),t.add(e)},off(n,e){if(!this.listeners.has(n)){console.warn(`EventBus: Attempted to remove a listener from a non-existent event: ${n}`);return}const t=this.listeners.get(n);if(!t.has(e)){console.warn(`EventBus: Attempted to remove a non-existent listener from event: ${n}`);return}document.removeEventListener(n,e),t.delete(e),t.size===0&&this.listeners.delete(n)},removeAll(n){if(!this.listeners.has(n)){console.warn(`EventBus: Attempted to remove all listeners from a non-existent event: ${n}`);return}this.listeners.get(n).forEach(e=>{document.removeEventListener(n,e)}),this.listeners.delete(n)}};function Fo(n){const e=new Set(n.map(Number));let t=0;for(;e.has(t);)t++;return t}function aa(n,e=3){const t="abcdefghijklmnopqrstuvwxyz",r=[];function i(s,c,f){if(f===0){r.push(s);return}for(let h=c;h<t.length;h++)if(i(s+t[h],h+1,f-1),r.length>n)return}let a=1;for(;r.length<=n&&a<=e;)i("",0,a),a++;return r[n]||null}function Rv(n,e,t,r,i,a){let s=n-t,c=e-r,f=i-t,h=a-r,y=s*f+c*h,v=f*f+h*h,w=v!==0?y/v:-1,E,D;w<0?(E=t,D=r):w>1?(E=i,D=a):(E=t+w*f,D=r+w*h);let k=n-E,I=e-D;return Math.sqrt(k*k+I*I)}function Ba(n,e){return(n%e+e)%e}function jo(n,e){n=n.replace(/^#/,""),(n.length===3||n.length===4)&&(n=n.split("").map(r=>r+r).join("")),n.length===8&&(n=n.slice(0,6));const t=Math.round(Math.min(Math.max(e,0),1)*255).toString(16).padStart(2,"0");return`#${n}${t}`}class Lv{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.appSettings.settings,this._canvas={main:{canvas:$t("#main-canvas").node(),ctx:$t("#main-canvas").node().getContext("2d")},node:{canvas:$t("#node-canvas").node(),ctx:$t("#node-canvas").node().getContext("2d")},edge:{canvas:$t("#edge-canvas").node(),ctx:$t("#edge-canvas").node().getContext("2d")},face:{canvas:$t("#face-canvas").node(),ctx:$t("#face-canvas").node().getContext("2d")}},this.canvas=$t("#main-canvas").node(),this.ctx=this.canvas.getContext("2d"),this.mouse={x:0,y:0,dragging:!1}}init(){this.updateCanvasSize(window.innerWidth,window.innerHeight),this.canvas.addEventListener("dblclick",this.handleDbclick.bind(this)),this.canvas.addEventListener("click",this.handleClick.bind(this));let e=0;this.canvas.addEventListener("touchend",t=>{const r=new Date().getTime(),i=r-e;i<300&&i>0&&this.handleDbclick(t),e=r}),$t("#main-canvas").on("mousedown",t=>{this.mouse.dragging=!1,[this.mouse.x,this.mouse.y]=nr(t)}).on("mousemove",t=>{const[r,i]=nr(t);(Math.abs(r-this.mouse.x)>2||Math.abs(i-this.mouse.y)>2)&&(this.mouse.dragging=!0)}).on("mouseup",t=>{this.mouse.dragging||([this.mouse.x,this.mouse.y]=nr(t))}),$t(this.canvas).call(wg().container(this.canvas).subject(this.dragsubject.bind(this)).filter(t=>!(this.settings.scale||this.settings.select)).on("start",this.dragstarted.bind(this)).on("drag",this.dragged.bind(this)).on("end",this.dragended.bind(this)))}updateCanvasSize(e,t){for(const r in this._canvas)this._canvas[r].canvas.width=e,this._canvas[r].canvas.height=t;this.app.graphManager.redraw()}addNodeAtEvent(e){e.preventDefault();const[t,r]=e.type=="touchend"?Gc(e,this.canvas):nr(e,this.canvas),i=[...new Set(this.app.graphManager.graphs.all.flatMap(c=>c.nodes()))],a=Fo(i),s=aa(a);this.app.graphManager.addNode(a,{x:t,y:r,color:this.settings.node_color,label:s})}addNodeConnectedToNode(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(s=>s.nodes()))],r=Fo(t),i=aa(r),a={x:e.x+30,y:e.y+30,color:this.settings.node_color,label:i};this.app.graphManager.addNode(r,a),this.app.graphManager.graph.addEdge(e.id,r),this.app.graphManager.saveGraphState("tree-node")}dragsubject(e){let t={id:null},r=1/0;return this.app.nodes.forEach(i=>{const a=e.x-i.x,s=e.y-i.y,c=Math.sqrt(a*a+s*s);c<this.settings.node_radius*i.size&&c<r&&(r=c,t=i)}),t&&(this.settings.component?t.component=this.app.graphManager.metric.getComponent(t.id):t.component=this.app.graphManager.graph.getSelectedNodes()),this.settings.panning&&(t.component=this.app.graphManager.graph.nodes()),t}dragstarted(e){e.subject.fx=e.subject.x,e.subject.fy=e.subject.y,e.subject.__moved=!1,e.subject.id!==null&&(this.app.graphManager.update=!0,this.canvas.style.cursor="grab",!e.active&&this.settings.forceSimulation&&this.app.simulation.alphaTarget(.5).restart())}dragged(e){if(e.subject.fx=e.x,e.subject.fy=e.y,(e.dx!==0||e.dy!==0)&&(e.subject.__moved=!0),!this.settings.forceSimulation&&e.subject.component){for(let t of e.subject.component)this.app.graphManager.graph.updateNodeAttributes(t,r=>({...r,x:r.x+e.dx,y:r.y+e.dy})),this.settings.performance?this.app.graphManager.needsRedraw={node:!0,edge:!1,face:!1}:this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0};e.subject.id!==null&&(this.canvas.style.cursor="grabbing",this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y})),this.settings.performance?this.app.graphManager.needsRedraw={node:!0,edge:!1,face:!1}:this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0})}}dragended(e){e.active||this.app.simulation.alphaTarget(0),e.subject.fx=null,e.subject.fy=null,e.subject.x=e.x,e.subject.y=e.y,this.canvas.style.cursor="default",this.settings.forceSimulation||this.app.updateSimulation(),e.subject.__moved&&e.subject.id!==null&&!this.settings.forceSimulation&&this.app.graphManager.graph.updateNodeAttributes(e.subject.id,t=>({...t,x:e.x,y:e.y})),(e.subject.component&&e.subject.component.length||e.subject.id!==null)&&(this.settings.forceSimulation||this.app.graphManager.saveGraphState("update-position"))}findClickedNode(e,t){return this.app.nodes.find(r=>{let i=e-r.x,a=t-r.y;return Math.sqrt(i*i+a*a)<this.settings.node_radius*r.size})}findClickedEdge(e,t){let r=10;return this.app.links.find(i=>{let a=i.source,s=i.target;return Rv(e,t,a.x,a.y,s.x,s.y)<r})}insertNodeInEdge(e){const t=[...new Set(this.app.graphManager.graphs.all.flatMap(c=>c.nodes()))],r=Fo(t),i=aa(r);let a=(e.source.x+e.target.x)/2,s=(e.source.y+e.target.y)/2;this.app.graphManager.graph.addNode(r,{x:a,y:s,color:this.settings.color,label:i}),this.app.graphManager.graph.dropEdge(e.source.id,e.target.id),this.app.graphManager.graph.addEdge(e.source.id,r),this.app.graphManager.graph.addEdge(r,e.target.id),this.app.graphManager.saveGraphState("tree-edge")}handleDbclick(e){const[t,r]=e.type=="touchend"?Gc(e,this.canvas):nr(e,this.canvas);let i=this.findClickedNode(t,r),a=this.findClickedEdge(t,r);i?this.settings.tree?this.addNodeConnectedToNode(i):this.app.graphManager.graph.toggleNodeSelection(i.id):a?this.settings.tree?this.insertNodeInEdge(a):this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s)}):this.addNodeAtEvent(e)}handleClick(e){if(this.mouse.dragging)return;let[t,r]=nr(e,this.canvas),i=this.findClickedNode(t,r),a=this.findClickedEdge(t,r);i?this.settings.select?this.app.graphManager.graph.toggleNodeSelection(i.id):(this.app.graphManager.metric.addNEFGInfo(i),this.settings.colorPicker&&(this.app.colorPicker.setColor("node",i.color),this.app.colorPicker.setColor("stroke",i.stroke),this.app.colorPicker.setColor("label",i.labelColor))):a?this.settings.select?this.app.graphManager.graph.findEdge(a.source.id,a.target.id,s=>{this.app.graphManager.graph.toggleEdgeSelection(s)}):(this.app.graphManager.metric.addNEFGInfo(a),this.settings.colorPicker&&(this.app.colorPicker.setColor("edge",a.color),this.app.colorPicker.setColor("label",a.labelColor))):(this.app.graphManager.deselectAll(),this.app.rect.scale.active=!1)}}function Gc(n,e){const t=n.changedTouches[0],r=e.getBoundingClientRect();return[t.clientX-r.left,t.clientY-r.top]}var zv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pt(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Ua={exports:{}},qc;function $v(){if(qc)return Ua.exports;qc=1;var n=typeof Reflect=="object"?Reflect:null,e=n&&typeof n.apply=="function"?n.apply:function(T,B,S){return Function.prototype.apply.call(T,B,S)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(T){return Object.getOwnPropertyNames(T).concat(Object.getOwnPropertySymbols(T))}:t=function(T){return Object.getOwnPropertyNames(T)};function r(_){console&&console.warn&&console.warn(_)}var i=Number.isNaN||function(T){return T!==T};function a(){a.init.call(this)}Ua.exports=a,Ua.exports.once=P,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function c(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(_){if(typeof _!="number"||_<0||i(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");s=_}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(T){if(typeof T!="number"||T<0||i(T))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+T+".");return this._maxListeners=T,this};function f(_){return _._maxListeners===void 0?a.defaultMaxListeners:_._maxListeners}a.prototype.getMaxListeners=function(){return f(this)},a.prototype.emit=function(T){for(var B=[],S=1;S<arguments.length;S++)B.push(arguments[S]);var z=T==="error",G=this._events;if(G!==void 0)z=z&&G.error===void 0;else if(!z)return!1;if(z){var F;if(B.length>0&&(F=B[0]),F instanceof Error)throw F;var U=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw U.context=F,U}var V=G[T];if(V===void 0)return!1;if(typeof V=="function")e(V,this,B);else for(var j=V.length,ye=D(V,j),S=0;S<j;++S)e(ye[S],this,B);return!0};function h(_,T,B,S){var z,G,F;if(c(B),G=_._events,G===void 0?(G=_._events=Object.create(null),_._eventsCount=0):(G.newListener!==void 0&&(_.emit("newListener",T,B.listener?B.listener:B),G=_._events),F=G[T]),F===void 0)F=G[T]=B,++_._eventsCount;else if(typeof F=="function"?F=G[T]=S?[B,F]:[F,B]:S?F.unshift(B):F.push(B),z=f(_),z>0&&F.length>z&&!F.warned){F.warned=!0;var U=new Error("Possible EventEmitter memory leak detected. "+F.length+" "+String(T)+" listeners added. Use emitter.setMaxListeners() to increase limit");U.name="MaxListenersExceededWarning",U.emitter=_,U.type=T,U.count=F.length,r(U)}return _}a.prototype.addListener=function(T,B){return h(this,T,B,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(T,B){return h(this,T,B,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v(_,T,B){var S={fired:!1,wrapFn:void 0,target:_,type:T,listener:B},z=y.bind(S);return z.listener=B,S.wrapFn=z,z}a.prototype.once=function(T,B){return c(B),this.on(T,v(this,T,B)),this},a.prototype.prependOnceListener=function(T,B){return c(B),this.prependListener(T,v(this,T,B)),this},a.prototype.removeListener=function(T,B){var S,z,G,F,U;if(c(B),z=this._events,z===void 0)return this;if(S=z[T],S===void 0)return this;if(S===B||S.listener===B)--this._eventsCount===0?this._events=Object.create(null):(delete z[T],z.removeListener&&this.emit("removeListener",T,S.listener||B));else if(typeof S!="function"){for(G=-1,F=S.length-1;F>=0;F--)if(S[F]===B||S[F].listener===B){U=S[F].listener,G=F;break}if(G<0)return this;G===0?S.shift():k(S,G),S.length===1&&(z[T]=S[0]),z.removeListener!==void 0&&this.emit("removeListener",T,U||B)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(T){var B,S,z;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[T]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[T]),this;if(arguments.length===0){var G=Object.keys(S),F;for(z=0;z<G.length;++z)F=G[z],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(B=S[T],typeof B=="function")this.removeListener(T,B);else if(B!==void 0)for(z=B.length-1;z>=0;z--)this.removeListener(T,B[z]);return this};function w(_,T,B){var S=_._events;if(S===void 0)return[];var z=S[T];return z===void 0?[]:typeof z=="function"?B?[z.listener||z]:[z]:B?I(z):D(z,z.length)}a.prototype.listeners=function(T){return w(this,T,!0)},a.prototype.rawListeners=function(T){return w(this,T,!1)},a.listenerCount=function(_,T){return typeof _.listenerCount=="function"?_.listenerCount(T):E.call(_,T)},a.prototype.listenerCount=E;function E(_){var T=this._events;if(T!==void 0){var B=T[_];if(typeof B=="function")return 1;if(B!==void 0)return B.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function D(_,T){for(var B=new Array(T),S=0;S<T;++S)B[S]=_[S];return B}function k(_,T){for(;T+1<_.length;T++)_[T]=_[T+1];_.pop()}function I(_){for(var T=new Array(_.length),B=0;B<T.length;++B)T[B]=_[B].listener||_[B];return T}function P(_,T){return new Promise(function(B,S){function z(F){_.removeListener(T,G),S(F)}function G(){typeof _.removeListener=="function"&&_.removeListener("error",z),B([].slice.call(arguments))}R(_,T,G,{once:!0}),T!=="error"&&C(_,z,{once:!0})})}function C(_,T,B){typeof _.on=="function"&&R(_,"error",T,B)}function R(_,T,B,S){if(typeof _.on=="function")S.once?_.once(T,B):_.on(T,B);else if(typeof _.addEventListener=="function")_.addEventListener(T,function z(G){S.once&&_.removeEventListener(T,z),B(G)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return Ua.exports}var Gv=$v(),Bo,Fc;function jn(){if(Fc)return Bo;Fc=1;function n(e){if(typeof e!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=e}return typeof Symbol<"u"&&(n.prototype[Symbol.iterator]=function(){return this}),n.of=function(){var e=arguments,t=e.length,r=0;return new n(function(){return r>=t?{done:!0}:{done:!1,value:e[r++]}})},n.empty=function(){var e=new n(function(){return{done:!0}});return e},n.fromSequence=function(e){var t=0,r=e.length;return new n(function(){return t>=r?{done:!0}:{done:!1,value:e[t++]}})},n.is=function(e){return e instanceof n?!0:typeof e=="object"&&e!==null&&typeof e.next=="function"},Bo=n,Bo}var qv=jn();const ar=Pt(qv);var Ka={},jc;function Zh(){return jc||(jc=1,Ka.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u",Ka.SYMBOL_SUPPORT=typeof Symbol<"u"),Ka}var Uo,Bc;function Jh(){if(Bc)return Uo;Bc=1;var n=jn(),e=Zh(),t=e.ARRAY_BUFFER_SUPPORT,r=e.SYMBOL_SUPPORT;function i(a){return typeof a=="string"||Array.isArray(a)||t&&ArrayBuffer.isView(a)?n.fromSequence(a):typeof a!="object"||a===null?null:r&&typeof a[Symbol.iterator]=="function"?a[Symbol.iterator]():typeof a.next=="function"?a:null}return Uo=function(s){var c=i(s);if(!c)throw new Error("obliterator: target is not iterable nor a valid iterator.");return c},Uo}var Ko,Uc;function Fv(){if(Uc)return Ko;Uc=1;var n=Jh();return Ko=function(t,r){for(var i=arguments.length>1?r:1/0,a=i!==1/0?new Array(i):[],s,c=0,f=n(t);;){if(c===i)return a;if(s=f.next(),s.done)return c!==r&&(a.length=c),a;a[c++]=s.value}},Ko}var jv=Fv();const ef=Pt(jv);var Wo,Kc;function Bv(){if(Kc)return Wo;Kc=1;var n=jn(),e=Jh();return Wo=function(){var r=arguments,i=null,a=-1;return new n(function(){var c=null;do{if(i===null){if(a++,a>=r.length)return{done:!0};i=e(r[a])}if(c=i.next(),c.done===!0){i=null;continue}break}while(!0);return c})},Wo}var Uv=Bv();const Xr=Pt(Uv);function Kv(){const n=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const r in arguments[e])n[r]=arguments[e][r];return n}let pt=Kv;typeof Object.assign=="function"&&(pt=Object.assign);function ir(n,e,t,r){const i=n._nodes.get(e);let a=null;return i&&(r==="mixed"?a=i.out&&i.out[t]||i.undirected&&i.undirected[t]:r==="directed"?a=i.out&&i.out[t]:a=i.undirected&&i.undirected[t]),a}function wt(n){return typeof n=="object"&&n!==null}function tf(n){let e;for(e in n)return!1;return!0}function er(n,e,t){Object.defineProperty(n,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function yr(n,e,t){const r={enumerable:!0,configurable:!0};typeof t=="function"?r.get=t:(r.value=t,r.writable=!1),Object.defineProperty(n,e,r)}function Wc(n){return!(!wt(n)||n.attributes&&!Array.isArray(n.attributes))}function Wv(){let n=Math.floor(Math.random()*256)&255;return()=>n++}class ac extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}let Pe=class rf extends ac{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,rf.prototype.constructor)}};class Ae extends ac{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ae.prototype.constructor)}}class je extends ac{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,je.prototype.constructor)}}function nf(n,e){this.key=n,this.attributes=e,this.clear()}nf.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function af(n,e){this.key=n,this.attributes=e,this.clear()}af.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function of(n,e){this.key=n,this.attributes=e,this.clear()}of.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function _i(n,e,t,r,i){this.key=e,this.attributes=i,this.undirected=n,this.source=t,this.target=r}_i.prototype.attach=function(){let n="out",e="in";this.undirected&&(n=e="undirected");const t=this.source.key,r=this.target.key;this.source[n][r]=this,!(this.undirected&&t===r)&&(this.target[e][t]=this)};_i.prototype.attachMulti=function(){let n="out",e="in";const t=this.source.key,r=this.target.key;this.undirected&&(n=e="undirected");const i=this.source[n],a=i[r];if(typeof a>"u"){i[r]=this,this.undirected&&t===r||(this.target[e][t]=this);return}a.previous=this,this.next=a,i[r]=this,this.target[e][t]=this};_i.prototype.detach=function(){const n=this.source.key,e=this.target.key;let t="out",r="in";this.undirected&&(t=r="undirected"),delete this.source[t][e],delete this.target[r][n]};_i.prototype.detachMulti=function(){const n=this.source.key,e=this.target.key;let t="out",r="in";this.undirected&&(t=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[r][n]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[r][n]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const sf=0,uf=1,Hv=2,cf=3;function Qr(n,e,t,r,i,a,s){let c,f,h,y;if(r=""+r,t===sf){if(c=n._nodes.get(r),!c)throw new Ae(`Graph.${e}: could not find the "${r}" node in the graph.`);h=i,y=a}else if(t===cf){if(i=""+i,f=n._edges.get(i),!f)throw new Ae(`Graph.${e}: could not find the "${i}" edge in the graph.`);const v=f.source.key,w=f.target.key;if(r===v)c=f.target;else if(r===w)c=f.source;else throw new Ae(`Graph.${e}: the "${r}" node is not attached to the "${i}" edge (${v}, ${w}).`);h=a,y=s}else{if(f=n._edges.get(r),!f)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`);t===uf?c=f.source:c=f.target,h=i,y=a}return[c,h,y]}function Yv(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);return s.attributes[c]}}function Xv(n,e,t){n.prototype[e]=function(r,i){const[a]=Qr(this,e,t,r,i);return a.attributes}}function Vv(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);return s.attributes.hasOwnProperty(c)}}function Qv(n,e,t){n.prototype[e]=function(r,i,a,s){const[c,f,h]=Qr(this,e,t,r,i,a,s);return c.attributes[f]=h,this.emit("nodeAttributesUpdated",{key:c.key,type:"set",attributes:c.attributes,name:f}),this}}function Zv(n,e,t){n.prototype[e]=function(r,i,a,s){const[c,f,h]=Qr(this,e,t,r,i,a,s);if(typeof h!="function")throw new Pe(`Graph.${e}: updater should be a function.`);const y=c.attributes,v=h(y[f]);return y[f]=v,this.emit("nodeAttributesUpdated",{key:c.key,type:"set",attributes:c.attributes,name:f}),this}}function Jv(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);return delete s.attributes[c],this.emit("nodeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:c}),this}}function em(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);if(!wt(c))throw new Pe(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=c,this.emit("nodeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function tm(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);if(!wt(c))throw new Pe(`Graph.${e}: provided attributes are not a plain object.`);return pt(s.attributes,c),this.emit("nodeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:c}),this}}function rm(n,e,t){n.prototype[e]=function(r,i,a){const[s,c]=Qr(this,e,t,r,i,a);if(typeof c!="function")throw new Pe(`Graph.${e}: provided updater is not a function.`);return s.attributes=c(s.attributes),this.emit("nodeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const nm=[{name:n=>`get${n}Attribute`,attacher:Yv},{name:n=>`get${n}Attributes`,attacher:Xv},{name:n=>`has${n}Attribute`,attacher:Vv},{name:n=>`set${n}Attribute`,attacher:Qv},{name:n=>`update${n}Attribute`,attacher:Zv},{name:n=>`remove${n}Attribute`,attacher:Jv},{name:n=>`replace${n}Attributes`,attacher:em},{name:n=>`merge${n}Attributes`,attacher:tm},{name:n=>`update${n}Attributes`,attacher:rm}];function im(n){nm.forEach(function({name:e,attacher:t}){t(n,e("Node"),sf),t(n,e("Source"),uf),t(n,e("Target"),Hv),t(n,e("Opposite"),cf)})}function am(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes[i]}}function om(n,e,t){n.prototype[e]=function(r){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,s=""+arguments[1];if(i=ir(this,a,s,t),!i)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function sm(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return a.attributes.hasOwnProperty(i)}}function um(n,e,t){n.prototype[e]=function(r,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const c=""+r,f=""+i;if(i=arguments[2],a=arguments[3],s=ir(this,c,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${c}" - "${f}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes[i]=a,this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function cm(n,e,t){n.prototype[e]=function(r,i,a){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const c=""+r,f=""+i;if(i=arguments[2],a=arguments[3],s=ir(this,c,f,t),!s)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${c}" - "${f}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof a!="function")throw new Pe(`Graph.${e}: updater should be a function.`);return s.attributes[i]=a(s.attributes[i]),this.emit("edgeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:i}),this}}function lm(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete a.attributes[i],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:i}),this}}function dm(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!wt(i))throw new Pe(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=i,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function hm(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!wt(i))throw new Pe(`Graph.${e}: provided attributes are not a plain object.`);return pt(a.attributes,i),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:i}),this}}function fm(n,e,t){n.prototype[e]=function(r,i){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new je(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new je(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,c=""+i;if(i=arguments[2],a=ir(this,s,c,t),!a)throw new Ae(`Graph.${e}: could not find an edge for the given path ("${s}" - "${c}").`)}else{if(t!=="mixed")throw new je(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,a=this._edges.get(r),!a)throw new Ae(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new Pe(`Graph.${e}: provided updater is not a function.`);return a.attributes=i(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const pm=[{name:n=>`get${n}Attribute`,attacher:am},{name:n=>`get${n}Attributes`,attacher:om},{name:n=>`has${n}Attribute`,attacher:sm},{name:n=>`set${n}Attribute`,attacher:um},{name:n=>`update${n}Attribute`,attacher:cm},{name:n=>`remove${n}Attribute`,attacher:lm},{name:n=>`replace${n}Attributes`,attacher:dm},{name:n=>`merge${n}Attributes`,attacher:hm},{name:n=>`update${n}Attributes`,attacher:fm}];function gm(n){pm.forEach(function({name:e,attacher:t}){t(n,e("Edge"),"mixed"),t(n,e("DirectedEdge"),"directed"),t(n,e("UndirectedEdge"),"undirected")})}const ym=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function vm(n,e,t,r){let i=!1;for(const a in e){if(a===r)continue;const s=e[a];if(i=t(s.key,s.attributes,s.source.key,s.target.key,s.source.attributes,s.target.attributes,s.undirected),n&&i)return s.key}}function mm(n,e,t,r){let i,a,s,c=!1;for(const f in e)if(f!==r){i=e[f];do{if(a=i.source,s=i.target,c=t(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected),n&&c)return i.key;i=i.next}while(i!==void 0)}}function Ho(n,e){const t=Object.keys(n),r=t.length;let i,a=0;return new ar(function(){do if(i)i=i.next;else{if(a>=r)return{done:!0};const c=t[a++];if(c===e){i=void 0;continue}i=n[c]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function bm(n,e,t,r){const i=e[t];if(!i)return;const a=i.source,s=i.target;if(r(i.key,i.attributes,a.key,s.key,a.attributes,s.attributes,i.undirected)&&n)return i.key}function wm(n,e,t,r){let i=e[t];if(!i)return;let a=!1;do{if(a=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),n&&a)return i.key;i=i.next}while(i!==void 0)}function Yo(n,e){let t=n[e];return t.next!==void 0?new ar(function(){if(!t)return{done:!0};const r={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:r}}):ar.of({edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected})}function Em(n,e){if(n.size===0)return[];if(e==="mixed"||e===n.type)return typeof Array.from=="function"?Array.from(n._edges.keys()):ef(n._edges.keys(),n._edges.size);const t=e==="undirected"?n.undirectedSize:n.directedSize,r=new Array(t),i=e==="undirected",a=n._edges.values();let s=0,c,f;for(;c=a.next(),c.done!==!0;)f=c.value,f.undirected===i&&(r[s++]=f.key);return r}function lf(n,e,t,r){if(e.size===0)return;const i=t!=="mixed"&&t!==e.type,a=t==="undirected";let s,c,f=!1;const h=e._edges.values();for(;s=h.next(),s.done!==!0;){if(c=s.value,i&&c.undirected!==a)continue;const{key:y,attributes:v,source:w,target:E}=c;if(f=r(y,v,w.key,E.key,w.attributes,E.attributes,c.undirected),n&&f)return y}}function xm(n,e){if(n.size===0)return ar.empty();const t=e!=="mixed"&&e!==n.type,r=e==="undirected",i=n._edges.values();return new ar(function(){let s,c;for(;;){if(s=i.next(),s.done)return s;if(c=s.value,!(t&&c.undirected!==r))break}return{value:{edge:c.key,attributes:c.attributes,source:c.source.key,target:c.target.key,sourceAttributes:c.source.attributes,targetAttributes:c.target.attributes,undirected:c.undirected},done:!1}})}function oc(n,e,t,r,i,a){const s=e?mm:vm;let c;if(t!=="undirected"&&(r!=="out"&&(c=s(n,i.in,a),n&&c)||r!=="in"&&(c=s(n,i.out,a,r?void 0:i.key),n&&c))||t!=="directed"&&(c=s(n,i.undirected,a),n&&c))return c}function _m(n,e,t,r){const i=[];return oc(!1,n,e,t,r,function(a){i.push(a)}),i}function Sm(n,e,t){let r=ar.empty();return n!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(r=Xr(r,Ho(t.in))),e!=="in"&&typeof t.out<"u"&&(r=Xr(r,Ho(t.out,e?void 0:t.key)))),n!=="directed"&&typeof t.undirected<"u"&&(r=Xr(r,Ho(t.undirected))),r}function sc(n,e,t,r,i,a,s){const c=t?wm:bm;let f;if(e!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(f=c(n,i.in,a,s),n&&f)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==a)&&(f=c(n,i.out,a,s),n&&f))||e!=="directed"&&typeof i.undirected<"u"&&(f=c(n,i.undirected,a,s),n&&f))return f}function Am(n,e,t,r,i){const a=[];return sc(!1,n,e,t,r,i,function(s){a.push(s)}),a}function km(n,e,t,r){let i=ar.empty();return n!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&r in t.in&&(i=Xr(i,Yo(t.in,r))),typeof t.out<"u"&&e!=="in"&&r in t.out&&(e||t.key!==r)&&(i=Xr(i,Yo(t.out,r)))),n!=="directed"&&typeof t.undirected<"u"&&r in t.undirected&&(i=Xr(i,Yo(t.undirected,r))),i}function Dm(n,e){const{name:t,type:r,direction:i}=e;n.prototype[t]=function(a,s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return Em(this,r);if(arguments.length===1){a=""+a;const c=this._nodes.get(a);if(typeof c>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return _m(this.multi,r==="mixed"?this.type:r,i,c)}if(arguments.length===2){a=""+a,s=""+s;const c=this._nodes.get(a);if(!c)throw new Ae(`Graph.${t}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new Ae(`Graph.${t}:  could not find the "${s}" target node in the graph.`);return Am(r,this.multi,i,c,s)}throw new Pe(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Cm(n,e){const{name:t,type:r,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[a]=function(h,y,v){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return v=h,lf(!1,this,r,v);if(arguments.length===2){h=""+h,v=y;const w=this._nodes.get(h);if(typeof w>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);return oc(!1,this.multi,r==="mixed"?this.type:r,i,w,v)}if(arguments.length===3){h=""+h,y=""+y;const w=this._nodes.get(h);if(!w)throw new Ae(`Graph.${a}:  could not find the "${h}" source node in the graph.`);if(!this._nodes.has(y))throw new Ae(`Graph.${a}:  could not find the "${y}" target node in the graph.`);return sc(!1,r,this.multi,i,w,y,v)}throw new Pe(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const s="map"+t[0].toUpperCase()+t.slice(1);n.prototype[s]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop();let v;if(h.length===0){let w=0;r!=="directed"&&(w+=this.undirectedSize),r!=="undirected"&&(w+=this.directedSize),v=new Array(w);let E=0;h.push((D,k,I,P,C,R,_)=>{v[E++]=y(D,k,I,P,C,R,_)})}else v=[],h.push((w,E,D,k,I,P,C)=>{v.push(y(w,E,D,k,I,P,C))});return this[a].apply(this,h),v};const c="filter"+t[0].toUpperCase()+t.slice(1);n.prototype[c]=function(){const h=Array.prototype.slice.call(arguments),y=h.pop(),v=[];return h.push((w,E,D,k,I,P,C)=>{y(w,E,D,k,I,P,C)&&v.push(w)}),this[a].apply(this,h),v};const f="reduce"+t[0].toUpperCase()+t.slice(1);n.prototype[f]=function(){let h=Array.prototype.slice.call(arguments);if(h.length<2||h.length>4)throw new Pe(`Graph.${f}: invalid number of arguments (expecting 2, 3 or 4 and got ${h.length}).`);if(typeof h[h.length-1]=="function"&&typeof h[h.length-2]!="function")throw new Pe(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let y,v;h.length===2?(y=h[0],v=h[1],h=[]):h.length===3?(y=h[1],v=h[2],h=[h[0]]):h.length===4&&(y=h[2],v=h[3],h=[h[0],h[1]]);let w=v;return h.push((E,D,k,I,P,C,R)=>{w=y(w,E,D,k,I,P,C,R)}),this[a].apply(this,h),w}}function Im(n,e){const{name:t,type:r,direction:i}=e,a="find"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[a]=function(f,h,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return y=f,lf(!0,this,r,y);if(arguments.length===2){f=""+f,y=h;const v=this._nodes.get(f);if(typeof v>"u")throw new Ae(`Graph.${a}: could not find the "${f}" node in the graph.`);return oc(!0,this.multi,r==="mixed"?this.type:r,i,v,y)}if(arguments.length===3){f=""+f,h=""+h;const v=this._nodes.get(f);if(!v)throw new Ae(`Graph.${a}:  could not find the "${f}" source node in the graph.`);if(!this._nodes.has(h))throw new Ae(`Graph.${a}:  could not find the "${h}" target node in the graph.`);return sc(!0,r,this.multi,i,v,h,y)}throw new Pe(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const s="some"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[s]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((v,w,E,D,k,I,P)=>h(v,w,E,D,k,I,P)),!!this[a].apply(this,f)};const c="every"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[c]=function(){const f=Array.prototype.slice.call(arguments),h=f.pop();return f.push((v,w,E,D,k,I,P)=>!h(v,w,E,D,k,I,P)),!this[a].apply(this,f)}}function Mm(n,e){const{name:t,type:r,direction:i}=e,a=t.slice(0,-1)+"Entries";n.prototype[a]=function(s,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return ar.empty();if(!arguments.length)return xm(this,r);if(arguments.length===1){s=""+s;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return Sm(r,i,f)}if(arguments.length===2){s=""+s,c=""+c;const f=this._nodes.get(s);if(!f)throw new Ae(`Graph.${a}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(c))throw new Ae(`Graph.${a}:  could not find the "${c}" target node in the graph.`);return km(r,i,f,c)}throw new Pe(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Nm(n){ym.forEach(e=>{Dm(n,e),Cm(n,e),Im(n,e),Mm(n,e)})}const Pm=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function _o(){this.A=null,this.B=null}_o.prototype.wrap=function(n){this.A===null?this.A=n:this.B===null&&(this.B=n)};_o.prototype.has=function(n){return this.A!==null&&n in this.A||this.B!==null&&n in this.B};function Hi(n,e,t,r,i){for(const a in r){const s=r[a],c=s.source,f=s.target,h=c===t?f:c;if(e&&e.has(h.key))continue;const y=i(h.key,h.attributes);if(n&&y)return h.key}}function uc(n,e,t,r,i){if(e!=="mixed"){if(e==="undirected")return Hi(n,null,r,r.undirected,i);if(typeof t=="string")return Hi(n,null,r,r[t],i)}const a=new _o;let s;if(e!=="undirected"){if(t!=="out"){if(s=Hi(n,null,r,r.in,i),n&&s)return s;a.wrap(r.in)}if(t!=="in"){if(s=Hi(n,a,r,r.out,i),n&&s)return s;a.wrap(r.out)}}if(e!=="directed"&&(s=Hi(n,a,r,r.undirected,i),n&&s))return s}function Om(n,e,t){if(n!=="mixed"){if(n==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const r=[];return uc(!1,n,e,t,function(i){r.push(i)}),r}function Yi(n,e,t){const r=Object.keys(t),i=r.length;let a=0;return new ar(function(){let c=null;do{if(a>=i)return n&&n.wrap(t),{done:!0};const f=t[r[a++]],h=f.source,y=f.target;if(c=h===e?y:h,n&&n.has(c.key)){c=null;continue}}while(c===null);return{done:!1,value:{neighbor:c.key,attributes:c.attributes}}})}function Tm(n,e,t){if(n!=="mixed"){if(n==="undirected")return Yi(null,t,t.undirected);if(typeof e=="string")return Yi(null,t,t[e])}let r=ar.empty();const i=new _o;return n!=="undirected"&&(e!=="out"&&(r=Xr(r,Yi(i,t,t.in))),e!=="in"&&(r=Xr(r,Yi(i,t,t.out)))),n!=="directed"&&(r=Xr(r,Yi(i,t,t.undirected))),r}function Rm(n,e){const{name:t,type:r,direction:i}=e;n.prototype[t]=function(a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new Ae(`Graph.${t}: could not find the "${a}" node in the graph.`);return Om(r==="mixed"?this.type:r,i,s)}}function Lm(n,e){const{name:t,type:r,direction:i}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[a]=function(h,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;h=""+h;const v=this._nodes.get(h);if(typeof v>"u")throw new Ae(`Graph.${a}: could not find the "${h}" node in the graph.`);uc(!1,r==="mixed"?this.type:r,i,v,y)};const s="map"+t[0].toUpperCase()+t.slice(1);n.prototype[s]=function(h,y){const v=[];return this[a](h,(w,E)=>{v.push(y(w,E))}),v};const c="filter"+t[0].toUpperCase()+t.slice(1);n.prototype[c]=function(h,y){const v=[];return this[a](h,(w,E)=>{y(w,E)&&v.push(w)}),v};const f="reduce"+t[0].toUpperCase()+t.slice(1);n.prototype[f]=function(h,y,v){if(arguments.length<3)throw new Pe(`Graph.${f}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let w=v;return this[a](h,(E,D)=>{w=y(w,E,D)}),w}}function zm(n,e){const{name:t,type:r,direction:i}=e,a=t[0].toUpperCase()+t.slice(1,-1),s="find"+a;n.prototype[s]=function(h,y){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;h=""+h;const v=this._nodes.get(h);if(typeof v>"u")throw new Ae(`Graph.${s}: could not find the "${h}" node in the graph.`);return uc(!0,r==="mixed"?this.type:r,i,v,y)};const c="some"+a;n.prototype[c]=function(h,y){return!!this[s](h,y)};const f="every"+a;n.prototype[f]=function(h,y){return!this[s](h,(w,E)=>!y(w,E))}}function $m(n,e){const{name:t,type:r,direction:i}=e,a=t.slice(0,-1)+"Entries";n.prototype[a]=function(s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return ar.empty();s=""+s;const c=this._nodes.get(s);if(typeof c>"u")throw new Ae(`Graph.${a}: could not find the "${s}" node in the graph.`);return Tm(r==="mixed"?this.type:r,i,c)}}function Gm(n){Pm.forEach(e=>{Rm(n,e),Lm(n,e),zm(n,e),$m(n,e)})}function Wa(n,e,t,r,i){const a=r._nodes.values(),s=r.type;let c,f,h,y,v,w;for(;c=a.next(),c.done!==!0;){let E=!1;if(f=c.value,s!=="undirected"){y=f.out;for(h in y){v=y[h];do w=v.target,E=!0,i(f.key,w.key,f.attributes,w.attributes,v.key,v.attributes,v.undirected),v=v.next;while(v)}}if(s!=="directed"){y=f.undirected;for(h in y)if(!(e&&f.key>h)){v=y[h];do w=v.target,w.key!==h&&(w=v.source),E=!0,i(f.key,w.key,f.attributes,w.attributes,v.key,v.attributes,v.undirected),v=v.next;while(v)}}t&&!E&&i(f.key,null,f.attributes,null,null,null,null)}}function qm(n,e){const t={key:n};return tf(e.attributes)||(t.attributes=pt({},e.attributes)),t}function Fm(n,e,t){const r={key:e,source:t.source.key,target:t.target.key};return tf(t.attributes)||(r.attributes=pt({},t.attributes)),n==="mixed"&&t.undirected&&(r.undirected=!0),r}function jm(n){if(!wt(n))throw new Pe('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in n))throw new Pe("Graph.import: serialized node is missing its key.");if("attributes"in n&&(!wt(n.attributes)||n.attributes===null))throw new Pe("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Bm(n){if(!wt(n))throw new Pe('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in n))throw new Pe("Graph.import: serialized edge is missing its source.");if(!("target"in n))throw new Pe("Graph.import: serialized edge is missing its target.");if("attributes"in n&&(!wt(n.attributes)||n.attributes===null))throw new Pe("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in n&&typeof n.undirected!="boolean")throw new Pe("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const Um=Wv(),Km=new Set(["directed","undirected","mixed"]),Hc=new Set(["domain","_events","_eventsCount","_maxListeners"]),Wm=[{name:n=>`${n}Edge`,generateKey:!0},{name:n=>`${n}DirectedEdge`,generateKey:!0,type:"directed"},{name:n=>`${n}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:n=>`${n}EdgeWithKey`},{name:n=>`${n}DirectedEdgeWithKey`,type:"directed"},{name:n=>`${n}UndirectedEdgeWithKey`,type:"undirected"}],Hm={allowSelfLoops:!0,multi:!1,type:"mixed"};function Ym(n,e,t){if(t&&!wt(t))throw new Pe(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},n._nodes.has(e))throw new je(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new n.NodeDataClass(e,t);return n._nodes.set(e,r),n.emit("nodeAdded",{key:e,attributes:t}),r}function Yc(n,e,t){const r=new n.NodeDataClass(e,t);return n._nodes.set(e,r),n.emit("nodeAdded",{key:e,attributes:t}),r}function df(n,e,t,r,i,a,s,c){if(!r&&n.type==="undirected")throw new je(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&n.type==="directed")throw new je(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(c&&!wt(c))throw new Pe(`Graph.${e}: invalid attributes. Expecting an object but got "${c}"`);if(a=""+a,s=""+s,c=c||{},!n.allowSelfLoops&&a===s)throw new je(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const f=n._nodes.get(a),h=n._nodes.get(s);if(!f)throw new Ae(`Graph.${e}: source node "${a}" not found.`);if(!h)throw new Ae(`Graph.${e}: target node "${s}" not found.`);const y={key:null,undirected:r,source:a,target:s,attributes:c};if(t)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new je(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!n.multi&&(r?typeof f.undirected[s]<"u":typeof f.out[s]<"u"))throw new je(`Graph.${e}: an edge linking "${a}" to "${s}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const v=new _i(r,i,f,h,c);n._edges.set(i,v);const w=a===s;return r?(f.undirectedDegree++,h.undirectedDegree++,w&&(f.undirectedLoops++,n._undirectedSelfLoopCount++)):(f.outDegree++,h.inDegree++,w&&(f.directedLoops++,n._directedSelfLoopCount++)),n.multi?v.attachMulti():v.attach(),r?n._undirectedSize++:n._directedSize++,y.key=i,n.emit("edgeAdded",y),i}function Xm(n,e,t,r,i,a,s,c,f){if(!r&&n.type==="undirected")throw new je(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&n.type==="directed")throw new je(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(c){if(f){if(typeof c!="function")throw new Pe(`Graph.${e}: invalid updater function. Expecting a function but got "${c}"`)}else if(!wt(c))throw new Pe(`Graph.${e}: invalid attributes. Expecting an object but got "${c}"`)}a=""+a,s=""+s;let h;if(f&&(h=c,c=void 0),!n.allowSelfLoops&&a===s)throw new je(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let y=n._nodes.get(a),v=n._nodes.get(s),w,E;if(!t&&(w=n._edges.get(i),w)){if((w.source.key!==a||w.target.key!==s)&&(!r||w.source.key!==s||w.target.key!==a))throw new je(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${a}" source & "${s}" target vs. ("${w.source.key}", "${w.target.key}").`);E=w}if(!E&&!n.multi&&y&&(E=r?y.undirected[s]:y.out[s]),E){const C=[E.key,!1,!1,!1];if(f?!h:!c)return C;if(f){const R=E.attributes;E.attributes=h(R),n.emit("edgeAttributesUpdated",{type:"replace",key:E.key,attributes:E.attributes})}else pt(E.attributes,c),n.emit("edgeAttributesUpdated",{type:"merge",key:E.key,attributes:E.attributes,data:c});return C}c=c||{},f&&h&&(c=h(c));const D={key:null,undirected:r,source:a,target:s,attributes:c};if(t)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new je(`Graph.${e}: the "${i}" edge already exists in the graph.`);let k=!1,I=!1;y||(y=Yc(n,a,{}),k=!0,a===s&&(v=y,I=!0)),v||(v=Yc(n,s,{}),I=!0),w=new _i(r,i,y,v,c),n._edges.set(i,w);const P=a===s;return r?(y.undirectedDegree++,v.undirectedDegree++,P&&(y.undirectedLoops++,n._undirectedSelfLoopCount++)):(y.outDegree++,v.inDegree++,P&&(y.directedLoops++,n._directedSelfLoopCount++)),n.multi?w.attachMulti():w.attach(),r?n._undirectedSize++:n._directedSize++,D.key=i,n.emit("edgeAdded",D),[i,!0,k,I]}function si(n,e){n._edges.delete(e.key);const{source:t,target:r,attributes:i}=e,a=e.undirected,s=t===r;a?(t.undirectedDegree--,r.undirectedDegree--,s&&(t.undirectedLoops--,n._undirectedSelfLoopCount--)):(t.outDegree--,r.inDegree--,s&&(t.directedLoops--,n._directedSelfLoopCount--)),n.multi?e.detachMulti():e.detach(),a?n._undirectedSize--:n._directedSize--,n.emit("edgeDropped",{key:e.key,attributes:i,source:t.key,target:r.key,undirected:a})}class Qe extends Gv.EventEmitter{constructor(e){if(super(),e=pt({},Hm,e),typeof e.multi!="boolean")throw new Pe(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Km.has(e.type))throw new Pe(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new Pe(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?nf:e.type==="directed"?af:of;er(this,"NodeDataClass",t);const r="geid_"+Um()+"_";let i=0;const a=()=>{let s;do s=r+i++;while(this._edges.has(s));return s};er(this,"_attributes",{}),er(this,"_nodes",new Map),er(this,"_edges",new Map),er(this,"_directedSize",0),er(this,"_undirectedSize",0),er(this,"_directedSelfLoopCount",0),er(this,"_undirectedSelfLoopCount",0),er(this,"_edgeKeyGenerator",a),er(this,"_options",e),Hc.forEach(s=>er(this,s,this[s])),yr(this,"order",()=>this._nodes.size),yr(this,"size",()=>this._edges.size),yr(this,"directedSize",()=>this._directedSize),yr(this,"undirectedSize",()=>this._undirectedSize),yr(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),yr(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),yr(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),yr(this,"multi",this._options.multi),yr(this,"type",this._options.type),yr(this,"allowSelfLoops",this._options.allowSelfLoops),yr(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(t):!1}throw new Pe(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(t):!1}throw new Pe(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,t=""+t;const r=this._nodes.get(e);return r?typeof r.out<"u"&&r.out.hasOwnProperty(t)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(t):!1}throw new Pe(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new je("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const i=r.out&&r.out[t]||void 0;if(i)return i.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new je("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const i=r.undirected&&r.undirected[t]||void 0;if(i)return i.key}edge(e,t){if(this.multi)throw new je("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new Ae(`Graph.edge: could not find the "${t}" target node in the graph.`);const i=r.out&&r.out[t]||r.undirected&&r.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.in||t in r.out}areOutNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.out}areInNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in r.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in r.undirected}areNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in r.in||t in r.out)||this.type!=="directed"&&t in r.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in r.in||this.type!=="directed"&&t in r.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const r=this._nodes.get(e);if(!r)throw new Ae(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in r.out||this.type!=="directed"&&t in r.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.inDegree),r}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.outDegree),r}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=t.undirectedDegree),this.type!=="undirected"&&(r+=t.inDegree+t.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.inDegree,i+=t.directedLoops),r-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.outDegree,i+=t.directedLoops),r-i}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(r+=t.inDegree+t.outDegree,i+=t.directedLoops*2),r-i}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const r=this._edges.get(t);if(!r)throw new Ae(`Graph.opposite: could not find the "${t}" edge in the graph.`);const i=r.source.key,a=r.target.key;if(e===i)return a;if(e===a)return i;throw new Ae(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${i}, ${a}).`)}hasExtremity(e,t){e=""+e,t=""+t;const r=this._edges.get(e);if(!r)throw new Ae(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===t||r.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new Ae(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return Ym(this,e,t).key}mergeNode(e,t){if(t&&!wt(t))throw new Pe(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let r=this._nodes.get(e);return r?(t&&(pt(r.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.attributes,data:t})),[e,!1]):(r=new this.NodeDataClass(e,t),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new Pe(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let r=this._nodes.get(e);if(r){if(t){const a=r.attributes;r.attributes=t(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const i=t?t({}):{};return r=new this.NodeDataClass(e,i),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new Ae(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in t.out){r=t.out[i];do si(this,r),r=r.next;while(r)}for(const i in t.in){r=t.in[i];do si(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in t.undirected){r=t.undirected[i];do si(this,r),r=r.next;while(r)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(t=ir(this,r,i,this.type),!t)throw new Ae(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new Ae(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return si(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new je("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new je("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const r=ir(this,e,t,"directed");if(!r)throw new Ae(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return si(this,r),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new je("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new je("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=ir(this,e,t,"undirected");if(!r)throw new Ae(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return si(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new Pe("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=t(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!wt(e))throw new Pe("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!wt(e))throw new Pe("Graph.mergeAttributes: provided attributes are not a plain object.");return pt(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new Pe("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new Pe("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!Wc(t))throw new Pe("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new Pe("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!Wc(t))throw new Pe("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,a,s,c;for(;i=r.next(),i.done!==!0;)a=i.value,s=a.source,c=a.target,a.attributes=e(a.key,a.attributes,s.key,c.key,s.attributes,c.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new Pe("Graph.forEachAdjacencyEntry: expecting a callback.");Wa(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Pe("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Wa(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new Pe("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Wa(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new Pe("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Wa(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):ef(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new Pe("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let r,i;for(;r=t.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new Pe("Graph.findNode: expecting a callback.");const t=this._nodes.values();let r,i;for(;r=t.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new Pe("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let r,i;const a=new Array(this.order);let s=0;for(;r=t.next(),r.done!==!0;)i=r.value,a[s++]=e(i.key,i.attributes);return a}someNode(e){if(typeof e!="function")throw new Pe("Graph.someNode: expecting a callback.");const t=this._nodes.values();let r,i;for(;r=t.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new Pe("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let r,i;for(;r=t.next(),r.done!==!0;)if(i=r.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new Pe("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let r,i;const a=[];for(;r=t.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)&&a.push(i.key);return a}reduceNodes(e,t){if(typeof e!="function")throw new Pe("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Pe("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=t;const i=this._nodes.values();let a,s;for(;a=i.next(),a.done!==!0;)s=a.value,r=e(r,s.key,s.attributes);return r}nodeEntries(){const e=this._nodes.values();return new ar(()=>{const t=e.next();if(t.done)return t;const r=t.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((i,a)=>{e[t++]=qm(a,i)});const r=new Array(this._edges.size);return t=0,this._edges.forEach((i,a)=>{r[t++]=Fm(this.type,a,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,t=!1){if(e instanceof Qe)return e.forEachNode((f,h)=>{t?this.mergeNode(f,h):this.addNode(f,h)}),e.forEachEdge((f,h,y,v,w,E,D)=>{t?D?this.mergeUndirectedEdgeWithKey(f,y,v,h):this.mergeDirectedEdgeWithKey(f,y,v,h):D?this.addUndirectedEdgeWithKey(f,y,v,h):this.addDirectedEdgeWithKey(f,y,v,h)}),this;if(!wt(e))throw new Pe("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!wt(e.attributes))throw new Pe("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,i,a,s,c;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new Pe("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=a.length;r<i;r++){s=a[r],jm(s);const{key:f,attributes:h}=s;t?this.mergeNode(f,h):this.addNode(f,h)}}if(e.edges){let f=!1;if(this.type==="undirected"&&(f=!0),a=e.edges,!Array.isArray(a))throw new Pe("Graph.import: invalid edges. Expecting an array.");for(r=0,i=a.length;r<i;r++){c=a[r],Bm(c);const{source:h,target:y,attributes:v,undirected:w=f}=c;let E;"key"in c?(E=t?w?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:w?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,E.call(this,c.key,h,y,v)):(E=t?w?this.mergeUndirectedEdge:this.mergeDirectedEdge:w?this.addUndirectedEdge:this.addDirectedEdge,E.call(this,h,y,v))}}return this}nullCopy(e){const t=new Qe(pt({},this._options,e));return t.replaceAttributes(pt({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((r,i)=>{const a=pt({},r.attributes);r=new t.NodeDataClass(i,a),t._nodes.set(i,r)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new je(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new je("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new je("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),r=this._edges.values();let i,a;for(;i=r.next(),i.done!==!0;)a=i.value,df(t,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,pt({},a.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,s)=>{e[s]=a.attributes});const t={},r={};this._edges.forEach((a,s)=>{const c=a.undirected?"--":"->";let f="",h=a.source.key,y=a.target.key,v;a.undirected&&h>y&&(v=h,h=y,y=v);const w=`(${h})${c}(${y})`;s.startsWith("geid_")?this.multi&&(typeof r[w]>"u"?r[w]=0:r[w]++,f+=`${r[w]}. `):f+=`[${s}]: `,f+=w,t[f]=a.attributes});const i={};for(const a in this)this.hasOwnProperty(a)&&!Hc.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(i[a]=this[a]);return i.attributes=this._attributes,i.nodes=e,i.edges=t,er(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(Qe.prototype[Symbol.for("nodejs.util.inspect.custom")]=Qe.prototype.inspect);Wm.forEach(n=>{["add","merge","update"].forEach(e=>{const t=n.name(e),r=e==="add"?df:Xm;n.generateKey?Qe.prototype[t]=function(i,a,s){return r(this,t,!0,(n.type||this.type)==="undirected",null,i,a,s,e==="update")}:Qe.prototype[t]=function(i,a,s,c){return r(this,t,!1,(n.type||this.type)==="undirected",i,a,s,c,e==="update")}})});im(Qe);gm(Qe);Nm(Qe);Gm(Qe);let hf=class extends Qe{constructor(e){const t=pt({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new Pe("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new Pe('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},ff=class extends Qe{constructor(e){const t=pt({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new Pe("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new Pe('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}};class pf extends Qe{constructor(e){const t=pt({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Pe("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class gf extends Qe{constructor(e){const t=pt({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Pe("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new Pe('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class yf extends Qe{constructor(e){const t=pt({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new Pe("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new Pe('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function Si(n){n.from=function(e,t){const r=pt({},e.options,t),i=new n(r);return i.import(e),i}}Si(Qe);Si(hf);Si(ff);Si(pf);Si(gf);Si(yf);Qe.Graph=Qe;Qe.DirectedGraph=hf;Qe.UndirectedGraph=ff;Qe.MultiGraph=pf;Qe.MultiDirectedGraph=gf;Qe.MultiUndirectedGraph=yf;Qe.InvalidArgumentsGraphError=Pe;Qe.NotFoundGraphError=Ae;Qe.UsageGraphError=je;var vr={},Xo,Xc;function $e(){return Xc||(Xc=1,Xo=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"}),Xo}var Vo={},Vc;function cc(){return Vc||(Vc=1,Vo.copyNode=function(n,e,t){return t=Object.assign({},t),n.addNode(e,t)}),Vo}var ui={},Qc;function Zr(){return Qc||(Qc=1,ui.addEdge=function(e,t,r,i,a,s){return t?r==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(r,i,a,s):r==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(r,i,a,s)},ui.copyEdge=function(e,t,r,i,a,s){return s=Object.assign({},s),t?r==null?e.addUndirectedEdge(i,a,s):e.addUndirectedEdgeWithKey(r,i,a,s):r==null?e.addDirectedEdge(i,a,s):e.addDirectedEdgeWithKey(r,i,a,s)},ui.mergeEdge=function(e,t,r,i,a,s){return t?r==null?e.mergeUndirectedEdge(i,a,s):e.mergeUndirectedEdgeWithKey(r,i,a,s):r==null?e.mergeDirectedEdge(i,a,s):e.mergeDirectedEdgeWithKey(r,i,a,s)},ui.updateEdge=function(e,t,r,i,a,s){return t?r==null?e.updateUndirectedEdge(i,a,s):e.updateUndirectedEdgeWithKey(r,i,a,s):r==null?e.updateDirectedEdge(i,a,s):e.updateDirectedEdgeWithKey(r,i,a,s)}),ui}var Qo,Zc;function Vm(){if(Zc)return Qo;Zc=1;var n=$e(),e=cc().copyNode,t=Zr().copyEdge;return Qo=function(i,a){if(!n(i)||!n(a))throw new Error("graphology-operators/disjoint-union: invalid graph.");if(i.multi!==a.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");var s=i.nullCopy();s.mergeAttributes(i.getAttributes());var c={},f={},h=0;return i.forEachNode(function(y,v){c[y]=h,e(s,h,v),h++}),a.forEachNode(function(y,v){f[y]=h,e(s,h,v),h++}),h=0,i.forEachEdge(function(y,v,w,E,D,k,I){t(s,I,h++,c[w],c[E],E,v)}),a.forEachEdge(function(y,v,w,E,D,k,I){t(s,I,h++,f[w],f[E],E,v)}),s},Qo}var Zo,Jc;function Qm(){if(Jc)return Zo;Jc=1;var n=$e(),e=Zr().copyEdge;return Zo=function(r){if(!n(r))throw new Error("graphology-operators/reverse: invalid graph.");var i=r.emptyCopy();return r.forEachEdge(function(a,s,c,f,h,y,v){v?e(i,!0,a,c,f,s):e(i,!1,a,f,c,s)}),i},Zo}var Jo,el;function Zm(){if(el)return Jo;el=1;var n=$e(),e=cc().copyNode,t=Zr().copyEdge;return Jo=function(i,a){if(!n(i))throw new Error("graphology-operators/subgraph: invalid graph instance.");var s=i.nullCopy(),c=a;if(Array.isArray(a)){if(a.length===0)return s;a=new Set(a)}if(a instanceof Set){if(a.size===0)return s;c=function(h){return a.has(h)};var f=a;a=new Set,f.forEach(function(h){a.add(""+h)})}if(typeof c!="function")throw new Error("graphology-operators/subgraph: invalid nodes. Expecting an array or a set or a filtering function.");if(typeof a=="function"){if(i.forEachNode(function(h,y){c(h,y)&&e(s,h,y)}),s.order===0)return s}else a.forEach(function(h){if(!i.hasNode(h))throw new Error('graphology-operators/subgraph: the "'+h+'" node was not found in the graph.');e(s,h,i.getNodeAttributes(h))});return i.forEachEdge(function(h,y,v,w,E,D,k){c(v,E)&&(w!==v&&!c(w,D)||t(s,k,h,v,w,y))}),s},Jo}var es,tl;function Jm(){if(tl)return es;tl=1;var n=$e(),e=Zr().copyEdge;return es=function(r,i){if(!n(r))throw new Error("graphology-operators/to-directed: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(r.type==="directed")return r.copy();var s=r.emptyCopy({type:"directed"});return r.forEachDirectedEdge(function(c,f,h,y){e(s,!1,c,h,y,f)}),r.forEachUndirectedEdge(function(c,f,h,y){var v=!r.multi&&r.type==="mixed"&&s.edge(h,y),w=!r.multi&&r.type==="mixed"&&s.edge(y,h);v?s.replaceEdgeAttributes(v,a(s.getEdgeAttributes(v),f)):e(s,!1,null,h,y,f),h!==y&&(w?s.replaceEdgeAttributes(w,a(s.getEdgeAttributes(w),f)):e(s,!1,null,y,h,f))}),s},es}var ts,rl;function e0(){if(rl)return ts;rl=1;var n=$e();return ts=function(t){if(!n(t))throw new Error("graphology-operators/to-mixed: expecting a valid graphology instance.");return t.copy({type:"mixed"})},ts}var rs,nl;function t0(){if(nl)return rs;nl=1;var n=$e();return rs=function(t){if(!n(t))throw new Error("graphology-operators/to-multi: expecting a valid graphology instance.");return t.copy({multi:!0})},rs}var ns,il;function r0(){if(il)return ns;il=1;var n=$e(),e=Zr().copyEdge;return ns=function(r,i){if(!n(r))throw new Error("graphology-operators/to-simple: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(!r.multi)return r.copy();var s=r.emptyCopy({multi:!1});return r.forEachEdge(function(c,f,h,y,v,w,E){var D=E?s.undirectedEdge(h,y):s.directedEdge(h,y);if(D){a&&s.replaceEdgeAttributes(D,a(s.getEdgeAttributes(D),f));return}e(s,E,c,h,y,f)}),s},ns}var is,al;function n0(){if(al)return is;al=1;var n=$e(),e=Zr().copyEdge;return is=function(r,i){if(!n(r))throw new Error("graphology-operators/to-undirected: expecting a valid graphology instance.");typeof i=="function"&&(i={mergeEdge:i}),i=i||{};var a=typeof i.mergeEdge=="function"?i.mergeEdge:null;if(r.type==="undirected")return r.copy();var s=r.emptyCopy({type:"undirected"});return r.forEachUndirectedEdge(function(c,f,h,y){e(s,!0,c,h,y,f)}),r.forEachDirectedEdge(function(c,f,h,y){if(!r.multi){var v=s.edge(h,y);if(v){a&&s.replaceEdgeAttributes(v,a(s.getEdgeAttributes(v),f));return}}e(s,!0,null,h,y,f)}),s},is}var as,ol;function i0(){if(ol)return as;ol=1;var n=$e();return as=function(t,r){if(!n(t)||!n(r))throw new Error("graphology-operators/union: invalid graph.");if(t.multi!==r.multi)throw new Error("graphology-operators/union: both graph should be simple or multi.");var i=t.copy();return i.import(r,!0),i},as}var sl;function a0(){return sl||(sl=1,vr.disjointUnion=Vm(),vr.reverse=Qm(),vr.subgraph=Zm(),vr.toDirected=Jm(),vr.toMixed=e0(),vr.toMulti=t0(),vr.toSimple=r0(),vr.toUndirected=n0(),vr.union=i0()),vr}var vi=a0();function o0(n){n.prototype.updateSelectedNodesName=function(e){this.updateSelectedNodesAttributes({label:e})},n.prototype.updateSelectedNodesInfo=function(e){this.updateSelectedNodesAttributes({desc:e})},n.prototype.setDefaultNodeWeight=function(e=1){this.updateEachNodeAttributes((t,r)=>({...r,weight:e}))},n.prototype.getNodesForD3=function(){return this.nodes().map(e=>({...this.getNodeAttributes(e),id:Number(e)}))},n.prototype.selectNode=function(e){this.setNodeAttribute(e,"selected",!0)},n.prototype.deselectNode=function(e){this.setNodeAttribute(e,"selected",!1)},n.prototype.toggleNodeSelection=function(e){if((this.getNodeAttribute(e,"selected")||0)>0)this.setNodeAttribute(e,"selected",0);else{let r=0;this.forEachNode((i,a)=>{a.selected>r&&(r=a.selected)}),this.setNodeAttribute(e,"selected",r+1)}},n.prototype.getSelectedNodes=function(){return this.filterNodes((e,t)=>t.selected>0).sort((e,t)=>this.getNodeAttribute(e,"selected")-this.getNodeAttribute(t,"selected"))},n.prototype.updateSelectedNodesColor=function(e,t,r){!e||!t||!r?e?this.updateSelectedNodesAttributes({color:e}):t?this.updateSelectedNodesAttributes({stroke:t}):r&&this.updateSelectedNodesAttributes({labelColor:r}):this.updateSelectedNodesAttributes({color:e,stroke:t,labelColor:r})},n.prototype.updateSelectedNodesAttributes=function(e){this.getSelectedNodes().forEach(t=>{this.mergeNodeAttributes(t,e)})},n.prototype.connectSelectedNodes=function(e,t="directed"){const r=this.getSelectedNodes();if(!(r.length<1)){if(r.length>1)for(let i=0;i<r.length;i++)for(let a=i+1;a<r.length;a++){const s=r[i],c=r[a],f={color:e,selected:!1};this.type==="mixed"?t==="undirected"?this.mergeUndirectedEdge(s,c,f):this.mergeDirectedEdge(s,c,f):this.mergeEdge(s,c,f)}else if(this.allowSelfLoops){const i=r[0],a={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(i,i,a):this.mergeDirectedEdge(i,i,a)}}},n.prototype.connectSelectedNodesInOrder=function(e,t="directed"){const r=this.getSelectedNodes();for(let i=0;i<r.length-1;i++){const a=r[i],s=r[i+1],c={color:e,selected:!1};t==="undirected"?this.mergeUndirectedEdge(a,s,c):this.mergeDirectedEdge(a,s,c)}}}function s0(n){n.prototype.setDefaultEdgeWeight=function(e=1){this.updateEachEdgeAttributes((t,r)=>({...r,weight:e}))},n.prototype.getEdgeSourceTarget=function(e){return[this.source(e),this.target(e)]},n.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},n.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})},n.prototype.getEdgesForD3=function(){return this.edges().map(e=>{const{source:t,target:r,...i}=this.getEdgeAttributes(e);return{source:Number(t),target:Number(r),...i}})},n.prototype.selectEdge=function(e){this.setEdgeAttribute(e,"selected",!0)},n.prototype.deselectEdge=function(e){this.setEdgeAttribute(e,"selected",!1)},n.prototype.toggleEdgeSelection=function(e){if((this.getEdgeAttribute(e,"selected")||0)>0)this.setEdgeAttribute(e,"selected",0);else{let r=0;this.forEachEdge((i,a)=>{a.selected>r&&(r=a.selected)}),this.setEdgeAttribute(e,"selected",r+1)}},n.prototype.getSelectedEdges=function(){return this.filterEdges((e,t)=>t.selected>0).sort((e,t)=>this.getEdgeAttribute(e,"selected")-this.getEdgeAttribute(t,"selected"))},n.prototype.updateSelectedEdgesAttributes=function(e){this.getSelectedEdges().forEach(t=>{this.mergeEdgeAttributes(t,e)})},n.prototype.updateSelectedEdgesColor=function(e,t){const r={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedEdgesAttributes(r)},n.prototype.updateSelectedEdgesName=function(e){this.updateSelectedEdgesAttributes({label:e})},n.prototype.updateSelectedEdgesInfo=function(e){this.updateSelectedEdgesAttributes({desc:e})}}function u0(n){n.prototype.addFace=function(e,t){const r=e.join("_");t={...t,key:r,id:this._faces.size,nodes:e,color:this.colors.face_color,labelColor:this.colors.label_color};var i=new c0(r,e,t);this._faces.set(r,i)},n.prototype.faces=function(){return Array.from(this._faces.keys())},n.prototype.findFace=function(e){return e.sort(),e.join("_")},n.prototype.dropFace=function(e){this._faces.has(e)&&this._faces.delete(e)},n.prototype.hasFace=function(e){return this._faces.has(e)},n.prototype.faceNodeNeighbors=function(e){const t=[];return this.forEachFace((r,i)=>{i.nodes.includes(e)&&t.push(r)}),t},n.prototype.faceEdgeNeighbors=function(e){const{source:t,target:r}=this.getEdgeAttributes(e),i=[];return this.forEachFace((a,s)=>{s.nodes.includes(""+t)&&s.nodes.includes(""+r)&&i.push(a)}),i},n.prototype.forEachFace=function(e){for(const t of this._faces.values())e(t.key,t.attributes)},n.prototype.setFaceAttribute=function(e,t,r){this._faces.get(e).attributes[t]=r},n.prototype.getFaceAttribute=function(e,t){return this._faces.get(e).attributes[t]},n.prototype.getFaceAttributes=function(e){return this._faces.get(e).attributes},n.prototype.selectFace=function(e){this.setFaceAttribute(e,"selected",!0)},n.prototype.deselectFace=function(e){this.setFaceAttribute(e,"selected",!1)},n.prototype.toggleFaceSelection=function(e){if((this.getFaceAttribute(e,"selected")||0)>0)this.setFaceAttribute(e,"selected",0);else{let r=0;this.forEachFace((i,a)=>{a.selected>r&&(r=a.selected)}),this.setFaceAttribute(e,"selected",r+1)}},n.prototype.getSelectedFaces=function(){return this.faces().filter(e=>this.getFaceAttributes(e).selected>0).sort((e,t)=>this.getFaceAttribute(e,"selected")-this.getFaceAttribute(t,"selected"))},n.prototype.updateSelectedFacesAttributes=function(e){this.getSelectedFaces().forEach(t=>{const r=this.getFaceAttributes(t);this._faces.get(t).attributes={...r,...e}})},n.prototype.updateSelectedFacesColor=function(e,t){const r={...e&&{color:e},...t&&{labelColor:t}};this.updateSelectedFacesAttributes(r)},n.prototype.updateSelectedFacesName=function(e){this.updateSelectedFacesAttributes({label:e})},n.prototype.updateSelectedFacesInfo=function(e){this.updateSelectedFacesAttributes({desc:e})},n.prototype.updateSelectedFacesWeight=function(e){this.updateSelectedFacesAttributes({weight:e})},n.prototype.deleteSelectedFaces=function(){this.getSelectedFaces().forEach(e=>this.dropFace(e))}}class c0{constructor(e,t,r){this.key=e,this.attributes=r,this.nodes=t}}class gn extends Qe{constructor(e){super(e),this.isCustom=!0,this.defaultColors={edge_color:"#4682b4",label_color:"#000000",node_color:"#ffffff",face_color:"#4682b455",stroke_color:"#4682b4"},this.colors=this.defaultColors,this._faces=new Map,this.events()}events(){this.on("nodeAdded",({key:e})=>{const t=this.getNodeAttributes(e);t.id||this.setNodeAttribute(e,"id",+e),t.label===void 0&&this.setNodeAttribute(e,"label",aa(t.id)),t.weight===void 0&&this.setNodeAttribute(e,"weight",void 0),t.color===void 0&&this.setNodeAttribute(e,"color",this.colors.node_color),t.stroke===void 0&&this.setNodeAttribute(e,"stroke",this.colors.stroke_color),t.labelColor===void 0&&this.setNodeAttribute(e,"labelColor",this.colors.label_color),t.selected===void 0&&this.setNodeAttribute(e,"selected",!1),t.size===void 0&&this.setNodeAttribute(e,"size",.25),t.magnitude===void 0&&this.setNodeAttribute(e,"magnitude",1),t.desc===void 0&&this.setNodeAttribute(e,"desc",{})}),this.on("edgeAdded",({key:e,source:t,target:r})=>{const i=this.getEdgeAttributes(e);i.id||this.setEdgeAttribute(e,"id",this.size-1),i.label===void 0&&this.setEdgeAttribute(e,"label",aa(i.id)),i.weight===void 0&&this.setEdgeAttribute(e,"weight",void 0),i.color===void 0&&this.setEdgeAttribute(e,"color",this.colors.edge_color),i.labelColor===void 0&&this.setEdgeAttribute(e,"labelColor",this.colors.label_color),i.source||this.setEdgeAttribute(e,"source",Number(t)),i.target||this.setEdgeAttribute(e,"target",Number(r)),i.selected===void 0&&this.setEdgeAttribute(e,"selected",!1),i.desc===void 0&&this.setEdgeAttribute(e,"desc",{})})}validateSettings(e={}){return Object.fromEntries(Object.keys(this.defaultColors).map(t=>[t,t in e?e[t]:this.defaultColors[t]]))}nullCopy(e){var t=new gn(mo({},this._options,e));return t.replaceAttributes(mo({},this.getAttributes())),t}deselectAll(){this.updateEachNodeAttributes((e,t)=>({...t,selected:0})),this.updateEachEdgeAttributes((e,t)=>({...t,selected:!1}))}deleteSelected(){this.getSelectedEdges().forEach(e=>this.dropEdge(e)),this.getSelectedNodes().forEach(e=>this.dropNode(e))}updateSelectedName(e){this.updateSelectedNodesAttributes({label:e}),this.updateSelectedEdgesAttributes({label:e}),this.updateSelectedFacesAttributes({label:e})}updateSelectedInfo(e){this.updateSelectedNodesAttributes({desc:e}),this.updateSelectedEdgesAttributes({desc:e}),this.updateSelectedFacesAttributes({desc:e})}updateSelectedWeight(e){this.updateSelectedNodesAttributes({weight:e}),this.updateSelectedEdgesAttributes({weight:e}),this.updateSelectedFacesAttributes({weight:e})}selectPath(e){this.deselectAll(),e.forEach(t=>{this.hasNode(t)&&this.selectNode(t)});for(let t=0;t<e.length-1;t++){const r=e[t],i=e[t+1];if(this.hasEdge(r,i)){const a=this.edge(r,i);this.selectEdge(a)}}}replace(e){this.clear(),this.import(e.export())}dropNode(e){const t=this.faceNodeNeighbors(e);t.length&&t.map(r=>{this.dropFace(r)}),super.dropNode(e)}dropEdge(e){var t;if(arguments.length>1){var r=""+arguments[0],i=""+arguments[1];this.findEdge(r,i,s=>{t=s})}else t=e;const a=this.faceEdgeNeighbors(t);a.length&&a.map(s=>{this.dropFace(s)}),super.dropEdge(t)}export(){const e=super.export();e.attributes.selected=!1;var t=new Array(this._faces.size),r=0;return this._faces.forEach(function(i,a){t[r++]=d0(a,i)}),e.faces=t,e}import(e){const t=super.import(e);if(typeof e.faces=="function")e.forEachFace((r,i)=>{t.addFace(i.nodes,i)});else for(const r of e.faces)t.addFace(r.nodes,r.attributes);return t}subgraph(e){const t=this.nullCopy();if(!e||Array.isArray(e)&&e.length===0||e instanceof Set&&e.size===0)return t;const r=new Set(e);for(const i of r)t.addNode(i,this.getNodeAttributes(i));return this.forEachEdge((i,a,s,c,f,h,y)=>{r.has(s)&&r.has(c)&&(y?t.addUndirectedEdgeWithKey(i,s,c,a):t.addDirectedEdgeWithKey(i,s,c,a))}),this.forEachFace((i,a)=>{(a.nodes||[]).every(c=>r.has(c))&&t.addFace(a.nodes,a)}),t}mergeWith(e){if(this.multi!==e.multi)throw new Error("graphology-operators/disjoint-union: both graph should be simple or multi.");this.mergeAttributes(this.getAttributes());var t={},r=Math.max(...this.nodes())+1;e.forEachNode((i,a)=>{t[i]=r,this.addNode(r++,a)}),r=Math.max(...this.edges())+1,e.forEachEdge((i,a,s,c,f,h,y)=>{y?this.addUndirectedEdge(t[s],t[c],{...a,id:r++}):this.addDirectedEdge(t[s],t[c],{...a,id:r++})}),r=Math.max(...this.faces())+1,e.forEachFace((i,a)=>{this.addFace(a.nodes.map(s=>t[s]),{...a,id:r++})})}clear(){this._faces.clear(),this._edges.clear(),this._nodes.clear()}}function l0(){for(var n=arguments[0],e=1,t=arguments.length;e<t;e++)if(arguments[e])for(var r in arguments[e])n[r]=arguments[e][r];return n}var mo=l0;typeof Object.assign=="function"&&(mo=Object.assign);function d0(n,e){var t={key:n,nodes:e.nodes};return Object.keys(e.attributes).length&&(t.attributes=mo({},e.attributes)),t}o0(gn);s0(gn);u0(gn);class h0 extends gn{constructor(e={}){const t=Object.assign({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new InvalidArgumentsGraphError(`DirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}class f0 extends gn{constructor(e={}){const t=Object.assign({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new InvalidArgumentsGraphError("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new InvalidArgumentsGraphError(`UndirectedGraph.from: inconsistent "${t.type}" type in given options!`);super(t)}}var ci={},os,ul;function Er(){return ul||(ul=1,os=function(e){return e!==null&&typeof e=="function"&&typeof e.prototype=="object"&&typeof e.prototype.addUndirectedEdgeWithKey=="function"&&typeof e.prototype.dropNode=="function"}),os}var ss,cl;function p0(){if(cl)return ss;cl=1;var n=Er();return ss=function(t,r){if(!n(t))throw new Error("graphology-generators/classic/complete: invalid Graph constructor.");var i=new t,a,s;for(a=0;a<r;a++)i.addNode(a);for(a=0;a<r;a++)for(s=a+1;s<r;s++)i.type!=="directed"&&i.addUndirectedEdge(a,s),i.type!=="undirected"&&(i.addDirectedEdge(a,s),i.addDirectedEdge(s,a));return i},ss}var us,ll;function lc(){if(ll)return us;ll=1;var n=Er();return us=function(t,r){if(!n(t))throw new Error("graphology-generators/classic/empty: invalid Graph constructor.");var i=new t,a;for(a=0;a<r;a++)i.addNode(a);return i},us}var cs,dl;function g0(){if(dl)return cs;dl=1;var n=Er();return cs=function(t,r){if(!n(t))throw new Error("graphology-generators/classic/ladder: invalid Graph constructor.");var i=new t,a;for(a=0;a<r-1;a++)i.mergeEdge(a,a+1);for(a=r;a<r*2-1;a++)i.mergeEdge(a,a+1);for(a=0;a<r;a++)i.addEdge(a,a+r);return i},cs}var ls,hl;function y0(){if(hl)return ls;hl=1;var n=Er();return ls=function(t,r){if(!n(t))throw new Error("graphology-generators/classic/path: invalid Graph constructor.");for(var i=new t,a=0;a<r-1;a++)i.mergeEdge(a,a+1);return i},ls}var fl;function v0(){return fl||(fl=1,ci.complete=p0(),ci.empty=lc(),ci.ladder=g0(),ci.path=y0()),ci}var Yr=v0(),mr={},ds,pl;function m0(){if(pl)return ds;pl=1;function n(e){this.graph=e,this.stack=new Array(e.order),this.seen=new Set,this.size=0}return n.prototype.hasAlreadySeenEverything=function(){return this.seen.size===this.graph.order},n.prototype.countUnseenNodes=function(){return this.graph.order-this.seen.size},n.prototype.forEachNodeYetUnseen=function(e){var t=this.seen,r=this.graph;r.someNode(function(i,a){if(t.size===r.order)return!0;if(t.has(i))return!1;var s=e(i,a);return!!s})},n.prototype.has=function(e){return this.seen.has(e)},n.prototype.push=function(e){var t=this.seen.size;return this.seen.add(e),t===this.seen.size?!1:(this.stack[this.size++]=e,!0)},n.prototype.pushWith=function(e,t){var r=this.seen.size;return this.seen.add(e),r===this.seen.size?!1:(this.stack[this.size++]=t,!0)},n.prototype.pop=function(){if(this.size!==0)return this.stack[--this.size]},ds=n,ds}var gl;function b0(){if(gl)return mr;gl=1;var n=$e(),e=cc().copyNode,t=Zr().copyEdge,r=m0();function i(E,D){if(!n(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(E.order){var k=new r(E),I=k.push.bind(k);k.forEachNodeYetUnseen(function(P){var C=[];k.push(P);for(var R;k.size!==0;)R=k.pop(),C.push(R),E.forEachNeighbor(R,I);D(C)})}}function a(E,D){if(!n(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(E.order){var k=new r(E),I=k.push.bind(k);k.forEachNodeYetUnseen(function(P){var C=0;k.push(P);for(var R;k.size!==0;)R=k.pop(),C++,E.forEachNeighbor(R,I);D(C)})}}function s(E,D,k){if(!n(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return;var I=new r(E),P;function C(R,_,T,B,S,z,G){P===B&&(B=T),D(R,_,T,B,S,z,G)&&I.push(B)}I.forEachNodeYetUnseen(function(R){var _=0;for(I.push(R);I.size!==0;)P=I.pop(),_++,E.forEachEdge(P,C);k(_)})}function c(E){var D=0;return a(E,function(){D++}),D}function f(E){var D=[];return i(E,function(k){D.push(k)}),D}function h(E){if(!n(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return[];var D=new r(E),k=D.push.bind(D),I=[],P;return D.forEachNodeYetUnseen(function(C){P=[],D.push(C);for(var R;D.size!==0;)R=D.pop(),P.push(R),E.forEachNeighbor(R,k);return P.length>I.length&&(I=P),I.length>D.countUnseenNodes()}),I}function y(E){var D=h(E),k=E.nullCopy();return D.forEach(function(I){e(k,I,E.getNodeAttributes(I))}),E.forEachEdge(function(I,P,C,R,_,T,B){k.hasNode(C)&&t(k,B,I,C,R,P)}),k}function v(E){var D=new Set(h(E));E.forEachNode(function(k){D.has(k)||E.dropNode(k)})}function w(E){if(!n(E))throw new Error("graphology-components: the given graph is not a valid graphology instance.");if(!E.order)return[];if(E.type==="undirected")throw new Error("graphology-components: the given graph is undirected");var D=E.nodes(),k=[],I,P;if(!E.size){for(I=0,P=D.length;I<P;I++)k.push([D[I]]);return k}var C=1,R=[],_=[],T=new Map,B=new Set,S,z,G,F=function(U){var V,j=E.outboundNeighbors(U),ye;T.set(U,C++),R.push(U),_.push(U);for(var fe=0,Y=j.length;fe<Y;fe++)if(V=j[fe],T.has(V)){if(ye=T.get(V),!B.has(V))for(;T.get(R[R.length-1])>ye;)R.pop()}else F(V);if(T.get(R[R.length-1])===T.get(U)){S=[];do z=_.pop(),S.push(z),B.add(z);while(z!==U);k.push(S),R.pop()}};for(I=0,P=D.length;I<P;I++)G=D[I],B.has(G)||F(G);return k}return mr.forEachConnectedComponent=i,mr.forEachConnectedComponentOrder=a,mr.forEachConnectedComponentOrderWithEdgeFilter=s,mr.countConnectedComponents=c,mr.connectedComponents=f,mr.largestConnectedComponent=h,mr.largestConnectedComponentSubgraph=y,mr.cropToLargestConnectedComponent=v,mr.stronglyConnectedComponents=w,mr}var Ha=b0(),Mr={},Rn={},hs,yl;function dc(){if(yl)return hs;yl=1;var n=Zh(),e=n.ARRAY_BUFFER_SUPPORT,t=n.SYMBOL_SUPPORT;return hs=function(i,a){var s,c,f,h,y;if(!i)throw new Error("obliterator/forEach: invalid iterable.");if(typeof a!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(i)||e&&ArrayBuffer.isView(i)||typeof i=="string"||i.toString()==="[object Arguments]"){for(f=0,h=i.length;f<h;f++)a(i[f],f);return}if(typeof i.forEach=="function"){i.forEach(a);return}if(t&&Symbol.iterator in i&&typeof i.next!="function"&&(i=i[Symbol.iterator]()),typeof i.next=="function"){for(s=i,f=0;y=s.next(),y.done!==!0;)a(y.value,f),f++;return}for(c in i)i.hasOwnProperty(c)&&a(i[c],c)},hs}var fs,vl;function w0(){if(vl)return fs;vl=1;var n=jn(),e=dc();function t(){this.clear()}return t.prototype.clear=function(){this.items=[],this.offset=0,this.size=0},t.prototype.enqueue=function(r){return this.items.push(r),++this.size},t.prototype.dequeue=function(){if(this.size){var r=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,r}},t.prototype.peek=function(){if(this.size)return this.items[this.offset]},t.prototype.forEach=function(r,i){i=arguments.length>1?i:this;for(var a=this.offset,s=0,c=this.items.length;a<c;a++,s++)r.call(i,this.items[a],s,this)},t.prototype.toArray=function(){return this.items.slice(this.offset)},t.prototype.values=function(){var r=this.items,i=this.offset;return new n(function(){if(i>=r.length)return{done:!0};var a=r[i];return i++,{value:a,done:!1}})},t.prototype.entries=function(){var r=this.items,i=this.offset,a=0;return new n(function(){if(i>=r.length)return{done:!0};var s=r[i];return i++,{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var r=this.toArray();return Object.defineProperty(r,"constructor",{value:t,enumerable:!1}),r},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(r){var i=new t;return e(r,function(a){i.enqueue(a)}),i},t.of=function(){return t.from(arguments)},fs=t,fs}var ps,ml;function E0(){return ml||(ml=1,ps=function(e,t){var r=t.length;if(r!==0){var i=e.length;e.length+=r;for(var a=0;a<r;a++)e[i+a]=t[a]}}),ps}var bl;function fa(){if(bl)return Rn;bl=1;var n=$e(),e=w0(),t=E0();function r(h,y,v){if(!n(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');if(!h.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" target node does not exist in the given graph.');if(y=""+y,v=""+v,y===v)return[y];var w=h.inboundNeighbors.bind(h),E=h.outboundNeighbors.bind(h),D={},k={};D[y]=null,k[v]=null;var I=[y],P=[v],C,R,_,T,B,S,z,G,F=!1;e:for(;I.length&&P.length;)if(I.length<=P.length){for(C=I,I=[],B=0,z=C.length;B<z;B++)for(R=C[B],_=E(R),S=0,G=_.length;S<G;S++)if(T=_[S],T in D||(I.push(T),D[T]=R),T in k){F=!0;break e}}else for(C=P,P=[],B=0,z=C.length;B<z;B++)for(R=C[B],_=w(R),S=0,G=_.length;S<G;S++)if(T=_[S],T in k||(P.push(T),k[T]=R),T in D){F=!0;break e}if(!F)return null;for(var U=[];T;)U.unshift(T),T=D[T];for(T=k[U[U.length-1]];T;)U.push(T),T=k[T];return U.length?U:null}function i(h,y){if(!n(h))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<2)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 2.");if(!h.hasNode(y))throw new Error('graphology-shortest-path: the "'+y+'" source node does not exist in the given graph.');y=""+y;var v={},w={},E,D,k,I,P,C;for(v[y]=!0,w[y]=[y];Object.keys(v).length;){E=v,v={};for(k in E)for(D=h.outboundNeighbors(k),P=0,C=D.length;P<C;P++)I=D[P],w[I]||(w[I]=w[k].concat(I),v[I]=!0)}return w}function a(h,y,v){if(!n(y))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!y.hasNode(v))throw new Error('graphology-shortest-path: the "'+v+'" source node does not exist in the given graph.');v=""+v;var w=new Set,E={},D=0;E[v]=0;for(var k=[v],I,P,C;k.length!==0;){var R=[];for(I=0,P=k.length;I<P;I++)C=k[I],!w.has(C)&&(w.add(C),t(R,y[h](C)),E[C]=D);D++,k=R}return E}var s=a.bind(null,"outboundNeighbors"),c=a.bind(null,"neighbors");function f(h,y){y=""+y;var v=[],w={},E={},D=h.nodes(),k,I,P,C,R,_,T,B,S;for(_=0,B=D.length;_<B;_++)C=D[_],w[C]=[],E[C]=0;var z={};E[y]=1,z[y]=0;for(var G=e.of(y);G.size;)for(C=G.dequeue(),v.push(C),k=z[C],I=E[C],P=h.outboundNeighbors(C),T=0,S=P.length;T<S;T++)R=P[T],R in z||(G.enqueue(R),z[R]=k+1),z[R]===k+1&&(E[R]+=I,w[R].push(C));return[v,w,E]}return Rn.bidirectional=r,Rn.singleSource=i,Rn.singleSourceLength=s,Rn.undirectedSingleSourceLength=c,Rn.brandes=f,Rn}var gs={},wl;function x0(){if(wl)return gs;wl=1;var n=function(){return!0};return gs.edgePathFromNodePath=function(e,t){var r=t.length,i,a,s,c;if(r<2)return a=t[0],c=e.multi?e.findEdge(a,a,n):e.edge(a,a),c?[c]:[];r--;var f=new Array(r);for(i=0;i<r;i++){if(a=t[i],s=t[i+1],c=e.multi?e.findOutboundEdge(a,s,n):e.edge(a,s),c===void 0)throw new Error("graphology-shortest-path: given path is impossible in given graph.");f[i]=c}return f},gs}var Xi={},Vi={},El;function Gr(){if(El)return Vi;El=1;function n(r){return typeof r!="number"||isNaN(r)?1:r}function e(r,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var c=function(h){return s(h[r])},f=function(){return s(void 0)};return typeof r=="string"?(a.fromAttributes=c,a.fromGraph=function(h,y){return c(h.getNodeAttributes(y))},a.fromEntry=function(h,y){return c(y)}):typeof r=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){return s(r(y,h.getNodeAttributes(y)))},a.fromEntry=function(h,y){return s(r(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f),a}function t(r,i){var a={},s=function(h){return typeof h>"u"?i:h};typeof i=="function"&&(s=i);var c=function(h){return s(h[r])},f=function(){return s(void 0)};return typeof r=="string"?(a.fromAttributes=c,a.fromGraph=function(h,y){return c(h.getEdgeAttributes(y))},a.fromEntry=function(h,y){return c(y)},a.fromPartialEntry=a.fromEntry,a.fromMinimalEntry=a.fromEntry):typeof r=="function"?(a.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},a.fromGraph=function(h,y){var v=h.extremities(y);return s(r(y,h.getEdgeAttributes(y),v[0],v[1],h.getNodeAttributes(v[0]),h.getNodeAttributes(v[1]),h.isUndirected(y)))},a.fromEntry=function(h,y,v,w,E,D,k){return s(r(h,y,v,w,E,D,k))},a.fromPartialEntry=function(h,y,v,w){return s(r(h,y,v,w))},a.fromMinimalEntry=function(h,y){return s(r(h,y))}):(a.fromAttributes=f,a.fromGraph=f,a.fromEntry=f,a.fromMinimalEntry=f),a}return Vi.createNodeValueGetter=e,Vi.createEdgeValueGetter=t,Vi.createEdgeWeightGetter=function(r){return t(r,n)},Vi}var li={},xl;function hc(){if(xl)return li;xl=1;var n=function(i,a){return i<a?-1:i>a?1:0},e=function(i,a){return i<a?1:i>a?-1:0};function t(i){return function(a,s){return i(s,a)}}function r(i){return i===2?function(a,s){return a[0]<s[0]?-1:a[0]>s[0]?1:a[1]<s[1]?-1:a[1]>s[1]?1:0}:function(a,s){for(var c=0;c<i;){if(a[c]<s[c])return-1;if(a[c]>s[c])return 1;c++}return 0}}return li.DEFAULT_COMPARATOR=n,li.DEFAULT_REVERSE_COMPARATOR=e,li.reverseComparator=t,li.createTupleComparator=r,li}var di={},ys={},_l;function pa(){return _l||(_l=1,function(n){var e=Math.pow(2,8)-1,t=Math.pow(2,16)-1,r=Math.pow(2,32)-1,i=Math.pow(2,7)-1,a=Math.pow(2,15)-1,s=Math.pow(2,31)-1;n.getPointerArray=function(f){var h=f-1;if(h<=e)return Uint8Array;if(h<=t)return Uint16Array;if(h<=r)return Uint32Array;throw new Error("mnemonist: Pointer Array of size > 4294967295 is not supported.")},n.getSignedPointerArray=function(f){var h=f-1;return h<=i?Int8Array:h<=a?Int16Array:h<=s?Int32Array:Float64Array},n.getNumberType=function(f){return f===(f|0)?Math.sign(f)===-1?f<=127&&f>=-128?Int8Array:f<=32767&&f>=-32768?Int16Array:Int32Array:f<=255?Uint8Array:f<=65535?Uint16Array:Uint32Array:Float64Array};var c={Uint8Array:1,Int8Array:2,Uint16Array:3,Int16Array:4,Uint32Array:5,Int32Array:6,Float32Array:7,Float64Array:8};n.getMinimalRepresentation=function(f,h){var y=null,v=0,w,E,D,k,I;for(k=0,I=f.length;k<I;k++)D=h?h(f[k]):f[k],E=n.getNumberType(D),w=c[E.name],w>v&&(v=w,y=E);return y},n.isTypedArray=function(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(f)},n.concat=function(){var f=0,h,y,v;for(h=0,v=arguments.length;h<v;h++)f+=arguments[h].length;var w=new arguments[0].constructor(f);for(h=0,y=0;h<v;h++)w.set(arguments[h],y),y+=arguments[h].length;return w},n.indices=function(f){for(var h=n.getPointerArray(f),y=new h(f),v=0;v<f;v++)y[v]=v;return y}}(ys)),ys}var Sl;function So(){if(Sl)return di;Sl=1;var n=dc(),e=pa();function t(s){return Array.isArray(s)||e.isTypedArray(s)}function r(s){if(typeof s.length=="number")return s.length;if(typeof s.size=="number")return s.size}function i(s){var c=r(s),f=typeof c=="number"?new Array(c):[],h=0;return n(s,function(y){f[h++]=y}),f}function a(s){var c=r(s),f=typeof c=="number"?e.getPointerArray(c):Array,h=typeof c=="number"?new Array(c):[],y=typeof c=="number"?new f(c):[],v=0;return n(s,function(w){h[v]=w,y[v]=v++}),[h,y]}return di.isArrayLike=t,di.guessLength=r,di.toArray=i,di.toArrayWithIndices=a,di}var vs,Al;function fc(){if(Al)return vs;Al=1;var n=dc(),e=hc(),t=So(),r=e.DEFAULT_COMPARATOR,i=e.reverseComparator;function a(P,C,R,_){for(var T=C[_],B,S;_>R;){if(B=_-1>>1,S=C[B],P(T,S)<0){C[_]=S,_=B;continue}break}C[_]=T}function s(P,C,R){for(var _=C.length,T=R,B=C[R],S=2*R+1,z;S<_;)z=S+1,z<_&&P(C[S],C[z])>=0&&(S=z),C[R]=C[S],R=S,S=2*R+1;C[R]=B,a(P,C,T,R)}function c(P,C,R){C.push(R),a(P,C,0,C.length-1)}function f(P,C){var R=C.pop();if(C.length!==0){var _=C[0];return C[0]=R,s(P,C,0),_}return R}function h(P,C,R){if(C.length===0)throw new Error("mnemonist/heap.replace: cannot pop an empty heap.");var _=C[0];return C[0]=R,s(P,C,0),_}function y(P,C,R){var _;return C.length!==0&&P(C[0],R)<0&&(_=C[0],C[0]=R,R=_,s(P,C,0)),R}function v(P,C){for(var R=C.length,_=R>>1,T=_;--T>=0;)s(P,C,T)}function w(P,C){for(var R=C.length,_=0,T=new Array(R);_<R;)T[_++]=f(P,C);return T}function E(P,C,R){arguments.length===2&&(R=C,C=P,P=r);var _=i(P),T,B,S,z=1/0,G;if(C===1){if(t.isArrayLike(R)){for(T=0,B=R.length;T<B;T++)S=R[T],(z===1/0||P(S,z)<0)&&(z=S);return G=new R.constructor(1),G[0]=z,G}return n(R,function(U){(z===1/0||P(U,z)<0)&&(z=U)}),[z]}if(t.isArrayLike(R)){if(C>=R.length)return R.slice().sort(P);for(G=R.slice(0,C),v(_,G),T=C,B=R.length;T<B;T++)_(R[T],G[0])>0&&h(_,G,R[T]);return G.sort(P)}var F=t.guessLength(R);return F!==null&&F<C&&(C=F),G=new Array(C),T=0,n(R,function(U){T<C?G[T]=U:(T===C&&v(_,G),_(U,G[0])>0&&h(_,G,U)),T++}),G.length>T&&(G.length=T),G.sort(P)}function D(P,C,R){arguments.length===2&&(R=C,C=P,P=r);var _=i(P),T,B,S,z=-1/0,G;if(C===1){if(t.isArrayLike(R)){for(T=0,B=R.length;T<B;T++)S=R[T],(z===-1/0||P(S,z)>0)&&(z=S);return G=new R.constructor(1),G[0]=z,G}return n(R,function(U){(z===-1/0||P(U,z)>0)&&(z=U)}),[z]}if(t.isArrayLike(R)){if(C>=R.length)return R.slice().sort(_);for(G=R.slice(0,C),v(P,G),T=C,B=R.length;T<B;T++)P(R[T],G[0])>0&&h(P,G,R[T]);return G.sort(_)}var F=t.guessLength(R);return F!==null&&F<C&&(C=F),G=new Array(C),T=0,n(R,function(U){T<C?G[T]=U:(T===C&&v(P,G),P(U,G[0])>0&&h(P,G,U)),T++}),G.length>T&&(G.length=T),G.sort(_)}function k(P){if(this.clear(),this.comparator=P||r,typeof this.comparator!="function")throw new Error("mnemonist/Heap.constructor: given comparator should be a function.")}k.prototype.clear=function(){this.items=[],this.size=0},k.prototype.push=function(P){return c(this.comparator,this.items,P),++this.size},k.prototype.peek=function(){return this.items[0]},k.prototype.pop=function(){return this.size!==0&&this.size--,f(this.comparator,this.items)},k.prototype.replace=function(P){return h(this.comparator,this.items,P)},k.prototype.pushpop=function(P){return y(this.comparator,this.items,P)},k.prototype.consume=function(){return this.size=0,w(this.comparator,this.items)},k.prototype.toArray=function(){return w(this.comparator,this.items.slice())},k.prototype.inspect=function(){var P=this.toArray();return Object.defineProperty(P,"constructor",{value:k,enumerable:!1}),P},typeof Symbol<"u"&&(k.prototype[Symbol.for("nodejs.util.inspect.custom")]=k.prototype.inspect);function I(P){if(this.clear(),this.comparator=P||r,typeof this.comparator!="function")throw new Error("mnemonist/MaxHeap.constructor: given comparator should be a function.");this.comparator=i(this.comparator)}return I.prototype=k.prototype,k.from=function(P,C){var R=new k(C),_;return t.isArrayLike(P)?_=P.slice():_=t.toArray(P),v(R.comparator,_),R.items=_,R.size=_.length,R},I.from=function(P,C){var R=new I(C),_;return t.isArrayLike(P)?_=P.slice():_=t.toArray(P),v(R.comparator,_),R.items=_,R.size=_.length,R},k.siftUp=s,k.siftDown=a,k.push=c,k.pop=f,k.replace=h,k.pushpop=y,k.heapify=v,k.consume=w,k.nsmallest=E,k.nlargest=D,k.MinHeap=k,k.MaxHeap=I,vs=k,vs}var kl;function _0(){if(kl)return Xi;kl=1;var n=$e(),e=Gr().createEdgeWeightGetter,t=fc(),r="weight";function i(v,w){return v[0]>w[0]?1:v[0]<w[0]?-1:v[1]>w[1]?1:v[1]<w[1]?-1:v[2]>w[2]?1:v[2]<w[2]?-1:0}function a(v,w){return v[0]>w[0]?1:v[0]<w[0]?-1:v[1]>w[1]?1:v[1]<w[1]?-1:v[2]>w[2]?1:v[2]<w[2]?-1:v[3]>w[3]?1:v[3]<w[3]?-1:0}function s(v,w,E,D){if(w=""+w,E=""+E,!n(v))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");if(w&&!v.hasNode(w))throw new Error('graphology-shortest-path/dijkstra: the "'+w+'" source node does not exist in the given graph.');if(E&&!v.hasNode(E))throw new Error('graphology-shortest-path/dijkstra: the "'+E+'" target node does not exist in the given graph.');if(D=e(D||r).fromMinimalEntry,w===E)return[0,[w]];var k=[{},{}],I=[{},{}],P=[new t(i),new t(i)],C=[{},{}];I[0][w]=[w],I[1][E]=[E],C[0][w]=0,C[1][E]=0;var R=[],_=1/0,T=0,B=1,S,z,G,F,U,V,j,ye,fe;for(P[0].push([0,T++,w]),P[1].push([0,T++,E]);P[0].size&&P[1].size;)if(B=1-B,S=P[B].pop(),F=S[0],U=S[2],!(U in k[B])){if(k[B][U]=F,U in k[1-B])return[_,R];for(z=B===1?v.inboundEdges(U):v.outboundEdges(U),ye=0,fe=z.length;ye<fe;ye++){if(j=z[ye],V=v.opposite(U,j),G=k[B][U]+D(j,v.getEdgeAttributes(j)),V in k[B]&&G<k[B][V])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(V in C[B])||G<C[B][V])&&(C[B][V]=G,P[B].push([G,T++,V]),I[B][V]=I[B][U].concat(V),V in C[0]&&V in C[1]&&(F=C[0][V]+C[1][V],(R.length===0||_>F)&&(_=F,R=I[0][V].concat(I[1][V].slice(0,-1).reverse()))))}}return[1/0,null]}function c(v,w,E,D,k,I){if(!n(v))throw new Error("graphology-shortest-path/dijkstra: invalid graphology instance.");E=e(E||r).fromMinimalEntry;var P={},C={},R=new t(i),_=0,T,B,S,z,G,F,U,V,j,ye,fe;for(V=0,ye=w.length;V<ye;V++)z=w[V],C[z]=0,R.push([0,_++,z]),I[z]=[z];for(;R.size;)if(B=R.pop(),U=B[0],z=B[2],!(z in P)){if(P[z]=U,z===k)break;for(T=v.outboundEdges(z),j=0,fe=T.length;j<fe;j++){if(F=T[j],G=v.opposite(z,F),S=E(F,v.getEdgeAttributes(F))+P[z],G in P&&S<P[G])throw Error("graphology-shortest-path/dijkstra: contradictory paths found. Do some of your edges have a negative weight?");(!(G in C)||S<C[G])&&(C[G]=S,R.push([S,_++,G]),I[G]=I[z].concat(G))}}return P}function f(v,w,E){var D={};return c(v,[w],E,0,null,D),D}function h(v,w,E,D){return s(v,w,E,D)[1]}function y(v,w,E){w=""+w,E=e(E||r).fromMinimalEntry;var D=[],k={},I={},P=v.nodes(),C,R,_,T,B,S,z,G,F,U;for(F=0,U=P.length;F<U;F++)S=P[F],k[S]=[],I[S]=0;var V={};I[w]=1;var j={};j[w]=0;var ye=0,fe=new t(a);for(fe.push([0,ye++,w,w]);fe.size;)if(R=fe.pop(),T=R[0],_=R[2],S=R[3],!(S in V))for(I[S]+=I[_],D.push(S),V[S]=T,C=v.outboundEdges(S),F=0,U=C.length;F<U;F++)G=C[F],z=v.opposite(S,G),B=T+E(G,v.getEdgeAttributes(G)),!(z in V)&&(!(z in j)||B<j[z])?(j[z]=B,fe.push([B,ye++,S,z]),I[z]=0,k[z]=[S]):B===j[z]&&(I[z]+=I[S],k[z].push(S));return[D,k,I]}return Xi.bidirectional=h,Xi.singleSource=f,Xi.brandes=y,Xi}var Dl;function S0(){if(Dl)return Mr;Dl=1;var n=fa(),e=x0();return Mr.unweighted=n,Mr.dijkstra=_0(),Mr.bidirectional=n.bidirectional,Mr.singleSource=n.singleSource,Mr.singleSourceLength=n.singleSourceLength,Mr.undirectedSingleSourceLength=n.undirectedSingleSourceLength,Mr.brandes=n.brandes,Mr.edgePathFromNodePath=e.edgePathFromNodePath,Mr}var Cl=S0(),It={},Nr={},ms,Il;function vf(){if(Il)return ms;Il=1;var n=$e();return ms=function(t){if(!n(t))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!t.multi)return t.size;var r=0,i=0;function a(){r++}function s(){i++}return t.forEachNode(function(c){t.type!=="directed"&&t.forEachUndirectedNeighbor(c,a),t.type!=="undirected"&&t.forEachOutNeighbor(c,s)}),r/2+i},ms}var Ml;function mf(){if(Ml)return Nr;Ml=1;var n=$e(),e=vf();function t(s,c){return 2*c/(s*(s-1))}function r(s,c){return c/(s*(s-1))}function i(s,c){var f=s*(s-1);return c/(f+f/2)}function a(s,c,f){var h,y;if(arguments.length>3){if(h=f,y=arguments[3],typeof h!="number"||h<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof y!="number"||y<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!n(f))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");h=f.order,y=f.size,f.multi&&c===!1&&(y=e(f))}if(h<2)return 0;s===null&&(s=f.type),c===null&&(c=f.multi);var v;return s==="undirected"?v=t:s==="directed"?v=r:v=i,v(h,y)}return Nr.abstractDensity=a,Nr.density=a.bind(null,null,null),Nr.directedDensity=a.bind(null,"directed",!1),Nr.undirectedDensity=a.bind(null,"undirected",!1),Nr.mixedDensity=a.bind(null,"mixed",!1),Nr.multiDirectedDensity=a.bind(null,"directed",!0),Nr.multiUndirectedDensity=a.bind(null,"undirected",!0),Nr.multiMixedDensity=a.bind(null,"mixed",!0),Nr}var Ya={},Nl;function A0(){if(Nl)return Ya;Nl=1;var n=$e();function e(r,i){if(!n(r))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,c,f,h={};for(f=0;f<a.length;f++)c=a[f],h[c]=[1/0,-1/0];return r.forEachNode(function(y,v){for(f=0;f<a.length;f++)c=a[f],s=v[c],s<h[c][0]&&(h[c][0]=s),s>h[c][1]&&(h[c][1]=s)}),typeof i=="string"?h[i]:h}function t(r,i){if(!n(r))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,c,f,h={};for(f=0;f<a.length;f++)c=a[f],h[c]=[1/0,-1/0];return r.forEachEdge(function(y,v){for(f=0;f<a.length;f++)c=a[f],s=v[c],s<h[c][0]&&(h[c][0]=s),s>h[c][1]&&(h[c][1]=s)}),typeof i=="string"?h[i]:h}return Ya.nodeExtent=e,Ya.edgeExtent=t,Ya}var bs,Pl;function bf(){if(Pl)return bs;Pl=1;var n=$e(),e=fa().singleSourceLength;return bs=function(r,i){if(!n(r))throw new Error("graphology-metrics/eccentricity: given graph is not a valid graphology instance.");if(r.size===0)return 1/0;var a=-1/0,s=e(r,i),c,f,h=0;for(c in s)f=s[c],f>a&&(a=f),h++;return h<r.order?1/0:a},bs}var ws,Ol;function k0(){if(Ol)return ws;Ol=1;var n=$e(),e=bf();return ws=function(r){if(!n(r))throw new Error("graphology-metrics/diameter: given graph is not a valid graphology instance.");if(r.size===0)return 1/0;var i=-1/0;return r.someNode(function(a){var s=e(r,a);return s>i&&(i=s),i===1/0}),i},ws}var Es,Tl;function Et(){if(Tl)return Es;Tl=1;function n(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function e(t,r){t=t||{};var i={};for(var a in r){var s=t[a],c=r[a];if(!n(c)){i[a]=e(s,c);continue}s===void 0?i[a]=c:i[a]=s}return i}return Es=e,Es}var xs,Rl;function ga(){if(Rl)return xs;Rl=1;var n=$e();return xs=function(t){if(!n(t))throw new Error("graphology-utils/infer-type: expecting a valid graphology instance.");var r=t.type;return r!=="mixed"?r:t.directedSize===0&&t.undirectedSize===0||t.directedSize>0&&t.undirectedSize>0?"mixed":t.directedSize>0?"directed":"undirected"},xs}var _s,Ll;function D0(){if(Ll)return _s;Ll=1;var n=Et(),e=$e(),t=ga(),r=Gr(),i={getNodeCommunity:"community",getEdgeWeight:"weight",resolution:1};function a(C,R){var _=new Array(C.order),T=new Float64Array(C.order),B={},S=0,z=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry,G=r.createNodeValueGetter(R.getNodeCommunity).fromEntry,F=0,U={};return C.forEachNode(function(V,j){U[V]=F,_[F++]=G(V,j)}),C.forEachUndirectedEdge(function(V,j,ye,fe,Y,O,J){var ee=z(V,j,ye,fe,Y,O,J);S+=ee,B[V]=ee,T[U[ye]]+=ee,ye!==fe&&(T[U[fe]]+=ee)}),{weights:B,communities:_,weightedDegrees:T,M:S}}function s(C,R){var _=new Array(C.order),T=new Float64Array(C.order),B=new Float64Array(C.order),S={},z=0,G=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry,F=r.createNodeValueGetter(R.getNodeCommunity).fromEntry,U=0,V={};return C.forEachNode(function(j,ye){V[j]=U,_[U++]=F(j,ye)}),C.forEachDirectedEdge(function(j,ye,fe,Y,O,J,ee){var ce=G(j,ye,fe,Y,O,J,ee);z+=ce,S[j]=ce,B[V[fe]]+=ce,T[V[Y]]+=ce}),{weights:S,communities:_,weightedInDegrees:T,weightedOutDegrees:B,M:z}}function c(C,R){var _=R.resolution,T=a(C,R),B=T.communities,S=T.weightedDegrees,z=T.M,G=C.nodes(),F,U,V,j,ye,fe,Y=0,O=z*2;for(F=0,V=C.order;F<V;F++)for(U=0;U<V;U++)B[F]===B[U]&&(fe=C.undirectedEdge(G[F],G[U]),j=T.weights[fe]||0,ye=S[F]*S[U],F===U&&typeof fe<"u"?Y+=(j-ye/O*_)*2:Y+=j-ye/O*_);return Y/O}function f(C,R){var _=R.resolution,T=s(C,R),B=T.communities,S=T.weightedInDegrees,z=T.weightedOutDegrees,G=T.M,F=C.nodes(),U,V,j,ye,fe,Y,O=0;for(U=0,j=C.order;U<j;U++)for(V=0;V<j;V++)B[U]===B[V]&&(Y=C.directedEdge(F[U],F[V]),ye=T.weights[Y]||0,fe=S[U]*z[V],O+=ye-fe/G*_);return O/G}function h(C,R){var _={},T={},B={},S=r.createNodeValueGetter(R.getNodeCommunity).fromEntry;return C.forEachNode(function(z,G){var F=S(z,G);if(_[z]=F,typeof F>"u")throw new Error('graphology-metrics/modularity: the "'+z+'" node is not in the partition.');T[F]=0,B[F]=0}),{communities:_,totalWeights:T,internalWeights:B}}function y(C,R){var _={},T={},B={},S={},z=r.createNodeValueGetter(R.getNodeCommunity).fromEntry;return C.forEachNode(function(G,F){var U=z(G,F);if(_[G]=U,typeof U>"u")throw new Error('graphology-metrics/modularity: the "'+G+'" node is not in the partition.');T[U]=0,B[U]=0,S[U]=0}),{communities:_,totalInWeights:T,totalOutWeights:B,internalWeights:S}}function v(C,R){var _=R.resolution,T=h(C,R),B=0,S=T.totalWeights,z=T.internalWeights,G=T.communities,F=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry;C.forEachUndirectedEdge(function(ye,fe,Y,O,J,ee,ce){var oe=F(ye,fe,Y,O,J,ee,ce);B+=oe;var le=G[Y],se=G[O];S[le]+=oe,S[se]+=oe,le===se&&(z[le]+=oe*2)});var U=0,V=B*2;for(var j in z)U+=z[j]/V-Math.pow(S[j]/V,2)*_;return U}function w(C,R){var _=R.resolution,T=y(C,R),B=0,S=T.totalInWeights,z=T.totalOutWeights,G=T.internalWeights,F=T.communities,U=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry;C.forEachDirectedEdge(function(ye,fe,Y,O,J,ee,ce){var oe=U(ye,fe,Y,O,J,ee,ce);B+=oe;var le=F[Y],se=F[O];z[le]+=oe,S[se]+=oe,le===se&&(G[le]+=oe)});var V=0;for(var j in G)V+=G[j]/B-S[j]*z[j]/Math.pow(B,2)*_;return V}function E(C,R,_,T){return T/(2*C)-R*_/(2*(C*C))}function D(C,R,_,T,B,S){return S/C-(B*R+T*_)/(C*C)}function k(C,R){if(!e(C))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(C.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(C.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var _=t(C);if(_==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return R=n(R,i),_==="directed"?f(C,R):c(C,R)}function I(C,R){if(!e(C))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(C.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(C.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var _=t(C);if(_==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return R=n(R,i),_==="directed"?w(C,R):v(C,R)}var P=I;return P.sparse=I,P.dense=k,P.undirectedDelta=E,P.directedDelta=D,_s=P,_s}var Ss,zl;function C0(){if(zl)return Ss;zl=1;var n=$e(),e=Gr().createEdgeWeightGetter,t="weight";return Ss=function(i,a){if(!n(i))throw new Error("graphology-metrics/weighted-size: the given graph is not a valid graphology instance.");a=e(a||t).fromEntry;var s=0;return i.forEachEdge(function(c,f,h,y,v,w,E){s+=a(c,f,h,y,v,w,E)}),s},Ss}var $l;function I0(){if($l)return It;$l=1;var n=mf(),e=A0();return It.diameter=k0(),It.modularity=D0(),It.simpleSize=vf(),It.weightedSize=C0(),It.abstractDensity=n.abstractDensity,It.density=n.density,It.directedDensity=n.directedDensity,It.undirectedDensity=n.undirectedDensity,It.mixedDensity=n.mixedDensity,It.multiDirectedDensity=n.multiDirectedDensity,It.multiUndirectedDensity=n.multiUndirectedDensity,It.multiMixedDensity=n.multiMixedDensity,It.nodeExtent=e.nodeExtent,It.edgeExtent=e.edgeExtent,It}var Gl=I0(),Xa={},As,ql;function wf(){if(ql)return As;ql=1;var n=$e(),e=ga(),t=Et(),r=Gr().createEdgeWeightGetter,i={edgeDisparityAttribute:"disparity",getEdgeWeight:"weight"};function a(c,f,h){if(!n(f))throw new Error("graphology-metrics/edge/disparity: the given graph is not a valid graphology instance.");if(f.multi||e(f)==="mixed")throw new Error("graphology-metrics/edge/disparity: not defined for multi nor mixed graphs.");h=t(h,i);var y=r(h.getEdgeWeight).fromEntry,v={};f.forEachNode(function(I){v[I]=0}),f.forEachEdge(function(I,P,C,R,_,T,B){var S=y(I,P,C,R,_,T,B);v[C]+=S,v[R]+=S});var w,E,D,k={};if(f.forEachAssymetricAdjacencyEntry(function(I,P,C,R,_,T,B){var S=y(_,T,I,P,C,R,B);w!==I&&(w=I,E=f.degree(I),D=v[I]);var z=f.degree(P),G=v[P],F=S/D,U=S/G,V=Math.pow(1-F,E-1),j=Math.pow(1-U,z-1);k[_]=Math.min(V,j)}),c){f.updateEachEdgeAttributes(function(I,P){return P[h.edgeDisparityAttribute]=k[I],P},{attributes:[h.edgeDisparityAttribute]});return}return k}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),As=s,As}var ks={},Fl;function Ao(){return Fl||(Fl=1,function(n){n.intersection=function(){if(arguments.length<2)throw new Error("mnemonist/Set.intersection: needs at least two arguments.");var e=new Set,t=1/0,r=null,i,a,s=arguments.length;for(a=0;a<s;a++){if(i=arguments[a],i.size===0)return e;i.size<t&&(t=i.size,r=i)}for(var c=r.values(),f,h,y,v;f=c.next(),!f.done;){for(h=f.value,y=!0,a=0;a<s;a++)if(v=arguments[a],v!==r&&!v.has(h)){y=!1;break}y&&e.add(h)}return e},n.union=function(){if(arguments.length<2)throw new Error("mnemonist/Set.union: needs at least two arguments.");var e=new Set,t,r=arguments.length,i,a;for(t=0;t<r;t++)for(i=arguments[t].values();a=i.next(),!a.done;)e.add(a.value);return e},n.difference=function(e,t){if(!e.size)return new Set;if(!t.size)return new Set(e);for(var r=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||r.add(a.value);return r},n.symmetricDifference=function(e,t){for(var r=new Set,i=e.values(),a;a=i.next(),!a.done;)t.has(a.value)||r.add(a.value);for(i=t.values();a=i.next(),!a.done;)e.has(a.value)||r.add(a.value);return r},n.isSubset=function(e,t){var r=e.values(),i;if(e===t)return!0;if(e.size>t.size)return!1;for(;i=r.next(),!i.done;)if(!t.has(i.value))return!1;return!0},n.isSuperset=function(e,t){return n.isSubset(t,e)},n.add=function(e,t){for(var r=t.values(),i;i=r.next(),!i.done;)e.add(i.value)},n.subtract=function(e,t){for(var r=t.values(),i;i=r.next(),!i.done;)e.delete(i.value)},n.intersect=function(e,t){for(var r=e.values(),i;i=r.next(),!i.done;)t.has(i.value)||e.delete(i.value)},n.disjunct=function(e,t){for(var r=e.values(),i,a=[];i=r.next(),!i.done;)t.has(i.value)&&a.push(i.value);for(r=t.values();i=r.next(),!i.done;)e.has(i.value)||e.add(i.value);for(var s=0,c=a.length;s<c;s++)e.delete(a[s])},n.intersectionSize=function(e,t){var r;if(e.size>t.size&&(r=e,e=t,t=r),e.size===0)return 0;if(e===t)return e.size;for(var i=e.values(),a,s=0;a=i.next(),!a.done;)t.has(a.value)&&s++;return s},n.unionSize=function(e,t){var r=n.intersectionSize(e,t);return e.size+t.size-r},n.jaccard=function(e,t){var r=n.intersectionSize(e,t);if(r===0)return 0;var i=e.size+t.size-r;return r/i},n.overlap=function(e,t){var r=n.intersectionSize(e,t);return r===0?0:r/Math.min(e.size,t.size)}}(ks)),ks}var Ds,jl;function M0(){if(jl)return Ds;jl=1;var n=$e(),e=Ao().intersectionSize;function t(i,a){if(!n(a))throw new Error("graphology-metrics/simmelian-strength: given graph is not a valid graphology instance.");var s={};if(a.forEachNode(function(f){s[f]=new Set(a.neighbors(f))}),!i){var c={};return a.forEachEdge(function(f,h,y,v){c[f]=e(s[y],s[v])}),c}a.updateEachEdgeAttributes(function(f,h,y,v){return h.simmelianStrength=e(s[y],s[v]),h},{attributes:["simmelianStrength"]})}var r=t.bind(null,!1);return r.assign=t.bind(null,!0),Ds=r,Ds}var Bl;function N0(){return Bl||(Bl=1,Xa.disparity=wf(),Xa.simmelianStrength=M0()),Xa}var P0=N0(),Cs,Ul;function pc(){if(Ul)return Cs;Ul=1;var n=So(),e=jn();function t(r,i){if(arguments.length<2)throw new Error("mnemonist/fixed-deque: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-deque: `capacity` should be a positive number.");this.ArrayClass=r,this.capacity=i,this.items=new r(this.capacity),this.clear()}return t.prototype.clear=function(){this.start=0,this.size=0},t.prototype.push=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.push: deque capacity ("+this.capacity+") exceeded!");var i=this.start+this.size;return i>=this.capacity&&(i-=this.capacity),this.items[i]=r,++this.size},t.prototype.unshift=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-deque.unshift: deque capacity ("+this.capacity+") exceeded!");var i=this.start-1;return this.start===0&&(i=this.capacity-1),this.items[i]=r,this.start=i,++this.size},t.prototype.pop=function(){if(this.size!==0){this.size--;var r=this.start+this.size;return r>=this.capacity&&(r-=this.capacity),this.items[r]}},t.prototype.shift=function(){if(this.size!==0){var r=this.start;return this.size--,this.start++,this.start===this.capacity&&(this.start=0),this.items[r]}},t.prototype.peekFirst=function(){if(this.size!==0)return this.items[this.start]},t.prototype.peekLast=function(){if(this.size!==0){var r=this.start+this.size-1;return r>=this.capacity&&(r-=this.capacity),this.items[r]}},t.prototype.get=function(r){if(!(this.size===0||r>=this.capacity))return r=this.start+r,r>=this.capacity&&(r-=this.capacity),this.items[r]},t.prototype.forEach=function(r,i){i=arguments.length>1?i:this;for(var a=this.capacity,s=this.size,c=this.start,f=0;f<s;)r.call(i,this.items[c],f,this),c++,f++,c===a&&(c=0)},t.prototype.toArray=function(){var r=this.start+this.size;if(r<this.capacity)return this.items.slice(this.start,r);for(var i=new this.ArrayClass(this.size),a=this.capacity,s=this.size,c=this.start,f=0;f<s;)i[f]=this.items[c],c++,f++,c===a&&(c=0);return i},t.prototype.values=function(){var r=this.items,i=this.capacity,a=this.size,s=this.start,c=0;return new e(function(){if(c>=a)return{done:!0};var f=r[s];return s++,c++,s===i&&(s=0),{value:f,done:!1}})},t.prototype.entries=function(){var r=this.items,i=this.capacity,a=this.size,s=this.start,c=0;return new e(function(){if(c>=a)return{done:!0};var f=r[s];return s++,s===i&&(s=0),{value:[c++,f],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){var r=this.toArray();return r.type=this.ArrayClass.name,r.capacity=this.capacity,Object.defineProperty(r,"constructor",{value:t,enumerable:!1}),r},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(r,i,a){if(arguments.length<3&&(a=n.guessLength(r),typeof a!="number"))throw new Error("mnemonist/fixed-deque.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(n.isArrayLike(r)){var c,f;for(c=0,f=r.length;c<f;c++)s.items[c]=r[c];return s.size=f,s}return n.forEach(r,function(h){s.push(h)}),s},Cs=t,Cs}var Is,Kl;function Ef(){if(Kl)return Is;Kl=1;var n=jn(),e=pa().getPointerArray;function t(r){var i=e(r);this.size=0,this.length=r,this.dense=new i(r),this.sparse=new i(r)}return t.prototype.clear=function(){this.size=0},t.prototype.has=function(r){var i=this.sparse[r];return i<this.size&&this.dense[i]===r},t.prototype.add=function(r){var i=this.sparse[r];return i<this.size&&this.dense[i]===r?this:(this.dense[this.size]=r,this.sparse[r]=this.size,this.size++,this)},t.prototype.delete=function(r){var i=this.sparse[r];return i>=this.size||this.dense[i]!==r?!1:(i=this.dense[this.size-1],this.dense[this.sparse[r]]=i,this.sparse[i]=this.sparse[r],this.size--,!0)},t.prototype.forEach=function(r,i){i=arguments.length>1?i:this;for(var a,s=0;s<this.size;s++)a=this.dense[s],r.call(i,a,a)},t.prototype.values=function(){var r=this.size,i=this.dense,a=0;return new n(function(){if(a<r){var s=i[a];return a++,{value:s}}return{done:!0}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.inspect=function(){for(var r=new Set,i=0;i<this.size;i++)r.add(this.dense[i]);return Object.defineProperty(r,"constructor",{value:t,enumerable:!1}),r.length=this.length,r},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),Is=t,Is}var Va={},Wl;function Bn(){if(Wl)return Va;Wl=1;var n=pa(),e=Gr().createEdgeWeightGetter;function t(a,s){return a==="outbound"||a==="inbound"?s.directedSize+s.undirectedSize*2:a==="in"||a==="out"||a==="directed"?s.directedSize:s.undirectedSize*2}function r(a,s){s=s||"outbound";var c=a[s+"Neighbors"].bind(a),f=t(s,a),h=n.getPointerArray(f),y=n.getPointerArray(a.order);this.graph=a,this.neighborhood=new y(f),this.starts=new h(a.order+1),this.nodes=a.nodes();var v={},w,E,D,k,I,P,C=0;for(w=0,E=a.order;w<E;w++)v[this.nodes[w]]=w;for(w=0,E=a.order;w<E;w++)for(I=this.nodes[w],P=c(I),this.starts[w]=C,D=0,k=P.length;D<k;D++)this.neighborhood[C++]=v[P[D]];this.starts[w]=f}r.prototype.bounds=function(a){return[this.starts[a],this.starts[a+1]]},r.prototype.project=function(){var a=this,s={};return a.nodes.forEach(function(c,f){s[c]=Array.from(a.neighborhood.slice(a.starts[f],a.starts[f+1])).map(function(h){return a.nodes[h]})}),s},r.prototype.collect=function(a){var s,c,f={};for(s=0,c=a.length;s<c;s++)f[this.nodes[s]]=a[s];return f},r.prototype.assign=function(a,s){var c=0;this.graph.updateEachNodeAttributes(function(f,h){return h[a]=s[c++],h},{attributes:[a]})},Va.NeighborhoodIndex=r;function i(a,s,c){c=c||"outbound";var f=a[c+"Edges"].bind(a),h=t(c,a),y=n.getPointerArray(h),v=n.getPointerArray(a.order),w=e(s).fromMinimalEntry;this.graph=a,this.neighborhood=new v(h),this.weights=new Float64Array(h),this.outDegrees=new Float64Array(a.order),this.starts=new y(a.order+1),this.nodes=a.nodes();var E={},D,k,I,P,C,R,_,T,B,S=0;for(D=0,k=a.order;D<k;D++)E[this.nodes[D]]=D;for(D=0,k=a.order;D<k;D++)for(C=this.nodes[D],_=f(C),this.starts[D]=S,I=0,P=_.length;I<P;I++)T=_[I],R=a.opposite(C,T),B=w(T,a.getEdgeAttributes(T)),this.neighborhood[S]=E[R],this.weights[S++]=B,this.outDegrees[D]+=B;this.starts[D]=h}return i.prototype.bounds=r.prototype.bounds,i.prototype.project=r.prototype.project,i.prototype.collect=r.prototype.collect,i.prototype.assign=r.prototype.assign,Va.WeightedNeighborhoodIndex=i,Va}var Ms,Hl;function O0(){if(Hl)return Ms;Hl=1;var n=$e(),e=Et(),t=pc(),r=Ef(),i=Bn().NeighborhoodIndex,a={nodeCentralityAttribute:"closenessCentrality",wassermanFaust:!1};function s(h){this.index=new i(h,"inbound"),this.queue=new t(Array,h.order),this.seen=new r(h.order)}s.prototype.fromNode=function(h){var y=this.index,v=this.queue,w=this.seen;w.clear(),v.clear(),w.add(h),v.push([h,0]);for(var E,D,k,I,P,C,R=0,_=0;v.size!==0;)for(E=v.shift(),D=E[0],k=E[1],k!==0&&(R+=k,_+=1),P=y.starts[D+1],I=y.starts[D];I<P;I++)C=y.neighborhood[I],!w.has(C)&&(w.add(C),v.push([C,k+1]));return[_,R]};function c(h,y,v){if(!n(y))throw new Error("graphology-metrics/centrality/closeness: the given graph is not a valid graphology instance.");v=e(v,a);var w=v.wassermanFaust,E=new s(y),D=y.order,k,I,P,C,R,_=new Float64Array(D);for(k=0;k<D;k++)I=E.fromNode(k),P=I[0],C=I[1],R=0,C>0&&D>1&&(R=P/C,w&&(R*=P/(D-1))),_[k]=R;return h?E.index.assign(v.nodeCentralityAttribute,_):E.index.collect(_)}var f=c.bind(null,!1);return f.assign=c.bind(null,!0),Ms=f,Ms}var T0=O0();const R0=Pt(T0);var Qi={},Yl;function L0(){if(Yl)return Qi;Yl=1;var n=$e();function e(a,s,c,f){var h=s+"Centrality";if(!n(c))throw new Error("graphology-centrality/"+h+": the given graph is not a valid graphology instance.");if(s!=="degree"&&c.type==="undirected")throw new Error("graphology-centrality/"+h+": cannot compute "+s+" centrality on an undirected graph.");f=f||{};var y=f.nodeCentralityAttribute||h,v=c.order-1,w=c[s].bind(c);if(a){c.updateEachNodeAttributes(function(D,k){return k[y]=w(D)/v,k},{attributes:[y]});return}var E={};return c.forEachNode(function(D){E[D]=w(D)/v}),E}var t=e.bind(null,!1,"degree"),r=e.bind(null,!1,"inDegree"),i=e.bind(null,!1,"outDegree");return t.assign=e.bind(null,!0,"degree"),r.assign=e.bind(null,!0,"inDegree"),i.assign=e.bind(null,!0,"outDegree"),Qi.degreeCentrality=t,Qi.inDegreeCentrality=r,Qi.outDegreeCentrality=i,Qi}var z0=L0(),Qa={},Ns,Xl;function $0(){if(Xl)return Ns;Xl=1;var n=jn(),e=So();function t(r,i){if(arguments.length<2)throw new Error("mnemonist/fixed-stack: expecting an Array class and a capacity.");if(typeof i!="number"||i<=0)throw new Error("mnemonist/fixed-stack: `capacity` should be a positive number.");this.capacity=i,this.ArrayClass=r,this.items=new this.ArrayClass(this.capacity),this.clear()}return t.prototype.clear=function(){this.size=0},t.prototype.push=function(r){if(this.size===this.capacity)throw new Error("mnemonist/fixed-stack.push: stack capacity ("+this.capacity+") exceeded!");return this.items[this.size++]=r,this.size},t.prototype.pop=function(){if(this.size!==0)return this.items[--this.size]},t.prototype.peek=function(){return this.items[this.size-1]},t.prototype.forEach=function(r,i){i=arguments.length>1?i:this;for(var a=0,s=this.items.length;a<s;a++)r.call(i,this.items[s-a-1],a,this)},t.prototype.toArray=function(){for(var r=new this.ArrayClass(this.size),i=this.size-1,a=this.size;a--;)r[a]=this.items[i-a];return r},t.prototype.values=function(){var r=this.items,i=this.size,a=0;return new n(function(){if(a>=i)return{done:!0};var s=r[i-a-1];return a++,{value:s,done:!1}})},t.prototype.entries=function(){var r=this.items,i=this.size,a=0;return new n(function(){if(a>=i)return{done:!0};var s=r[i-a-1];return{value:[a++,s],done:!1}})},typeof Symbol<"u"&&(t.prototype[Symbol.iterator]=t.prototype.values),t.prototype.toString=function(){return this.toArray().join(",")},t.prototype.toJSON=function(){return this.toArray()},t.prototype.inspect=function(){var r=this.toArray();return r.type=this.ArrayClass.name,r.capacity=this.capacity,Object.defineProperty(r,"constructor",{value:t,enumerable:!1}),r},typeof Symbol<"u"&&(t.prototype[Symbol.for("nodejs.util.inspect.custom")]=t.prototype.inspect),t.from=function(r,i,a){if(arguments.length<3&&(a=e.guessLength(r),typeof a!="number"))throw new Error("mnemonist/fixed-stack.from: could not guess iterable length. Please provide desired capacity as last argument.");var s=new t(i,a);if(e.isArrayLike(r)){var c,f;for(c=0,f=r.length;c<f;c++)s.items[c]=r[c];return s.size=f,s}return e.forEach(r,function(h){s.push(h)}),s},Ns=t,Ns}var Vl;function xf(){if(Vl)return Qa;Vl=1;var n=pc(),e=$0(),t=fc(),r=pa(),i=Bn(),a=i.NeighborhoodIndex,s=i.WeightedNeighborhoodIndex;Qa.createUnweightedIndexedBrandes=function(h){var y=new a(h),v=y.neighborhood,w=y.starts,E=h.order,D=new e(r.getPointerArray(E),E),k=new Uint32Array(E),I=new Array(E),P=new Int32Array(E),C=new n(Uint32Array,E),R=function(_){var T,B,S,z,G,F,U;for(F=0;F<E;F++)I[F]=[],k[F]=0,P[F]=-1;for(k[_]=1,P[_]=0,C.push(_);C.size!==0;)for(F=C.shift(),D.push(F),T=P[F],B=k[F],S=w[F],z=w[F+1],G=S;G<z;G++)U=v[G],P[U]===-1&&(C.push(U),P[U]=T+1),P[U]===T+1&&(k[U]+=B,I[U].push(F));return[D,I,k]};return R.index=y,R};function c(f,h){return f[0]>h[0]?1:f[0]<h[0]?-1:f[1]>h[1]?1:f[1]<h[1]?-1:f[2]>h[2]?1:f[2]<h[2]?-1:f[3]>h[3]?1:f[3]<h[3]?-1:0}return Qa.createDijkstraIndexedBrandes=function(h,y){var v=new s(h,y||"weight"),w=v.neighborhood,E=v.weights,D=v.starts,k=h.order,I=new e(r.getPointerArray(k),k),P=new Uint32Array(k),C=new Array(k),R=new Float64Array(k),_=new Float64Array(k),T=new t(c),B=function(S){var z,G,F,U,V,j,ye,fe,Y,O=0;for(fe=0;fe<k;fe++)C[fe]=[],P[fe]=0,R[fe]=-1,_[fe]=-1;for(P[S]=1,_[S]=0,T.push([0,O++,S,S]);T.size!==0;)if(F=T.pop(),U=F[0],V=F[2],fe=F[3],R[fe]===-1)for(I.push(fe),R[fe]=U,P[fe]+=P[V],z=D[fe],G=D[fe+1],ye=z;ye<G;ye++)Y=w[ye],j=U+E[ye],R[Y]===-1&&(_[Y]===-1||j<_[Y])?(_[Y]=j,T.push([j,O++,fe,Y]),P[Y]=0,C[Y]=[fe]):j===_[Y]&&(P[Y]+=P[fe],C[Y].push(fe));return[I,C,P]};return B.index=v,B},Qa}var Ps,Ql;function G0(){if(Ql)return Ps;Ql=1;var n=$e(),e=xf(),t=Et(),r=e.createUnweightedIndexedBrandes,i=e.createDijkstraIndexedBrandes,a={nodeCentralityAttribute:"betweennessCentrality",getEdgeWeight:"weight",normalized:!0};function s(f,h,y){if(!n(h))throw new Error("graphology-centrality/beetweenness-centrality: the given graph is not a valid graphology instance.");y=t(y,a);var v=y.nodeCentralityAttribute,w=y.normalized,E=y.getEdgeWeight?i(h,y.getEdgeWeight):r(h),D=h.order,k,I,P,C,R,_,T,B,S,z,G=new Float64Array(D),F=new Float64Array(D);for(_=0;_<D;_++){for(k=E(_),I=k[0],P=k[1],C=k[2],T=I.size;T--;)G[I.items[I.size-T]]=0;for(;I.size!==0;){for(z=I.pop(),R=(1+G[z])/C[z],T=0,B=P[z].length;T<B;T++)S=P[z][T],G[S]+=C[S]*R;z!==_&&(F[z]+=G[z])}}var U=null;if(w?U=D<=2?null:1/((D-1)*(D-2)):U=h.type==="undirected"?.5:null,U!==null)for(_=0;_<D;_++)F[_]*=U;return f?E.index.assign(v,F):E.index.collect(F)}var c=s.bind(null,!1);return c.assign=s.bind(null,!0),Ps=c,Ps}var q0=G0();const F0=Pt(q0);var Os,Zl;function j0(){if(Zl)return Os;Zl=1;var n=$e(),e=Et(),t=Bn().WeightedNeighborhoodIndex,r={nodeCentralityAttribute:"eigenvectorCentrality",getEdgeWeight:"weight",maxIterations:100,tolerance:1e-6};function i(c){for(var f=0,h=0,y=0,v=c.length;y<v;y++){var w=Math.abs(c[y]);w>f&&(h*=f/w*(f/w),f=w),h+=w===0&&f===0?0:w/f*(w/f)}return f===1/0?1:f*Math.sqrt(h)}function a(c,f,h){if(!n(f))throw new Error("graphology-metrics/centrality/eigenvector: the given graph is not a valid graphology instance.");h=e(h,r);var y=h.maxIterations,v=h.tolerance,w=f.order,E=new t(f,h.getEdgeWeight),D,k,I,P,C=new Float64Array(f.order);for(D=0;D<w;D++)C[D]=1/w;for(var R=0,_=0,T,B,S,z=!1;R<y;){for(B=C,C=new Float64Array(B),D=0;D<w;D++)for(I=E.starts[D+1],k=E.starts[D];k<I;k++)T=E.neighborhood[k],P=E.weights[k],C[T]+=B[D]*P;for(S=i(C),D=0;D<w;D++)C[D]/=S;for(_=0,D=0;D<w;D++)_+=Math.abs(C[D]-B[D]);if(_<w*v){z=!0;break}R++}if(!z)throw Error("graphology-metrics/centrality/eigenvector: failed to converge.");if(c){E.assign(h.nodeCentralityAttribute,C);return}return E.collect(C)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),Os=s,Os}var B0=j0();const U0=Pt(B0);var hi={},Ts,Jl;function K0(){if(Jl)return Ts;Jl=1;var n=$e();function e(r,i){if(r.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.max: not enough values!");for(var a=void 0,s,c=1,f=r.length;c<f;c++)s=r[c],i!==void 0&&(s=i(s)),(a===void 0||s>a)&&(a=s);return a}function t(r,i){if(r.length<1)throw new Error("graphology-metrics/layout-quality/connected-closeness.min: not enough values!");for(var a=void 0,s,c=1,f=r.length;c<f;c++)s=r[c],i!==void 0&&(s=i(s)),(a===void 0||s<a)&&(a=s);return a}return Ts=function(i,a){if(!n(i))throw new Error("graphology-metrics/layout-quality/connected-closeness: given graph is not a valid graphology instance.");if(i.size<2)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:R.C};a=a||{},a.epsilon=a.epsilon||.03,a.gridSize=a.gridSize||10;var s=a.rng||Math.random,c=T(),f=i.edges().map(function(S){var z=i.getNodeAttributes(i.source(S)),G=i.getNodeAttributes(i.target(S)),F=Math.sqrt(Math.pow(z.x-G.x,2)+Math.pow(z.y-G.y,2));return F}),h=[0,Math.max(e(c),e(f)||0)],y=0,v={},w,E,D,k,I,P=-1;do{for(k=0;k<=a.gridSize;k++)w=h[0]+(h[1]-h[0])*k/a.gridSize,v[w]===void 0&&(v[w]=_(w,i,c,f));E=y,y=0,I=Object.values(v),I.forEach(function(S,z){D=S.C,D>y&&(y=D,P=z)}),h=[I[Math.max(0,P-1)].Delta,I[Math.min(I.length-1,P+1)].Delta]}while((y-E)/y>=a.epsilon/10);var C=B(I,a.epsilon),R=_(C,i,c,f);if(R.C<.1)return{deltaMax:void 0,ePercentOfDeltaMax:void 0,pPercentOfDeltaMax:void 0,pEdgeOfDeltaMax:void 0,cMax:R.C};return{deltaMax:C,ePercentOfDeltaMax:R.ePercent,pPercentOfDeltaMax:R.pPercent,pEdgeOfDeltaMax:R.pEdge,cMax:R.C};function _(S,z,G,F){var U=F.filter(function(ce){return ce<=S}),V=G.filter(function(ce){return ce<=S}),j=U.length,ye=j/F.length,fe=V.length,Y=fe/G.length,O=ye-Y,J=z.undirected?1:2,ee=j/(J*fe*(z.order*(z.order-1))/G.length);return{Delta:S,ePercent:ye,pPercent:Y,pEdge:ee,C:O}}function T(){if(i.order<2)return[];var S=[],z,G,F,U,V,j=i.size;if(j<1)return[];for(var ye=0;ye<j;ye++){z=i.nodes()[Math.floor(s()*i.order)];do G=i.nodes()[Math.floor(s()*i.order)];while(z===G);F=i.getNodeAttributes(z),U=i.getNodeAttributes(G),V=Math.sqrt(Math.pow(F.x-U.x,2)+Math.pow(F.y-U.y,2)),S.push(V)}return S}function B(S,z){var G=e(S,function(U){return U.C}),F=t(S.filter(function(U){return U.C>=(1-z)*G}),function(U){return U.Delta});return F}},Ts}var Rs,ed;function W0(){if(ed)return Rs;ed=1;var n=$e();function e(t,r){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}return Rs=function(r){if(!n(r))throw new Error("graphology-metrics/layout-quality/edge-uniformity: given graph is not a valid graphology instance.");if(r.size===0)return 0;var i=0,a=0,s,c=new Float64Array(r.size);r.forEachEdge(function(v,w,E,D,k,I){var P=e(k,I);c[a++]=P,i+=P});var f=i/r.size,h=0;for(a=0,s=r.size;a<s;a++)h+=Math.pow(f-c[a],2);var y=h/(r.size*Math.pow(f,2));return Math.sqrt(y)},Rs}var Ls,td;function H0(){if(td)return Ls;td=1;var n=hc(),e=fc(),t=n.DEFAULT_COMPARATOR,r=n.reverseComparator;function i(c,f,h,y){for(var v=h,w=y,E=f[y],D=2*y+1,k;D<v;)k=D+1,k<v&&c(f[D],f[k])>=0&&(D=k),f[y]=f[D],y=D,D=2*y+1;f[y]=E,e.siftDown(c,f,w,y)}function a(c,f,h,y){for(var v=y,w=v,E=new c(y),D,k;w>0;)D=h[--w],w!==0&&(k=h[0],h[0]=D,i(f,h,--y,0),D=k),E[w]=D;return E}function s(c,f,h){if(arguments.length===2&&(h=f,f=null),this.ArrayClass=c,this.capacity=h,this.items=new c(h),this.clear(),this.comparator=f||t,typeof h!="number"&&h<=0)throw new Error("mnemonist/FixedReverseHeap.constructor: capacity should be a number > 0.");if(typeof this.comparator!="function")throw new Error("mnemonist/FixedReverseHeap.constructor: given comparator should be a function.");this.comparator=r(this.comparator)}return s.prototype.clear=function(){this.size=0},s.prototype.push=function(c){return this.size<this.capacity?(this.items[this.size]=c,e.siftDown(this.comparator,this.items,0,this.size),this.size++):this.comparator(c,this.items[0])>0&&e.replace(this.comparator,this.items,c),this.size},s.prototype.peek=function(){return this.items[0]},s.prototype.consume=function(){var c=a(this.ArrayClass,this.comparator,this.items,this.size);return this.size=0,c},s.prototype.toArray=function(){return a(this.ArrayClass,this.comparator,this.items.slice(0,this.size),this.size)},s.prototype.inspect=function(){var c=this.toArray();return Object.defineProperty(c,"constructor",{value:s,enumerable:!1}),c},typeof Symbol<"u"&&(s.prototype[Symbol.for("nodejs.util.inspect.custom")]=s.prototype.inspect),Ls=s,Ls}var Za={},rd;function Y0(){if(rd)return Za;rd=1;var n=new Float64Array(64),e=new Float64Array(64);function t(i,a,s){var c,f,h,y,v;for(n[0]=a,e[0]=s,f=0;f>=0;)if(h=n[f],y=e[f]-1,h<y){for(c=i[h];h<y;){for(;i[y]>=c&&h<y;)y--;for(h<y&&(i[h++]=i[y]);i[h]<=c&&h<y;)h++;h<y&&(i[y--]=i[h])}i[h]=c,n[f+1]=h+1,e[f+1]=e[f],e[f++]=h,e[f]-n[f]>e[f-1]-n[f-1]&&(v=n[f],n[f]=n[f-1],n[f-1]=v,v=e[f],e[f]=e[f-1],e[f-1]=v)}else f--;return i}Za.inplaceQuickSort=t;function r(i,a,s,c){var f,h,y,v,w,E;for(n[0]=s,e[0]=c,h=0;h>=0;)if(y=n[h],v=e[h]-1,y<v){for(w=a[y],f=i[w];y<v;){for(;i[a[v]]>=f&&y<v;)v--;for(y<v&&(a[y++]=a[v]);i[a[y]]<=f&&y<v;)y++;y<v&&(a[v--]=a[y])}a[y]=w,n[h+1]=y+1,e[h+1]=e[h],e[h++]=y,e[h]-n[h]>e[h-1]-n[h-1]&&(E=n[h],n[h]=n[h-1],n[h-1]=E,E=e[h],e[h]=e[h-1],e[h-1]=E)}else h--;return a}return Za.inplaceQuickSortIndices=r,Za}var zs,nd;function _f(){if(nd)return zs;nd=1;var n=So(),e=pa(),t=hc().createTupleComparator,r=H0(),i=Y0().inplaceQuickSortIndices;function a(v,w,E,D){var k,I=0,P;for(k=0;k<v;k++)P=w[k][E]-D[k],I+=P*P;return I}function s(v,w){var E=w.length,D=new Array(v),k=new Array(E),I,P=e.getPointerArray(E),C=new P(E),R,_,T,B=!0;for(R=0;R<v;R++){for(I=new Float64Array(E),_=0;_<E;_++)T=w[_],I[_]=T[1][R],B&&(k[_]=T[0],C[_]=_);B=!1,D[R]=I}return{axes:D,ids:C,labels:k}}function c(v,w,E,D){for(var k=D.length,I=e.getPointerArray(k+1),P=new I(k),C=new I(k),R=new I(k),_=[[0,0,E.length,-1,0]],T,B,S,z,G,F,U,V,j=0;_.length!==0;)T=_.pop(),V=T[0],F=T[1],U=T[2],B=T[3],S=T[4],i(w[V],E,F,U),k=U-F,z=F+(k>>>1),G=E[z],P[j]=G,B>-1&&(S===0?C[B]=j+1:R[B]=j+1),V=(V+1)%v,z!==F&&z!==U-1&&_.push([V,z+1,U,j,1]),z!==F&&_.push([V,F,z,j,0]),j++;return{axes:w,labels:D,pivots:P,lefts:C,rights:R}}function f(v,w){this.dimensions=v,this.visited=0,this.axes=w.axes,this.labels=w.labels,this.pivots=w.pivots,this.lefts=w.lefts,this.rights=w.rights,this.size=this.labels.length}f.prototype.nearestNeighbor=function(v){var w=1/0,E=null,D=this.dimensions,k=this.axes,I=this.pivots,P=this.lefts,C=this.rights,R=0;function _(T,B){R++;var S=P[B],z=C[B],G=I[B],F=a(D,k,G,v);if(!(F<w&&(E=G,w=F,F===0))){var U=k[T][G]-v[T];T=(T+1)%D,U>0?S!==0&&_(T,S-1):z!==0&&_(T,z-1),U*U<w&&(U>0?z!==0&&_(T,z-1):S!==0&&_(T,S-1))}}return _(0,0),this.visited=R,this.labels[E]};var h=t(3),y=t(2);return f.prototype.kNearestNeighbors=function(v,w){if(v<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");if(v=Math.min(v,this.size),v===1)return[this.nearestNeighbor(w)];var E=new r(Array,h,v),D=this.dimensions,k=this.axes,I=this.pivots,P=this.lefts,C=this.rights,R=0;function _(S,z){var G=P[z],F=C[z],U=I[z],V=a(D,k,U,w);E.push([V,R++,U]);var j=w[S],ye=k[S][U],fe=j-ye;S=(S+1)%D,j<ye?G!==0&&_(S,G-1):F!==0&&_(S,F-1),(fe*fe<E.peek()[0]||E.size<v)&&(j<ye?F!==0&&_(S,F-1):G!==0&&_(S,G-1))}_(0,0),this.visited=R;for(var T=E.consume(),B=0;B<T.length;B++)T[B]=this.labels[T[B][2]];return T},f.prototype.linearKNearestNeighbors=function(v,w){if(v<=0)throw new Error("mnemonist/kd-tree.kNearestNeighbors: k should be a positive number.");v=Math.min(v,this.size);var E=new r(Array,y,v),D,k,I;for(D=0,k=this.size;D<k;D++)I=a(this.dimensions,this.axes,this.pivots[D],w),E.push([I,D]);var P=E.consume();for(D=0;D<P.length;D++)P[D]=this.labels[this.pivots[P[D][1]]];return P},f.prototype.inspect=function(){var v=new Map;v.dimensions=this.dimensions,Object.defineProperty(v,"constructor",{value:f,enumerable:!1});var w,E,D;for(w=0;w<this.size;w++){for(D=new Array(this.dimensions),E=0;E<this.dimensions;E++)D[E]=this.axes[E][w];v.set(this.labels[w],D)}return v},typeof Symbol<"u"&&(f.prototype[Symbol.for("nodejs.util.inspect.custom")]=f.prototype.inspect),f.from=function(v,w){var E=n.toArray(v),D=s(w,E),k=c(w,D.axes,D.ids,D.labels);return new f(w,k)},f.fromAxes=function(v,w){w||(w=e.indices(v[0].length));var E=v.length,D=c(v.length,v,e.indices(w.length),w);return new f(E,D)},zs=f,zs}var $s,id;function Sf(){if(id)return $s;id=1;var n=$e(),e=_f(),t=Ao().intersectionSize;return $s=function(i){if(!n(i))throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: cannot compute stress for a null graph.");if(i.size===0)return 0;var a=[new Float64Array(i.order),new Float64Array(i.order)],s=0;i.forEachNode(function(h,y){a[0][s]=y.x,a[1][s++]=y.y});var c=e.fromAxes(a,i.nodes()),f=0;return i.forEachNode(function(h,y){var v=new Set(i.neighbors(h));if(v.size===0||v.size===i.order-1){f+=1;return}var w=c.kNearestNeighbors(v.size+1,[y.x,y.y]);w=new Set(w.slice(1));var E=t(v,w);f+=E/w.size}),f/i.order},$s}var Gs,ad;function Af(){if(ad)return Gs;ad=1;var n=$e(),e=fa().undirectedSingleSourceLength;function t(r,i){return Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))}return Gs=function(i){if(!n(i))throw new Error("graphology-metrics/layout-quality/stress: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/stress: cannot compute stress for a null graph.");var a=new Array(i.order),s=new Array(i.order),c=0,f=i.order*4;i.forEachNode(function(C,R){a[c]=C,s[c++]=R});var h,y,v,w,E,D,k,I,P=0;for(c=0,y=i.order;c<y;c++)for(E=e(i,a[c]),v=s[c],h=c+1;h<y;h++)w=s[h],D=E[a[h]],typeof D>"u"&&(D=f),I=t(v,w),k=1/(D*D),P+=k*Math.pow(I-D,2);return P},Gs}var od;function X0(){return od||(od=1,hi.connectedCloseness=K0(),hi.edgeUniformity=W0(),hi.neighborhoodPreservation=Sf(),hi.stress=Af()),hi}var V0=X0(),Q0=Af();const Z0=Pt(Q0);var J0=bf();const eb=Pt(J0);var qs,sd;function tb(){if(sd)return qs;sd=1;var n=$e(),e=Et(),t=Bn().WeightedNeighborhoodIndex,r={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function i(s,c,f){if(!n(c))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");f=e(f,r);var h=f.alpha,y=f.maxIterations,v=f.tolerance,w=f.nodePagerankAttribute,E=c.order,D=1/E,k=new t(c,f.getEdgeWeight),I,P,C,R,_=new Float64Array(c.order),T=new Float64Array(k.weights.length),B=[];for(I=0;I<E;I++)for(_[I]=D,C=k.starts[I+1],R=k.outDegrees[I],R===0&&B.push(I),P=k.starts[I];P<C;P++)T[P]=k.weights[P]/R;for(var S=0,z=0,G,F,U,V=!1;S<y;){for(U=_,_=new Float64Array(c.order),G=0,I=0,C=B.length;I<C;I++)G+=U[B[I]];for(G*=h,I=0;I<E;I++){for(C=k.starts[I+1],P=k.starts[I];P<C;P++)F=k.neighborhood[P],_[F]+=h*U[I]*T[P];_[I]+=G*D+(1-h)*D}for(z=0,I=0;I<E;I++)z+=Math.abs(_[I]-U[I]);if(z<E*v){V=!0;break}S++}if(!V)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(s){k.assign(w,_);return}return k.collect(_)}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),qs=a,qs}var rb=tb();const nb=Pt(rb);var ib=Sf();const ab=Pt(ib);var ob=wf();const sb=Pt(ob),Ja=document;class kf{constructor(e){this.graphManager=e,this.pannel=Ja.querySelector("#floating-panel .body-info")}addHeader(e){const t=Ja.createElement("h4");t.textContent=e,this.pannel.appendChild(t),console.log(e)}addInfo(e){const t=Ja.createElement("div");t.insertAdjacentHTML("beforeend",e),this.pannel.appendChild(t),console.log(e)}addLine(){const e=Ja.createElement("hr");this.pannel.appendChild(e),this.pannel.scrollTop=this.pannel.scrollHeight}addNEFGInfo(e){if(e.desc&&Object.keys(e.desc).length!=0||e.weight){this.addHeader(`${e.label}:`);for(let t in e.desc)this.addInfo(`${t}: ${e.desc[t]}`);e.weight&&this.addInfo(`weight: ${e.weight}`),this.addLine()}}allNodeInfo(){for(let e of this.graphManager.graph.getSelectedNodes()){const t=this.graphManager.graph.getNodeAttributes(e);this.addNEFGInfo(t)}}allEdgeInfo(){for(let e of this.graphManager.graph.getSelectedEdges()){const t=this.graphManager.graph.getEdgeAttributes(e);this.addNEFGInfo(t)}}allFaceInfo(){for(let e of this.graphManager.graph.getSelectedFaces()){const t=this.graphManager.graph.getFaceAttributes(e);this.addNEFGInfo(t)}}allGraphInfo(){for(let e of this.graphManager.graphs.all.filter(t=>t.getAttribute("selected"))){const t=e.getAttributes();this.addNEFGInfo(t)}}getComponent(e){const t=this.graphManager.graph,r=Ha.connectedComponents(t);for(let i of r)if(i.includes(String(e)))return i;return null}basicInfo(){const e=this.graphManager.graph;this.addHeader("Basic Informattion"),this.addInfo(`|V|: ${e.order}`),this.addInfo(`|E|: ${e.size}`),this.addInfo(`|F|: ${e._faces.size}`);const t=e.someEdge((r,i)=>i.weight);this.addInfo(t?`Type: ${e.type}, weighted`:`Type: ${e.type}`),this.addLine()}degreeSequesnce(){this.addHeader("Degree Sequence");const e=this.graphManager.graph,r=`(${e.mapNodes((i,a)=>e.degree(i)).join(", ")})`;this.addInfo(r),this.addLine()}countComponents(){const e=this.graphManager.graph;this.addHeader("Connected Components");const t=Ha.countConnectedComponents(e);this.addInfo(`Count: ${t}`),Ha.forEachConnectedComponent(e,r=>{this.addInfo(r.map(i=>e.getNodeAttribute(i,"label")).join(", "))}),this.addLine()}neighbors(){const e=this.graphManager.graph;this.addHeader("Neighbors");const t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[r]=t,i=e.neighbors(r);this.addInfo(i.map(a=>e.getNodeAttribute(a,"label")).join(", ")),this.addLine()}shortestPath(){this.addHeader("Shortest Path");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==2){this.addInfo("Select two nodes"),this.addLine();return}const[r,i]=t,a=Cl.bidirectional(e,r,i);a?(this.addInfo(a.map(s=>e.getNodeAttribute(s,"label")).join(" -> ")),this.addLine(),e.selectPath(a)):(this.addInfo("They are not connected"),this.addLine())}density(){this.addHeader("Density");const e=this.graphManager.graph,t=Gl.density(e);this.addInfo(t),this.addLine()}diameter(){this.addHeader("Diameter");const e=this.graphManager.graph,t=Gl.diameter(e);this.addInfo(t),this.addLine()}eccentricity(){this.addHeader("Eccentricity");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length!==1){this.addInfo("Select one node"),this.addLine();return}const[r]=t,i=eb(e,r);this.addInfo(i),this.addLine()}simmelianStrength(){this.addHeader("Simmelian strength");const e=this.graphManager.graph,t=P0.simmelianStrength(e);for(const r in t){const{source:i,target:a}=e.getEdgeAttributes(r);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[r]}`)}this.addLine()}betweennessCentrality(){this.addHeader("Betweenness centrality");const e=this.graphManager.graph,t=F0(e);for(const r in t)this.addInfo(`${e.getNodeAttribute(r,"label")}: ${t[r]}`);this.addLine()}closenessCentrality(){this.addHeader("Closeness centrality");const e=this.graphManager.graph,t=R0(e);for(const r in t)this.addInfo(`${e.getNodeAttribute(r,"label")}: ${t[r]}`);this.addLine()}degreeCentrality(){this.addHeader("Degree centrality");const e=this.graphManager.graph,t=z0.degreeCentrality(e);for(const r in t)this.addInfo(`${e.getNodeAttribute(r,"label")}: ${t[r]}`);this.addLine()}eigenvectorCentrality(){this.addHeader("Eigenvector centrality");const e=this.graphManager.graph,t=U0(e);for(const r in t)this.addInfo(`${e.getNodeAttribute(r,"label")}: ${t[r]}`);this.addLine()}pagerank(){this.addHeader("Pagerank");const e=this.graphManager.graph,t=nb(e);for(const r in t)this.addInfo(`${e.getNodeAttribute(r,"label")}: ${t[r]}`);this.addLine()}edgeUniformity(){this.addHeader("Edge Uniformity");const e=this.graphManager.graph,t=V0.edgeUniformity(e);this.addInfo(t),this.addLine()}neighborhoodPreservation(){this.addHeader("Neighborhood preservation");const e=this.graphManager.graph,t=ab(e);this.addInfo(t),this.addLine()}stress(){this.addHeader("Stress");const e=this.graphManager.graph,t=Z0(e);this.addInfo(t),this.addLine()}disparity(){this.addHeader("Disparity");const e=this.graphManager.graph,t=sb(e);for(const r in t){const{source:i,target:a}=e.getEdgeAttributes(r);this.addInfo(`${e.getNodeAttribute(i,"label")}, ${e.getNodeAttribute(a,"label")} : ${t[r]}`)}this.addLine()}_isCycle(e){if(e.order==e.size&&Ha.countConnectedComponents(e)==1){const t=e.edges()[0],{source:r,target:i}=e.getEdgeAttributes(t);return e.dropEdge(t),Cl.bidirectional(e,i,r)}return!1}liesOnCycle(){this.addHeader("Lies on cycle");const e=this.graphManager.graph,t=this.graphManager.graph.getSelectedNodes();if(t.length<3){this.addInfo("Select at least 3 nodes"),this.addLine();return}const r=vi.subgraph(e,t);this.addInfo(!!this._isCycle(r)),this.addLine()}}var eo={},Fs,ud;function ub(){if(ud)return Fs;ud=1;var n=Er(),e=lc();return Fs=function(r,i,a){if(!n(r))throw new Error("graphology-generators/community/caveman: invalid Graph constructor.");var s=i*a,c=e(r,s);if(a<2)return c;var f,h,y;for(f=0;f<s;f+=a)for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)c.addEdge(h,y);return c},Fs}var js,cd;function cb(){if(cd)return js;cd=1;var n=Er(),e=lc();return js=function(r,i,a){if(!n(r))throw new Error("graphology-generators/community/connected-caveman: invalid Graph constructor.");var s=i*a,c=e(r,s);if(a<2)return c;var f,h,y;for(f=0;f<s;f+=a){for(h=f;h<f+a;h++)for(y=h+1;y<f+a;y++)(h!==f||h!==y-1)&&c.addEdge(h,y);f>0&&c.addEdge(f,(f-1)%s)}return c.addEdge(0,s-1),c},js}var ld;function lb(){return ld||(ld=1,eo.caveman=ub(),eo.connectedCaveman=cb()),eo}var dd=lb(),Zi={},Bs,hd;function db(){if(hd)return Bs;hd=1;var n=Er();return Bs=function(e,t){if(!n(e))throw new Error("graphology-generators/random/clusters: invalid Graph constructor.");t=t||{};var r="clusterDensity"in t?t.clusterDensity:.5,i=t.rng||Math.random,a=t.order,s=t.size,c=t.clusters;if(typeof r!="number"||r>1||r<0)throw new Error("graphology-generators/random/clusters: `clusterDensity` option should be a number between 0 and 1.");if(typeof i!="function")throw new Error("graphology-generators/random/clusters: `rng` option should be a function.");if(typeof a!="number"||a<=0)throw new Error("graphology-generators/random/clusters: `order` option should be a positive number.");if(typeof s!="number"||s<=0)throw new Error("graphology-generators/random/clusters: `size` option should be a positive number.");if(typeof c!="number"||c<=0)throw new Error("graphology-generators/random/clusters: `clusters` option should be a positive number.");var f=new e;if(!a)return f;var h=new Array(c),y,v,w;for(w=0;w<c;w++)h[w]=[];for(w=0;w<a;w++)y=i()*c|0,f.addNode(w,{cluster:y}),h[y].push(w);if(!s)return f;var E,D,k;for(w=0;w<s;w++){if(i()<1-r){E=i()*a|0;do D=i()*a|0;while(E===D)}else{if(y=i()*c|0,v=h[y],k=v.length,!k||k<2)continue;E=v[i()*k|0];do D=v[i()*k|0];while(E===D)}f.multi?f.addEdge(E,D):f.mergeEdge(E,D)}return f},Bs}var Us,fd;function hb(){if(fd)return Us;fd=1;var n=Er(),e=mf().abstractDensity;function t(i,a){if(!n(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,c=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(c=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof c!="number"||c<0||c>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");var y,v;for(y=0;y<s;y++)h.addNode(y);if(c<=0)return h;for(y=0;y<s;y++)for(v=y+1;v<s;v++)h.type!=="directed"&&f()<c&&h.addUndirectedEdge(y,v),h.type!=="undirected"&&(f()<c&&h.addDirectedEdge(y,v),f()<c&&h.addDirectedEdge(v,y));return h}function r(i,a){if(!n(i))throw new Error("graphology-generators/random/erdos-renyi: invalid Graph constructor.");var s=a.order,c=a.probability,f=a.rng||Math.random,h=new i;if(typeof a.approximateSize=="number"&&(c=e(h.type,!1,s,a.approximateSize)),typeof s!="number"||s<=0)throw new Error("graphology-generators/random/erdos-renyi: invalid `order`. Should be a positive number.");if(typeof c!="number"||c<0||c>1)throw new Error("graphology-generators/random/erdos-renyi: invalid `probability`. Should be a number between 0 and 1. Or maybe you gave an `approximateSize` exceeding the graph's density.");if(typeof f!="function")throw new Error("graphology-generators/random/erdos-renyi: invalid `rng`. Should be a function.");for(var y=0;y<s;y++)h.addNode(y);if(c<=0)return h;var v=-1,w=Math.log(1-c),E,D;if(h.type!=="undirected")for(D=0;D<s;){for(E=Math.log(1-f()),v+=1+(E/w|0),D===v&&v++;D<s&&s<=v;)v-=s,D++,D===v&&v++;D<s&&h.addDirectedEdge(D,v)}if(v=-1,h.type!=="directed")for(D=1;D<s;){for(E=Math.log(1-f()),v+=1+(E/w|0);v>=D&&D<s;)v-=D,D++;D<s&&h.addUndirectedEdge(D,v)}return h}return t.sparse=r,Us=t,Us}var Ks,pd;function fb(){if(pd)return Ks;pd=1;var n=Er();return Ks=function(t,r){if(!n(t))throw new Error("graphology-generators/random/girvan-newman: invalid Graph constructor.");var i=r.zOut,a=r.rng||Math.random;if(typeof i!="number")throw new Error("graphology-generators/random/girvan-newman: invalid `zOut`. Should be a number.");if(typeof a!="function")throw new Error("graphology-generators/random/girvan-newman: invalid `rng`. Should be a function.");var s=i/96,c=(16-s*96)/31,f=new t,h,y,v;for(y=0;y<128;y++)f.addNode(y);for(y=0;y<128;y++)for(v=y+1;v<128;v++)h=a(),y%4===v%4?h<c&&f.addEdge(y,v):h<s&&f.addEdge(y,v);return f},Ks}var gd;function pb(){return gd||(gd=1,Zi.clusters=db(),Zi.erdosRenyi=hb(),Zi.girvanNewman=fb()),Zi}var Ws=pb(),Pr={},Hs,yd;function gb(){return yd||(yd=1,Hs=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,i,a;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(!n(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!n(i[1],t.get(i[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,a[i]))return!1;for(i=r;i--!==0;){var s=a[i];if(!n(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}),Hs}var vd;function yb(){if(vd)return Pr;vd=1;var n=gb(),e=Symbol("size");function t(y,v){var w=y.length,E=v.length;if(w!==E)return!1;var D,k,I,P,C=new Set;e:for(I=0;I<w;I++){for(D=y[I],P=0;P<E;P++)if(!C.has(P)&&(k=v[P],n(D,k))){C.add(P);continue e}return!1}return!0}function r(y,v){if(y[e]!==v[e])return!1;for(var w in y)if(!t(y[w],v[w]))return!1;return!0}function i(y,v){var w={},E;return y.forEachOutEdge(v,function(D,k,I,P){E=w[P]||0,E++,w[P]=E}),w}function a(y,v){var w={},E;return y.forEachUndirectedEdge(v,function(D,k,I,P){P=v===I?P:I,!(v>P)&&(E=w[P]||0,E++,w[P]=E)}),w}function s(y,v){var w={};w[e]=0;var E;return y.forEachOutEdge(v,function(D,k,I,P){E=w[P],E||(E=[],w[e]+=1,w[P]=E),E.push(k)}),w}function c(y,v){var w={};w[e]=0;var E;return y.forEachUndirectedEdge(v,function(D,k,I,P){P=v===I?P:I,!(v>P)&&(E=w[P],E||(E=[],w[e]+=1,w[P]=E),E.push(k))}),w}function f(y,v,w){return v===w?!0:v.order!==w.order?!1:v.everyNode(function(E,D){return w.hasNode(E)?y?n(D,w.getNodeAttributes(E)):!0:!1})}function h(y,v,w,E){if(w===E)return!0;if(v){if(w.type==="directed"&&E.type==="undirected"||w.type==="undirected"&&E.type==="directed")return!1}else if(w.type!==E.type||w.allowSelfLoops!==E.allowSelfLoops||w.multi!==E.multi)return!1;if(w.directedSize!==E.directedSize||w.undirectedSize!==E.undirectedSize||!f(y,w,E))return!1;var D=!1,k=!1;if(!w.multi&&!E.multi){if(D=w.everyDirectedEdge(function(C,R,_,T){return E.hasDirectedEdge(_,T)?y?n(w.getDirectedEdgeAttributes(_,T),E.getDirectedEdgeAttributes(_,T)):!0:!1}),!D||(k=w.everyUndirectedEdge(function(C,R,_,T){return E.hasUndirectedEdge(_,T)?y?n(w.getUndirectedEdgeAttributes(_,T),E.getUndirectedEdgeAttributes(_,T)):!0:!1}),!k))return!1}else{var I=y?s:i,P=y?r:n;if(D=w.everyNode(function(C){var R=I(w,C),_=I(E,C);return P(R,_)}),!D||(I=y?c:a,k=w.everyNode(function(C){var R=I(w,C),_=I(E,C);return P(R,_)}),!k))return!1}return!0}return Pr.isGraph=$e(),Pr.isGraphConstructor=Er(),Pr.haveSameNodes=f.bind(null,!1),Pr.haveSameNodesDeep=f.bind(null,!0),Pr.areSameGraphs=h.bind(null,!1,!1),Pr.areSameGraphsDeep=h.bind(null,!0,!1),Pr.haveSameEdges=h.bind(null,!1,!0),Pr.haveSameEdgesDeep=h.bind(null,!0,!0),Pr}var Ys,md;function vb(){return md||(md=1,Ys=yb()),Ys}var gc=vb(),bd=["0111111110111100010101000000000100","1011000100000100010101000000001000","1101000111000100000000000001100010","1110000100001100000000000000000000","1000001000100000000000000000000000","1000001000100000100000000000000000","1000110000000000100000000000000000","1111000000000000000000000000000000","1010000000000000000000000000001011","0010000000000000000000000000000001","1000110000000000000000000000000000","1000000000000000000000000000000000","1001000000000000000000000000000000","1111000000000000000000000000000001","0000000000000000000000000000000011","0000000000000000000000000000000011","0000011000000000000000000000000000","1100000000000000000000000000000000","0000000000000000000000000000000011","1100000000000000000000000000000001","0000000000000000000000000000000011","1100000000000000000000000000000000","0000000000000000000000000000000011","0000000000000000000000000101010011","0000000000000000000000000101000100","0000000000000000000000011000000100","0000000000000000000000000000010001","0010000000000000000000011000000001","0010000000000000000000000000000101","0000000000000000000000010010000011","0100000010000000000000000000000011","1000000000000000000000001100100011","0010000010000011001010110000011101","0000000011000111001110110011111110"],mb=new Set([0,1,2,3,4,5,6,7,8,10,11,12,13,16,17,19,21]);function bb(n,e={}){if(!gc.isGraphConstructor(n))throw new Error("graphology-generators/social/karate: invalid Graph constructor.");for(var t=new n(e),r,i=0;i<34;i++)r=mb.has(i)?"Mr. Hi":"Officer",t.addNode(i,{club:r});var a,s,c,f,h,y;for(c=0,h=bd.length;c<h;c++)for(a=bd[c].split(""),f=c+1,y=a.length;f<y;f++)s=+a[f],s&&t.addEdgeWithKey(c+"->"+f,c,f);return t}var Xs=[[0,1],[2,3],[2,4],[2,5],[1,5],[1,6],[1,7],[1,8],[1,9],[9,10],[3,4],[3,11],[4,6],[4,11],[6,7],[7,12],[8,13],[8,12],[11,12],[12,14]];function wb(n,e={}){if(!gc.isGraphConstructor(n))throw new Error("graphology-generators/social/florentine-families: invalid Graph constructor.");var t=new n(e),r,i;for(r=0,i=Xs.length;r<i;r++)t.mergeEdge(Xs[r][0],Xs[r][1]);return t}var tr={},Vs,wd;function Eb(){if(wd)return Vs;wd=1;var n=$e();return Vs=function(t){if(!n(t))throw new Error("graphology-utils/infer-multi: expecting a valid graphology instance.");if(!t.multi||t.order===0||t.size<2)return!1;var r=!1,i,a,s,c;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,E,D){if(!r){if(D&&f>h&&(c=h,h=f,f=c),f===i&&h===a&&D===s){r=!0;return}i=f,a=h,s=D}}),r},Vs}var Qs,Ed;function xb(){return Ed||(Ed=1,Qs=function(e,t){if(t.length!==0){var r,i,a,s,c;for(a=0,c=t.length;a<c;a++)for(r=t[a],s=a+1;s<c;s++)i=t[s],e.mergeEdge(r,i)}}),Qs}var Zs,xd;function _b(){return xd||(xd=1,Zs=function(e,t){if(t.length!==0){var r,i,a,s;if(e.mergeNode(t[0]),t.length!==1){for(a=1,s=t.length;a<s;a++)r=t[a-1],i=t[a],e.mergeEdge(r,i);e.mergeEdge(i,t[0])}}}),Zs}var Js,_d;function Sb(){return _d||(_d=1,Js=function(e,t){if(t.length!==0){var r,i,a,s;for(e.mergeNode(t[0]),a=1,s=t.length;a<s;a++)r=t[a-1],i=t[a],e.mergeEdge(r,i)}}),Js}var eu,Sd;function Ab(){return Sd||(Sd=1,eu=function(e,t){if(t.length!==0){var r,i,a,s=t[0];for(e.mergeNode(s),i=1,a=t.length;i<a;i++)r=t[i],e.mergeEdge(s,r)}}),eu}var tu,Ad;function kb(){if(Ad)return tu;Ad=1;var n=Zr().copyEdge;return tu=function(t,r,i){typeof r>"u"&&(r={}),typeof i>"u"&&(i={});var a=t.nullCopy();t.forEachNode(function(f,h){var y=r[f];typeof y>"u"&&(y=f),a.addNode(y,h)});var s,c;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,E,D){f!==s&&(s=f,c=r[f],typeof c>"u"&&(c=f));var k=r[h];typeof k>"u"&&(k=h);var I=i[w];typeof I>"u"&&(I=w),n(a,D,I,c,k,E)}),a},tu}var ru,kd;function Db(){if(kd)return ru;kd=1;var n=Zr().copyEdge;return ru=function(t,r,i){var a=t.nullCopy();t.forEachNode(function(f,h){var y=r?r(f,h):f;a.addNode(y,h)});var s,c;return t.forEachAssymetricAdjacencyEntry(function(f,h,y,v,w,E,D){f!==s&&(s=f,c=r?r(f,y):f);var k=r?r(h,v):h,I=i?i(w,E,f,h,y,v,D):w;n(a,D,I,c,k,E)}),a},ru}var Dd;function Cb(){return Dd||(Dd=1,tr.inferMulti=Eb(),tr.inferType=ga(),tr.isGraph=$e(),tr.isGraphConstructor=Er(),tr.mergeClique=xb(),tr.mergeCycle=_b(),tr.mergePath=Sb(),tr.mergeStar=Ab(),tr.renameGraphKeys=kb(),tr.updateGraphKeys=Db()),tr}var nu,Cd;function Ib(){return Cd||(Cd=1,nu=Cb()),nu}var Mb=Ib(),Id=[[0,1,2,3,4],[1,0,5,6],[2,0,3,4],[3,0,1,2,5,4,6],[5,1,3,6],[4,0,2,3,6,7],[6,1,3,5,4,7],[7,4,6,8],[8,7,9],[9,8]];function Nb(n,e={}){if(!gc.isGraphConstructor(n))throw new Error("invalid Graph constructor.");var t=new n(e),r,i;for(r=0,i=Id.length;r<i;r++)Mb.mergeStar(t,Id[r]);return t}const Pb={stars:[{id:0,label:"Hamal",ra:"02 08 34.7",dec:"23 34 50.5",magnitude:2.17},{id:1,label:"Sheratan",ra:"01 56 01.0",dec:"20 55 48.5",magnitude:2.7},{id:2,label:"Gamma",ra:"01 54 53.8",dec:"19 24 58.7",magnitude:3.84},{id:3,label:"41 Arietis",ra:"02 51 27.2",dec:"27 21 50.6",magnitude:3.58}],edges:[[0,1],[1,2],[0,3]]},Ob={stars:[{id:0,label:"Aldebaran",ra:"04 37 21.6",dec:"16 33 34.5",magnitude:1},{id:1,label:"Elnath",ra:"05 26 17.5",dec:"28 36 27.0",magnitude:1.65},{id:2,label:"Zeta",ra:"05 37 38.7",dec:"21 08 33.0",magnitude:2.97},{id:3,label:"Theta2",ra:"04 30 05.6",dec:"15 55 34.7",magnitude:3.45},{id:4,label:"Lambda",ra:"04 02 04.1",dec:"12 33 38.8",magnitude:3.38},{id:5,label:"Omicron",ra:"03 26 09.5",dec:"09 06 59.4",magnitude:3.77},{id:6,label:"Gamma",ra:"04 21 13.2",dec:"15 41 16.8",magnitude:3.8},{id:7,label:"Delta",ra:"04 24 22.8",dec:"17 36 04.5",magnitude:3.92},{id:8,label:"Delta3",ra:"04 26 56.4",dec:"17 59 06.4",magnitude:4.31},{id:9,label:"Ain",ra:"04 30 04.9",dec:"19 14 09.9",magnitude:3.69},{id:10,label:"Tau",ra:"04 43 45.1",dec:"23 00 19.2",magnitude:4.22},{id:11,label:"Atlas",ra:"03 50 39.0",dec:"24 07 49.6",magnitude:4.22}],edges:[[0,3],[0,2],[6,4],[4,5],[3,6],[6,7],[8,7],[8,9],[9,0],[9,10],[1,10],[11,7]]},Tb={stars:[{id:0,label:"Castor",ra:"07 36 12.8",dec:"31 50 01.2",magnitude:1.58},{id:1,label:"Pollux",ra:"07 46 52.0",dec:"27 57 57.2",magnitude:1.29},{id:2,label:"Kappa",ra:"07 45 58.6",dec:"24 20 15.9",magnitude:3.72},{id:3,label:"Upsilon",ra:"07 37 29.0",dec:"26 50 24.6",magnitude:4.16},{id:4,label:"Iota",ra:"07 27 17.9",dec:"27 44 54.9",magnitude:3.94},{id:5,label:"Tau",ra:"07 12 44.9",dec:"30 12 16.7",magnitude:4.53},{id:6,label:"Theta",ra:"06 54 27.2",dec:"33 55 55.1",magnitude:3.63},{id:7,label:"Wasat",ra:"07 21 38.1",dec:"21 56 09.7",magnitude:3.59},{id:8,label:"Mekbuda",ra:"07 05 36.5",dec:"20 32 00.0",magnitude:4.16},{id:9,label:"Alhena",ra:"06 39 10.1",dec:"16 22 38.5",magnitude:1.92},{id:10,label:"Lambda",ra:"07 19 32.8",dec:"16 29 40.3",magnitude:3.61},{id:11,label:"Xi",ra:"06 46 42.4",dec:"12 52 04.2",magnitude:3.44},{id:12,label:"Mebsuta",ra:"06 45 29.1",dec:"25 06 23.7",magnitude:3.19},{id:13,label:"Nu",ra:"06 30 27.6",dec:"20 11 46.3",magnitude:4.09},{id:14,label:"Tejat",ra:"06 24 29.2",dec:"22 30 03.1",magnitude:2.91},{id:15,label:"Propus",ra:"06 16 24.0",dec:"22 29 58.9",magnitude:3.28},{id:16,label:"1",ra:"06 05 39.1",dec:"23 15 43.8",magnitude:4.31}],edges:[[0,5],[1,3],[3,2],[3,4],[4,5],[5,6],[3,7],[7,8],[7,10],[8,9],[10,11],[5,12],[12,13],[12,14],[14,15],[15,16]]},Rb={stars:[{id:0,label:"Acubens",ra:"08 59 52.7",dec:"11 45 32.4",magnitude:4.28},{id:1,label:"Beta",ra:"08 17 53.5",dec:"09 06 24.1",magnitude:3.66},{id:2,label:"Asellus Australis",ra:"08 46 07.7",dec:"18 03 39.9",magnitude:4.09},{id:3,label:"Asellus Borealis",ra:"08 44 45.4",dec:"21 22 39.2",magnitude:4.66},{id:4,label:"Chi",ra:"08 21 36.4",dec:"27 08 10.9",magnitude:5.22},{id:5,label:"Iota",ra:"08 48 14.1",dec:"28 40 04.4",magnitude:4.19}],edges:[[0,2],[1,2],[2,3],[3,4],[3,5]]},Lb={stars:[{id:0,label:"Regulus",ra:"10 09 44.0",dec:"11 50 33.1",magnitude:1.32},{id:1,label:"Algieba",ra:"10 21 22.9",dec:"19 42 46.3",magnitude:2.16},{id:2,label:"Zosma",ra:"11 15 28.3",dec:"20 23 02.6",magnitude:2.58},{id:3,label:"Adhafera",ra:"10 18 06.7",dec:"23 17 27.1",magnitude:3.5},{id:4,label:"Denebola",ra:"11 50 22.2",dec:"14 25 44.7",magnitude:2.16},{id:5,label:"Chertan",ra:"11 15 35.1",dec:"15 17 24.1",magnitude:3.33},{id:6,label:"Eta",ra:"10 08 43.5",dec:"16 38 18.8",magnitude:3.5},{id:7,label:"Rasalas",ra:"09 54 12.9",dec:"25 53 16.1",magnitude:4.03},{id:8,label:"Epsilon",ra:"09 47 18.0",dec:"23 39 27.6",magnitude:3.11}],edges:[[1,3],[2,5],[5,4],[1,6],[2,1],[6,0],[0,5],[3,7],[7,8],[2,4]]},zb={stars:[{id:0,label:"Nu",ra:"11 47 10.7",dec:"06 23 09.0",magnitude:4.13},{id:1,label:"Zaniah",ra:"12 21 13.2",dec:"-00 48 34.3",magnitude:3.89},{id:2,label:"Porrima",ra:"12 42 57.7",dec:"-01 35 23.7",magnitude:2.81},{id:3,label:"Spica",ra:"13 26 32.8",dec:"-11 17 43.6",magnitude:.89},{id:4,label:"Kappa",ra:"14 14 15.9",dec:"-10 23 36.5",magnitude:4.31},{id:5,label:"Syrma",ra:"14 17 21.6",dec:"-06 07 24.0",magnitude:4.16},{id:6,label:"Mu",ra:"14 44 24.8",dec:"-05 46 13.4",magnitude:3.95},{id:7,label:"109",ra:"14 47 32.8",dec:"01 47 01.4",magnitude:3.73},{id:8,label:"Tau",ra:"14 02 57.3",dec:"01 25 10.9",magnitude:4.25},{id:9,label:"Heze",ra:"13 36 00.2",dec:"-00 43 38.6",magnitude:3.41},{id:10,label:"Delta",ra:"12 56 53.9",dec:"03 15 28.1",magnitude:3.44},{id:11,label:"Vindemiatrix",ra:"13 03 27.4",dec:"10 49 15.5",magnitude:2.98}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[7,8],[8,9],[9,10],[10,11],[2,10],[3,9]]},$b={stars:[{id:0,label:"Zubenelgenubi II",ra:"14 52 17.9",dec:"-16 08 54.7",magnitude:2.78},{id:1,label:"Sigma",ra:"15 05 34.3",dec:"-25 22 56.3",magnitude:3.3},{id:2,label:"Zubeneschamali",ra:"15 18 23.1",dec:"-09 28 41.6",magnitude:2.56},{id:3,label:"Gamma",ra:"15 36 57.5",dec:"-14 52 31.6",magnitude:4.06},{id:4,label:"Theta",ra:"15 55 16.9",dec:"-16 48 17.5",magnitude:4.28},{id:5,label:"Upsilon",ra:"15 38 34.7",dec:"-28 13 09.8",magnitude:3.73}],edges:[[0,1],[0,2],[2,3],[3,4],[2,1],[1,5]]},Gb={stars:[{id:0,label:"Acrab",ra:"16 06 55.3",dec:"-19 52 32.6",magnitude:2.59},{id:1,label:"Dschubba",ra:"16 01 50.6",dec:"-22 41 40.4",magnitude:2.25},{id:2,label:"Pi",ra:"16 00 23.8",dec:"-26 11 14.7",magnitude:2.81},{id:3,label:"Antares",ra:"16 30 58.3",dec:"-26 29 18.3",magnitude:.97},{id:4,label:"Tau",ra:"16 37 28.1",dec:"-28 16 06.8",magnitude:2.73},{id:5,label:"Epsilon",ra:"16 51 48.9",dec:"-34 20 18.8",magnitude:2.45},{id:6,label:"Mu1",ra:"16 53 35.8",dec:"-38 05 23.0",magnitude:2.92},{id:7,label:"Zeta2",ra:"16 56 22.6",dec:"-42 24 11.1",magnitude:3.75},{id:8,label:"Eta",ra:"17 13 58.6",dec:"-43 16 14.8",magnitude:3.41},{id:9,label:"Sargas",ra:"17 39 08.6",dec:"-43 00 43.4",magnitude:1.92},{id:10,label:"Iota1",ra:"17 49 21.5",dec:"-40 08 06.6",magnitude:3.09},{id:11,label:"Kappa",ra:"17 44 14.6",dec:"-39 02 29.6",magnitude:2.31},{id:12,label:"Shaula",ra:"17 35 19.9",dec:"-37 07 15.9",magnitude:1.52},{id:13,label:"Lesath",ra:"17 32 29.4",dec:"-37 18 53.3",magnitude:2.59}],edges:[[0,3],[1,3],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12]]},qb={stars:[{id:0,label:"51",ra:"17 22 58.0",dec:"-23 58 57.0",magnitude:4.78},{id:1,label:"Sabik",ra:"17 11 50.2",dec:"-15 45 26.7",magnitude:2.44},{id:2,label:"Zeta",ra:"16 38 33.8",dec:"-10 37 12.4",magnitude:2.56},{id:3,label:"Yed",ra:"16 19 40.3",dec:"-04 45 23.3",magnitude:3.38},{id:4,label:"Kappa",ra:"16 58 52.5",dec:"09 19 55.5",magnitude:3.36},{id:5,label:"Resalhague",ra:"17 36 06.9",dec:"12 32 15.6",magnitude:2.13},{id:6,label:"Cabalrai",ra:"17 44 43.7",dec:"04 33 12.4",magnitude:2.92},{id:7,label:"Gaia DR2",ra:"15 50 57.4",dec:"-03 30 35.9",magnitude:3.33},{id:8,label:"Epsilon",ra:"15 52 05.6",dec:"04 23 55.1",magnitude:3.75},{id:9,label:"Unukalhai",ra:"15 45 31.8",dec:"06 20 34.7",magnitude:2.8},{id:10,label:"Delta A",ra:"15 36 01.6",dec:"10 27 03.7",magnitude:3.86},{id:11,label:"Beta",ra:"15 47 22.3",dec:"15 20 20.6",magnitude:3.67},{id:12,label:"Gamma",ra:"15 57 38.2",dec:"15 34 31.3",magnitude:3.94},{id:13,label:"Kappa",ra:"15 49 53.7",dec:"18 03 34.6",magnitude:4.19},{id:14,label:"Nu",ra:"17 22 15.5",dec:"-12 52 26.5",magnitude:4.34},{id:15,label:"Xi",ra:"17 39 02.5",dec:"-15 24 56.5",magnitude:3.59},{id:16,label:"Omicron",ra:"17 42 50.5",dec:"-12 53 25.2",magnitude:4.25},{id:17,label:"Eta",ra:"18 22 37.2",dec:"-02 53 41.5",magnitude:3.39},{id:18,label:"Alya",ra:"18 57 28.5",dec:"04 13 59.3",magnitude:4.66}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,1],[14,15],[15,16],[16,17],[17,18],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,11]]},Fb={stars:[{id:0,label:"Beta2",ra:"19 25 02.3",dec:"-44 45 00.2",magnitude:4.34},{id:1,label:"Rukbat",ra:"19 25 37.9",dec:"-40 34 00.1",magnitude:3.92},{id:2,label:"Iota",ra:"19 56 59.7",dec:"-41 48 00.9",magnitude:4.25},{id:3,label:"Theta1",ra:"20 01 22.3",dec:"-35 12 25.3",magnitude:4.28},{id:4,label:"62",ra:"20 04 12.2",dec:"-27 38 22.1",magnitude:4.44},{id:5,label:"h2",ra:"19 38 14.3",dec:"-24 49 40.7",magnitude:4.56},{id:6,label:"Tau",ra:"19 08 30.9",dec:"-27 37 59.7",magnitude:3.47},{id:7,label:"Nunki",ra:"18 56 49.9",dec:"-26 15 54.9",magnitude:2},{id:8,label:"Xi2",ra:"18 59 14.2",dec:"-21 04 26.3",magnitude:3.69},{id:9,label:"Omicron",ra:"19 06 11.7",dec:"-21 42 17.7",magnitude:3.91},{id:10,label:"43",ra:"19 19 06.6",dec:"-18 54 31.3",magnitude:5.03},{id:11,label:"Rho1",ra:"19 23 08.0",dec:"-17 48 01.9",magnitude:3.98},{id:12,label:"Eta",ra:"18 19 20.5",dec:"-36 45 10.2",magnitude:3.14},{id:13,label:"Kaus Australis",ra:"18 25 51.1",dec:"-34 22 17.9",magnitude:1.8},{id:14,label:"Ascella",ra:"19 04 13.1",dec:"-29 50 36.0",magnitude:2.61},{id:15,label:"Phi",ra:"18 47 14.1",dec:"-26 57 52.7",magnitude:3.13},{id:16,label:"Kaus Media",ra:"18 22 36.8",dec:"-29 49 00.8",magnitude:2.86},{id:17,label:"Alnsal",ra:"18 07 26.2",dec:"-30 25 23.7",magnitude:3.13},{id:18,label:"3",ra:"17 49 09.4",dec:"-27 50 24.9",magnitude:4.66},{id:19,label:"Kaus Borealis",ra:"18 29 32.0",dec:"-25 24 28.0",magnitude:2.97},{id:20,label:"Mu",ra:"18 15 16.7",dec:"-21 03 09.9",magnitude:3.86},{id:21,label:"HD 180885",ra:"19 21 20.2",dec:"-35 22 27.8",magnitude:5.53},{id:22,label:"V4089",ra:"19 35 52.0",dec:"-39 58 43.5",magnitude:5.91}],edges:[[0,1],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[12,13],[16,17],[17,18],[19,20],[7,15],[6,14],[15,19],[16,19],[14,21],[5,21],[2,22],[1,21],[21,22],[13,16],[13,17],[15,14],[15,16]]},jb={stars:[{id:0,label:"Algedi",ra:"20 19 26.8",dec:"-12 28 05.0",magnitude:3.73},{id:1,label:"Dabih",ra:"20 22 25.3",dec:"-14 42 10.1",magnitude:3.2},{id:2,label:"Psi",ra:"20 47 34.8",dec:"-25 10 49.4",magnitude:4.22},{id:3,label:"Omega",ra:"20 53 18.9",dec:"-26 49 29.2",magnitude:4.22},{id:4,label:"Theta",ra:"21 07 21.2",dec:"-17 08 01.0",magnitude:4.06},{id:5,label:"Zeta",ra:"21 28 05.7",dec:"-22 18 09.6",magnitude:3.92},{id:6,label:"Iota",ra:"21 23 38.3",dec:"-16 43 41.4",magnitude:4.44},{id:7,label:"Nashira",ra:"21 41 28.5",dec:"-16 32 58.0",magnitude:3.77},{id:8,label:"Deneb",ra:"21 48 25.1",dec:"-16 00 50.3",magnitude:2.94},{id:9,label:"Nu",ra:"20 22 03.4",dec:"-12 40 51.8",magnitude:4.72},{id:10,label:"Sigma",ra:"20 20 50.5",dec:"-19 02 25.9",magnitude:5.41}],edges:[[0,1],[1,2],[3,4],[4,1],[4,5],[5,6],[4,6],[6,7],[7,8],[1,9],[1,10]]},Bb={stars:[{id:0,label:"c2",ra:"23 10 46.4",dec:"-21 02 11.8",magnitude:3.84},{id:1,label:"Skat",ra:"22 55 58.3",dec:"-15 41 17.0",magnitude:3.28},{id:2,label:"Tua",ra:"22 50 54.6",dec:"-13 27 39.6",magnitude:4.13},{id:3,label:"Sigma",ra:"22 31 57.9",dec:"-10 33 01.7",magnitude:4.81},{id:4,label:"Ancha",ra:"22 18 09.0",dec:"-07 39 34.2",magnitude:4.31},{id:5,label:"Sadalmelik",ra:"22 07 03.9",dec:"-00 11 58.6",magnitude:3.09},{id:6,label:"Sadachbia",ra:"22 22 56.6",dec:"-01 15 44.7",magnitude:3.83},{id:7,label:"Zeta",ra:"22 30 06.8",dec:"00 06 25.3",magnitude:3.73},{id:8,label:"Eta",ra:"22 36 38.2",dec:"00 00 37.0",magnitude:4},{id:9,label:"Lambda",ra:"22 53 54.9",dec:"-07 26 50.0",magnitude:3.8},{id:10,label:"Psi1",ra:"23 17 11.7",dec:"-08 57 07.4",magnitude:4.41},{id:11,label:"b1",ra:"23 24 16.6",dec:"-19 57 51.0",magnitude:4.09},{id:12,label:"Iota",ra:"22 07 47.0",dec:"-13 44 55.3",magnitude:4.25},{id:13,label:"Sadalsuud",ra:"21 32 52.4",dec:"-05 27 43.9",magnitude:3.03},{id:14,label:"Albali",ra:"20 49 01.9",dec:"-09 24 18.4",magnitude:3.78}],edges:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[4,12],[13,14],[5,13]]},Ub={stars:[{id:0,label:"Upsilon",ra:"25 20 50.0",dec:"27 23 43.0",magnitude:4.75},{id:1,label:"Sigma",ra:"25 04 10.7",dec:"31 56 17.7",magnitude:5.47},{id:2,label:"Phi",ra:"25 15 06.0",dec:"24 42 57.1",magnitude:4.81},{id:3,label:"Eta",ra:"25 32 49.0",dec:"15 28 27.7",magnitude:3.78},{id:4,label:"Omicron",ra:"25 46 42.6",dec:"09 16 58.9",magnitude:4.41},{id:5,label:"Alrescha",ra:"26 03 20.2",dec:"02 53 02.2",magnitude:3.81},{id:6,label:"Xi",ra:"25 54 50.8",dec:"03 18 37.5",magnitude:4.75},{id:7,label:"Nu",ra:"25 42 43.7",dec:"05 36 49.0",magnitude:4.56},{id:8,label:"Mu",ra:"25 31 29.4",dec:"06 16 19.8",magnitude:4.97},{id:9,label:"Epsilon",ra:"25 04 14.1",dec:"08 01 26.9",magnitude:4.41},{id:10,label:"Delta",ra:"24 49 58.4",dec:"07 43 13.8",magnitude:4.53},{id:11,label:"41",ra:"24 21 52.7",dec:"08 19 42.0",magnitude:5.53},{id:12,label:"Omega",ra:"24 00 35.3",dec:"07 00 03.0",magnitude:4.09},{id:13,label:"Iota",ra:"23 41 13.8",dec:"05 45 38.8",magnitude:4.22},{id:14,label:"Theta",ra:"23 29 13.8",dec:"06 30 54.9",magnitude:4.44},{id:15,label:"Gamma",ra:"23 18 27.4",dec:"03 25 04.4",magnitude:3.84},{id:16,label:"Kappa",ra:"23 28 12.5",dec:"01 23 29.7",magnitude:4.94},{id:17,label:"Lambda",ra:"23 43 18.9",dec:"01 55 00.3",magnitude:4.53}],edges:[[0,1],[1,2],[0,2],[2,3],[3,4],[4,5],[5,6],[6,7],[7,8],[8,9],[9,10],[10,11],[11,12],[12,13],[13,14],[14,15],[15,16],[16,17],[17,13]]},Kb={aries:Pb,taurus:Ob,gemini:Tb,cancer:Rb,leo:Lb,virgo:zb,libra:$b,scorpius:Gb,ophiuchus:qb,sagittarius:Fb,capricornus:jb,aquarius:Bb,pisces:Ub};class Wb{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout}load(e){const t=Kb[e.toLowerCase()];t?(this.graphManager.graph=Vb(e,t.stars,t.edges,this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("rotate180")):console.warn(`Constellation "${e}" not found.`)}aries(){this.load("aries")}taurus(){this.load("taurus")}gemini(){this.load("gemini")}cancer(){this.load("cancer")}leo(){this.load("leo")}virgo(){this.load("virgo")}libra(){this.load("libra")}scorpius(){this.load("scorpius")}ophiuchus(){this.load("ophiuchus")}sagittarius(){this.load("sagittarius")}capricornus(){this.load("capricornus")}aquarius(){this.load("aquarius")}pisces(){this.load("pisces")}orion(){this.load("orion")}}function Hb(n=3){return Math.pow(.8,n)}function Yb(n){const[e,t,r]=n.split(" ").map(parseFloat);return(e+t/60+r/3600)*15}function Xb(n){const e=n.trim().startsWith("-")?-1:1,t=n.trim().replace("+","").replace("-","").split(" ").map(parseFloat),[r,i,a]=t;return e*(r+i/60+a/3600)}function Vb(n,e,t,r){const i=new r;return e.forEach(a=>{const s=Yb(a.ra),c=Xb(a.dec);i.addNode(a.id,{label:a.label,x:s,y:c,magnitude:a.magnitude,size:Hb(a.magnitude),desc:{name:a.label,magnitude:a.magnitude,RA:Qb(a.ra),DEC:a.dec}})}),t.forEach(([a,s])=>{i.mergeEdge(a,s)}),i}function Qb(n){let[e=0,t=0,r=0]=n.split(" ").map(Number);r=r%60,t=t%60,e=e%24;const i=String(e).padStart(2,"0"),a=String(t).padStart(2,"0"),s=r.toFixed(1).padStart(4,"0");return[i,a,s].join(" ")}class Zb{constructor(e){this.graphManager=e,this.settings=e.settings,this.layout=e.layout,this.zodiac=new Wb(e)}empty(e){this.graphManager.graph=Yr.empty(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("circle")}complete(e){this.graphManager.graph=Yr.complete(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("circle")}ladder(e){this.graphManager.graph=Yr.ladder(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}completeBipartite(e,t){this.graphManager.graph=Yr.empty(this.graphManager.graphClass[this.settings.type],+e+ +t);for(let r=0;r<+e;r++)for(let i=+e;i<Number(e)+ +t;i++)this.graphManager.graph.addEdge(r,i);this.layout.applyLayout("twoLine",{line1Count:+e,Y:50})}cycle(e){this.graphManager.graph=Yr.path(this.graphManager.graphClass[this.settings.type],+e),this.graphManager.graph.addEdge(0,+e-1),this.layout.applyLayout("circle")}path(e){this.graphManager.graph=Yr.path(this.graphManager.graphClass[this.settings.type],+e),this.layout.applyLayout("oneLine")}caveman(e,t){this.graphManager.graph=dd.caveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.layout.applyLayout("circle")}connectedCaveman(e,t){this.graphManager.graph=dd.connectedCaveman(this.graphManager.graphClass[this.settings.type],+e,+t),this.layout.applyLayout("circle")}clusters(e,t,r){this.graphManager.graph=Ws.clusters(this.graphManager.graphClass[this.settings.type],{order:+e<2?2:+e,size:+t<2?2:+t,clusters:+r<2?2:+r}),this.layout.applyLayout("random")}erdosRenyi(e,t){this.graphManager.graph=Ws.erdosRenyi(this.graphManager.graphClass[this.settings.type],{order:+e,probability:+t>1?1:+t}),this.layout.applyLayout("circle")}girvanNewman(e){this.graphManager.graph=Ws.girvanNewman(this.graphManager.graphClass[this.settings.type],{zOut:4}),this.layout.applyLayout("circle")}krackhardtkite(){this.graphManager.graph=Nb(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("oneLine")}florentineFamilies(){this.graphManager.graph=wb(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("circle")}karateClub(){this.graphManager.graph=bb(this.graphManager.graphClass[this.settings.type]),this.layout.applyLayout("circle")}}const Md=document;class Jb{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.panel=Md.querySelector("widgets #graphs-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(r=>r.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph;this.index=e.split("-")[1];const r=t.getAttributes();if(this.selectLi(this.index),this.graphManager.metric.addNEFGInfo(r),this.graphManager.facePanel.updateFacePanel(),this.app.keyHandler.isCtrlHold()){let i=this.lis().map(a=>this.graphManager.graphs.all[a].nodes());i=new Set(i.flat()),this.graphManager.selectAllNode(i),this.graphManager.redraw({node:!0})}}selectLi(e){this.app.keyHandler.isCtrlHold()||(this.graphManager.graphs.index=this.index,this.deselectLis()),this.graphManager.graph.updateAttribute("selected",r=>!0);const t=this.ul.querySelector(`#graphs-${e}`);t&&t.classList.toggle("select")}updateGraphsPanel(){this.ul.innerHTML="",this.graphManager.graphs.all.forEach((e,t)=>{e.getAttribute("id")===void 0&&e.setAttribute("id",t),e.getAttribute("selected")||e.setAttribute("selected",!1),e.getAttribute("label")||e.setAttribute("label",`graph ${t}`);const r=Md.createElement("li");r.id=`graphs-${e.getAttribute("id")}`,r.setAttribute("name","graphs"),r.textContent=e.getAttribute("label"),this.ul.appendChild(r)})}listeners(){this.panel.addEventListener("click",e=>{e.target.id=="graphs-panel"&&this.deselectLis()})}deselectLis(){this.lis("node").forEach(e=>e.classList.remove("select")),this.graphManager.deselectAll()}}const Nd=document;class ew{constructor(e){this.app=e.app,this.eventBus=this.app.eventBus,this.graphManager=e,this.settings=e.settings,this.panel=Nd.querySelector("widgets #face-panel"),this.ul=this.panel.querySelector("ul"),this.index=0}init(){this.listeners(),this.events()}lis(e="id"){const t=this.ul.querySelectorAll("li.select");return e=="id"?[...t].map(r=>r.id.split("-")[1]):t}selectLis(e){const t=this.graphManager.graph,r=e.split("-")[1],i=t.getFaceAttributes(r);this.selectLi(r),this.graphManager.metric.addNEFGInfo(i);let a=this.lis().map(s=>t.getFaceAttribute(s,"nodes"));a=new Set(a.flat()),this.app.keyHandler.isCtrlHold()&&(this.graphManager.selectAllNode(a),this.graphManager.redraw({face:!0,node:!0}))}selectLi(e){this.app.keyHandler.isCtrlHold()||this.deselectLis(),this.graphManager.graph.selectFace(e);const t=this.ul.querySelector(`#face-${e}`);if(t&&t.classList.toggle("select"),this.settings.colorPicker){const r=this.graphManager.graph.getFaceAttribute(e,"color"),i=this.graphManager.graph.getFaceAttribute(e,"labelColor");this.app.colorPicker.setColor("face",r),this.app.colorPicker.setColor("label",i)}}updateFacePanel(){this.ul.innerHTML="";const e=this.graphManager.graph;let t=0;e.forEachFace((r,i)=>{t++,e.getFaceAttribute(r,"id")===void 0&&e.setFaceAttribute(r,"id",index),e.getFaceAttribute(r,"label")||e.setFaceAttribute(r,"label",`face ${t}`);const a=Nd.createElement("li");a.id=`face-${r}`,a.setAttribute("name","faces"),a.setAttribute("key",r),a.textContent=e.getFaceAttribute(r,"label"),this.ul.appendChild(a)})}listeners(){this.panel.addEventListener("click",e=>{e.target.id=="face-panel"&&this.deselectLis()})}events(){this.eventBus.on("key:down",e=>{[...e.detail.key].join("")})}deselectLis(){this.lis("node").forEach(e=>e.classList.remove("select")),this.graphManager.deselectAll()}}var uo={exports:{}},tw=uo.exports,Pd;function rw(){return Pd||(Pd=1,function(n,e){(function(t,r){n.exports=r()})(tw,function(){var t=function(o,u){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,b){g.__proto__=b}||function(g,b){for(var A in b)Object.prototype.hasOwnProperty.call(b,A)&&(g[A]=b[A])})(o,u)},r=function(){return(r=Object.assign||function(o){for(var u,g=1,b=arguments.length;g<b;g++)for(var A in u=arguments[g])Object.prototype.hasOwnProperty.call(u,A)&&(o[A]=u[A]);return o}).apply(this,arguments)};function i(o,u,g){for(var b,A=0,M=u.length;A<M;A++)!b&&A in u||((b=b||Array.prototype.slice.call(u,0,A))[A]=u[A]);return o.concat(b||Array.prototype.slice.call(u))}var a=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:zv,s=Object.keys,c=Array.isArray;function f(o,u){return typeof u!="object"||s(u).forEach(function(g){o[g]=u[g]}),o}typeof Promise>"u"||a.Promise||(a.Promise=Promise);var h=Object.getPrototypeOf,y={}.hasOwnProperty;function v(o,u){return y.call(o,u)}function w(o,u){typeof u=="function"&&(u=u(h(o))),(typeof Reflect>"u"?s:Reflect.ownKeys)(u).forEach(function(g){D(o,g,u[g])})}var E=Object.defineProperty;function D(o,u,g,b){E(o,u,f(g&&v(g,"get")&&typeof g.get=="function"?{get:g.get,set:g.set,configurable:!0}:{value:g,configurable:!0,writable:!0},b))}function k(o){return{from:function(u){return o.prototype=Object.create(u.prototype),D(o.prototype,"constructor",o),{extend:w.bind(null,o.prototype)}}}}var I=Object.getOwnPropertyDescriptor,P=[].slice;function C(o,u,g){return P.call(o,u,g)}function R(o,u){return u(o)}function _(o){if(!o)throw new Error("Assertion Failed")}function T(o){a.setImmediate?setImmediate(o):setTimeout(o,0)}function B(o,u){if(typeof u=="string"&&v(o,u))return o[u];if(!u)return o;if(typeof u!="string"){for(var g=[],b=0,A=u.length;b<A;++b){var M=B(o,u[b]);g.push(M)}return g}var $=u.indexOf(".");if($!==-1){var K=o[u.substr(0,$)];return K==null?void 0:B(K,u.substr($+1))}}function S(o,u,g){if(o&&u!==void 0&&!("isFrozen"in Object&&Object.isFrozen(o)))if(typeof u!="string"&&"length"in u){_(typeof g!="string"&&"length"in g);for(var b=0,A=u.length;b<A;++b)S(o,u[b],g[b])}else{var M,$,K=u.indexOf(".");K!==-1?(M=u.substr(0,K),($=u.substr(K+1))===""?g===void 0?c(o)&&!isNaN(parseInt(M))?o.splice(M,1):delete o[M]:o[M]=g:S(K=!(K=o[M])||!v(o,M)?o[M]={}:K,$,g)):g===void 0?c(o)&&!isNaN(parseInt(u))?o.splice(u,1):delete o[u]:o[u]=g}}function z(o){var u,g={};for(u in o)v(o,u)&&(g[u]=o[u]);return g}var G=[].concat;function F(o){return G.apply([],o)}var st="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(F([8,16,32,64].map(function(o){return["Int","Uint","Float"].map(function(u){return u+o+"Array"})}))).filter(function(o){return a[o]}),U=new Set(st.map(function(o){return a[o]})),V=null;function j(o){return V=new WeakMap,o=function u(g){if(!g||typeof g!="object")return g;var b=V.get(g);if(b)return b;if(c(g)){b=[],V.set(g,b);for(var A=0,M=g.length;A<M;++A)b.push(u(g[A]))}else if(U.has(g.constructor))b=g;else{var $,K=h(g);for($ in b=K===Object.prototype?{}:Object.create(K),V.set(g,b),g)v(g,$)&&(b[$]=u(g[$]))}return b}(o),V=null,o}var ye={}.toString;function fe(o){return ye.call(o).slice(8,-1)}var Y=typeof Symbol<"u"?Symbol.iterator:"@@iterator",O=typeof Y=="symbol"?function(o){var u;return o!=null&&(u=o[Y])&&u.apply(o)}:function(){return null};function J(o,u){return u=o.indexOf(u),0<=u&&o.splice(u,1),0<=u}var ee={};function ce(o){var u,g,b,A;if(arguments.length===1){if(c(o))return o.slice();if(this===ee&&typeof o=="string")return[o];if(A=O(o)){for(g=[];!(b=A.next()).done;)g.push(b.value);return g}if(o==null)return[o];if(typeof(u=o.length)!="number")return[o];for(g=new Array(u);u--;)g[u]=o[u];return g}for(u=arguments.length,g=new Array(u);u--;)g[u]=arguments[u];return g}var oe=typeof Symbol<"u"?function(o){return o[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},_t=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],d=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(_t),le={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(o,u){this.name=o,this.message=u}function me(o,u){return o+". Errors: "+Object.keys(u).map(function(g){return u[g].toString()}).filter(function(g,b,A){return A.indexOf(g)===b}).join(`
`)}function _e(o,u,g,b){this.failures=u,this.failedKeys=b,this.successCount=g,this.message=me(o,u)}function Me(o,u){this.name="BulkError",this.failures=Object.keys(u).map(function(g){return u[g]}),this.failuresByPos=u,this.message=me(o,this.failures)}k(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),k(_e).from(se),k(Me).from(se);var Oe=d.reduce(function(o,u){return o[u]=u+"Error",o},{}),Fe=se,de=d.reduce(function(o,u){var g=u+"Error";function b(A,M){this.name=g,A?typeof A=="string"?(this.message="".concat(A).concat(M?`
 `+M:""),this.inner=M||null):typeof A=="object"&&(this.message="".concat(A.name," ").concat(A.message),this.inner=A):(this.message=le[u]||g,this.inner=null)}return k(b).from(Fe),o[u]=b,o},{});de.Syntax=SyntaxError,de.Type=TypeError,de.Range=RangeError;var Ne=_t.reduce(function(o,u){return o[u+"Error"]=de[u],o},{}),Re=d.reduce(function(o,u){return["Syntax","Type","Range"].indexOf(u)===-1&&(o[u+"Error"]=de[u]),o},{});function ke(){}function Ke(o){return o}function Le(o,u){return o==null||o===Ke?u:function(g){return u(o(g))}}function Ee(o,u){return function(){o.apply(this,arguments),u.apply(this,arguments)}}function pe(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);g!==void 0&&(arguments[0]=g);var b=this.onsuccess,A=this.onerror;this.onsuccess=null,this.onerror=null;var M=u.apply(this,arguments);return b&&(this.onsuccess=this.onsuccess?Ee(b,this.onsuccess):b),A&&(this.onerror=this.onerror?Ee(A,this.onerror):A),M!==void 0?M:g}}function vt(o,u){return o===ke?u:function(){o.apply(this,arguments);var g=this.onsuccess,b=this.onerror;this.onsuccess=this.onerror=null,u.apply(this,arguments),g&&(this.onsuccess=this.onsuccess?Ee(g,this.onsuccess):g),b&&(this.onerror=this.onerror?Ee(b,this.onerror):b)}}function it(o,u){return o===ke?u:function(g){var b=o.apply(this,arguments);f(g,b);var A=this.onsuccess,M=this.onerror;return this.onsuccess=null,this.onerror=null,g=u.apply(this,arguments),A&&(this.onsuccess=this.onsuccess?Ee(A,this.onsuccess):A),M&&(this.onerror=this.onerror?Ee(M,this.onerror):M),b===void 0?g===void 0?void 0:g:f(b,g)}}function xt(o,u){return o===ke?u:function(){return u.apply(this,arguments)!==!1&&o.apply(this,arguments)}}function at(o,u){return o===ke?u:function(){var g=o.apply(this,arguments);if(g&&typeof g.then=="function"){for(var b=this,A=arguments.length,M=new Array(A);A--;)M[A]=arguments[A];return g.then(function(){return u.apply(b,M)})}return u.apply(this,arguments)}}Re.ModifyError=_e,Re.DexieError=se,Re.BulkError=Me;var Ve=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ht(o){Ve=o}var ot={},gt=100,st=typeof Promise>"u"?[]:function(){var o=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[o,h(o),o];var u=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[u,h(u),o]}(),_t=st[0],d=st[1],st=st[2],d=d&&d.then,ut=_t&&_t.constructor,ft=!!st,rt=function(o,u){xr.push([o,u]),mt&&(queueMicrotask(va),mt=!1)},St=!0,mt=!0,Ot=[],or=[],Jr=Ke,Tt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ke,pgp:!1,env:{},finalize:ke},ze=Tt,xr=[],bt=0,At=[];function Se(o){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var u=this._PSD=ze;if(typeof o!="function"){if(o!==ot)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&en(this,this._value))}this._state=null,this._value=null,++u.ref,function g(b,A){try{A(function(M){if(b._state===null){if(M===b)throw new TypeError("A promise cannot be resolved with itself.");var $=b._lib&&rn();M&&typeof M.then=="function"?g(b,function(K,H){M instanceof Se?M._then(K,H):M.then(K,H)}):(b._state=!0,b._value=M,tn(b)),$&&_r()}},en.bind(null,b))}catch(M){en(b,M)}}(this,o)}var sr={get:function(){var o=ze,u=Kn;function g(b,A){var M=this,$=!o.global&&(o!==ze||u!==Kn),K=$&&!Ge(),H=new Se(function(Q,te){yn(M,new qr(Wn(b,o,$,K),Wn(A,o,$,K),Q,te,o))});return this._consoleTask&&(H._consoleTask=this._consoleTask),H}return g.prototype=ot,g},set:function(o){D(this,"then",o&&o.prototype===ot?sr:{get:function(){return o},set:sr.set})}};function qr(o,u,g,b,A){this.onFulfilled=typeof o=="function"?o:null,this.onRejected=typeof u=="function"?u:null,this.resolve=g,this.reject=b,this.psd=A}function en(o,u){var g,b;or.push(u),o._state===null&&(g=o._lib&&rn(),u=Jr(u),o._state=!1,o._value=u,b=o,Ot.some(function(A){return A._value===b._value})||Ot.push(b),tn(o),g&&_r())}function tn(o){var u=o._listeners;o._listeners=[];for(var g=0,b=u.length;g<b;++g)yn(o,u[g]);var A=o._PSD;--A.ref||A.finalize(),bt===0&&(++bt,rt(function(){--bt==0&&vn()},[]))}function yn(o,u){if(o._state!==null){var g=o._state?u.onFulfilled:u.onRejected;if(g===null)return(o._state?u.resolve:u.reject)(o._value);++u.psd.ref,++bt,rt(ya,[g,o,u])}else o._listeners.push(u)}function ya(o,u,g){try{var b,A=u._value;!u._state&&or.length&&(or=[]),b=Ve&&u._consoleTask?u._consoleTask.run(function(){return o(A)}):o(A),u._state||or.indexOf(A)!==-1||function(M){for(var $=Ot.length;$;)if(Ot[--$]._value===M._value)return Ot.splice($,1)}(u),g.resolve(b)}catch(M){g.reject(M)}finally{--bt==0&&vn(),--g.psd.ref||g.psd.finalize()}}function va(){Kt(Tt,function(){rn()&&_r()})}function rn(){var o=St;return mt=St=!1,o}function _r(){var o,u,g;do for(;0<xr.length;)for(o=xr,xr=[],g=o.length,u=0;u<g;++u){var b=o[u];b[0].apply(null,b[1])}while(0<xr.length);mt=St=!0}function vn(){var o=Ot;Ot=[],o.forEach(function(b){b._PSD.onunhandled.call(null,b._value,b)});for(var u=At.slice(0),g=u.length;g;)u[--g]()}function Un(o){return new Se(ot,!1,o)}function Je(o,u){var g=ze;return function(){var b=rn(),A=ze;try{return Sr(g,!0),o.apply(this,arguments)}catch(M){u&&u(M)}finally{Sr(A,!1),b&&_r()}}}w(Se.prototype,{then:sr,_then:function(o,u){yn(this,new qr(null,null,o,u,ze))},catch:function(o){if(arguments.length===1)return this.then(null,o);var u=o,g=arguments[1];return typeof u=="function"?this.then(null,function(b){return(b instanceof u?g:Un)(b)}):this.then(null,function(b){return(b&&b.name===u?g:Un)(b)})},finally:function(o){return this.then(function(u){return Se.resolve(o()).then(function(){return u})},function(u){return Se.resolve(o()).then(function(){return Un(u)})})},timeout:function(o,u){var g=this;return o<1/0?new Se(function(b,A){var M=setTimeout(function(){return A(new de.Timeout(u))},o);g.then(b,A).finally(clearTimeout.bind(null,M))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&D(Se.prototype,Symbol.toStringTag,"Dexie.Promise"),Tt.env=ba(),w(Se,{all:function(){var o=ce.apply(null,arguments).map(mn);return new Se(function(u,g){o.length===0&&u([]);var b=o.length;o.forEach(function(A,M){return Se.resolve(A).then(function($){o[M]=$,--b||u(o)},g)})})},resolve:function(o){return o instanceof Se?o:o&&typeof o.then=="function"?new Se(function(u,g){o.then(u,g)}):new Se(ot,!0,o)},reject:Un,race:function(){var o=ce.apply(null,arguments).map(mn);return new Se(function(u,g){o.map(function(b){return Se.resolve(b).then(u,g)})})},PSD:{get:function(){return ze},set:function(o){return ze=o}},totalEchoes:{get:function(){return Kn}},newPSD:cr,usePSD:Kt,scheduler:{get:function(){return rt},set:function(o){rt=o}},rejectionMapper:{get:function(){return Jr},set:function(o){Jr=o}},follow:function(o,u){return new Se(function(g,b){return cr(function(A,M){var $=ze;$.unhandleds=[],$.onunhandled=M,$.finalize=Ee(function(){var K,H=this;K=function(){H.unhandleds.length===0?A():M(H.unhandleds[0])},At.push(function Q(){K(),At.splice(At.indexOf(Q),1)}),++bt,rt(function(){--bt==0&&vn()},[])},$.finalize),o()},u,g,b)})}}),ut&&(ut.allSettled&&D(Se,"allSettled",function(){var o=ce.apply(null,arguments).map(mn);return new Se(function(u){o.length===0&&u([]);var g=o.length,b=new Array(g);o.forEach(function(A,M){return Se.resolve(A).then(function($){return b[M]={status:"fulfilled",value:$}},function($){return b[M]={status:"rejected",reason:$}}).then(function(){return--g||u(b)})})})}),ut.any&&typeof AggregateError<"u"&&D(Se,"any",function(){var o=ce.apply(null,arguments).map(mn);return new Se(function(u,g){o.length===0&&g(new AggregateError([]));var b=o.length,A=new Array(b);o.forEach(function(M,$){return Se.resolve(M).then(function(K){return u(K)},function(K){A[$]=K,--b||g(new AggregateError(A))})})})}),ut.withResolvers&&(Se.withResolvers=ut.withResolvers));var ct={awaits:0,echoes:0,id:0},ur=0,Qt=[],jt=0,Kn=0,ko=0;function cr(o,u,g,b){var A=ze,M=Object.create(A);return M.parent=A,M.ref=0,M.global=!1,M.id=++ko,Tt.env,M.env=ft?{Promise:Se,PromiseProp:{value:Se,configurable:!0,writable:!0},all:Se.all,race:Se.race,allSettled:Se.allSettled,any:Se.any,resolve:Se.resolve,reject:Se.reject}:{},u&&f(M,u),++A.ref,M.finalize=function(){--this.parent.ref||this.parent.finalize()},b=Kt(M,o,g,b),M.ref===0&&M.finalize(),b}function Rt(){return ct.id||(ct.id=++ur),++ct.awaits,ct.echoes+=gt,ct.id}function Ge(){return!!ct.awaits&&(--ct.awaits==0&&(ct.id=0),ct.echoes=ct.awaits*gt,!0)}function mn(o){return ct.echoes&&o&&o.constructor===ut?(Rt(),o.then(function(u){return Ge(),u},function(u){return Ge(),et(u)})):o}function ma(){var o=Qt[Qt.length-1];Qt.pop(),Sr(o,!1)}function Sr(o,u){var g,b=ze;(u?!ct.echoes||jt++&&o===ze:!jt||--jt&&o===ze)||queueMicrotask(u?(function(A){++Kn,ct.echoes&&--ct.echoes!=0||(ct.echoes=ct.awaits=ct.id=0),Qt.push(ze),Sr(A,!0)}).bind(null,o):ma),o!==ze&&(ze=o,b===Tt&&(Tt.env=ba()),ft&&(g=Tt.env.Promise,u=o.env,(b.global||o.global)&&(Object.defineProperty(a,"Promise",u.PromiseProp),g.all=u.all,g.race=u.race,g.resolve=u.resolve,g.reject=u.reject,u.allSettled&&(g.allSettled=u.allSettled),u.any&&(g.any=u.any))))}function ba(){var o=a.Promise;return ft?{Promise:o,PromiseProp:Object.getOwnPropertyDescriptor(a,"Promise"),all:o.all,race:o.race,allSettled:o.allSettled,any:o.any,resolve:o.resolve,reject:o.reject}:{}}function Kt(o,u,g,b,A){var M=ze;try{return Sr(o,!0),u(g,b,A)}finally{Sr(M,!1)}}function Wn(o,u,g,b){return typeof o!="function"?o:function(){var A=ze;g&&Rt(),Sr(u,!0);try{return o.apply(this,arguments)}finally{Sr(A,!1),b&&queueMicrotask(Ge)}}}function Ai(o){Promise===ut&&ct.echoes===0?jt===0?o():enqueueNativeMicroTask(o):setTimeout(o,0)}(""+d).indexOf("[native code]")===-1&&(Rt=Ge=ke);var et=Se.reject,Fr="￿",Zt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wa="String expected.",jr=[],bn="__dbnames",nn="readonly",Hn="readwrite";function lr(o,u){return o?u?function(){return o.apply(this,arguments)&&u.apply(this,arguments)}:o:u}var ki={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Yn(o){return typeof o!="string"||/\./.test(o)?function(u){return u}:function(u){return u[o]===void 0&&o in u&&delete(u=j(u))[o],u}}function Xn(){throw de.Type()}function Ye(o,u){try{var g=Vn(o),b=Vn(u);if(g!==b)return g==="Array"?1:b==="Array"?-1:g==="binary"?1:b==="binary"?-1:g==="string"?1:b==="string"?-1:g==="Date"?1:b!=="Date"?NaN:-1;switch(g){case"number":case"Date":case"string":return u<o?1:o<u?-1:0;case"binary":return function(A,M){for(var $=A.length,K=M.length,H=$<K?$:K,Q=0;Q<H;++Q)if(A[Q]!==M[Q])return A[Q]<M[Q]?-1:1;return $===K?0:$<K?-1:1}(Ea(o),Ea(u));case"Array":return function(A,M){for(var $=A.length,K=M.length,H=$<K?$:K,Q=0;Q<H;++Q){var te=Ye(A[Q],M[Q]);if(te!==0)return te}return $===K?0:$<K?-1:1}(o,u)}}catch{}return NaN}function Vn(o){var u=typeof o;return u!="object"?u:ArrayBuffer.isView(o)?"binary":(o=fe(o),o==="ArrayBuffer"?"binary":o)}function Ea(o){return o instanceof Uint8Array?o:ArrayBuffer.isView(o)?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o)}var xa=(Ze.prototype._trans=function(o,u,g){var b=this._tx||ze.trans,A=this.name,M=Ve&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(o==="readonly"?"read":"write"," ").concat(this.name));function $(Q,te,X){if(!X.schema[A])throw new de.NotFound("Table "+A+" not part of transaction");return u(X.idbtrans,X)}var K=rn();try{var H=b&&b.db._novip===this.db._novip?b===ze.trans?b._promise(o,$,g):cr(function(){return b._promise(o,$,g)},{trans:b,transless:ze.transless||ze}):function Q(te,X,re,Z){if(te.idbdb&&(te._state.openComplete||ze.letThrough||te._vip)){var ie=te._createTransaction(X,re,te._dbSchema);try{ie.create(),te._state.PR1398_maxLoop=3}catch(ae){return ae.name===Oe.InvalidState&&te.isOpen()&&0<--te._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),te.close({disableAutoOpen:!1}),te.open().then(function(){return Q(te,X,re,Z)})):et(ae)}return ie._promise(X,function(ae,ne){return cr(function(){return ze.trans=ie,Z(ae,ne,ie)})}).then(function(ae){if(X==="readwrite")try{ie.idbtrans.commit()}catch{}return X==="readonly"?ae:ie._completion.then(function(){return ae})})}if(te._state.openComplete)return et(new de.DatabaseClosed(te._state.dbOpenError));if(!te._state.isBeingOpened){if(!te._state.autoOpen)return et(new de.DatabaseClosed);te.open().catch(ke)}return te._state.dbReadyPromise.then(function(){return Q(te,X,re,Z)})}(this.db,o,[this.name],$);return M&&(H._consoleTask=M,H=H.catch(function(Q){return console.trace(Q),et(Q)})),H}finally{K&&_r()}},Ze.prototype.get=function(o,u){var g=this;return o&&o.constructor===Object?this.where(o).first(u):o==null?et(new de.Type("Invalid argument to Table.get()")):this._trans("readonly",function(b){return g.core.get({trans:b,key:o}).then(function(A){return g.hook.reading.fire(A)})}).then(u)},Ze.prototype.where=function(o){if(typeof o=="string")return new this.db.WhereClause(this,o);if(c(o))return new this.db.WhereClause(this,"[".concat(o.join("+"),"]"));var u=s(o);if(u.length===1)return this.where(u[0]).equals(o[u[0]]);var g=this.schema.indexes.concat(this.schema.primKey).filter(function(K){if(K.compound&&u.every(function(Q){return 0<=K.keyPath.indexOf(Q)})){for(var H=0;H<u.length;++H)if(u.indexOf(K.keyPath[H])===-1)return!1;return!0}return!1}).sort(function(K,H){return K.keyPath.length-H.keyPath.length})[0];if(g&&this.db._maxKey!==Fr){var M=g.keyPath.slice(0,u.length);return this.where(M).equals(M.map(function(H){return o[H]}))}!g&&Ve&&console.warn("The query ".concat(JSON.stringify(o)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(u.join("+"),"]"));var b=this.schema.idxByName;function A(K,H){return Ye(K,H)===0}var $=u.reduce(function(X,H){var Q=X[0],te=X[1],X=b[H],re=o[H];return[Q||X,Q||!X?lr(te,X&&X.multi?function(Z){return Z=B(Z,H),c(Z)&&Z.some(function(ie){return A(re,ie)})}:function(Z){return A(re,B(Z,H))}):te]},[null,null]),M=$[0],$=$[1];return M?this.where(M.name).equals(o[M.keyPath]).filter($):g?this.filter($):this.where(u).equals("")},Ze.prototype.filter=function(o){return this.toCollection().and(o)},Ze.prototype.count=function(o){return this.toCollection().count(o)},Ze.prototype.offset=function(o){return this.toCollection().offset(o)},Ze.prototype.limit=function(o){return this.toCollection().limit(o)},Ze.prototype.each=function(o){return this.toCollection().each(o)},Ze.prototype.toArray=function(o){return this.toCollection().toArray(o)},Ze.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ze.prototype.orderBy=function(o){return new this.db.Collection(new this.db.WhereClause(this,c(o)?"[".concat(o.join("+"),"]"):o))},Ze.prototype.reverse=function(){return this.toCollection().reverse()},Ze.prototype.mapToClass=function(o){var u,g=this.db,b=this.name;function A(){return u!==null&&u.apply(this,arguments)||this}(this.schema.mappedClass=o).prototype instanceof Xn&&(function(H,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Class extends value "+String(Q)+" is not a constructor or null");function te(){this.constructor=H}t(H,Q),H.prototype=Q===null?Object.create(Q):(te.prototype=Q.prototype,new te)}(A,u=o),Object.defineProperty(A.prototype,"db",{get:function(){return g},enumerable:!1,configurable:!0}),A.prototype.table=function(){return b},o=A);for(var M=new Set,$=o.prototype;$;$=h($))Object.getOwnPropertyNames($).forEach(function(H){return M.add(H)});function K(H){if(!H)return H;var Q,te=Object.create(o.prototype);for(Q in H)if(!M.has(Q))try{te[Q]=H[Q]}catch{}return te}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=K,this.hook("reading",K),o},Ze.prototype.defineClass=function(){return this.mapToClass(function(o){f(this,o)})},Ze.prototype.add=function(o,u){var g=this,b=this.schema.primKey,A=b.auto,M=b.keyPath,$=o;return M&&A&&($=Yn(M)(o)),this._trans("readwrite",function(K){return g.core.mutate({trans:K,type:"add",keys:u!=null?[u]:null,values:[$]})}).then(function(K){return K.numFailures?Se.reject(K.failures[0]):K.lastResult}).then(function(K){if(M)try{S(o,M,K)}catch{}return K})},Ze.prototype.update=function(o,u){return typeof o!="object"||c(o)?this.where(":id").equals(o).modify(u):(o=B(o,this.schema.primKey.keyPath),o===void 0?et(new de.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(u))},Ze.prototype.put=function(o,u){var g=this,b=this.schema.primKey,A=b.auto,M=b.keyPath,$=o;return M&&A&&($=Yn(M)(o)),this._trans("readwrite",function(K){return g.core.mutate({trans:K,type:"put",values:[$],keys:u!=null?[u]:null})}).then(function(K){return K.numFailures?Se.reject(K.failures[0]):K.lastResult}).then(function(K){if(M)try{S(o,M,K)}catch{}return K})},Ze.prototype.delete=function(o){var u=this;return this._trans("readwrite",function(g){return u.core.mutate({trans:g,type:"delete",keys:[o]})}).then(function(g){return g.numFailures?Se.reject(g.failures[0]):void 0})},Ze.prototype.clear=function(){var o=this;return this._trans("readwrite",function(u){return o.core.mutate({trans:u,type:"deleteRange",range:ki})}).then(function(u){return u.numFailures?Se.reject(u.failures[0]):void 0})},Ze.prototype.bulkGet=function(o){var u=this;return this._trans("readonly",function(g){return u.core.getMany({keys:o,trans:g}).then(function(b){return b.map(function(A){return u.hook.reading.fire(A)})})})},Ze.prototype.bulkAdd=function(o,u,g){var b=this,A=Array.isArray(u)?u:void 0,M=(g=g||(A?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function($){var Q=b.schema.primKey,K=Q.auto,Q=Q.keyPath;if(Q&&A)throw new de.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(A&&A.length!==o.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,Q=Q&&K?o.map(Yn(Q)):o;return b.core.mutate({trans:$,type:"add",keys:A,values:Q,wantResults:M}).then(function(ie){var X=ie.numFailures,re=ie.results,Z=ie.lastResult,ie=ie.failures;if(X===0)return M?re:Z;throw new Me("".concat(b.name,".bulkAdd(): ").concat(X," of ").concat(H," operations failed"),ie)})})},Ze.prototype.bulkPut=function(o,u,g){var b=this,A=Array.isArray(u)?u:void 0,M=(g=g||(A?void 0:u))?g.allKeys:void 0;return this._trans("readwrite",function($){var Q=b.schema.primKey,K=Q.auto,Q=Q.keyPath;if(Q&&A)throw new de.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(A&&A.length!==o.length)throw new de.InvalidArgument("Arguments objects and keys must have the same length");var H=o.length,Q=Q&&K?o.map(Yn(Q)):o;return b.core.mutate({trans:$,type:"put",keys:A,values:Q,wantResults:M}).then(function(ie){var X=ie.numFailures,re=ie.results,Z=ie.lastResult,ie=ie.failures;if(X===0)return M?re:Z;throw new Me("".concat(b.name,".bulkPut(): ").concat(X," of ").concat(H," operations failed"),ie)})})},Ze.prototype.bulkUpdate=function(o){var u=this,g=this.core,b=o.map(function($){return $.key}),A=o.map(function($){return $.changes}),M=[];return this._trans("readwrite",function($){return g.getMany({trans:$,keys:b,cache:"clone"}).then(function(K){var H=[],Q=[];o.forEach(function(X,re){var Z=X.key,ie=X.changes,ae=K[re];if(ae){for(var ne=0,ue=Object.keys(ie);ne<ue.length;ne++){var he=ue[ne],ge=ie[he];if(he===u.schema.primKey.keyPath){if(Ye(ge,Z)!==0)throw new de.Constraint("Cannot update primary key in bulkUpdate()")}else S(ae,he,ge)}M.push(re),H.push(Z),Q.push(ae)}});var te=H.length;return g.mutate({trans:$,type:"put",keys:H,values:Q,updates:{keys:b,changeSpecs:A}}).then(function(X){var re=X.numFailures,Z=X.failures;if(re===0)return te;for(var ie=0,ae=Object.keys(Z);ie<ae.length;ie++){var ne,ue=ae[ie],he=M[Number(ue)];he!=null&&(ne=Z[ue],delete Z[ue],Z[he]=ne)}throw new Me("".concat(u.name,".bulkUpdate(): ").concat(re," of ").concat(te," operations failed"),Z)})})})},Ze.prototype.bulkDelete=function(o){var u=this,g=o.length;return this._trans("readwrite",function(b){return u.core.mutate({trans:b,type:"delete",keys:o})}).then(function($){var A=$.numFailures,M=$.lastResult,$=$.failures;if(A===0)return M;throw new Me("".concat(u.name,".bulkDelete(): ").concat(A," of ").concat(g," operations failed"),$)})},Ze);function Ze(){}function wn(o){function u($,K){if(K){for(var H=arguments.length,Q=new Array(H-1);--H;)Q[H-1]=arguments[H];return g[$].subscribe.apply(null,Q),o}if(typeof $=="string")return g[$]}var g={};u.addEventType=M;for(var b=1,A=arguments.length;b<A;++b)M(arguments[b]);return u;function M($,K,H){if(typeof $!="object"){var Q;K=K||xt;var te={subscribers:[],fire:H=H||ke,subscribe:function(X){te.subscribers.indexOf(X)===-1&&(te.subscribers.push(X),te.fire=K(te.fire,X))},unsubscribe:function(X){te.subscribers=te.subscribers.filter(function(re){return re!==X}),te.fire=te.subscribers.reduce(K,H)}};return g[$]=u[$]=te}s(Q=$).forEach(function(X){var re=Q[X];if(c(re))M(X,Q[X][0],Q[X][1]);else{if(re!=="asap")throw new de.InvalidArgument("Invalid event config");var Z=M(X,Ke,function(){for(var ie=arguments.length,ae=new Array(ie);ie--;)ae[ie]=arguments[ie];Z.subscribers.forEach(function(ne){T(function(){ne.apply(null,ae)})})})}})}}function En(o,u){return k(u).from({prototype:o}),u}function Br(o,u){return!(o.filter||o.algorithm||o.or)&&(u?o.justLimit:!o.replayFilter)}function an(o,u){o.filter=lr(o.filter,u)}function Ar(o,u,g){var b=o.replayFilter;o.replayFilter=b?function(){return lr(b(),u())}:u,o.justLimit=g&&!b}function on(o,u){if(o.isPrimKey)return u.primaryKey;var g=u.getIndexByKeyPath(o.index);if(!g)throw new de.Schema("KeyPath "+o.index+" on object store "+u.name+" is not indexed");return g}function xn(o,u,g){var b=on(o,u.schema);return u.openCursor({trans:g,values:!o.keysOnly,reverse:o.dir==="prev",unique:!!o.unique,query:{index:b,range:o.range}})}function Wt(o,u,g,b){var A=o.replayFilter?lr(o.filter,o.replayFilter()):o.filter;if(o.or){var M={},$=function(K,H,Q){var te,X;A&&!A(H,Q,function(re){return H.stop(re)},function(re){return H.fail(re)})||((X=""+(te=H.primaryKey))=="[object ArrayBuffer]"&&(X=""+new Uint8Array(te)),v(M,X)||(M[X]=!0,u(K,H,Q)))};return Promise.all([o.or._iterate($,g),sn(xn(o,b,g),o.algorithm,$,!o.keysOnly&&o.valueMapper)])}return sn(xn(o,b,g),lr(o.algorithm,A),u,!o.keysOnly&&o.valueMapper)}function sn(o,u,g,b){var A=Je(b?function(M,$,K){return g(b(M),$,K)}:g);return o.then(function(M){if(M)return M.start(function(){var $=function(){return M.continue()};u&&!u(M,function(K){return $=K},function(K){M.stop(K),$=ke},function(K){M.fail(K),$=ke})||A(M.value,M,function(K){return $=K}),$()})})}var _n=(Di.prototype.execute=function(o){var u=this["@@propmod"];if(u.add!==void 0){var g=u.add;if(c(g))return i(i([],c(o)?o:[],!0),g).sort();if(typeof g=="number")return(Number(o)||0)+g;if(typeof g=="bigint")try{return BigInt(o)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(u.remove!==void 0){var b=u.remove;if(c(b))return c(o)?o.filter(function(A){return!b.includes(A)}).sort():[];if(typeof b=="number")return Number(o)-b;if(typeof b=="bigint")try{return BigInt(o)-b}catch{return BigInt(0)-b}throw new TypeError("Invalid subtrahend ".concat(b))}return g=(g=u.replacePrefix)===null||g===void 0?void 0:g[0],g&&typeof o=="string"&&o.startsWith(g)?u.replacePrefix[1]+o.substring(g.length):o},Di);function Di(o){this["@@propmod"]=o}var _a=(Xe.prototype._read=function(o,u){var g=this._ctx;return g.error?g.table._trans(null,et.bind(null,g.error)):g.table._trans("readonly",o).then(u)},Xe.prototype._write=function(o){var u=this._ctx;return u.error?u.table._trans(null,et.bind(null,u.error)):u.table._trans("readwrite",o,"locked")},Xe.prototype._addAlgorithm=function(o){var u=this._ctx;u.algorithm=lr(u.algorithm,o)},Xe.prototype._iterate=function(o,u){return Wt(this._ctx,o,u,this._ctx.table.core)},Xe.prototype.clone=function(o){var u=Object.create(this.constructor.prototype),g=Object.create(this._ctx);return o&&f(g,o),u._ctx=g,u},Xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},Xe.prototype.each=function(o){var u=this._ctx;return this._read(function(g){return Wt(u,o,g,u.table.core)})},Xe.prototype.count=function(o){var u=this;return this._read(function(g){var b=u._ctx,A=b.table.core;if(Br(b,!0))return A.count({trans:g,query:{index:on(b,A.schema),range:b.range}}).then(function($){return Math.min($,b.limit)});var M=0;return Wt(b,function(){return++M,!1},g,A).then(function(){return M})}).then(o)},Xe.prototype.sortBy=function(o,u){var g=o.split(".").reverse(),b=g[0],A=g.length-1;function M(H,Q){return Q?M(H[g[Q]],Q-1):H[b]}var $=this._ctx.dir==="next"?1:-1;function K(H,Q){return Ye(M(H,A),M(Q,A))*$}return this.toArray(function(H){return H.sort(K)}).then(u)},Xe.prototype.toArray=function(o){var u=this;return this._read(function(g){var b=u._ctx;if(b.dir==="next"&&Br(b,!0)&&0<b.limit){var A=b.valueMapper,M=on(b,b.table.core.schema);return b.table.core.query({trans:g,limit:b.limit,values:!0,query:{index:M,range:b.range}}).then(function(K){return K=K.result,A?K.map(A):K})}var $=[];return Wt(b,function(K){return $.push(K)},g,b.table.core).then(function(){return $})},o)},Xe.prototype.offset=function(o){var u=this._ctx;return o<=0||(u.offset+=o,Br(u)?Ar(u,function(){var g=o;return function(b,A){return g===0||(g===1?--g:A(function(){b.advance(g),g=0}),!1)}}):Ar(u,function(){var g=o;return function(){return--g<0}})),this},Xe.prototype.limit=function(o){return this._ctx.limit=Math.min(this._ctx.limit,o),Ar(this._ctx,function(){var u=o;return function(g,b,A){return--u<=0&&b(A),0<=u}},!0),this},Xe.prototype.until=function(o,u){return an(this._ctx,function(g,b,A){return!o(g.value)||(b(A),u)}),this},Xe.prototype.first=function(o){return this.limit(1).toArray(function(u){return u[0]}).then(o)},Xe.prototype.last=function(o){return this.reverse().first(o)},Xe.prototype.filter=function(o){var u;return an(this._ctx,function(g){return o(g.value)}),(u=this._ctx).isMatch=lr(u.isMatch,o),this},Xe.prototype.and=function(o){return this.filter(o)},Xe.prototype.or=function(o){return new this.db.WhereClause(this._ctx.table,o,this)},Xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Xe.prototype.desc=function(){return this.reverse()},Xe.prototype.eachKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,b){o(b.key,b)})},Xe.prototype.eachUniqueKey=function(o){return this._ctx.unique="unique",this.eachKey(o)},Xe.prototype.eachPrimaryKey=function(o){var u=this._ctx;return u.keysOnly=!u.isMatch,this.each(function(g,b){o(b.primaryKey,b)})},Xe.prototype.keys=function(o){var u=this._ctx;u.keysOnly=!u.isMatch;var g=[];return this.each(function(b,A){g.push(A.key)}).then(function(){return g}).then(o)},Xe.prototype.primaryKeys=function(o){var u=this._ctx;if(u.dir==="next"&&Br(u,!0)&&0<u.limit)return this._read(function(b){var A=on(u,u.table.core.schema);return u.table.core.query({trans:b,values:!1,limit:u.limit,query:{index:A,range:u.range}})}).then(function(b){return b.result}).then(o);u.keysOnly=!u.isMatch;var g=[];return this.each(function(b,A){g.push(A.primaryKey)}).then(function(){return g}).then(o)},Xe.prototype.uniqueKeys=function(o){return this._ctx.unique="unique",this.keys(o)},Xe.prototype.firstKey=function(o){return this.limit(1).keys(function(u){return u[0]}).then(o)},Xe.prototype.lastKey=function(o){return this.reverse().firstKey(o)},Xe.prototype.distinct=function(){var o=this._ctx,o=o.index&&o.table.schema.idxByName[o.index];if(!o||!o.multi)return this;var u={};return an(this._ctx,function(A){var b=A.primaryKey.toString(),A=v(u,b);return u[b]=!0,!A}),this},Xe.prototype.modify=function(o){var u=this,g=this._ctx;return this._write(function(b){var A,M,$;$=typeof o=="function"?o:(A=s(o),M=A.length,function(ne){for(var ue=!1,he=0;he<M;++he){var ge=A[he],ve=o[ge],be=B(ne,ge);ve instanceof _n?(S(ne,ge,ve.execute(be)),ue=!0):be!==ve&&(S(ne,ge,ve),ue=!0)}return ue});var K=g.table.core,X=K.schema.primaryKey,H=X.outbound,Q=X.extractKey,te=200,X=u.db._options.modifyChunkSize;X&&(te=typeof X=="object"?X[K.name]||X["*"]||200:X);function re(ne,ge){var he=ge.failures,ge=ge.numFailures;ie+=ne-ge;for(var ve=0,be=s(he);ve<be.length;ve++){var Ce=be[ve];Z.push(he[Ce])}}var Z=[],ie=0,ae=[];return u.clone().primaryKeys().then(function(ne){function ue(ge){var ve=Math.min(te,ne.length-ge);return K.getMany({trans:b,keys:ne.slice(ge,ge+ve),cache:"immutable"}).then(function(be){for(var Ce=[],we=[],xe=H?[]:null,Ie=[],De=0;De<ve;++De){var Te=be[De],Ue={value:j(Te),primKey:ne[ge+De]};$.call(Ue,Ue.value,Ue)!==!1&&(Ue.value==null?Ie.push(ne[ge+De]):H||Ye(Q(Te),Q(Ue.value))===0?(we.push(Ue.value),H&&xe.push(ne[ge+De])):(Ie.push(ne[ge+De]),Ce.push(Ue.value)))}return Promise.resolve(0<Ce.length&&K.mutate({trans:b,type:"add",values:Ce}).then(function(We){for(var He in We.failures)Ie.splice(parseInt(He),1);re(Ce.length,We)})).then(function(){return(0<we.length||he&&typeof o=="object")&&K.mutate({trans:b,type:"put",keys:xe,values:we,criteria:he,changeSpec:typeof o!="function"&&o,isAdditionalChunk:0<ge}).then(function(We){return re(we.length,We)})}).then(function(){return(0<Ie.length||he&&o===Ci)&&K.mutate({trans:b,type:"delete",keys:Ie,criteria:he,isAdditionalChunk:0<ge}).then(function(We){return re(Ie.length,We)})}).then(function(){return ne.length>ge+ve&&ue(ge+te)})})}var he=Br(g)&&g.limit===1/0&&(typeof o!="function"||o===Ci)&&{index:g.index,range:g.range};return ue(0).then(function(){if(0<Z.length)throw new _e("Error modifying one or more objects",Z,ie,ae);return ne.length})})})},Xe.prototype.delete=function(){var o=this._ctx,u=o.range;return Br(o)&&(o.isPrimKey||u.type===3)?this._write(function(g){var b=o.table.core.schema.primaryKey,A=u;return o.table.core.count({trans:g,query:{index:b,range:A}}).then(function(M){return o.table.core.mutate({trans:g,type:"deleteRange",range:A}).then(function($){var K=$.failures;if($.lastResult,$.results,$=$.numFailures,$)throw new _e("Could not delete some values",Object.keys(K).map(function(H){return K[H]}),M-$);return M-$})})}):this.modify(Ci)},Xe);function Xe(){}var Ci=function(o,u){return u.value=null};function Do(o,u){return o<u?-1:o===u?0:1}function Sa(o,u){return u<o?-1:o===u?0:1}function Lt(o,u,g){return o=o instanceof Qn?new o.Collection(o):o,o._ctx.error=new(g||TypeError)(u),o}function un(o){return new o.Collection(o,function(){return Aa("")}).limit(0)}function Sn(o,u,g,b){var A,M,$,K,H,Q,te,X=g.length;if(!g.every(function(ie){return typeof ie=="string"}))return Lt(o,wa);function re(ie){A=ie==="next"?function(ne){return ne.toUpperCase()}:function(ne){return ne.toLowerCase()},M=ie==="next"?function(ne){return ne.toLowerCase()}:function(ne){return ne.toUpperCase()},$=ie==="next"?Do:Sa;var ae=g.map(function(ne){return{lower:M(ne),upper:A(ne)}}).sort(function(ne,ue){return $(ne.lower,ue.lower)});K=ae.map(function(ne){return ne.upper}),H=ae.map(function(ne){return ne.lower}),te=(Q=ie)==="next"?"":b}re("next"),o=new o.Collection(o,function(){return dr(K[0],H[X-1]+b)}),o._ondirectionchange=function(ie){re(ie)};var Z=0;return o._addAlgorithm(function(ie,ae,ne){var ue=ie.key;if(typeof ue!="string")return!1;var he=M(ue);if(u(he,H,Z))return!0;for(var ge=null,ve=Z;ve<X;++ve){var be=function(Ce,we,xe,Ie,De,Te){for(var Ue=Math.min(Ce.length,Ie.length),We=-1,He=0;He<Ue;++He){var Xt=we[He];if(Xt!==Ie[He])return De(Ce[He],xe[He])<0?Ce.substr(0,He)+xe[He]+xe.substr(He+1):De(Ce[He],Ie[He])<0?Ce.substr(0,He)+Ie[He]+xe.substr(He+1):0<=We?Ce.substr(0,We)+we[We]+xe.substr(We+1):null;De(Ce[He],Xt)<0&&(We=He)}return Ue<Ie.length&&Te==="next"?Ce+xe.substr(Ce.length):Ue<Ce.length&&Te==="prev"?Ce.substr(0,xe.length):We<0?null:Ce.substr(0,We)+Ie[We]+xe.substr(We+1)}(ue,he,K[ve],H[ve],$,Q);be===null&&ge===null?Z=ve+1:(ge===null||0<$(ge,be))&&(ge=be)}return ae(ge!==null?function(){ie.continue(ge+te)}:ne),!1}),o}function dr(o,u,g,b){return{type:2,lower:o,upper:u,lowerOpen:g,upperOpen:b}}function Aa(o){return{type:1,lower:o,upper:o}}var Qn=(Object.defineProperty(lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),lt.prototype.between=function(o,u,g,b){g=g!==!1,b=b===!0;try{return 0<this._cmp(o,u)||this._cmp(o,u)===0&&(g||b)&&(!g||!b)?un(this):new this.Collection(this,function(){return dr(o,u,!g,!b)})}catch{return Lt(this,Zt)}},lt.prototype.equals=function(o){return o==null?Lt(this,Zt):new this.Collection(this,function(){return Aa(o)})},lt.prototype.above=function(o){return o==null?Lt(this,Zt):new this.Collection(this,function(){return dr(o,void 0,!0)})},lt.prototype.aboveOrEqual=function(o){return o==null?Lt(this,Zt):new this.Collection(this,function(){return dr(o,void 0,!1)})},lt.prototype.below=function(o){return o==null?Lt(this,Zt):new this.Collection(this,function(){return dr(void 0,o,!1,!0)})},lt.prototype.belowOrEqual=function(o){return o==null?Lt(this,Zt):new this.Collection(this,function(){return dr(void 0,o)})},lt.prototype.startsWith=function(o){return typeof o!="string"?Lt(this,wa):this.between(o,o+Fr,!0,!0)},lt.prototype.startsWithIgnoreCase=function(o){return o===""?this.startsWith(o):Sn(this,function(u,g){return u.indexOf(g[0])===0},[o],Fr)},lt.prototype.equalsIgnoreCase=function(o){return Sn(this,function(u,g){return u===g[0]},[o],"")},lt.prototype.anyOfIgnoreCase=function(){var o=ce.apply(ee,arguments);return o.length===0?un(this):Sn(this,function(u,g){return g.indexOf(u)!==-1},o,"")},lt.prototype.startsWithAnyOfIgnoreCase=function(){var o=ce.apply(ee,arguments);return o.length===0?un(this):Sn(this,function(u,g){return g.some(function(b){return u.indexOf(b)===0})},o,Fr)},lt.prototype.anyOf=function(){var o=this,u=ce.apply(ee,arguments),g=this._cmp;try{u.sort(g)}catch{return Lt(this,Zt)}if(u.length===0)return un(this);var b=new this.Collection(this,function(){return dr(u[0],u[u.length-1])});b._ondirectionchange=function(M){g=M==="next"?o._ascending:o._descending,u.sort(g)};var A=0;return b._addAlgorithm(function(M,$,K){for(var H=M.key;0<g(H,u[A]);)if(++A===u.length)return $(K),!1;return g(H,u[A])===0||($(function(){M.continue(u[A])}),!1)}),b},lt.prototype.notEqual=function(o){return this.inAnyRange([[-1/0,o],[o,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},lt.prototype.noneOf=function(){var o=ce.apply(ee,arguments);if(o.length===0)return new this.Collection(this);try{o.sort(this._ascending)}catch{return Lt(this,Zt)}var u=o.reduce(function(g,b){return g?g.concat([[g[g.length-1][1],b]]):[[-1/0,b]]},null);return u.push([o[o.length-1],this.db._maxKey]),this.inAnyRange(u,{includeLowers:!1,includeUppers:!1})},lt.prototype.inAnyRange=function(ue,u){var g=this,b=this._cmp,A=this._ascending,M=this._descending,$=this._min,K=this._max;if(ue.length===0)return un(this);if(!ue.every(function(he){return he[0]!==void 0&&he[1]!==void 0&&A(he[0],he[1])<=0}))return Lt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",de.InvalidArgument);var H=!u||u.includeLowers!==!1,Q=u&&u.includeUppers===!0,te,X=A;function re(he,ge){return X(he[0],ge[0])}try{(te=ue.reduce(function(he,ge){for(var ve=0,be=he.length;ve<be;++ve){var Ce=he[ve];if(b(ge[0],Ce[1])<0&&0<b(ge[1],Ce[0])){Ce[0]=$(Ce[0],ge[0]),Ce[1]=K(Ce[1],ge[1]);break}}return ve===be&&he.push(ge),he},[])).sort(re)}catch{return Lt(this,Zt)}var Z=0,ie=Q?function(he){return 0<A(he,te[Z][1])}:function(he){return 0<=A(he,te[Z][1])},ae=H?function(he){return 0<M(he,te[Z][0])}:function(he){return 0<=M(he,te[Z][0])},ne=ie,ue=new this.Collection(this,function(){return dr(te[0][0],te[te.length-1][1],!H,!Q)});return ue._ondirectionchange=function(he){X=he==="next"?(ne=ie,A):(ne=ae,M),te.sort(re)},ue._addAlgorithm(function(he,ge,ve){for(var be,Ce=he.key;ne(Ce);)if(++Z===te.length)return ge(ve),!1;return!ie(be=Ce)&&!ae(be)||(g._cmp(Ce,te[Z][1])===0||g._cmp(Ce,te[Z][0])===0||ge(function(){X===A?he.continue(te[Z][0]):he.continue(te[Z][1])}),!1)}),ue},lt.prototype.startsWithAnyOf=function(){var o=ce.apply(ee,arguments);return o.every(function(u){return typeof u=="string"})?o.length===0?un(this):this.inAnyRange(o.map(function(u){return[u,u+Fr]})):Lt(this,"startsWithAnyOf() only works with strings")},lt);function lt(){}function Ht(o){return Je(function(u){return An(u),o(u.target.error),!1})}function An(o){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault()}var kr="storagemutated",Ii="x-storagemutated-1",hr=wn(null,kr),ka=(Jt.prototype._lock=function(){return _(!ze.global),++this._reculock,this._reculock!==1||ze.global||(ze.lockOwnerFor=this),this},Jt.prototype._unlock=function(){if(_(!ze.global),--this._reculock==0)for(ze.global||(ze.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var o=this._blockedFuncs.shift();try{Kt(o[1],o[0])}catch{}}return this},Jt.prototype._locked=function(){return this._reculock&&ze.lockOwnerFor!==this},Jt.prototype.create=function(o){var u=this;if(!this.mode)return this;var g=this.db.idbdb,b=this.db._state.dbOpenError;if(_(!this.idbtrans),!o&&!g)switch(b&&b.name){case"DatabaseClosedError":throw new de.DatabaseClosed(b);case"MissingAPIError":throw new de.MissingAPI(b.message,b);default:throw new de.OpenFailed(b)}if(!this.active)throw new de.TransactionInactive;return _(this._completion._state===null),(o=this.idbtrans=o||(this.db.core||g).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Je(function(A){An(A),u._reject(o.error)}),o.onabort=Je(function(A){An(A),u.active&&u._reject(new de.Abort(o.error)),u.active=!1,u.on("abort").fire(A)}),o.oncomplete=Je(function(){u.active=!1,u._resolve(),"mutatedParts"in o&&hr.storagemutated.fire(o.mutatedParts)}),this},Jt.prototype._promise=function(o,u,g){var b=this;if(o==="readwrite"&&this.mode!=="readwrite")return et(new de.ReadOnly("Transaction is readonly"));if(!this.active)return et(new de.TransactionInactive);if(this._locked())return new Se(function(M,$){b._blockedFuncs.push([function(){b._promise(o,u,g).then(M,$)},ze])});if(g)return cr(function(){var M=new Se(function($,K){b._lock();var H=u($,K,b);H&&H.then&&H.then($,K)});return M.finally(function(){return b._unlock()}),M._lib=!0,M});var A=new Se(function(M,$){var K=u(M,$,b);K&&K.then&&K.then(M,$)});return A._lib=!0,A},Jt.prototype._root=function(){return this.parent?this.parent._root():this},Jt.prototype.waitFor=function(o){var u,g=this._root(),b=Se.resolve(o);g._waitingFor?g._waitingFor=g._waitingFor.then(function(){return b}):(g._waitingFor=b,g._waitingQueue=[],u=g.idbtrans.objectStore(g.storeNames[0]),function M(){for(++g._spinCount;g._waitingQueue.length;)g._waitingQueue.shift()();g._waitingFor&&(u.get(-1/0).onsuccess=M)}());var A=g._waitingFor;return new Se(function(M,$){b.then(function(K){return g._waitingQueue.push(Je(M.bind(null,K)))},function(K){return g._waitingQueue.push(Je($.bind(null,K)))}).finally(function(){g._waitingFor===A&&(g._waitingFor=null)})})},Jt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new de.Abort))},Jt.prototype.table=function(o){var u=this._memoizedTables||(this._memoizedTables={});if(v(u,o))return u[o];var g=this.schema[o];if(!g)throw new de.NotFound("Table "+o+" not part of transaction");return g=new this.db.Table(o,g,this),g.core=this.db.core.table(o),u[o]=g},Jt);function Jt(){}function Zn(o,u,g,b,A,M,$){return{name:o,keyPath:u,unique:g,multi:b,auto:A,compound:M,src:(g&&!$?"&":"")+(b?"*":"")+(A?"++":"")+Mi(u)}}function Mi(o){return typeof o=="string"?o:o?"["+[].join.call(o,"+")+"]":""}function Ni(o,u,g){return{name:o,primKey:u,indexes:g,mappedClass:null,idxByName:(b=function(A){return[A.name,A]},g.reduce(function(A,M,$){return $=b(M,$),$&&(A[$[0]]=$[1]),A},{}))};var b}var fr=function(o){try{return o.only([[]]),fr=function(){return[[]]},[[]]}catch{return fr=function(){return Fr},Fr}};function cn(o){return o==null?function(){}:typeof o=="string"?(u=o).split(".").length===1?function(g){return g[u]}:function(g){return B(g,u)}:function(g){return B(g,o)};var u}function Da(o){return[].slice.call(o)}var Pi=0;function ln(o){return o==null?":id":typeof o=="string"?o:"[".concat(o.join("+"),"]")}function Co(o,u,H){function b(ne){if(ne.type===3)return null;if(ne.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Z=ne.lower,ie=ne.upper,ae=ne.lowerOpen,ne=ne.upperOpen;return Z===void 0?ie===void 0?null:u.upperBound(ie,!!ne):ie===void 0?u.lowerBound(Z,!!ae):u.bound(Z,ie,!!ae,!!ne)}function A(re){var Z,ie=re.name;return{name:ie,schema:re,mutate:function(ae){var ne=ae.trans,ue=ae.type,he=ae.keys,ge=ae.values,ve=ae.range;return new Promise(function(be,Ce){be=Je(be);var we=ne.objectStore(ie),xe=we.keyPath==null,Ie=ue==="put"||ue==="add";if(!Ie&&ue!=="delete"&&ue!=="deleteRange")throw new Error("Invalid operation type: "+ue);var De,Te=(he||ge||{length:1}).length;if(he&&ge&&he.length!==ge.length)throw new Error("Given keys array must have same length as given values array.");if(Te===0)return be({numFailures:0,failures:{},results:[],lastResult:void 0});function Ue(zt){++Xt,An(zt)}var We=[],He=[],Xt=0;if(ue==="deleteRange"){if(ve.type===4)return be({numFailures:Xt,failures:He,results:[],lastResult:void 0});ve.type===3?We.push(De=we.clear()):We.push(De=we.delete(b(ve)))}else{var xe=Ie?xe?[ge,he]:[ge,null]:[he,null],Be=xe[0],kt=xe[1];if(Ie)for(var Dt=0;Dt<Te;++Dt)We.push(De=kt&&kt[Dt]!==void 0?we[ue](Be[Dt],kt[Dt]):we[ue](Be[Dt])),De.onerror=Ue;else for(Dt=0;Dt<Te;++Dt)We.push(De=we[ue](Be[Dt])),De.onerror=Ue}function za(zt){zt=zt.target.result,We.forEach(function(Tn,zo){return Tn.error!=null&&(He[zo]=Tn.error)}),be({numFailures:Xt,failures:He,results:ue==="delete"?he:We.map(function(Tn){return Tn.result}),lastResult:zt})}De.onerror=function(zt){Ue(zt),za(zt)},De.onsuccess=za})},getMany:function(ae){var ne=ae.trans,ue=ae.keys;return new Promise(function(he,ge){he=Je(he);for(var ve,be=ne.objectStore(ie),Ce=ue.length,we=new Array(Ce),xe=0,Ie=0,De=function(We){We=We.target,we[We._pos]=We.result,++Ie===xe&&he(we)},Te=Ht(ge),Ue=0;Ue<Ce;++Ue)ue[Ue]!=null&&((ve=be.get(ue[Ue]))._pos=Ue,ve.onsuccess=De,ve.onerror=Te,++xe);xe===0&&he(we)})},get:function(ae){var ne=ae.trans,ue=ae.key;return new Promise(function(he,ge){he=Je(he);var ve=ne.objectStore(ie).get(ue);ve.onsuccess=function(be){return he(be.target.result)},ve.onerror=Ht(ge)})},query:(Z=Q,function(ae){return new Promise(function(ne,ue){ne=Je(ne);var he,ge,ve,xe=ae.trans,be=ae.values,Ce=ae.limit,De=ae.query,we=Ce===1/0?void 0:Ce,Ie=De.index,De=De.range,xe=xe.objectStore(ie),Ie=Ie.isPrimaryKey?xe:xe.index(Ie.name),De=b(De);if(Ce===0)return ne({result:[]});Z?((we=be?Ie.getAll(De,we):Ie.getAllKeys(De,we)).onsuccess=function(Te){return ne({result:Te.target.result})},we.onerror=Ht(ue)):(he=0,ge=!be&&"openKeyCursor"in Ie?Ie.openKeyCursor(De):Ie.openCursor(De),ve=[],ge.onsuccess=function(Te){var Ue=ge.result;return Ue?(ve.push(be?Ue.value:Ue.primaryKey),++he===Ce?ne({result:ve}):void Ue.continue()):ne({result:ve})},ge.onerror=Ht(ue))})}),openCursor:function(ae){var ne=ae.trans,ue=ae.values,he=ae.query,ge=ae.reverse,ve=ae.unique;return new Promise(function(be,Ce){be=Je(be);var Ie=he.index,we=he.range,xe=ne.objectStore(ie),xe=Ie.isPrimaryKey?xe:xe.index(Ie.name),Ie=ge?ve?"prevunique":"prev":ve?"nextunique":"next",De=!ue&&"openKeyCursor"in xe?xe.openKeyCursor(b(we),Ie):xe.openCursor(b(we),Ie);De.onerror=Ht(Ce),De.onsuccess=Je(function(Te){var Ue,We,He,Xt,Be=De.result;Be?(Be.___id=++Pi,Be.done=!1,Ue=Be.continue.bind(Be),We=(We=Be.continuePrimaryKey)&&We.bind(Be),He=Be.advance.bind(Be),Xt=function(){throw new Error("Cursor not stopped")},Be.trans=ne,Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=function(){throw new Error("Cursor not started")},Be.fail=Je(Ce),Be.next=function(){var kt=this,Dt=1;return this.start(function(){return Dt--?kt.continue():kt.stop()}).then(function(){return kt})},Be.start=function(kt){function Dt(){if(De.result)try{kt()}catch(zt){Be.fail(zt)}else Be.done=!0,Be.start=function(){throw new Error("Cursor behind last entry")},Be.stop()}var za=new Promise(function(zt,Tn){zt=Je(zt),De.onerror=Ht(Tn),Be.fail=Tn,Be.stop=function(zo){Be.stop=Be.continue=Be.continuePrimaryKey=Be.advance=Xt,zt(zo)}});return De.onsuccess=Je(function(zt){De.onsuccess=Dt,Dt()}),Be.continue=Ue,Be.continuePrimaryKey=We,Be.advance=He,Dt(),za},be(Be)):be(null)},Ce)})},count:function(ae){var ne=ae.query,ue=ae.trans,he=ne.index,ge=ne.range;return new Promise(function(ve,be){var Ce=ue.objectStore(ie),we=he.isPrimaryKey?Ce:Ce.index(he.name),Ce=b(ge),we=Ce?we.count(Ce):we.count();we.onsuccess=Je(function(xe){return ve(xe.target.result)}),we.onerror=Ht(be)})}}}var M,$,K,te=($=H,K=Da((M=o).objectStoreNames),{schema:{name:M.name,tables:K.map(function(re){return $.objectStore(re)}).map(function(re){var Z=re.keyPath,ne=re.autoIncrement,ie=c(Z),ae={},ne={name:re.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Z==null,compound:ie,keyPath:Z,autoIncrement:ne,unique:!0,extractKey:cn(Z)},indexes:Da(re.indexNames).map(function(ue){return re.index(ue)}).map(function(ve){var he=ve.name,ge=ve.unique,be=ve.multiEntry,ve=ve.keyPath,be={name:he,compound:c(ve),keyPath:ve,unique:ge,multiEntry:be,extractKey:cn(ve)};return ae[ln(ve)]=be}),getIndexByKeyPath:function(ue){return ae[ln(ue)]}};return ae[":id"]=ne.primaryKey,Z!=null&&(ae[ln(Z)]=ne.primaryKey),ne})},hasGetAll:0<K.length&&"getAll"in $.objectStore(K[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),H=te.schema,Q=te.hasGetAll,te=H.tables.map(A),X={};return te.forEach(function(re){return X[re.name]=re}),{stack:"dbcore",transaction:o.transaction.bind(o),table:function(re){if(!X[re])throw new Error("Table '".concat(re,"' not found"));return X[re]},MIN_KEY:-1/0,MAX_KEY:fr(u),schema:H}}function Oi(o,u,g,b){var A=g.IDBKeyRange;return g.indexedDB,{dbcore:(b=Co(u,A,b),o.dbcore.reduce(function(M,$){return $=$.create,r(r({},M),$(M))},b))}}function kn(o,b){var g=b.db,b=Oi(o._middlewares,g,o._deps,b);o.core=b.dbcore,o.tables.forEach(function(A){var M=A.name;o.core.schema.tables.some(function($){return $.name===M})&&(A.core=o.core.table(M),o[M]instanceof o.Table&&(o[M].core=A.core))})}function Dn(o,u,g,b){g.forEach(function(A){var M=b[A];u.forEach(function($){var K=function H(Q,te){return I(Q,te)||(Q=h(Q))&&H(Q,te)}($,A);(!K||"value"in K&&K.value===void 0)&&($===o.Transaction.prototype||$ instanceof o.Transaction?D($,A,{get:function(){return this.table(A)},set:function(H){E(this,A,{value:H,writable:!0,configurable:!0,enumerable:!0})}}):$[A]=new o.Table(A,M))})})}function Cn(o,u){u.forEach(function(g){for(var b in g)g[b]instanceof o.Table&&delete g[b]})}function Io(o,u){return o._cfg.version-u._cfg.version}function Mo(o,u,g,b){var A=o._dbSchema;g.objectStoreNames.contains("$meta")&&!A.$meta&&(A.$meta=Ni("$meta",Ia("")[0],[]),o._storeNames.push("$meta"));var M=o._createTransaction("readwrite",o._storeNames,A);M.create(g),M._completion.catch(b);var $=M._reject.bind(M),K=ze.transless||ze;cr(function(){return ze.trans=M,ze.transless=K,u!==0?(kn(o,g),Q=u,((H=M).storeNames.includes("$meta")?H.table("$meta").get("version").then(function(te){return te??Q}):Se.resolve(Q)).then(function(te){return re=te,Z=M,ie=g,ae=[],te=(X=o)._versions,ne=X._dbSchema=Mn(0,X.idbdb,ie),(te=te.filter(function(ue){return ue._cfg.version>=re})).length!==0?(te.forEach(function(ue){ae.push(function(){var he=ne,ge=ue._cfg.dbschema;dt(X,he,ie),dt(X,ge,ie),ne=X._dbSchema=ge;var ve=Ti(he,ge);ve.add.forEach(function(Ie){Ri(ie,Ie[0],Ie[1].primKey,Ie[1].indexes)}),ve.change.forEach(function(Ie){if(Ie.recreate)throw new de.Upgrade("Not yet support for changing primary key");var De=ie.objectStore(Ie.name);Ie.add.forEach(function(Te){return In(De,Te)}),Ie.change.forEach(function(Te){De.deleteIndex(Te.name),In(De,Te)}),Ie.del.forEach(function(Te){return De.deleteIndex(Te)})});var be=ue._cfg.contentUpgrade;if(be&&ue._cfg.version>re){kn(X,ie),Z._memoizedTables={};var Ce=z(ge);ve.del.forEach(function(Ie){Ce[Ie]=he[Ie]}),Cn(X,[X.Transaction.prototype]),Dn(X,[X.Transaction.prototype],s(Ce),Ce),Z.schema=Ce;var we,xe=oe(be);return xe&&Rt(),ve=Se.follow(function(){var Ie;(we=be(Z))&&xe&&(Ie=Ge.bind(null,null),we.then(Ie,Ie))}),we&&typeof we.then=="function"?Se.resolve(we):ve.then(function(){return we})}}),ae.push(function(he){var ge,ve,be=ue._cfg.dbschema;ge=be,ve=he,[].slice.call(ve.db.objectStoreNames).forEach(function(Ce){return ge[Ce]==null&&ve.db.deleteObjectStore(Ce)}),Cn(X,[X.Transaction.prototype]),Dn(X,[X.Transaction.prototype],X._storeNames,X._dbSchema),Z.schema=X._dbSchema}),ae.push(function(he){X.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(X.idbdb.version/10)===ue._cfg.version?(X.idbdb.deleteObjectStore("$meta"),delete X._dbSchema.$meta,X._storeNames=X._storeNames.filter(function(ge){return ge!=="$meta"})):he.objectStore("$meta").put(ue._cfg.version,"version"))})}),function ue(){return ae.length?Se.resolve(ae.shift()(Z.idbtrans)).then(ue):Se.resolve()}().then(function(){Ca(ne,ie)})):Se.resolve();var X,re,Z,ie,ae,ne}).catch($)):(s(A).forEach(function(te){Ri(g,te,A[te].primKey,A[te].indexes)}),kn(o,g),void Se.follow(function(){return o.on.populate.fire(M)}).catch($));var H,Q})}function Dr(o,u){Ca(o._dbSchema,u),u.db.version%10!=0||u.objectStoreNames.contains("$meta")||u.db.createObjectStore("$meta").add(Math.ceil(u.db.version/10-1),"version");var g=Mn(0,o.idbdb,u);dt(o,o._dbSchema,u);for(var b=0,A=Ti(g,o._dbSchema).change;b<A.length;b++){var M=function($){if($.change.length||$.recreate)return console.warn("Unable to patch indexes of table ".concat($.name," because it has changes on the type of index or primary key.")),{value:void 0};var K=u.objectStore($.name);$.add.forEach(function(H){Ve&&console.debug("Dexie upgrade patch: Creating missing index ".concat($.name,".").concat(H.src)),In(K,H)})}(A[b]);if(typeof M=="object")return M.value}}function Ti(o,u){var g,b={del:[],add:[],change:[]};for(g in o)u[g]||b.del.push(g);for(g in u){var A=o[g],M=u[g];if(A){var $={name:g,def:M,recreate:!1,del:[],add:[],change:[]};if(""+(A.primKey.keyPath||"")!=""+(M.primKey.keyPath||"")||A.primKey.auto!==M.primKey.auto)$.recreate=!0,b.change.push($);else{var K=A.idxByName,H=M.idxByName,Q=void 0;for(Q in K)H[Q]||$.del.push(Q);for(Q in H){var te=K[Q],X=H[Q];te?te.src!==X.src&&$.change.push(X):$.add.push(X)}(0<$.del.length||0<$.add.length||0<$.change.length)&&b.change.push($)}}else b.add.push([g,M])}return b}function Ri(o,u,g,b){var A=o.db.createObjectStore(u,g.keyPath?{keyPath:g.keyPath,autoIncrement:g.auto}:{autoIncrement:g.auto});return b.forEach(function(M){return In(A,M)}),A}function Ca(o,u){s(o).forEach(function(g){u.db.objectStoreNames.contains(g)||(Ve&&console.debug("Dexie: Creating missing table",g),Ri(u,g,o[g].primKey,o[g].indexes))})}function In(o,u){o.createIndex(u.name,u.keyPath,{unique:u.unique,multiEntry:u.multi})}function Mn(o,u,g){var b={};return C(u.objectStoreNames,0).forEach(function(A){for(var M=g.objectStore(A),$=Zn(Mi(Q=M.keyPath),Q||"",!0,!1,!!M.autoIncrement,Q&&typeof Q!="string",!0),K=[],H=0;H<M.indexNames.length;++H){var te=M.index(M.indexNames[H]),Q=te.keyPath,te=Zn(te.name,Q,!!te.unique,!!te.multiEntry,!1,Q&&typeof Q!="string",!1);K.push(te)}b[A]=Ni(A,$,K)}),b}function dt(o,u,g){for(var b=g.db.objectStoreNames,A=0;A<b.length;++A){var M=b[A],$=g.objectStore(M);o._hasGetAll="getAll"in $;for(var K=0;K<$.indexNames.length;++K){var H=$.indexNames[K],Q=$.index(H).keyPath,te=typeof Q=="string"?Q:"["+C(Q).join("+")+"]";!u[M]||(Q=u[M].idxByName[te])&&(Q.name=H,delete u[M].idxByName[te],u[M].idxByName[H]=Q)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&a.WorkerGlobalScope&&a instanceof a.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(o._hasGetAll=!1)}function Ia(o){return o.split(",").map(function(u,g){var b=(u=u.trim()).replace(/([&*]|\+\+)/g,""),A=/^\[/.test(b)?b.match(/^\[(.*)\]$/)[1].split("+"):b;return Zn(b,A||null,/\&/.test(u),/\*/.test(u),/\+\+/.test(u),c(A),g===0)})}var No=(Jn.prototype._parseStoresSpec=function(o,u){s(o).forEach(function(g){if(o[g]!==null){var b=Ia(o[g]),A=b.shift();if(A.unique=!0,A.multi)throw new de.Schema("Primary key cannot be multi-valued");b.forEach(function(M){if(M.auto)throw new de.Schema("Only primary key can be marked as autoIncrement (++)");if(!M.keyPath)throw new de.Schema("Index must have a name and cannot be an empty string")}),u[g]=Ni(g,A,b)}})},Jn.prototype.stores=function(g){var u=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,g):g;var g=u._versions,b={},A={};return g.forEach(function(M){f(b,M._cfg.storesSource),A=M._cfg.dbschema={},M._parseStoresSpec(b,A)}),u._dbSchema=A,Cn(u,[u._allTables,u,u.Transaction.prototype]),Dn(u,[u._allTables,u,u.Transaction.prototype,this._cfg.tables],s(A),A),u._storeNames=s(A),this},Jn.prototype.upgrade=function(o){return this._cfg.contentUpgrade=at(this._cfg.contentUpgrade||ke,o),this},Jn);function Jn(){}function Li(o,u){var g=o._dbNamesDB;return g||(g=o._dbNamesDB=new gr(bn,{addons:[],indexedDB:o,IDBKeyRange:u})).version(1).stores({dbnames:"name"}),g.table("dbnames")}function zi(o){return o&&typeof o.databases=="function"}function $i(o){return cr(function(){return ze.letThrough=!0,o()})}function Gi(o){return!("from"in o)}var yt=function(o,u){if(!this){var g=new yt;return o&&"d"in o&&f(g,o),g}f(this,arguments.length?{d:1,from:o,to:1<arguments.length?u:o}:{d:0})};function dn(o,u,g){var b=Ye(u,g);if(!isNaN(b)){if(0<b)throw RangeError();if(Gi(o))return f(o,{from:u,to:g,d:1});var A=o.l,b=o.r;if(Ye(g,o.from)<0)return A?dn(A,u,g):o.l={from:u,to:g,d:1,l:null,r:null},Ma(o);if(0<Ye(u,o.to))return b?dn(b,u,g):o.r={from:u,to:g,d:1,l:null,r:null},Ma(o);Ye(u,o.from)<0&&(o.from=u,o.l=null,o.d=b?b.d+1:1),0<Ye(g,o.to)&&(o.to=g,o.r=null,o.d=o.l?o.l.d+1:1),g=!o.r,A&&!o.l&&Cr(o,A),b&&g&&Cr(o,b)}}function Cr(o,u){Gi(u)||function g(b,H){var M=H.from,$=H.to,K=H.l,H=H.r;dn(b,M,$),K&&g(b,K),H&&g(b,H)}(o,u)}function Ir(o,u){var g=Ur(u),b=g.next();if(b.done)return!1;for(var A=b.value,M=Ur(o),$=M.next(A.from),K=$.value;!b.done&&!$.done;){if(Ye(K.from,A.to)<=0&&0<=Ye(K.to,A.from))return!0;Ye(A.from,K.from)<0?A=(b=g.next(K.from)).value:K=($=M.next(A.from)).value}return!1}function Ur(o){var u=Gi(o)?null:{s:0,n:o};return{next:function(g){for(var b=0<arguments.length;u;)switch(u.s){case 0:if(u.s=1,b)for(;u.n.l&&Ye(g,u.n.from)<0;)u={up:u,n:u.n.l,s:1};else for(;u.n.l;)u={up:u,n:u.n.l,s:1};case 1:if(u.s=2,!b||Ye(g,u.n.to)<=0)return{value:u.n,done:!1};case 2:if(u.n.r){u.s=3,u={up:u,n:u.n.r,s:0};continue}case 3:u=u.up}return{done:!0}}}}function Ma(o){var u,g,b=(((u=o.r)===null||u===void 0?void 0:u.d)||0)-(((g=o.l)===null||g===void 0?void 0:g.d)||0),A=1<b?"r":b<-1?"l":"";A&&(u=A=="r"?"l":"r",g=r({},o),b=o[A],o.from=b.from,o.to=b.to,o[A]=b[A],g[A]=b[u],(o[u]=g).d=qi(g)),o.d=qi(o)}function qi(g){var u=g.r,g=g.l;return(u?g?Math.max(u.d,g.d):u.d:g?g.d:0)+1}function Nn(o,u){return s(u).forEach(function(g){o[g]?Cr(o[g],u[g]):o[g]=function b(A){var M,$,K={};for(M in A)v(A,M)&&($=A[M],K[M]=!$||typeof $!="object"||U.has($.constructor)?$:b($));return K}(u[g])}),o}function ei(o,u){return o.all||u.all||Object.keys(o).some(function(g){return u[g]&&Ir(u[g],o[g])})}w(yt.prototype,((d={add:function(o){return Cr(this,o),this},addKey:function(o){return dn(this,o,o),this},addKeys:function(o){var u=this;return o.forEach(function(g){return dn(u,g,g)}),this},hasKey:function(o){var u=Ur(this).next(o).value;return u&&Ye(u.from,o)<=0&&0<=Ye(u.to,o)}})[Y]=function(){return Ur(this)},d));var Yt={},Fi={},ji=!1;function ti(o){Nn(Fi,o),ji||(ji=!0,setTimeout(function(){ji=!1,Bi(Fi,!(Fi={}))},0))}function Bi(o,u){u===void 0&&(u=!1);var g=new Set;if(o.all)for(var b=0,A=Object.values(Yt);b<A.length;b++)Na($=A[b],o,g,u);else for(var M in o){var $,K=/^idb\:\/\/(.*)\/(.*)\//.exec(M);K&&(M=K[1],K=K[2],($=Yt["idb://".concat(M,"/").concat(K)])&&Na($,o,g,u))}g.forEach(function(H){return H()})}function Na(o,u,g,b){for(var A=[],M=0,$=Object.entries(o.queries.query);M<$.length;M++){for(var K=$[M],H=K[0],Q=[],te=0,X=K[1];te<X.length;te++){var re=X[te];ei(u,re.obsSet)?re.subscribers.forEach(function(ne){return g.add(ne)}):b&&Q.push(re)}b&&A.push([H,Q])}if(b)for(var Z=0,ie=A;Z<ie.length;Z++){var ae=ie[Z],H=ae[0],Q=ae[1];o.queries.query[H]=Q}}function Po(o){var u=o._state,g=o._deps.indexedDB;if(u.isBeingOpened||o.idbdb)return u.dbReadyPromise.then(function(){return u.dbOpenError?et(u.dbOpenError):o});u.isBeingOpened=!0,u.dbOpenError=null,u.openComplete=!1;var b=u.openCanceller,A=Math.round(10*o.verno),M=!1;function $(){if(u.openCanceller!==b)throw new de.DatabaseClosed("db.open() was cancelled")}function K(){return new Se(function(re,Z){if($(),!g)throw new de.MissingAPI;var ie=o.name,ae=u.autoSchema||!A?g.open(ie):g.open(ie,A);if(!ae)throw new de.MissingAPI;ae.onerror=Ht(Z),ae.onblocked=Je(o._fireOnBlocked),ae.onupgradeneeded=Je(function(ne){var ue;te=ae.transaction,u.autoSchema&&!o._options.allowEmptyDB?(ae.onerror=An,te.abort(),ae.result.close(),(ue=g.deleteDatabase(ie)).onsuccess=ue.onerror=Je(function(){Z(new de.NoSuchDatabase("Database ".concat(ie," doesnt exist")))})):(te.onerror=Ht(Z),ne=ne.oldVersion>Math.pow(2,62)?0:ne.oldVersion,X=ne<1,o.idbdb=ae.result,M&&Dr(o,te),Mo(o,ne/10,te,Z))},Z),ae.onsuccess=Je(function(){te=null;var ne,ue,he,ge,ve,be=o.idbdb=ae.result,Ce=C(be.objectStoreNames);if(0<Ce.length)try{var we=be.transaction((ge=Ce).length===1?ge[0]:ge,"readonly");if(u.autoSchema)ue=be,he=we,(ne=o).verno=ue.version/10,he=ne._dbSchema=Mn(0,ue,he),ne._storeNames=C(ue.objectStoreNames,0),Dn(ne,[ne._allTables],s(he),he);else if(dt(o,o._dbSchema,we),((ve=Ti(Mn(0,(ve=o).idbdb,we),ve._dbSchema)).add.length||ve.change.some(function(xe){return xe.add.length||xe.change.length}))&&!M)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),be.close(),A=be.version+1,M=!0,re(K());kn(o,we)}catch{}jr.push(o),be.onversionchange=Je(function(xe){u.vcFired=!0,o.on("versionchange").fire(xe)}),be.onclose=Je(function(xe){o.on("close").fire(xe)}),X&&(ve=o._deps,we=ie,be=ve.indexedDB,ve=ve.IDBKeyRange,zi(be)||we===bn||Li(be,ve).put({name:we}).catch(ke)),re()},Z)}).catch(function(re){switch(re==null?void 0:re.name){case"UnknownError":if(0<u.PR1398_maxLoop)return u.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),K();break;case"VersionError":if(0<A)return A=0,K()}return Se.reject(re)})}var H,Q=u.dbReadyResolve,te=null,X=!1;return Se.race([b,(typeof navigator>"u"?Se.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(re){function Z(){return indexedDB.databases().finally(re)}H=setInterval(Z,100),Z()}).finally(function(){return clearInterval(H)}):Promise.resolve()).then(K)]).then(function(){return $(),u.onReadyBeingFired=[],Se.resolve($i(function(){return o.on.ready.fire(o.vip)})).then(function re(){if(0<u.onReadyBeingFired.length){var Z=u.onReadyBeingFired.reduce(at,ke);return u.onReadyBeingFired=[],Se.resolve($i(function(){return Z(o.vip)})).then(re)}})}).finally(function(){u.openCanceller===b&&(u.onReadyBeingFired=null,u.isBeingOpened=!1)}).catch(function(re){u.dbOpenError=re;try{te&&te.abort()}catch{}return b===u.openCanceller&&o._close(),et(re)}).finally(function(){u.openComplete=!0,Q()}).then(function(){var re;return X&&(re={},o.tables.forEach(function(Z){Z.schema.indexes.forEach(function(ie){ie.name&&(re["idb://".concat(o.name,"/").concat(Z.name,"/").concat(ie.name)]=new yt(-1/0,[[[]]]))}),re["idb://".concat(o.name,"/").concat(Z.name,"/")]=re["idb://".concat(o.name,"/").concat(Z.name,"/:dels")]=new yt(-1/0,[[[]]])}),hr(kr).fire(re),Bi(re,!0)),o})}function Pn(o){function u(M){return o.next(M)}var g=A(u),b=A(function(M){return o.throw(M)});function A(M){return function(H){var K=M(H),H=K.value;return K.done?H:H&&typeof H.then=="function"?H.then(g,b):c(H)?Promise.all(H).then(g,b):g(H)}}return A(u)()}function ri(o,u,g){for(var b=c(o)?o.slice():[o],A=0;A<g;++A)b.push(u);return b}var ni={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(o){return r(r({},o),{table:function(u){var g=o.table(u),b=g.schema,A={},M=[];function $(X,re,Z){var ie=ln(X),ae=A[ie]=A[ie]||[],ne=X==null?0:typeof X=="string"?1:X.length,ue=0<re,ue=r(r({},Z),{name:ue?"".concat(ie,"(virtual-from:").concat(Z.name,")"):Z.name,lowLevelIndex:Z,isVirtual:ue,keyTail:re,keyLength:ne,extractKey:cn(X),unique:!ue&&Z.unique});return ae.push(ue),ue.isPrimaryKey||M.push(ue),1<ne&&$(ne===2?X[0]:X.slice(0,ne-1),re+1,Z),ae.sort(function(he,ge){return he.keyTail-ge.keyTail}),ue}u=$(b.primaryKey.keyPath,0,b.primaryKey),A[":id"]=[u];for(var K=0,H=b.indexes;K<H.length;K++){var Q=H[K];$(Q.keyPath,0,Q)}function te(X){var re,Z=X.query.index;return Z.isVirtual?r(r({},X),{query:{index:Z.lowLevelIndex,range:(re=X.query.range,Z=Z.keyTail,{type:re.type===1?2:re.type,lower:ri(re.lower,re.lowerOpen?o.MAX_KEY:o.MIN_KEY,Z),lowerOpen:!0,upper:ri(re.upper,re.upperOpen?o.MIN_KEY:o.MAX_KEY,Z),upperOpen:!0})}}):X}return r(r({},g),{schema:r(r({},b),{primaryKey:u,indexes:M,getIndexByKeyPath:function(X){return(X=A[ln(X)])&&X[0]}}),count:function(X){return g.count(te(X))},query:function(X){return g.query(te(X))},openCursor:function(X){var re=X.query.index,Z=re.keyTail,ie=re.isVirtual,ae=re.keyLength;return ie?g.openCursor(te(X)).then(function(ue){return ue&&ne(ue)}):g.openCursor(X);function ne(ue){return Object.create(ue,{continue:{value:function(he){he!=null?ue.continue(ri(he,X.reverse?o.MAX_KEY:o.MIN_KEY,Z)):X.unique?ue.continue(ue.key.slice(0,ae).concat(X.reverse?o.MIN_KEY:o.MAX_KEY,Z)):ue.continue()}},continuePrimaryKey:{value:function(he,ge){ue.continuePrimaryKey(ri(he,o.MAX_KEY,Z),ge)}},primaryKey:{get:function(){return ue.primaryKey}},key:{get:function(){var he=ue.key;return ae===1?he[0]:he.slice(0,ae)}},value:{get:function(){return ue.value}}})}}})}})}};function Ui(o,u,g,b){return g=g||{},b=b||"",s(o).forEach(function(A){var M,$,K;v(u,A)?(M=o[A],$=u[A],typeof M=="object"&&typeof $=="object"&&M&&$?(K=fe(M))!==fe($)?g[b+A]=u[A]:K==="Object"?Ui(M,$,g,b+A+"."):M!==$&&(g[b+A]=u[A]):M!==$&&(g[b+A]=u[A])):g[b+A]=void 0}),s(u).forEach(function(A){v(o,A)||(g[b+A]=u[A])}),g}function On(o,u){return u.type==="delete"?u.keys:u.keys||u.values.map(o.extractKey)}var Oo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(o){return r(r({},o),{table:function(u){var g=o.table(u),b=g.schema.primaryKey;return r(r({},g),{mutate:function(A){var M=ze.trans,$=M.table(u).hook,K=$.deleting,H=$.creating,Q=$.updating;switch(A.type){case"add":if(H.fire===ke)break;return M._promise("readwrite",function(){return te(A)},!0);case"put":if(H.fire===ke&&Q.fire===ke)break;return M._promise("readwrite",function(){return te(A)},!0);case"delete":if(K.fire===ke)break;return M._promise("readwrite",function(){return te(A)},!0);case"deleteRange":if(K.fire===ke)break;return M._promise("readwrite",function(){return function X(re,Z,ie){return g.query({trans:re,values:!1,query:{index:b,range:Z},limit:ie}).then(function(ae){var ne=ae.result;return te({type:"delete",keys:ne,trans:re}).then(function(ue){return 0<ue.numFailures?Promise.reject(ue.failures[0]):ne.length<ie?{failures:[],numFailures:0,lastResult:void 0}:X(re,r(r({},Z),{lower:ne[ne.length-1],lowerOpen:!0}),ie)})})}(A.trans,A.range,1e4)},!0)}return g.mutate(A);function te(X){var re,Z,ie,ae=ze.trans,ne=X.keys||On(b,X);if(!ne)throw new Error("Keys missing");return(X=X.type==="add"||X.type==="put"?r(r({},X),{keys:ne}):r({},X)).type!=="delete"&&(X.values=i([],X.values)),X.keys&&(X.keys=i([],X.keys)),re=g,ie=ne,((Z=X).type==="add"?Promise.resolve([]):re.getMany({trans:Z.trans,keys:ie,cache:"immutable"})).then(function(ue){var he=ne.map(function(ge,ve){var be,Ce,we,xe=ue[ve],Ie={onerror:null,onsuccess:null};return X.type==="delete"?K.fire.call(Ie,ge,xe,ae):X.type==="add"||xe===void 0?(be=H.fire.call(Ie,ge,X.values[ve],ae),ge==null&&be!=null&&(X.keys[ve]=ge=be,b.outbound||S(X.values[ve],b.keyPath,ge))):(be=Ui(xe,X.values[ve]),(Ce=Q.fire.call(Ie,be,ge,xe,ae))&&(we=X.values[ve],Object.keys(Ce).forEach(function(De){v(we,De)?we[De]=Ce[De]:S(we,De,Ce[De])}))),Ie});return g.mutate(X).then(function(ge){for(var ve=ge.failures,be=ge.results,Ce=ge.numFailures,ge=ge.lastResult,we=0;we<ne.length;++we){var xe=(be||ne)[we],Ie=he[we];xe==null?Ie.onerror&&Ie.onerror(ve[we]):Ie.onsuccess&&Ie.onsuccess(X.type==="put"&&ue[we]?X.values[we]:xe)}return{failures:ve,results:be,numFailures:Ce,lastResult:ge}}).catch(function(ge){return he.forEach(function(ve){return ve.onerror&&ve.onerror(ge)}),Promise.reject(ge)})})}}})}})}};function Pa(o,u,g){try{if(!u||u.keys.length<o.length)return null;for(var b=[],A=0,M=0;A<u.keys.length&&M<o.length;++A)Ye(u.keys[A],o[M])===0&&(b.push(g?j(u.values[A]):u.values[A]),++M);return b.length===o.length?b:null}catch{return null}}var Oa={stack:"dbcore",level:-1,create:function(o){return{table:function(u){var g=o.table(u);return r(r({},g),{getMany:function(b){if(!b.cache)return g.getMany(b);var A=Pa(b.keys,b.trans._cache,b.cache==="clone");return A?Se.resolve(A):g.getMany(b).then(function(M){return b.trans._cache={keys:b.keys,values:b.cache==="clone"?j(M):M},M})},mutate:function(b){return b.type!=="add"&&(b.trans._cache=null),g.mutate(b)}})}}}};function hn(o,u){return o.trans.mode==="readonly"&&!!o.subscr&&!o.trans.explicit&&o.trans.db._options.cache!=="disabled"&&!u.schema.primaryKey.outbound}function pr(o,u){switch(o){case"query":return u.values&&!u.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Ta={stack:"dbcore",level:0,name:"Observability",create:function(o){var u=o.schema.name,g=new yt(o.MIN_KEY,o.MAX_KEY);return r(r({},o),{transaction:function(b,A,M){if(ze.subscr&&A!=="readonly")throw new de.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ze.querier));return o.transaction(b,A,M)},table:function(b){var A=o.table(b),M=A.schema,$=M.primaryKey,X=M.indexes,K=$.extractKey,H=$.outbound,Q=$.autoIncrement&&X.filter(function(Z){return Z.compound&&Z.keyPath.includes($.keyPath)}),te=r(r({},A),{mutate:function(Z){function ie(De){return De="idb://".concat(u,"/").concat(b,"/").concat(De),ge[De]||(ge[De]=new yt)}var ae,ne,ue,he=Z.trans,ge=Z.mutatedParts||(Z.mutatedParts={}),ve=ie(""),be=ie(":dels"),Ce=Z.type,Ie=Z.type==="deleteRange"?[Z.range]:Z.type==="delete"?[Z.keys]:Z.values.length<50?[On($,Z).filter(function(De){return De}),Z.values]:[],we=Ie[0],xe=Ie[1],Ie=Z.trans._cache;return c(we)?(ve.addKeys(we),(Ie=Ce==="delete"||we.length===xe.length?Pa(we,Ie):null)||be.addKeys(we),(Ie||xe)&&(ae=ie,ne=Ie,ue=xe,M.indexes.forEach(function(De){var Te=ae(De.name||"");function Ue(He){return He!=null?De.extractKey(He):null}function We(He){return De.multiEntry&&c(He)?He.forEach(function(Xt){return Te.addKey(Xt)}):Te.addKey(He)}(ne||ue).forEach(function(He,kt){var Be=ne&&Ue(ne[kt]),kt=ue&&Ue(ue[kt]);Ye(Be,kt)!==0&&(Be!=null&&We(Be),kt!=null&&We(kt))})}))):we?(xe={from:(xe=we.lower)!==null&&xe!==void 0?xe:o.MIN_KEY,to:(xe=we.upper)!==null&&xe!==void 0?xe:o.MAX_KEY},be.add(xe),ve.add(xe)):(ve.add(g),be.add(g),M.indexes.forEach(function(De){return ie(De.name).add(g)})),A.mutate(Z).then(function(De){return!we||Z.type!=="add"&&Z.type!=="put"||(ve.addKeys(De.results),Q&&Q.forEach(function(Te){for(var Ue=Z.values.map(function(Be){return Te.extractKey(Be)}),We=Te.keyPath.findIndex(function(Be){return Be===$.keyPath}),He=0,Xt=De.results.length;He<Xt;++He)Ue[He][We]=De.results[He];ie(Te.name).addKeys(Ue)})),he.mutatedParts=Nn(he.mutatedParts||{},ge),De})}}),X=function(ie){var ae=ie.query,ie=ae.index,ae=ae.range;return[ie,new yt((ie=ae.lower)!==null&&ie!==void 0?ie:o.MIN_KEY,(ae=ae.upper)!==null&&ae!==void 0?ae:o.MAX_KEY)]},re={get:function(Z){return[$,new yt(Z.key)]},getMany:function(Z){return[$,new yt().addKeys(Z.keys)]},count:X,query:X,openCursor:X};return s(re).forEach(function(Z){te[Z]=function(ie){var ae=ze.subscr,ne=!!ae,ue=hn(ze,A)&&pr(Z,ie)?ie.obsSet={}:ae;if(ne){var he=function(xe){return xe="idb://".concat(u,"/").concat(b,"/").concat(xe),ue[xe]||(ue[xe]=new yt)},ge=he(""),ve=he(":dels"),ae=re[Z](ie),ne=ae[0],ae=ae[1];if((Z==="query"&&ne.isPrimaryKey&&!ie.values?ve:he(ne.name||"")).add(ae),!ne.isPrimaryKey){if(Z!=="count"){var be=Z==="query"&&H&&ie.values&&A.query(r(r({},ie),{values:!1}));return A[Z].apply(this,arguments).then(function(xe){if(Z==="query"){if(H&&ie.values)return be.then(function(Ue){return Ue=Ue.result,ge.addKeys(Ue),xe});var Ie=ie.values?xe.result.map(K):xe.result;(ie.values?ge:ve).addKeys(Ie)}else if(Z==="openCursor"){var De=xe,Te=ie.values;return De&&Object.create(De,{key:{get:function(){return ve.addKey(De.primaryKey),De.key}},primaryKey:{get:function(){var Ue=De.primaryKey;return ve.addKey(Ue),Ue}},value:{get:function(){return Te&&ge.addKey(De.primaryKey),De.value}}})}return xe})}ve.add(g)}}return A[Z].apply(this,arguments)}}),te}})}};function ii(o,u,g){if(g.numFailures===0)return u;if(u.type==="deleteRange")return null;var b=u.keys?u.keys.length:"values"in u&&u.values?u.values.length:1;return g.numFailures===b?null:(u=r({},u),c(u.keys)&&(u.keys=u.keys.filter(function(A,M){return!(M in g.failures)})),"values"in u&&c(u.values)&&(u.values=u.values.filter(function(A,M){return!(M in g.failures)})),u)}function Ki(o,u){return g=o,((b=u).lower===void 0||(b.lowerOpen?0<Ye(g,b.lower):0<=Ye(g,b.lower)))&&(o=o,(u=u).upper===void 0||(u.upperOpen?Ye(o,u.upper)<0:Ye(o,u.upper)<=0));var g,b}function Ra(o,u,re,b,A,M){if(!re||re.length===0)return o;var $=u.query.index,K=$.multiEntry,H=u.query.range,Q=b.schema.primaryKey.extractKey,te=$.extractKey,X=($.lowLevelIndex||$).extractKey,re=re.reduce(function(Z,ie){var ae=Z,ne=[];if(ie.type==="add"||ie.type==="put")for(var ue=new yt,he=ie.values.length-1;0<=he;--he){var ge,ve=ie.values[he],be=Q(ve);ue.hasKey(be)||(ge=te(ve),(K&&c(ge)?ge.some(function(De){return Ki(De,H)}):Ki(ge,H))&&(ue.addKey(be),ne.push(ve)))}switch(ie.type){case"add":var Ce=new yt().addKeys(u.values?Z.map(function(Te){return Q(Te)}):Z),ae=Z.concat(u.values?ne.filter(function(Te){return Te=Q(Te),!Ce.hasKey(Te)&&(Ce.addKey(Te),!0)}):ne.map(function(Te){return Q(Te)}).filter(function(Te){return!Ce.hasKey(Te)&&(Ce.addKey(Te),!0)}));break;case"put":var we=new yt().addKeys(ie.values.map(function(Te){return Q(Te)}));ae=Z.filter(function(Te){return!we.hasKey(u.values?Q(Te):Te)}).concat(u.values?ne:ne.map(function(Te){return Q(Te)}));break;case"delete":var xe=new yt().addKeys(ie.keys);ae=Z.filter(function(Te){return!xe.hasKey(u.values?Q(Te):Te)});break;case"deleteRange":var Ie=ie.range;ae=Z.filter(function(Te){return!Ki(Q(Te),Ie)})}return ae},o);return re===o?o:(re.sort(function(Z,ie){return Ye(X(Z),X(ie))||Ye(Q(Z),Q(ie))}),u.limit&&u.limit<1/0&&(re.length>u.limit?re.length=u.limit:o.length===u.limit&&re.length<u.limit&&(A.dirty=!0)),M?Object.freeze(re):re)}function La(o,u){return Ye(o.lower,u.lower)===0&&Ye(o.upper,u.upper)===0&&!!o.lowerOpen==!!u.lowerOpen&&!!o.upperOpen==!!u.upperOpen}function To(o,u){return function(g,b,A,M){if(g===void 0)return b!==void 0?-1:0;if(b===void 0)return 1;if((b=Ye(g,b))===0){if(A&&M)return 0;if(A)return 1;if(M)return-1}return b}(o.lower,u.lower,o.lowerOpen,u.lowerOpen)<=0&&0<=function(g,b,A,M){if(g===void 0)return b!==void 0?1:0;if(b===void 0)return-1;if((b=Ye(g,b))===0){if(A&&M)return 0;if(A)return-1;if(M)return 1}return b}(o.upper,u.upper,o.upperOpen,u.upperOpen)}function Ro(o,u,g,b){o.subscribers.add(g),b.addEventListener("abort",function(){var A,M;o.subscribers.delete(g),o.subscribers.size===0&&(A=o,M=u,setTimeout(function(){A.subscribers.size===0&&J(M,A)},3e3))})}var Lo={stack:"dbcore",level:0,name:"Cache",create:function(o){var u=o.schema.name;return r(r({},o),{transaction:function(g,b,A){var M,$,K=o.transaction(g,b,A);return b==="readwrite"&&($=(M=new AbortController).signal,A=function(H){return function(){if(M.abort(),b==="readwrite"){for(var Q=new Set,te=0,X=g;te<X.length;te++){var re=X[te],Z=Yt["idb://".concat(u,"/").concat(re)];if(Z){var ie=o.table(re),ae=Z.optimisticOps.filter(function(Te){return Te.trans===K});if(K._explicit&&H&&K.mutatedParts)for(var ne=0,ue=Object.values(Z.queries.query);ne<ue.length;ne++)for(var he=0,ge=(Ce=ue[ne]).slice();he<ge.length;he++)ei((we=ge[he]).obsSet,K.mutatedParts)&&(J(Ce,we),we.subscribers.forEach(function(Te){return Q.add(Te)}));else if(0<ae.length){Z.optimisticOps=Z.optimisticOps.filter(function(Te){return Te.trans!==K});for(var ve=0,be=Object.values(Z.queries.query);ve<be.length;ve++)for(var Ce,we,xe,Ie=0,De=(Ce=be[ve]).slice();Ie<De.length;Ie++)(we=De[Ie]).res!=null&&K.mutatedParts&&(H&&!we.dirty?(xe=Object.isFrozen(we.res),xe=Ra(we.res,we.req,ae,ie,we,xe),we.dirty?(J(Ce,we),we.subscribers.forEach(function(Te){return Q.add(Te)})):xe!==we.res&&(we.res=xe,we.promise=Se.resolve({result:xe}))):(we.dirty&&J(Ce,we),we.subscribers.forEach(function(Te){return Q.add(Te)})))}}}Q.forEach(function(Te){return Te()})}}},K.addEventListener("abort",A(!1),{signal:$}),K.addEventListener("error",A(!1),{signal:$}),K.addEventListener("complete",A(!0),{signal:$})),K},table:function(g){var b=o.table(g),A=b.schema.primaryKey;return r(r({},b),{mutate:function(M){var $=ze.trans;if(A.outbound||$.db._options.cache==="disabled"||$.explicit||$.idbtrans.mode!=="readwrite")return b.mutate(M);var K=Yt["idb://".concat(u,"/").concat(g)];return K?($=b.mutate(M),M.type!=="add"&&M.type!=="put"||!(50<=M.values.length||On(A,M).some(function(H){return H==null}))?(K.optimisticOps.push(M),M.mutatedParts&&ti(M.mutatedParts),$.then(function(H){0<H.numFailures&&(J(K.optimisticOps,M),(H=ii(0,M,H))&&K.optimisticOps.push(H),M.mutatedParts&&ti(M.mutatedParts))}),$.catch(function(){J(K.optimisticOps,M),M.mutatedParts&&ti(M.mutatedParts)})):$.then(function(H){var Q=ii(0,r(r({},M),{values:M.values.map(function(te,X){var re;return H.failures[X]?te:(te=(re=A.keyPath)!==null&&re!==void 0&&re.includes(".")?j(te):r({},te),S(te,A.keyPath,H.results[X]),te)})}),H);K.optimisticOps.push(Q),queueMicrotask(function(){return M.mutatedParts&&ti(M.mutatedParts)})}),$):b.mutate(M)},query:function(M){if(!hn(ze,b)||!pr("query",M))return b.query(M);var $=((Q=ze.trans)===null||Q===void 0?void 0:Q.db._options.cache)==="immutable",X=ze,K=X.requery,H=X.signal,Q=function(ie,ae,ne,ue){var he=Yt["idb://".concat(ie,"/").concat(ae)];if(!he)return[];if(!(ae=he.queries[ne]))return[null,!1,he,null];var ge=ae[(ue.query?ue.query.index.name:null)||""];if(!ge)return[null,!1,he,null];switch(ne){case"query":var ve=ge.find(function(be){return be.req.limit===ue.limit&&be.req.values===ue.values&&La(be.req.query.range,ue.query.range)});return ve?[ve,!0,he,ge]:[ge.find(function(be){return("limit"in be.req?be.req.limit:1/0)>=ue.limit&&(!ue.values||be.req.values)&&To(be.req.query.range,ue.query.range)}),!1,he,ge];case"count":return ve=ge.find(function(be){return La(be.req.query.range,ue.query.range)}),[ve,!!ve,he,ge]}}(u,g,"query",M),te=Q[0],X=Q[1],re=Q[2],Z=Q[3];return te&&X?te.obsSet=M.obsSet:(X=b.query(M).then(function(ie){var ae=ie.result;if(te&&(te.res=ae),$){for(var ne=0,ue=ae.length;ne<ue;++ne)Object.freeze(ae[ne]);Object.freeze(ae)}else ie.result=j(ae);return ie}).catch(function(ie){return Z&&te&&J(Z,te),Promise.reject(ie)}),te={obsSet:M.obsSet,promise:X,subscribers:new Set,type:"query",req:M,dirty:!1},Z?Z.push(te):(Z=[te],(re=re||(Yt["idb://".concat(u,"/").concat(g)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[M.query.index.name||""]=Z)),Ro(te,Z,K,H),te.promise.then(function(ie){return{result:Ra(ie.result,M,re==null?void 0:re.optimisticOps,b,te,$)}})}})}})}};function ai(o,u){return new Proxy(o,{get:function(g,b,A){return b==="db"?u:Reflect.get(g,b,A)}})}var gr=(tt.prototype.version=function(o){if(isNaN(o)||o<.1)throw new de.Type("Given version is not a positive number");if(o=Math.round(10*o)/10,this.idbdb||this._state.isBeingOpened)throw new de.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,o);var u=this._versions,g=u.filter(function(b){return b._cfg.version===o})[0];return g||(g=new this.Version(o),u.push(g),u.sort(Io),g.stores({}),this._state.autoSchema=!1,g)},tt.prototype._whenReady=function(o){var u=this;return this.idbdb&&(this._state.openComplete||ze.letThrough||this._vip)?o():new Se(function(g,b){if(u._state.openComplete)return b(new de.DatabaseClosed(u._state.dbOpenError));if(!u._state.isBeingOpened){if(!u._state.autoOpen)return void b(new de.DatabaseClosed);u.open().catch(ke)}u._state.dbReadyPromise.then(g,b)}).then(o)},tt.prototype.use=function(o){var u=o.stack,g=o.create,b=o.level,A=o.name;return A&&this.unuse({stack:u,name:A}),o=this._middlewares[u]||(this._middlewares[u]=[]),o.push({stack:u,create:g,level:b??10,name:A}),o.sort(function(M,$){return M.level-$.level}),this},tt.prototype.unuse=function(o){var u=o.stack,g=o.name,b=o.create;return u&&this._middlewares[u]&&(this._middlewares[u]=this._middlewares[u].filter(function(A){return b?A.create!==b:!!g&&A.name!==g})),this},tt.prototype.open=function(){var o=this;return Kt(Tt,function(){return Po(o)})},tt.prototype._close=function(){var o=this._state,u=jr.indexOf(this);if(0<=u&&jr.splice(u,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}o.isBeingOpened||(o.dbReadyPromise=new Se(function(g){o.dbReadyResolve=g}),o.openCanceller=new Se(function(g,b){o.cancelOpen=b}))},tt.prototype.close=function(g){var u=(g===void 0?{disableAutoOpen:!0}:g).disableAutoOpen,g=this._state;u?(g.isBeingOpened&&g.cancelOpen(new de.DatabaseClosed),this._close(),g.autoOpen=!1,g.dbOpenError=new de.DatabaseClosed):(this._close(),g.autoOpen=this._options.autoOpen||g.isBeingOpened,g.openComplete=!1,g.dbOpenError=null)},tt.prototype.delete=function(o){var u=this;o===void 0&&(o={disableAutoOpen:!0});var g=0<arguments.length&&typeof arguments[0]!="object",b=this._state;return new Se(function(A,M){function $(){u.close(o);var K=u._deps.indexedDB.deleteDatabase(u.name);K.onsuccess=Je(function(){var H,Q,te;H=u._deps,Q=u.name,te=H.indexedDB,H=H.IDBKeyRange,zi(te)||Q===bn||Li(te,H).delete(Q).catch(ke),A()}),K.onerror=Ht(M),K.onblocked=u._fireOnBlocked}if(g)throw new de.InvalidArgument("Invalid closeOptions argument to db.delete()");b.isBeingOpened?b.dbReadyPromise.then($):$()})},tt.prototype.backendDB=function(){return this.idbdb},tt.prototype.isOpen=function(){return this.idbdb!==null},tt.prototype.hasBeenClosed=function(){var o=this._state.dbOpenError;return o&&o.name==="DatabaseClosed"},tt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},tt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tt.prototype,"tables",{get:function(){var o=this;return s(this._allTables).map(function(u){return o._allTables[u]})},enumerable:!1,configurable:!0}),tt.prototype.transaction=function(){var o=(function(u,g,b){var A=arguments.length;if(A<2)throw new de.InvalidArgument("Too few arguments");for(var M=new Array(A-1);--A;)M[A-1]=arguments[A];return b=M.pop(),[u,F(M),b]}).apply(this,arguments);return this._transaction.apply(this,o)},tt.prototype._transaction=function(o,u,g){var b=this,A=ze.trans;A&&A.db===this&&o.indexOf("!")===-1||(A=null);var M,$,K=o.indexOf("?")!==-1;o=o.replace("!","").replace("?","");try{if($=u.map(function(Q){if(Q=Q instanceof b.Table?Q.name:Q,typeof Q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Q}),o=="r"||o===nn)M=nn;else{if(o!="rw"&&o!=Hn)throw new de.InvalidArgument("Invalid transaction mode: "+o);M=Hn}if(A){if(A.mode===nn&&M===Hn){if(!K)throw new de.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");A=null}A&&$.forEach(function(Q){if(A&&A.storeNames.indexOf(Q)===-1){if(!K)throw new de.SubTransaction("Table "+Q+" not included in parent transaction.");A=null}}),K&&A&&!A.active&&(A=null)}}catch(Q){return A?A._promise(null,function(te,X){X(Q)}):et(Q)}var H=(function Q(te,X,re,Z,ie){return Se.resolve().then(function(){var ae=ze.transless||ze,ne=te._createTransaction(X,re,te._dbSchema,Z);if(ne.explicit=!0,ae={trans:ne,transless:ae},Z)ne.idbtrans=Z.idbtrans;else try{ne.create(),ne.idbtrans._explicit=!0,te._state.PR1398_maxLoop=3}catch(ge){return ge.name===Oe.InvalidState&&te.isOpen()&&0<--te._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),te.close({disableAutoOpen:!1}),te.open().then(function(){return Q(te,X,re,null,ie)})):et(ge)}var ue,he=oe(ie);return he&&Rt(),ae=Se.follow(function(){var ge;(ue=ie.call(ne,ne))&&(he?(ge=Ge.bind(null,null),ue.then(ge,ge)):typeof ue.next=="function"&&typeof ue.throw=="function"&&(ue=Pn(ue)))},ae),(ue&&typeof ue.then=="function"?Se.resolve(ue).then(function(ge){return ne.active?ge:et(new de.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ae.then(function(){return ue})).then(function(ge){return Z&&ne._resolve(),ne._completion.then(function(){return ge})}).catch(function(ge){return ne._reject(ge),et(ge)})})}).bind(null,this,M,$,A,g);return A?A._promise(M,H,"lock"):ze.trans?Kt(ze.transless,function(){return b._whenReady(H)}):this._whenReady(H)},tt.prototype.table=function(o){if(!v(this._allTables,o))throw new de.InvalidTable("Table ".concat(o," does not exist"));return this._allTables[o]},tt);function tt(o,u){var g=this;this._middlewares={},this.verno=0;var b=tt.dependencies;this._options=u=r({addons:tt.addons,autoOpen:!0,indexedDB:b.indexedDB,IDBKeyRange:b.IDBKeyRange,cache:"cloned"},u),this._deps={indexedDB:u.indexedDB,IDBKeyRange:u.IDBKeyRange},b=u.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var A,M,$,K,H,Q={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ke,dbReadyPromise:null,cancelOpen:ke,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:u.autoOpen};Q.dbReadyPromise=new Se(function(X){Q.dbReadyResolve=X}),Q.openCanceller=new Se(function(X,re){Q.cancelOpen=re}),this._state=Q,this.name=o,this.on=wn(this,"populate","blocked","versionchange","close",{ready:[at,ke]}),this.on.ready.subscribe=R(this.on.ready.subscribe,function(X){return function(re,Z){tt.vip(function(){var ie,ae=g._state;ae.openComplete?(ae.dbOpenError||Se.resolve().then(re),Z&&X(re)):ae.onReadyBeingFired?(ae.onReadyBeingFired.push(re),Z&&X(re)):(X(re),ie=g,Z||X(function ne(){ie.on.ready.unsubscribe(re),ie.on.ready.unsubscribe(ne)}))})}}),this.Collection=(A=this,En(_a.prototype,function(ue,ne){this.db=A;var Z=ki,ie=null;if(ne)try{Z=ne()}catch(he){ie=he}var ae=ue._ctx,ne=ae.table,ue=ne.hook.reading.fire;this._ctx={table:ne,index:ae.index,isPrimKey:!ae.index||ne.schema.primKey.keyPath&&ae.index===ne.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ie,or:ae.or,valueMapper:ue!==Ke?ue:null}})),this.Table=(M=this,En(xa.prototype,function(X,re,Z){this.db=M,this._tx=Z,this.name=X,this.schema=re,this.hook=M._allTables[X]?M._allTables[X].hook:wn(null,{creating:[pe,ke],reading:[Le,Ke],updating:[it,ke],deleting:[vt,ke]})})),this.Transaction=($=this,En(ka.prototype,function(X,re,Z,ie,ae){var ne=this;this.db=$,this.mode=X,this.storeNames=re,this.schema=Z,this.chromeTransactionDurability=ie,this.idbtrans=null,this.on=wn(this,"complete","error","abort"),this.parent=ae||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Se(function(ue,he){ne._resolve=ue,ne._reject=he}),this._completion.then(function(){ne.active=!1,ne.on.complete.fire()},function(ue){var he=ne.active;return ne.active=!1,ne.on.error.fire(ue),ne.parent?ne.parent._reject(ue):he&&ne.idbtrans&&ne.idbtrans.abort(),et(ue)})})),this.Version=(K=this,En(No.prototype,function(X){this.db=K,this._cfg={version:X,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(H=this,En(Qn.prototype,function(X,re,Z){if(this.db=H,this._ctx={table:X,index:re===":id"?null:re,or:Z},this._cmp=this._ascending=Ye,this._descending=function(ie,ae){return Ye(ae,ie)},this._max=function(ie,ae){return 0<Ye(ie,ae)?ie:ae},this._min=function(ie,ae){return Ye(ie,ae)<0?ie:ae},this._IDBKeyRange=H._deps.IDBKeyRange,!this._IDBKeyRange)throw new de.MissingAPI})),this.on("versionchange",function(X){0<X.newVersion?console.warn("Another connection wants to upgrade database '".concat(g.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(g.name,"'. Closing db now to resume the delete request.")),g.close({disableAutoOpen:!1})}),this.on("blocked",function(X){!X.newVersion||X.newVersion<X.oldVersion?console.warn("Dexie.delete('".concat(g.name,"') was blocked")):console.warn("Upgrade '".concat(g.name,"' blocked by other connection holding version ").concat(X.oldVersion/10))}),this._maxKey=fr(u.IDBKeyRange),this._createTransaction=function(X,re,Z,ie){return new g.Transaction(X,re,Z,g._options.chromeTransactionDurability,ie)},this._fireOnBlocked=function(X){g.on("blocked").fire(X),jr.filter(function(re){return re.name===g.name&&re!==g&&!re._state.vcFired}).map(function(re){return re.on("versionchange").fire(X)})},this.use(Oa),this.use(Lo),this.use(Ta),this.use(ni),this.use(Oo);var te=new Proxy(this,{get:function(X,re,Z){if(re==="_vip")return!0;if(re==="table")return function(ae){return ai(g.table(ae),te)};var ie=Reflect.get(X,re,Z);return ie instanceof xa?ai(ie,te):re==="tables"?ie.map(function(ae){return ai(ae,te)}):re==="_createTransaction"?function(){return ai(ie.apply(this,arguments),te)}:ie}});this.vip=te,b.forEach(function(X){return X(g)})}var oi,d=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",l=(p.prototype.subscribe=function(o,u,g){return this._subscribe(o&&typeof o!="function"?o:{next:o,error:u,complete:g})},p.prototype[d]=function(){return this},p);function p(o){this._subscribe=o}try{oi={indexedDB:a.indexedDB||a.mozIndexedDB||a.webkitIndexedDB||a.msIndexedDB,IDBKeyRange:a.IDBKeyRange||a.webkitIDBKeyRange}}catch{oi={indexedDB:null,IDBKeyRange:null}}function m(o){var u,g=!1,b=new l(function(A){var M=oe(o),$,K=!1,H={},Q={},te={get closed(){return K},unsubscribe:function(){K||(K=!0,$&&$.abort(),X&&hr.storagemutated.unsubscribe(Z))}};A.start&&A.start(te);var X=!1,re=function(){return Ai(ie)},Z=function(ae){Nn(H,ae),ei(Q,H)&&re()},ie=function(){var ae,ne,ue;!K&&oi.indexedDB&&(H={},ae={},$&&$.abort(),$=new AbortController,ue=function(he){var ge=rn();try{M&&Rt();var ve=cr(o,he);return ve=M?ve.finally(Ge):ve}finally{ge&&_r()}}(ne={subscr:ae,signal:$.signal,requery:re,querier:o,trans:null}),Promise.resolve(ue).then(function(he){g=!0,u=he,K||ne.signal.aborted||(H={},function(ge){for(var ve in ge)if(v(ge,ve))return;return 1}(Q=ae)||X||(hr(kr,Z),X=!0),Ai(function(){return!K&&A.next&&A.next(he)}))},function(he){g=!1,["DatabaseClosedError","AbortError"].includes(he==null?void 0:he.name)||K||Ai(function(){K||A.error&&A.error(he)})}))};return setTimeout(re,0),te});return b.hasValue=function(){return g},b.getValue=function(){return u},b}var x=gr;function N(o){var u=q;try{q=!0,hr.storagemutated.fire(o),Bi(o,!0)}finally{q=u}}w(x,r(r({},Re),{delete:function(o){return new x(o,{addons:[]}).delete()},exists:function(o){return new x(o,{addons:[]}).open().then(function(u){return u.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(o){try{return u=x.dependencies,g=u.indexedDB,u=u.IDBKeyRange,(zi(g)?Promise.resolve(g.databases()).then(function(b){return b.map(function(A){return A.name}).filter(function(A){return A!==bn})}):Li(g,u).toCollection().primaryKeys()).then(o)}catch{return et(new de.MissingAPI)}var u,g},defineClass:function(){return function(o){f(this,o)}},ignoreTransaction:function(o){return ze.trans?Kt(ze.transless,o):o()},vip:$i,async:function(o){return function(){try{var u=Pn(o.apply(this,arguments));return u&&typeof u.then=="function"?u:Se.resolve(u)}catch(g){return et(g)}}},spawn:function(o,u,g){try{var b=Pn(o.apply(g,u||[]));return b&&typeof b.then=="function"?b:Se.resolve(b)}catch(A){return et(A)}},currentTransaction:{get:function(){return ze.trans||null}},waitFor:function(o,u){return u=Se.resolve(typeof o=="function"?x.ignoreTransaction(o):o).timeout(u||6e4),ze.trans?ze.trans.waitFor(u):u},Promise:Se,debug:{get:function(){return Ve},set:function(o){ht(o)}},derive:k,extend:f,props:w,override:R,Events:wn,on:hr,liveQuery:m,extendObservabilitySet:Nn,getByKeyPath:B,setByKeyPath:S,delByKeyPath:function(o,u){typeof u=="string"?S(o,u,void 0):"length"in u&&[].map.call(u,function(g){S(o,g,void 0)})},shallowClone:z,deepClone:j,getObjectDiff:Ui,cmp:Ye,asap:T,minKey:-1/0,addons:[],connections:jr,errnames:Oe,dependencies:oi,cache:Yt,semVer:"4.0.11",version:"4.0.11".split(".").map(function(o){return parseInt(o)}).reduce(function(o,u,g){return o+u/Math.pow(10,2*g)})})),x.maxKey=fr(x.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(hr(kr,function(o){q||(o=new CustomEvent(Ii,{detail:o}),q=!0,dispatchEvent(o),q=!1)}),addEventListener(Ii,function(o){o=o.detail,q||N(o)}));var L,q=!1,W=function(){};return typeof BroadcastChannel<"u"&&((W=function(){(L=new BroadcastChannel(Ii)).onmessage=function(o){return o.data&&N(o.data)}})(),typeof L.unref=="function"&&L.unref(),hr(kr,function(o){q||L.postMessage(o)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(o){if(!gr.disableBfCache&&o.persisted){Ve&&console.debug("Dexie: handling persisted pagehide"),L!=null&&L.close();for(var u=0,g=jr;u<g.length;u++)g[u].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(o){!gr.disableBfCache&&o.persisted&&(Ve&&console.debug("Dexie: handling persisted pageshow"),W(),N({all:new yt(-1/0,[[]])}))})),Se.rejectionMapper=function(o,u){return!o||o instanceof se||o instanceof TypeError||o instanceof SyntaxError||!o.name||!Ne[o.name]?o:(u=new Ne[o.name](u||o.message,o),"stack"in o&&D(u,"stack",{get:function(){return this.inner.stack}}),u)},ht(Ve),r(gr,Object.freeze({__proto__:null,Dexie:gr,liveQuery:m,Entity:Xn,cmp:Ye,PropModification:_n,replacePrefix:function(o,u){return new _n({replacePrefix:[o,u]})},add:function(o){return new _n({add:o})},remove:function(o){return new _n({remove:o})},default:gr,RangeSet:yt,mergeRanges:Cr,rangesOverlap:Ir}),{default:gr}),gr})}(uo)),uo.exports}var nw=rw();const Uu=Pt(nw),Od=Symbol.for("Dexie"),Ku=globalThis[Od]||(globalThis[Od]=Uu);if(Uu.semVer!==Ku.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Uu.semVer} and ${Ku.semVer}`);const Nt=new Ku("GraphStudioDB");Nt.version(1).stores({settings:"",history:"++id,timestamp"});class iw{constructor(e,t="mixed"){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.layout=e.layout,this.generator=new Zb(this),this.metric=new kf(this),this.graphsPanel=new Jb(this),this.facePanel=new ew(this),this.needsRedraw={node:!0,edge:!0,face:!0,rect:!1},this._saveQueue=Promise.resolve(),this.index=-1,this.cut=!1,this._cutNode=[],this.graphClass={directed:h0,undirected:f0,mixed:gn},this._graph=Yr.empty(this.graphClass[t],0),this._graph.updateAttributes(r=>({...r,label:"Graph",id:0,selected:!1})),this.graphs={index:0,all:[this._graph]},this.selectNodeIndex=0,this.selectEdgeIndex=0,this.subGraph=void 0,this.init()}init(){this.setupEventListeners(),this.graphsPanel.init(),this.facePanel.init()}get graph(){return this.graphs.all[this.graphs.index]}set graph(e){e.mergeAttributes(this.graphs.all[this.graphs.index].getAttributes()),this.graphs.all[this.graphs.index]=e}addNode(e,t){this.graph.addNode(e,t),this.saveGraphState("add node")}async updateIndex(e=null){const t=await Nt.history.count();if(e<0)return console.log("Nothing to Undo...",e,t),!1;if(e>=t)return console.log("Nothing to Redo...",e,t),!1;e===null?this.index=t-1:this.index=e;const r=await this.getSnapshot(this.index);return this.loadSnapshot(r),this.refresh(),!0}clearTo(e="mixed"){this.eventBus.emit("updateSetting",{key:"type",value:e}),this.graph=Yr.empty(this.graphClass[e],0),this.saveGraphState(`new ${e}`)}setupEventListeners(){this.eventBus.on("redo",async e=>{await this.updateIndex(this.index+1)}),this.eventBus.on("undo",async e=>{await this.updateIndex(this.index-1)})}saveGraphState(e="",t=!0){this._saveQueue=this._saveQueue.then(()=>this._performSaveGraphState(e,t)).catch(r=>{console.error("Error saving graph state:",r)})}async _performSaveGraphState(e="",t=!0){var i;const r=await this.getSnapshot(this.index);if(r&&await Nt.history.where("timestamp").above(r.timestamp).delete(),this.settings.saveHistory){const a=((i=this.settings)==null?void 0:i.historyLimit)||100,s={version:1,index:this.graphs.index,all:this.graphs.all.map(c=>c.export()),timestamp:Date.now(),action:e};await this.saveHistory(s),this.index++>=a&&(this.index=a-1),this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),t&&this.app.updateSimulation(),this.redraw()}}redraw(e={node:!0,edge:!0,face:!0,rect:!0}){this.needsRedraw=e,setTimeout(()=>{this.needsRedraw={node:!1,edge:!1,face:!1,rect:!1}},120)}makeGraphComplete(e="directed"){for(let t=0;t<this.graph.order;t++)for(let r=t+1;r<this.graph.order;r++)this.graph.type=="mixed"?e=="undirected"?this.graph.mergeUndirectedEdge(t,r):this.graph.mergeDirectedEdge(t,r):this.graph.mergeEdge(t,r);this.saveGraphState("connect all edges")}dropSelected(){const e=this.graph.getSelectedEdges(),t=this.graph.getSelectedNodes();this.graph.getSelectedFaces().forEach(i=>{this.graph.hasFace(i)&&this.graph.dropFace(i)}),e.forEach(i=>{this.graph.hasEdge(i)&&this.graph.dropEdge(i)}),t.forEach(i=>{this.graph.hasNode(i)&&this.graph.dropNode(i)}),this.app.rect.scale.active=!1,this.saveGraphState("remove selected")}connectSelectedNodes(e="directed"){this.graph.connectSelectedNodes(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge`)}connectSelectedNodesInOrder(e="directed"){this.graph.connectSelectedNodesInOrder(this.settings.edge_color,e),this.saveGraphState(`add ${e} edge in order`)}updateSelectedColor(e=!0,t=!0,r=!0,i=!0,a=!0){this.graph.updateSelectedNodesColor(e?this.settings.node_color:!1,t?this.settings.stroke_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedEdgesColor(r?this.settings.edge_color:!1,a?this.settings.label_color:!1),this.graph.updateSelectedFacesColor(i?this.settings.face_color:!1,a?this.settings.label_color:!1),this.saveGraphState("update color",!1)}updateSelectedName(e){e?(this.graph.updateSelectedName(e),this.updateSelectedGarphsAttributes({label:e})):this.graph.updateSelectedName(""),this.saveGraphState("update name",!1)}getSelectedGraphs(){return this.graphs.all.filter(e=>e.getAttribute("selected"))}updateSelectedGarphsAttributes(e){this.getSelectedGraphs().forEach(t=>{t.mergeAttributes(e)})}updateSelectedInfo(e){if(e){const t={"":e};this.graph.updateSelectedInfo(t),this.updateSelectedGarphsAttributes({desc:t})}else this.graph.updateSelectedInfo({}),this.updateSelectedGarphsAttributes({desc:{}});this.saveGraphState("update info",!1)}updateSelectedWeight(e){const t=parseFloat(e);t?(this.graph.updateSelectedWeight(t),this.updateSelectedGarphsAttributes({weight:t})):(this.graph.updateSelectedWeight(void 0),this.updateSelectedGarphsAttributes({weight:void 0})),this.saveGraphState("update weight",!1)}deselectAll(){this.deselectAllNode(),this.deselectAllEdge(),this.deselectAllFace(),this.deselectAllGraph(),this.redraw()}deselectAllGraph(){for(const e of this.graphs.all)e.updateAttribute("selected",t=>!1);this.app.rect.scale.active=!1}deselectAllNode(){this.graph.updateEachNodeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({node:!0})}deselectAllEdge(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,selected:!1})),this.app.rect.scale.active=!1,this.redraw({edge:!0})}deselectAllFace(){this.graph.forEachFace((e,t)=>this.graph.deselectFace(e)),this.app.rect.scale.active=!1,this.redraw({face:!0})}selectAll(e=null){this.selectAllNode(e),this.selectAllEdge(e),this.selectAllFace(e),this.redraw()}selectAllFace(e){this.deselectAllFace(),e?e.forEach(t=>{this.selectFace(t)}):this.graph.updateEachFaceAttributes((t,r)=>({...r,selected:r.id+1})),this.redraw({face:!0})}selectAllEdge(e){this.deselectAllEdge(),e?e.forEach(t=>{this.selectEdge(t)}):this.graph.updateEachEdgeAttributes((t,r)=>({...r,selected:r.id+1})),this.redraw({edge:!0})}selectAllNode(e){e?(this.deselectAllNode(),e.forEach(t=>{this.graph.hasNode(t)&&this.graph.updateNodeAttributes(t,r=>({...r,selected:r.id+1}))})):this.graph.updateEachNodeAttributes((t,r)=>({...r,selected:r.id+1})),this.redraw({node:!0})}selectNode(e){this.graph.selectNode(e)}selectFace(e){this.graph.selectFace(e)}selectEdge(e){this.graph.selectEdge(e)}selectNextNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=Ba(this.selectNodeIndex+1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectPerviousNode(){this.app.keyHandler.isShiftHold()||this.deselectAllNode(),this.selectNodeIndex=Ba(this.selectNodeIndex-1,this.graph.order);const e=this.graph.nodes()[this.selectNodeIndex];this.graph.selectNode(e)}selectNextEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=Ba(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}selectPerviousEdge(){this.app.keyHandler.isShiftHold()||this.deselectAllEdge(),this.selectEdgeIndex=Ba(this.selectEdgeIndex+1,this.graph.size);const e=this.graph.edges()[this.selectEdgeIndex];this.graph.selectEdge(e)}copySubgraph(){const e=this.graph.getSelectedNodes();if(e.length===0)return null;this.subGraph=this.graph.subgraph(e),this.cut=!1}cutSubgraph(){if(this._cutNode=this.graph.getSelectedNodes(),this._cutNode.length===0)return null;this.subGraph=this.graph.subgraph(this._cutNode),this.cut=!0,this.redraw()}pasteSubgraph(e=!1,t={x:150,y:100}){if(this.subGraph){this.subGraph.forEachNode((r,i)=>{const a={...i};"x"in a&&(a.x+=t.x),"y"in a&&(a.y+=t.y),this.subGraph.replaceNodeAttributes(r,a)}),this.deselectAll(),this.graph.mergeWith(this.subGraph);for(const r of this._cutNode)this.graph.dropNode(r);this.cut=!1,this._cutNode.length=0,this.saveGraphState()}}reverseGraph(){if(this.graph.type!=="undirected"){const e=vi.reverse(this.graph);this.graph.replace(e),this.saveGraphState()}}toDirectedGraph(){if(this.graph.type!=="directed"){const e=vi.toDirected(this.graph);this.clearTo("directed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"directed"}),this.saveGraphState()}}toMixedGraph(){if(this.graph.type!=="mixed"){const e=vi.toMixed(this.graph);this.clearTo("mixed"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"mixed"}),this.saveGraphState()}}toUndirectedGraph(){if(this.graph.type!=="undirected"){const e=vi.toUndirected(this.graph);this.clearTo("undirected"),this.graph.replace(e),this.eventBus.emit("updateSetting",{key:"type",value:"undirected"}),this.saveGraphState()}}toWeighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:1})),this.saveGraphState("add weight to all edge")}toUnweighted(){this.graph.updateEachEdgeAttributes((e,t)=>({...t,weight:void 0})),this.saveGraphState("remove weight from all edge")}async saveHistory(e){var t;try{await Nt.history.add(e);const r=((t=this.settings)==null?void 0:t.historyLimit)||100,i=await Nt.history.count();if(i>r){const s=(await Nt.history.orderBy("id").limit(i-r).toArray()).map(c=>c.id);await Nt.history.bulkDelete(s),console.log(`Pruned ${s.length} old history snapshots.`)}}catch(r){console.error("Failed to save history snapshot:",r)}}async getLastSnapshot(){return await Nt.history.orderBy("id").reverse().first()}async getSnapshot(e){return await Nt.history.orderBy("id").offset(e).limit(1).first()}loadSnapshot(e){this.graphs={index:e.index,all:[]};for(const t of e.all){const r=Yr.empty(this.graphClass[t.options.type],0);this.graphs.all.push(r.import(t))}}refresh(){this.eventBus.emit("updateSetting",{key:"type",value:this.graphs.all[0].type}),this.graphsPanel.updateGraphsPanel(),this.facePanel.updateFacePanel(),this.app.updateSimulation(),this.redraw()}async clearHistory(){await Nt.history.clear(),this.index=-1,console.log("History table cleared.")}subgraph(){if(!this.graph.getSelectedNodes().length){this.metric.addHeader("Graphs"),this.metric.addInfo("Select at least one node"),this.metric.addLine();return}const t=this.graph.copySubgraph();t.removeAttribute("id"),t.removeAttribute("label"),this.graphs.all.push(t),t.deselectAll(),this.deselectAll(),this.saveGraphState("add subgraph")}addFace(){const e=this.graph.getSelectedNodes(),t=vi.subgraph(this.graph,e);this.metric._isCycle(t)&&(this.graph.addFace(e),this.saveGraphState("add face"))}}const aw="Shortcuts",ow={n:{desc:"New graph",action:"new-mixed-btn"},o:{desc:"Import graph",action:"import-graph"},s:{desc:"Scale",action:"toggle-scale-btn",value:!0},u:{desc:"Undo",action:"undo-btn"},d:{desc:"Delete",action:"remove-selection-btn"},c:{desc:"Update color",action:"color-selection-btn"},e:{desc:"Add edge",action:"add-edge-btn"},"alt+e":{desc:"Add edge",action:"add-edge-in-order-btn"},a:{desc:"All node info",action:"all-node-info-btn"},q:{desc:"Clear panel",action:"clear-info-panel-btn"},y:{desc:"Copy",action:"copy-subgraph"},x:{desc:"Cut",action:"cut-subgraph"},p:{desc:"Paste",action:"paste-subgraph"},"ctrl+p":{desc:"Paste",action:"paste-subgraph-seprate"},r:{desc:"Rename",action:"rename-btn"},i:{desc:"Info",action:"desc-btn"},w:{desc:"weight",action:"weight-btn"},f:{desc:"Force Simulation",action:"toggle-force-btn",value:!0},"ctrl+f":{desc:"Force Simulation",action:"add-face-btn"},t:{desc:"Tree",action:"toggle-tree-btn",value:!0},F5:{desc:"Reload",action:"reload"},ArrowUp:{desc:"Select all node",action:"select-all-node"},ArrowDown:{desc:"Deselect all node",action:"deselect-all-node"},ArrowRight:{desc:"Select next node",action:"select-next-node"},ArrowLeft:{desc:"Select previous node",action:"select-pervious-node"},"shift+ArrowRight":{desc:"Select next node",action:"select-next-node"},"shift+ArrowLeft":{desc:"Select previous node",action:"select-pervious-node"},shift:{desc:"Select",action:"toggle-select-btn",value:!0},alt:{desc:"Component",action:"toggle-component-btn",value:!0},ctrl:{desc:"Panning",action:"toggle-panning-btn",value:!0},"alt+a":{desc:"All edge info",action:"all-edge-info-btn"},"alt+ArrowUp":{desc:"Select all edge",action:"select-all-edge"},"alt+ArrowDown":{desc:"Deselect all edge",action:"deselect-all-edge"},"alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"shift+alt+ArrowRight":{desc:"Select next edge",action:"select-next-edge"},"shift+alt+ArrowLeft":{desc:"Select previous edge",action:"select-pervious-edge"},"ctrl+r":{desc:"Redo",action:"redo-btn"},"ctrl+s":{desc:"Export graph",action:"export-graph"},C:{desc:"Complete",action:"complete-btn"},"alt+C":{desc:"Complete",action:"complete-directed-btn"},O:{desc:"Organize circle",action:"organize-circle"},E:{desc:"Add directed edge",action:"add-directed-edge-btn"},"alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},P:{desc:"Export PNG",action:"export-png"},"shift+C":{desc:"Complete",action:"complete-btn"},"shift+alt+C":{desc:"Complete",action:"complete-directed-btn"},"shift+O":{desc:"Organize circle",action:"organize-circle"},"shift+alt+E":{desc:"Add directed edge",action:"add-directed-edge-in-order-btn"},"shift+E":{desc:"Add directed edge",action:"add-directed-edge-btn"},"shift+P":{desc:"Export PNG",action:"export-png"},space:{desc:"Home",action:{c:{desc:"+ Color",action:{c:{desc:"Color Picker",action:"color-picker-btn"},n:{desc:"Update Node Color",action:"update-node-color"},s:{desc:"Update Stroke Color",action:"update-stroke-color"},e:{desc:"Update Edge Color",action:"update-edge-color"},l:{desc:"Update Label Color",action:"update-label-color"}}},n:{desc:"+ New Graph",action:{m:{desc:"Mixed Graph",action:"new-mixed-btn"},d:{desc:"Directed Graph",action:"new-digraph-btn"},u:{desc:"Undirected Graph",action:"new-undirected-graph-btn"}}},"⇒":{desc:"Next Node (Alt for Edge)",action:""},"⇐":{desc:"Pervious Node (Alt for Edge)",action:""},"⇑":{desc:"Select all Nodes (Alt for Edges)",action:""},"⇓":{desc:"Deselect all Nodes (Alt for Edges)",action:""}}}},to={desc:aw,action:ow},Bt=document;class sw{constructor(e){this.app=e,this.eventBus=e.eventBus,this.eventKeyMap={AltRight:"alt",ControlRight:"ctrl",ShiftRight:"shift",AltLeft:"alt",ControlLeft:"ctrl",ShiftLeft:"shift",Space:"space"},this.pressedKeys=new Set,this.lastChord=to.action.space.action,this.modalChord=Bt.querySelector(".modal-chord"),this.inputModal=Bt.querySelector(".modal-input"),this._input=!1,this.header=Bt.querySelector(".modal-chord .shortcut-chord .header"),this.fakeHeader=Bt.querySelector(".modal-chord  .shortcut-chord-fake .header"),this._Chord=Bt.querySelector(".shortcut-chord"),this.fakeChord=Bt.querySelector(".shortcut-chord-fake"),this.exceptionKey=["ArrowUp","ArrowDown","arrowLeft","ArrowRight"]}init(){this.chordGenerator(this.lastChord),Bt.addEventListener("keydown",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const r=this.updatePressedKeys(t,"add");if(this._input){if(r==="Escape"&&this.toggleInput("rename",!1),r==="Enter"){const i=Bt.querySelector(".input-chord input");this.app.menu.handleMenuAction(this._input,i.value),this.toggleInput("rename",!1)}}else{this.isChordVisible()&&this.eventBus.on("key:down",{key:this.pressedKeys});const i=this.findKey();i?t.preventDefault():this.pressedKeys.clear(),this.action(i)}}),Bt.addEventListener("keyup",t=>{if(t.repeat&&!this.exceptionKey.includes(t.key))return;const r=this.updatePressedKeys(t,"delete");this._input||(t.preventDefault(),this.lastChord[r]&&typeof this.lastChord[r].value=="boolean"&&this.app.menu.handleMenuAction(this.lastChord[r].action,!this.lastChord[r].value)),this.eventBus.emit("key:up",{key:this.pressedKeys})});const e=Bt.querySelectorAll(".modal, .modal-chord, .modal-input");e.length>0&&e.forEach(t=>{t.addEventListener("click",r=>{r.target===t&&(t.style.display="none",this.lastChord=to.action,this._input=!1)})})}chordGenerator(e){const t=Bt.createElement("ul");for(const a in e){const s=e[a].desc,c=Bt.createElement("li");c.innerHTML=`
      <span class="title">${a}</span>
      <span class="arrow">→</span>
      <span class="desc">${s}</span>
    `,t.appendChild(c)}const r=this._Chord.querySelector("ul");r&&this._Chord.removeChild(r);const i=this.fakeChord.querySelector("ul");i&&this.fakeChord.removeChild(i),this._Chord.appendChild(t),this.fakeChord.appendChild(t.cloneNode(!0))}action(e){const t=this.lastChord[e];t?typeof t.action=="string"?(this.app.menu.handleMenuAction(t.action,t.value),this.lastChord=to.action,this.toggleChord(!1)):(this.lastChord=t.action,this.chordGenerator(this.lastChord),this.toggleChord(!0)):(this.toggleChord(!1),this.lastChord=to.action)}toggleChord(e=!0){e?this.modalChord.style.display="flex":this.modalChord.style.display="none"}toggleInput(e="rename",t=!0){const r=Bt.querySelector(".input-chord .header"),i=Bt.querySelector(".input-chord input");switch(e){case"rename":r.textContent="Rename",i.name="rename",i.placeholder="Enter New Name ...";break;case"desc":r.textContent="Description",i.name="desc",i.placeholder="Enter New Description ...";break;case"weight":r.textContent="Weight",i.name="weight",i.placeholder="Enter New Weight ...";break}t?(this.inputModal.style.display="flex",i.focus(),this._input=e):(this.inputModal.style.display="none",this._input=!1),setTimeout(()=>{i.value=""},1)}findKey(){return Object.keys(this.lastChord).find(r=>{const i=r.split("+");return this.isCombo(...i)})}isCombo(...e){return e.every(t=>this.pressedKeys.has(t))&&this.pressedKeys.size===e.length}updatePressedKeys(e,t="add"){const r=this.eventKeyMap[e.code]||e.key;return t==="add"&&r!=="meta"?this.pressedKeys.add(r):this.pressedKeys.delete(r),r}isShiftHold(){return this.pressedKeys.has("shift")}isCtrlHold(){return this.pressedKeys.has("ctrl")}isChordVisible(){return this.modalChord.style.display!=="none"}}const nt=document;function co(n,e){nt.querySelector(".container").classList.toggle("grid-hidden",n.grid<=2),nt.getElementById("grid-size-1").value=n.grid,nt.getElementById("vertex-size-1").value=n.node_radius,nt.getElementById("edge-size-1").value=n.edge_size,nt.getElementById("label-size-1").value=n.label_size,nt.getElementById("history-limit-1").value=n.historyLimit,nt.querySelector("#vertex-label .check").classList.toggle("hidden",!n.vertexLabel),nt.querySelector("#edge-label .check").classList.toggle("hidden",!n.edgeLabel),nt.querySelector("#face-label .check").classList.toggle("hidden",!n.faceLabel),nt.querySelector("#weight-label .check").classList.toggle("hidden",!n.weightLabel),nt.querySelector("#performance .check").classList.toggle("hidden",!n.performance),nt.querySelector("#save-history .check").classList.toggle("hidden",!n.saveHistory),nt.querySelector("#component").classList.toggle("gray-background",!n.component),nt.querySelector("#scale").classList.toggle("gray-background",!n.scale),nt.querySelector("#tree").classList.toggle("gray-background",!n.tree),nt.querySelector("#force").classList.toggle("gray-background",!n.forceSimulation),nt.querySelector("#colorPicker").classList.toggle("gray-background",!n.colorPicker),nt.querySelector("#panning").classList.toggle("gray-background",!n.panning),nt.querySelector("#select").classList.toggle("gray-background",!n.select),e.style.cursor=n.panning?"move":"default";const t=nt.documentElement;nt.querySelector(".container").classList.toggle("grid-hidden",n.grid<=2),t.style.setProperty("--grid-size",`${n.grid}px`),t.style.setProperty("--grid-color",n.grid_color),nt.querySelector(".container").style.backgroundColor=n.background_color}var Ln={},Or={},Ji={},Td;function uw(){if(Td)return Ji;Td=1;var n=$e();function e(a,s,c,f){var h=s+"Centrality";if(!n(c))throw new Error("graphology-centrality/"+h+": the given graph is not a valid graphology instance.");if(s!=="degree"&&c.type==="undirected")throw new Error("graphology-centrality/"+h+": cannot compute "+s+" centrality on an undirected graph.");f=f||{};var y=f.nodeCentralityAttribute||h,v=c.order-1,w=c[s].bind(c);if(a){c.updateEachNodeAttributes(function(D,k){return k[y]=w(D)/v,k},{attributes:[y]});return}var E={};return c.forEachNode(function(D){E[D]=w(D)/v}),E}var t=e.bind(null,!1,"degree"),r=e.bind(null,!1,"inDegree"),i=e.bind(null,!1,"outDegree");return t.assign=e.bind(null,!0,"degree"),r.assign=e.bind(null,!0,"inDegree"),i.assign=e.bind(null,!0,"outDegree"),Ji.degreeCentrality=t,Ji.inDegreeCentrality=r,Ji.outDegreeCentrality=i,Ji}var iu,Rd;function cw(){if(Rd)return iu;Rd=1;var n=$e(),e=xf(),t=Et(),r=e.createUnweightedIndexedBrandes,i=e.createDijkstraIndexedBrandes,a={nodeCentralityAttribute:"betweennessCentrality",getEdgeWeight:"weight",normalized:!0};function s(f,h,y){if(!n(h))throw new Error("graphology-centrality/beetweenness-centrality: the given graph is not a valid graphology instance.");y=t(y,a);var v=y.nodeCentralityAttribute,w=y.normalized,E=y.getEdgeWeight?i(h,y.getEdgeWeight):r(h),D=h.order,k,I,P,C,R,_,T,B,S,z,G=new Float64Array(D),F=new Float64Array(D);for(_=0;_<D;_++){for(k=E(_),I=k[0],P=k[1],C=k[2],T=I.size;T--;)G[I.items[I.size-T]]=0;for(;I.size!==0;){for(z=I.pop(),R=(1+G[z])/C[z],T=0,B=P[z].length;T<B;T++)S=P[z][T],G[S]+=C[S]*R;z!==_&&(F[z]+=G[z])}}var U=null;if(w?U=D<=2?null:1/((D-1)*(D-2)):U=h.type==="undirected"?.5:null,U!==null)for(_=0;_<D;_++)F[_]*=U;return f?E.index.assign(v,F):E.index.collect(F)}var c=s.bind(null,!1);return c.assign=s.bind(null,!0),iu=c,iu}var au,Ld;function lw(){if(Ld)return au;Ld=1;var n=$e(),e=Et(),t=pc(),r=Ef(),i=Bn().NeighborhoodIndex,a={nodeCentralityAttribute:"closenessCentrality",wassermanFaust:!1};function s(h){this.index=new i(h,"inbound"),this.queue=new t(Array,h.order),this.seen=new r(h.order)}s.prototype.fromNode=function(h){var y=this.index,v=this.queue,w=this.seen;w.clear(),v.clear(),w.add(h),v.push([h,0]);for(var E,D,k,I,P,C,R=0,_=0;v.size!==0;)for(E=v.shift(),D=E[0],k=E[1],k!==0&&(R+=k,_+=1),P=y.starts[D+1],I=y.starts[D];I<P;I++)C=y.neighborhood[I],!w.has(C)&&(w.add(C),v.push([C,k+1]));return[_,R]};function c(h,y,v){if(!n(y))throw new Error("graphology-metrics/centrality/closeness: the given graph is not a valid graphology instance.");v=e(v,a);var w=v.wassermanFaust,E=new s(y),D=y.order,k,I,P,C,R,_=new Float64Array(D);for(k=0;k<D;k++)I=E.fromNode(k),P=I[0],C=I[1],R=0,C>0&&D>1&&(R=P/C,w&&(R*=P/(D-1))),_[k]=R;return h?E.index.assign(v.nodeCentralityAttribute,_):E.index.collect(_)}var f=c.bind(null,!1);return f.assign=c.bind(null,!0),au=f,au}var ou,zd;function dw(){if(zd)return ou;zd=1;var n=$e(),e=Et(),t=Bn().WeightedNeighborhoodIndex,r={nodeCentralityAttribute:"eigenvectorCentrality",getEdgeWeight:"weight",maxIterations:100,tolerance:1e-6};function i(c){for(var f=0,h=0,y=0,v=c.length;y<v;y++){var w=Math.abs(c[y]);w>f&&(h*=f/w*(f/w),f=w),h+=w===0&&f===0?0:w/f*(w/f)}return f===1/0?1:f*Math.sqrt(h)}function a(c,f,h){if(!n(f))throw new Error("graphology-metrics/centrality/eigenvector: the given graph is not a valid graphology instance.");h=e(h,r);var y=h.maxIterations,v=h.tolerance,w=f.order,E=new t(f,h.getEdgeWeight),D,k,I,P,C=new Float64Array(f.order);for(D=0;D<w;D++)C[D]=1/w;for(var R=0,_=0,T,B,S,z=!1;R<y;){for(B=C,C=new Float64Array(B),D=0;D<w;D++)for(I=E.starts[D+1],k=E.starts[D];k<I;k++)T=E.neighborhood[k],P=E.weights[k],C[T]+=B[D]*P;for(S=i(C),D=0;D<w;D++)C[D]/=S;for(_=0,D=0;D<w;D++)_+=Math.abs(C[D]-B[D]);if(_<w*v){z=!0;break}R++}if(!z)throw Error("graphology-metrics/centrality/eigenvector: failed to converge.");if(c){E.assign(h.nodeCentralityAttribute,C);return}return E.collect(C)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),ou=s,ou}var su,$d;function hw(){if($d)return su;$d=1;var n=Et(),e=$e(),t=Gr().createEdgeWeightGetter,r={nodeAuthorityAttribute:"authority",nodeHubAttribute:"hub",getEdgeWeight:"weight",maxIterations:100,normalize:!0,tolerance:1e-8};function i(f,h){var y=Object.create(null),v,w;for(v=0,w=f.length;v<w;v++)y[f[v]]=h;return y}function a(f){var h=0;for(var y in f)h+=f[y];return h}function s(f,h,y){if(!e(h))throw new Error("graphology-hits: the given graph is not a valid graphology instance.");if(h.multi)throw new Error("graphology-hits: the HITS algorithm does not work with MultiGraphs.");y=n(y,r);var v=t(y.getEdgeWeight).fromEntry,w=h.order,E=h.nodes(),D,k=i(E,1/w),I={},P=!1,C,R,_,T,B,S,z,G,F,U,V,j,ye;for(h.forEachEdge(function(fe,Y,O,J,ee,ce,oe){I[fe]=v(fe,Y,O,J,ee,ce,oe)}),S=0;S<y.maxIterations;S++){for(C=k,k=i(E,0),R=i(E,0),G=0,z=0,V=0;V<w;V++)for(_=E[V],D=h.outboundEdges(_),j=0,ye=D.length;j<ye;j++)B=D[j],T=h.opposite(_,B),R[T]+=C[_]*I[B],R[T]>z&&(z=R[T]);for(V=0;V<w;V++)for(_=E[V],D=h.outboundEdges(_),j=0,ye=D.length;j<ye;j++)B=D[j],T=h.opposite(_,B),k[_]+=R[T]*I[B],k[T]>G&&(G=k[T]);U=1/G;for(_ in k)k[_]*=U;U=1/z;for(_ in R)R[_]*=U;F=0;for(_ in k)F+=Math.abs(k[_]-C[_]);if(F<y.tolerance){P=!0;break}}if(!P)throw Error("graphology-metrics/centrality/hits: failed to converge.");if(y.normalize){U=1/a(R);for(_ in R)R[_]*=U;U=1/a(k);for(_ in k)k[_]*=U}if(f){h.updateEachNodeAttributes(function(fe,Y){return Y[y.nodeAuthorityAttribute]=R[fe],Y[y.nodeHubAttribute]=k[fe],Y},{attributes:[y.nodeAuthorityAttribute,y.nodeHubAttribute]});return}return{hubs:k,authorities:R}}var c=s.bind(null,!1);return c.assign=s.bind(null,!0),su=c,su}var uu,Gd;function fw(){if(Gd)return uu;Gd=1;var n=$e(),e=Et(),t=Bn().WeightedNeighborhoodIndex,r={nodePagerankAttribute:"pagerank",getEdgeWeight:"weight",alpha:.85,maxIterations:100,tolerance:1e-6};function i(s,c,f){if(!n(c))throw new Error("graphology-metrics/centrality/pagerank: the given graph is not a valid graphology instance.");f=e(f,r);var h=f.alpha,y=f.maxIterations,v=f.tolerance,w=f.nodePagerankAttribute,E=c.order,D=1/E,k=new t(c,f.getEdgeWeight),I,P,C,R,_=new Float64Array(c.order),T=new Float64Array(k.weights.length),B=[];for(I=0;I<E;I++)for(_[I]=D,C=k.starts[I+1],R=k.outDegrees[I],R===0&&B.push(I),P=k.starts[I];P<C;P++)T[P]=k.weights[P]/R;for(var S=0,z=0,G,F,U,V=!1;S<y;){for(U=_,_=new Float64Array(c.order),G=0,I=0,C=B.length;I<C;I++)G+=U[B[I]];for(G*=h,I=0;I<E;I++){for(C=k.starts[I+1],P=k.starts[I];P<C;P++)F=k.neighborhood[P],_[F]+=h*U[I]*T[P];_[I]+=G*D+(1-h)*D}for(z=0,I=0;I<E;I++)z+=Math.abs(_[I]-U[I]);if(z<E*v){V=!0;break}S++}if(!V)throw Error("graphology-metrics/centrality/pagerank: failed to converge.");if(s){k.assign(w,_);return}return k.collect(_)}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),uu=a,uu}var qd;function pw(){if(qd)return Or;qd=1;var n=uw();return Or.betweenness=cw(),Or.closeness=lw(),Or.eigenvector=dw(),Or.hits=hw(),Or.pagerank=fw(),Or.degree=n.degreeCentrality,Or.inDegree=n.inDegreeCentrality,Or.outDegree=n.outDegreeCentrality,Or}var ro={},cu,Fd;function gw(){if(Fd)return cu;Fd=1;var n=$e(),e=ga(),t=Et(),r=Gr().createEdgeWeightGetter,i={edgeDisparityAttribute:"disparity",getEdgeWeight:"weight"};function a(c,f,h){if(!n(f))throw new Error("graphology-metrics/edge/disparity: the given graph is not a valid graphology instance.");if(f.multi||e(f)==="mixed")throw new Error("graphology-metrics/edge/disparity: not defined for multi nor mixed graphs.");h=t(h,i);var y=r(h.getEdgeWeight).fromEntry,v={};f.forEachNode(function(I){v[I]=0}),f.forEachAssymetricAdjacencyEntry(function(I,P,C,R,_,T,B){var S=y(_,T,I,P,C,R,B);v[I]+=S,v[P]+=S});var w,E,D,k={};if(f.forEachAssymetricAdjacencyEntry(function(I,P,C,R,_,T,B){var S=y(_,T,I,P,C,R,B);w!==I&&(w=I,E=f.degree(I),D=v[I]);var z=f.degree(P),G=v[P],F=S/D,U=S/G,V=Math.pow(1-F,E-1),j=Math.pow(1-U,z-1);k[_]=Math.min(V,j)}),c){f.updateEachEdgeAttributes(function(I,P){return P[h.edgeDisparityAttribute]=k[I],P},{attributes:[h.edgeDisparityAttribute]});return}return k}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),cu=s,cu}var lu,jd;function yw(){if(jd)return lu;jd=1;var n=$e(),e=Ao().intersectionSize;function t(i,a){if(!n(a))throw new Error("graphology-metrics/simmelian-strength: given graph is not a valid graphology instance.");var s={};if(a.forEachNode(function(f){s[f]=new Set(a.neighbors(f))}),!i){var c={};return a.forEachEdge(function(f,h,y,v){c[f]=e(s[y],s[v])}),c}a.updateEachEdgeAttributes(function(f,h,y,v){return h.simmelianStrength=e(s[y],s[v]),h},{attributes:["simmelianStrength"]})}var r=t.bind(null,!1);return r.assign=t.bind(null,!0),lu=r,lu}var Bd;function vw(){return Bd||(Bd=1,ro.disparity=gw(),ro.simmelianStrength=yw()),ro}var Mt={},Tr={},du,Ud;function Df(){if(Ud)return du;Ud=1;var n=$e();return du=function(t){if(!n(t))throw new Error("graphology-metrics/simple-size: the given graph is not a valid graphology instance.");if(!t.multi)return t.size;var r=0,i=0;function a(){r++}function s(){i++}return t.forEachNode(function(c){t.type!=="directed"&&t.forEachUndirectedNeighbor(c,a),t.type!=="undirected"&&t.forEachOutNeighbor(c,s)}),r/2+i},du}var Kd;function mw(){if(Kd)return Tr;Kd=1;var n=$e(),e=Df();function t(s,c){return 2*c/(s*(s-1))}function r(s,c){return c/(s*(s-1))}function i(s,c){var f=s*(s-1);return c/(f+f/2)}function a(s,c,f){var h,y;if(arguments.length>3){if(h=f,y=arguments[3],typeof h!="number"||h<0)throw new Error("graphology-metrics/density: given order is not a valid number.");if(typeof y!="number"||y<0)throw new Error("graphology-metrics/density: given size is not a valid number.")}else{if(!n(f))throw new Error("graphology-metrics/density: given graph is not a valid graphology instance.");h=f.order,y=f.size,f.multi&&c===!1&&(y=e(f))}if(h<2)return 0;s===null&&(s=f.type),c===null&&(c=f.multi);var v;return s==="undirected"?v=t:s==="directed"?v=r:v=i,v(h,y)}return Tr.abstractDensity=a,Tr.density=a.bind(null,null,null),Tr.directedDensity=a.bind(null,"directed",!1),Tr.undirectedDensity=a.bind(null,"undirected",!1),Tr.mixedDensity=a.bind(null,"mixed",!1),Tr.multiDirectedDensity=a.bind(null,"directed",!0),Tr.multiUndirectedDensity=a.bind(null,"undirected",!0),Tr.multiMixedDensity=a.bind(null,"mixed",!0),Tr}var no={},Wd;function bw(){if(Wd)return no;Wd=1;var n=$e();function e(r,i){if(!n(r))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,c,f,h={};for(f=0;f<a.length;f++)c=a[f],h[c]=[1/0,-1/0];return r.forEachNode(function(y,v){for(f=0;f<a.length;f++)c=a[f],s=v[c],s<h[c][0]&&(h[c][0]=s),s>h[c][1]&&(h[c][1]=s)}),typeof i=="string"?h[i]:h}function t(r,i){if(!n(r))throw new Error("graphology-metrics/extent: the given graph is not a valid graphology instance.");var a=[].concat(i),s,c,f,h={};for(f=0;f<a.length;f++)c=a[f],h[c]=[1/0,-1/0];return r.forEachEdge(function(y,v){for(f=0;f<a.length;f++)c=a[f],s=v[c],s<h[c][0]&&(h[c][0]=s),s>h[c][1]&&(h[c][1]=s)}),typeof i=="string"?h[i]:h}return no.nodeExtent=e,no.edgeExtent=t,no}var hu,Hd;function Cf(){if(Hd)return hu;Hd=1;var n=$e(),e=fa().singleSourceLength;return hu=function(r,i){if(!n(r))throw new Error("graphology-metrics/eccentricity: given graph is not a valid graphology instance.");if(r.size===0)return 1/0;var a=-1/0,s=e(r,i),c,f,h=0;for(c in s)f=s[c],f>a&&(a=f),h++;return h<r.order?1/0:a},hu}var fu,Yd;function ww(){if(Yd)return fu;Yd=1;var n=$e(),e=Cf();return fu=function(r){if(!n(r))throw new Error("graphology-metrics/diameter: given graph is not a valid graphology instance.");if(r.size===0)return 1/0;var i=-1/0;return r.someNode(function(a){var s=e(r,a);return s>i&&(i=s),i===1/0}),i},fu}var pu,Xd;function Ew(){if(Xd)return pu;Xd=1;var n=Et(),e=$e(),t=ga(),r=Gr(),i={getNodeCommunity:"community",getEdgeWeight:"weight",resolution:1};function a(C,R){var _=new Array(C.order),T=new Float64Array(C.order),B={},S=0,z=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry,G=r.createNodeValueGetter(R.getNodeCommunity).fromEntry,F=0,U={};return C.forEachNode(function(V,j){U[V]=F,_[F++]=G(V,j)}),C.forEachUndirectedEdge(function(V,j,ye,fe,Y,O,J){var ee=z(V,j,ye,fe,Y,O,J);S+=ee,B[V]=ee,T[U[ye]]+=ee,ye!==fe&&(T[U[fe]]+=ee)}),{weights:B,communities:_,weightedDegrees:T,M:S}}function s(C,R){var _=new Array(C.order),T=new Float64Array(C.order),B=new Float64Array(C.order),S={},z=0,G=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry,F=r.createNodeValueGetter(R.getNodeCommunity).fromEntry,U=0,V={};return C.forEachNode(function(j,ye){V[j]=U,_[U++]=F(j,ye)}),C.forEachDirectedEdge(function(j,ye,fe,Y,O,J,ee){var ce=G(j,ye,fe,Y,O,J,ee);z+=ce,S[j]=ce,B[V[fe]]+=ce,T[V[Y]]+=ce}),{weights:S,communities:_,weightedInDegrees:T,weightedOutDegrees:B,M:z}}function c(C,R){var _=R.resolution,T=a(C,R),B=T.communities,S=T.weightedDegrees,z=T.M,G=C.nodes(),F,U,V,j,ye,fe,Y=0,O=z*2;for(F=0,V=C.order;F<V;F++)for(U=0;U<V;U++)B[F]===B[U]&&(fe=C.undirectedEdge(G[F],G[U]),j=T.weights[fe]||0,ye=S[F]*S[U],F===U&&typeof fe<"u"?Y+=(j-ye/O*_)*2:Y+=j-ye/O*_);return Y/O}function f(C,R){var _=R.resolution,T=s(C,R),B=T.communities,S=T.weightedInDegrees,z=T.weightedOutDegrees,G=T.M,F=C.nodes(),U,V,j,ye,fe,Y,O=0;for(U=0,j=C.order;U<j;U++)for(V=0;V<j;V++)B[U]===B[V]&&(Y=C.directedEdge(F[U],F[V]),ye=T.weights[Y]||0,fe=S[U]*z[V],O+=ye-fe/G*_);return O/G}function h(C,R){var _={},T={},B={},S=r.createNodeValueGetter(R.getNodeCommunity).fromEntry;return C.forEachNode(function(z,G){var F=S(z,G);if(_[z]=F,typeof F>"u")throw new Error('graphology-metrics/modularity: the "'+z+'" node is not in the partition.');T[F]=0,B[F]=0}),{communities:_,totalWeights:T,internalWeights:B}}function y(C,R){var _={},T={},B={},S={},z=r.createNodeValueGetter(R.getNodeCommunity).fromEntry;return C.forEachNode(function(G,F){var U=z(G,F);if(_[G]=U,typeof U>"u")throw new Error('graphology-metrics/modularity: the "'+G+'" node is not in the partition.');T[U]=0,B[U]=0,S[U]=0}),{communities:_,totalInWeights:T,totalOutWeights:B,internalWeights:S}}function v(C,R){var _=R.resolution,T=h(C,R),B=0,S=T.totalWeights,z=T.internalWeights,G=T.communities,F=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry;C.forEachUndirectedEdge(function(ye,fe,Y,O,J,ee,ce){var oe=F(ye,fe,Y,O,J,ee,ce);B+=oe;var le=G[Y],se=G[O];S[le]+=oe,S[se]+=oe,le===se&&(z[le]+=oe*2)});var U=0,V=B*2;for(var j in z)U+=z[j]/V-Math.pow(S[j]/V,2)*_;return U}function w(C,R){var _=R.resolution,T=y(C,R),B=0,S=T.totalInWeights,z=T.totalOutWeights,G=T.internalWeights,F=T.communities,U=r.createEdgeWeightGetter(R.getEdgeWeight).fromEntry;C.forEachDirectedEdge(function(ye,fe,Y,O,J,ee,ce){var oe=U(ye,fe,Y,O,J,ee,ce);B+=oe;var le=F[Y],se=F[O];z[le]+=oe,S[se]+=oe,le===se&&(G[le]+=oe)});var V=0;for(var j in G)V+=G[j]/B-S[j]*z[j]/Math.pow(B,2)*_;return V}function E(C,R,_,T){return T/(2*C)-R*_/(2*(C*C))}function D(C,R,_,T,B,S){return S/C-(B*R+T*_)/(C*C)}function k(C,R){if(!e(C))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(C.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(C.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var _=t(C);if(_==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return R=n(R,i),_==="directed"?f(C,R):c(C,R)}function I(C,R){if(!e(C))throw new Error("graphology-metrics/modularity: given graph is not a valid graphology instance.");if(C.size===0)throw new Error("graphology-metrics/modularity: cannot compute modularity of an empty graph.");if(C.multi)throw new Error("graphology-metrics/modularity: cannot compute modularity of a multi graph. Cast it to a simple one beforehand.");var _=t(C);if(_==="mixed")throw new Error("graphology-metrics/modularity: cannot compute modularity of a mixed graph.");return R=n(R,i),_==="directed"?w(C,R):v(C,R)}var P=I;return P.sparse=I,P.dense=k,P.undirectedDelta=E,P.directedDelta=D,pu=P,pu}var gu,Vd;function xw(){if(Vd)return gu;Vd=1;var n=$e(),e=Gr().createEdgeWeightGetter,t="weight";return gu=function(i,a){if(!n(i))throw new Error("graphology-metrics/weighted-size: the given graph is not a valid graphology instance.");a=e(a||t).fromEntry;var s=0;return i.forEachEdge(function(c,f,h,y,v,w,E){s+=a(c,f,h,y,v,w,E)}),s},gu}var Qd;function _w(){if(Qd)return Mt;Qd=1;var n=mw(),e=bw();return Mt.diameter=ww(),Mt.modularity=Ew(),Mt.simpleSize=Df(),Mt.weightedSize=xw(),Mt.abstractDensity=n.abstractDensity,Mt.density=n.density,Mt.directedDensity=n.directedDensity,Mt.undirectedDensity=n.undirectedDensity,Mt.mixedDensity=n.mixedDensity,Mt.multiDirectedDensity=n.multiDirectedDensity,Mt.multiUndirectedDensity=n.multiUndirectedDensity,Mt.multiMixedDensity=n.multiMixedDensity,Mt.nodeExtent=e.nodeExtent,Mt.edgeExtent=e.edgeExtent,Mt}var ea={},yu,Zd;function Sw(){if(Zd)return yu;Zd=1;var n=$e();function e(t,r){return Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2))}return yu=function(r){if(!n(r))throw new Error("graphology-metrics/layout-quality/edge-uniformity: given graph is not a valid graphology instance.");if(r.size===0)return 0;var i=0,a=0,s,c=new Float64Array(r.size);r.forEachEdge(function(v,w,E,D,k,I){var P=e(k,I);c[a++]=P,i+=P});var f=i/r.size,h=0;for(a=0,s=r.size;a<s;a++)h+=Math.pow(f-c[a],2);var y=h/(r.size*Math.pow(f,2));return Math.sqrt(y)},yu}var vu,Jd;function Aw(){if(Jd)return vu;Jd=1;var n=$e(),e=_f(),t=Ao().intersectionSize;return vu=function(i){if(!n(i))throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/neighborhood-preservation: cannot compute stress for a null graph.");if(i.size===0)return 0;var a=[new Float64Array(i.order),new Float64Array(i.order)],s=0;i.forEachNode(function(h,y){a[0][s]=y.x,a[1][s++]=y.y});var c=e.fromAxes(a,i.nodes()),f=0;return i.forEachNode(function(h,y){var v=new Set(i.neighbors(h));if(v.size===0||v.size===i.order-1){f+=1;return}var w=c.kNearestNeighbors(v.size+1,[y.x,y.y]);w=new Set(w.slice(1));var E=t(v,w);f+=E/w.size}),f/i.order},vu}var mu,eh;function kw(){if(eh)return mu;eh=1;var n=$e(),e=fa().undirectedSingleSourceLength;function t(r,i){return Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))}return mu=function(i){if(!n(i))throw new Error("graphology-metrics/layout-quality/stress: given graph is not a valid graphology instance.");if(i.order===0)throw new Error("graphology-metrics/layout-quality/stress: cannot compute stress for a null graph.");var a=new Array(i.order),s=new Array(i.order),c=0,f=i.order*4;i.forEachNode(function(C,R){a[c]=C,s[c++]=R});var h,y,v,w,E,D,k,I,P=0;for(c=0,y=i.order;c<y;c++)for(E=e(i,a[c]),v=s[c],h=c+1;h<y;h++)w=s[h],D=E[a[h]],typeof D>"u"&&(D=f),I=t(v,w),k=1/(D*D),P+=k*Math.pow(I-D,2);return P},mu}var th;function Dw(){return th||(th=1,ea.edgeUniformity=Sw(),ea.neighborhoodPreservation=Aw(),ea.stress=kw()),ea}var Rr={},Wr={},rh;function Cw(){if(rh)return Wr;rh=1;var n=$e(),e="weight";function t(r,i,a,s,c){if(!n(a))throw new Error("graphology-metrics/"+r+": the given graph is not a valid graphology instance.");c=c||e;var f=0;return a[i](s,function(h,y,v,w,E,D,k){var I=typeof c=="function"?c(h,y,v,w,E,D,k):y[c];(typeof I!="number"||isNaN(I))&&(I=1),f+=I}),f}return Wr.weightedDegree=t.bind(null,"weightedDegree","forEachEdge"),Wr.weightedInDegree=t.bind(null,"weightedInDegree","forEachInEdge"),Wr.weightedOutDegree=t.bind(null,"weightedOutDegree","forEachOutEdge"),Wr.weightedInboundDegree=t.bind(null,"weightedInboundDegree","forEachInboundEdge"),Wr.weightedOutboundDegree=t.bind(null,"weightedOutboundDegree","forEachOutboundEdge"),Wr.weightedUndirectedDegree=t.bind(null,"weightedUndirectedDegree","forEachUndirectedEdge"),Wr.weightedDirectedDegree=t.bind(null,"weightedDirectedDegree","forEachDirectedEdge"),Wr}var nh;function Iw(){if(nh)return Rr;nh=1;var n=Cw();return Rr.eccentricity=Cf(),Rr.weightedDegree=n.weightedDegree,Rr.weightedInDegree=n.weightedInDegree,Rr.weightedOutDegree=n.weightedOutDegree,Rr.weightedInboundDegree=n.weightedInboundDegree,Rr.weightedOutboundDegree=n.weightedOutboundDegree,Rr.weightedUndirectedDegree=n.weightedUndirectedDegree,Rr.weightedDirectedDegree=n.weightedDirectedDegree,Rr}var ih;function Mw(){return ih||(ih=1,Ln.centrality=pw(),Ln.edge=vw(),Ln.graph=_w(),Ln.layoutQuality=Dw(),Ln.node=Iw()),Ln}var bu,ah;function Nw(){return ah||(ah=1,bu=Mw()),bu}Nw();var Gn;const mi=class mi{constructor(e){mc(this,Gn,!0);if(this.app=e,this.eventBus=e.eventBus,mi.instance)return mi.instance;mi.instance=this,this.debounceTimer=null,this.defaultSettings={background_color:"#ffffff",colorPicker:!1,component:!1,console_panel:!0,directed:!0,directed_edge:!0,edgeLabel:!0,edge_color:"#4682b4",edge_size:2,forceSimulation:!0,force_edge:!1,grid:20,type:"mixed",grid_color:"#00000020",info_panel:!0,label_color:"#000000",label_pos:{x:0,y:0},label_size:15,node_color:"#ffffff",face_color:"#4682b455",node_radius:40,panning:!1,scale:!1,select:!1,stroke_color:"#4682b4",stroke_size:2,tools_panel:!0,tree:!0,vertexLabel:!0,faceLabel:!0,weightLabel:!0,saveHistory:!0,historyLimit:100,graphs_panel:!0,face_panel:!0,performance:!1},this.nightSkyTheme={background_color:"#0d1b2a",edge_color:"#60a5fa",edge_size:1,forceSimulation:!1,grid_color:"#ffffff10",label_color:"#d1d5db",label_pos:{x:-20,y:-20},node_color:"#ffffff",node_radius:10,stroke_color:"#ffffff",stroke_size:0},this.registerEventListeners()}async init(){return this.settings=await this.loadFromIndexDb(),this.settings}registerEventListeners(){this.eventBus.on("updateSetting",e=>{const{key:t,value:r}=e.detail;this.setSetting(t,r)}),this.eventBus.on("updateAllSettings",e=>{const t=e.detail;t&&typeof t=="object"&&this.setAllSettings(t)}),this.eventBus.on("resetSettings",()=>{this.resetToDefault()}),this.eventBus.on("toggleSetting",e=>{const{key:t,value:r}=e.detail;t&&(this.toggleSetting(t,r),this.app.graphManager.needsRedraw={node:t=="vertexLabel",edge:t=="directed_edge"||t=="edgeLabel"||t=="weightLabel",face:t=="faceLabel"})})}async loadFromIndexDb(){try{const e=await Nt.settings.get("appSettings"),t=this.validateSettings(e);return Object.keys(this.defaultSettings).some(i=>!e||!(i in e))?(await Nt.settings.put(t,"appSettings"),console.log("Missing or invalid keys found — defaults merged and saved.")):console.log("Settings loaded successfully from IndexedDB."),t}catch(e){return console.warn("Failed to load settings from IndexedDB. Using defaults.",e),{...this.defaultSettings}}}saveToIndexedDB(e=this.settings){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(async()=>{try{await Nt.settings.update("appSettings",e),console.log("Settings saved to IndexedDB"),this.app.graphManager.needsRedraw={node:!1,edge:!1,face:!1,rect:!1}}catch(t){console.error("Failed to save settings to IndexedDB",t)}},500)}resetToDefault(){this.setAllSettings(this.defaultSettings)}getSetting(e){return this.settings[e]}getAllSettings(){return{...this.settings}}setSetting(e,t){const r=this.settings[e];if(e in this.settings){if(this.settings[e]!==t)switch(this.settings[e]=t,$a(this,Gn)&&this.settings[e]!=r&&this.saveToIndexedDB({[e]:this.settings[e]}),co(this.settings,this.app.canvas),e){case"node_radius":this.app.graphManager.needsRedraw={node:!0};break;case"stroke_size":this.app.graphManager.needsRedraw={node:!0};break;case"edge_size":this.app.graphManager.needsRedraw={edge:!0};break;case"label_size":this.app.graphManager.needsRedraw={node:!0,edge:!0,face:!0};break}}else console.warn(`Setting "${e}" does not exist.`)}setAllSettings(e){Object.keys(e).forEach(t=>{t in this.settings&&(this.settings[t]=e[t])}),$a(this,Gn)&&this.saveToIndexedDB(),co(this.settings,this.app.canvas)}toggleSetting(e,t=null){const r=["scale","panning","select","component"],i=this.settings[e];e in this.settings&&typeof this.settings[e]=="boolean"?(console.log(),t===null?this.settings[e]=!this.settings[e]:this.settings[e]=t,r.includes(e)&&(this.settings.forceSimulation=!1,r.forEach(a=>{a!=e&&this.settings[e]&&(this.settings[a]=!1)})),e==="forceSimulation"&&(this.settings.forceSimulation?(r.forEach(a=>{this.settings[e]&&(this.settings[a]=!1)}),this.app.startSimulation()):this.app.stopSimulation()),this.settings.performance&&(this.settings.forceSimulation=!1),$a(this,Gn)&&this.settings[e]!=i&&!r.includes(e)&&this.saveToIndexedDB({[e]:this.settings[e]}),co(this.settings,this.app.canvas),this.app.widget.init()):console.warn(`Setting "${e}" does not exist or is not a boolean.`)}setAutoSave(e){bc(this,Gn,e)}validateSettings(e){const t=this.defaultSettings,r={};for(const i in t)r[i]=e!=null&&e.hasOwnProperty(i)?e[i]:t[i];return r}loadNightSkyTheme(){this.setAllSettings(this.nightSkyTheme)}};Gn=new WeakMap,Ct(mi,"instance",null);let Wu=mi;const qe=document;class Pw{constructor(e,t,r="menu-bar"){if(this.app=e,this.eventBus=e.eventBus,this.graphManager=e.graphManager,this.appSettings=e.appSettings,this.layout=e.layout,this.menuData=t,this.container=qe.getElementById(r),!this.container){console.error("Menu container not found!");return}this.spaceEvent=new KeyboardEvent("keydown",{key:" ",code:"Space",keyCode:32,which:32,bubbles:!0})}init(){this.renderMenu(),this.attachEventListeners()}renderMenu(){this.container.innerHTML="";const e=qe.createElement("ul");this.menuData.forEach(t=>{const r=this.createMenu(t);e.appendChild(r)}),this.container.appendChild(e)}createMenu(e){const t=qe.createElement("li");if(e.id&&(t.id=e.id),e.title&&(t.textContent=e.title),e.submenu){const r=this.createSubmenu(e.submenu);t.appendChild(r)}return t}createSubmenu(e){const t=qe.createElement("ul");return e.forEach(r=>{if(r.type==="divider"){t.appendChild(qe.createElement("hr"));return}const i=qe.createElement("li");if(r.id&&(i.id=r.id),r.title){const a=qe.createElement("label");if(a.textContent=r.title,r.link){const s=qe.createElement("a");s.href=r.link,s.target="_blank",r.label?s.textContent=r.label:(s.textContent="?",s.classList.add("border")),a.insertBefore(s,a.firstChild)}i.appendChild(a)}if(r.shortcut){const a=qe.createElement("span");a.textContent=r.shortcut,i.appendChild(a)}if("check"in r&&!r.shortcut){const a=qe.createElement("span");a.innerHTML="&#10004;",a.classList.add("check"),r.check||a.classList.add("hidden"),i.appendChild(a)}if(r.input)if(r.id==="import-graph")i.appendChild(this.createInput(r.input[0]));else{const a=qe.createElement("div");r.input.forEach(s=>{a.appendChild(this.createInput(s))}),i.appendChild(a)}r.name&&i.setAttribute("name",r.name),r.submenu&&i.appendChild(this.createSubmenu(r.submenu)),t.appendChild(i)}),t}createInput(e){const t=qe.createElement("input");return t.type=e.type||"text",t.id=e.id,"hidden"in e&&(t.hidden=e.hidden),e.name&&(t.name=e.name),e.placeholder&&(t.placeholder=e.placeholder),e.required&&(t.required=!0),["number","range","date"].includes(t.type)&&(e.min!==void 0&&(t.min=e.min),e.max!==void 0&&(t.max=e.max),e.step!==void 0&&(t.step=e.step)),e.value!==void 0&&(e.type==="checkbox"||e.type==="radio"?t.checked=e.value:t.value=e.value),t}handleMenuAction(e,t){const r={"new-mixed-btn":()=>{this.graphManager.clearTo("mixed")},"new-digraph-btn":()=>{this.graphManager.clearTo("directed")},"new-undirected-graph-btn":()=>{this.graphManager.clearTo("undirected")},"import-graph":()=>this.eventBus.emit("import"),"export-graph":()=>this.eventBus.emit("export",{type:"json"}),"export-png":()=>this.eventBus.emit("export",{type:"png"}),"default-settings-btn":()=>this.appSettings.resetToDefault(),"sky-night-theme-btn":()=>this.appSettings.loadNightSkyTheme(),reload:()=>location.reload(),"add-edge-btn":()=>this.graphManager.connectSelectedNodes("undirected"),"add-face-btn":()=>this.graphManager.addFace(),"add-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("undirected"),"add-directed-edge-btn":()=>this.graphManager.connectSelectedNodes("directed"),"add-directed-edge-in-order-btn":()=>this.graphManager.connectSelectedNodesInOrder("directed"),"remove-selection-btn":()=>this.graphManager.dropSelected(),"color-selection-btn":()=>this.graphManager.updateSelectedColor(!0,!0,!0,!0),"complete-btn":()=>this.graphManager.makeGraphComplete("undirected"),"complete-directed-btn":()=>this.graphManager.makeGraphComplete("directed"),"node-color":()=>this.eventBus.emit("updateSetting",{key:"node_color",value:t}),"edge-color":()=>this.eventBus.emit("updateSetting",{key:"edge_color",value:t}),"label-color":()=>this.eventBus.emit("updateSetting",{key:"label_color",value:t}),"stroke-color":()=>this.eventBus.emit("updateSetting",{key:"stroke_color",value:t}),"background-color":()=>{qe.querySelector(".container").style.backgroundColor=t,this.eventBus.emit("updateSetting",{key:"background_color",value:t})},"grid-color":()=>{qe.documentElement.style.setProperty("--grid-color",t),this.eventBus.emit("updateSetting",{key:"grid_color",value:t})},rename:()=>this.graphManager.updateSelectedName(t),"rename-btn":()=>this.app.keyHandler.toggleInput("rename"),desc:()=>this.graphManager.updateSelectedInfo(t),"desc-btn":()=>this.app.keyHandler.toggleInput("desc"),weight:()=>this.graphManager.updateSelectedWeight(t),"weight-btn":()=>this.app.keyHandler.toggleInput("weight"),"redo-btn":()=>this.eventBus.emit("redo"),"undo-btn":()=>this.eventBus.emit("undo"),"panel-btn":()=>this.eventBus.emit("toggleSetting",{key:"info_panel"}),"tools-btn":()=>this.eventBus.emit("toggleSetting",{key:"tools_panel"}),"graphs-btn":()=>this.eventBus.emit("toggleSetting",{key:"graphs_panel"}),"faces-btn":()=>this.eventBus.emit("toggleSetting",{key:"face_panel"}),"shortcut-chord-btn":()=>qe.dispatchEvent(this.spaceEvent),"component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component"}),"scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale"}),"tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree"}),"force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation"}),"panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning"}),"select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select"}),"toggle-component-btn":()=>this.eventBus.emit("toggleSetting",{key:"component",value:t}),"toggle-scale-btn":()=>this.eventBus.emit("toggleSetting",{key:"scale",value:t}),"toggle-tree-btn":()=>this.eventBus.emit("toggleSetting",{key:"tree",value:t}),"toggle-force-btn":()=>this.eventBus.emit("toggleSetting",{key:"forceSimulation",value:t}),"toggle-panning-btn":()=>this.eventBus.emit("toggleSetting",{key:"panning",value:t}),"toggle-select-btn":()=>this.eventBus.emit("toggleSetting",{key:"select",value:t}),"color-picker-btn":()=>this.eventBus.emit("toggleSetting",{key:"colorPicker"}),"vertex-label":()=>this.eventBus.emit("toggleSetting",{key:"vertexLabel"}),"edge-label":()=>this.eventBus.emit("toggleSetting",{key:"edgeLabel"}),"face-label":()=>this.eventBus.emit("toggleSetting",{key:"faceLabel"}),"weight-label":()=>this.eventBus.emit("toggleSetting",{key:"weightLabel"}),"vertex-size-1":()=>this.eventBus.emit("updateSetting",{key:"node_radius",value:t}),"edge-size-1":()=>this.eventBus.emit("updateSetting",{key:"edge_size",value:t}),"label-size-1":()=>this.eventBus.emit("updateSetting",{key:"label_size",value:t}),"grid-size-1":()=>this.eventBus.emit("updateSetting",{key:"grid",value:t}),"stroke-size-1":()=>this.eventBus.emit("updateSetting",{key:"stroke_size",value:t}),performance:()=>this.eventBus.emit("toggleSetting",{key:"performance"}),"save-history":()=>this.eventBus.emit("toggleSetting",{key:"saveHistory"}),"clear-histoory-btn":()=>this.graphManager.clearHistory(),"history-limit-1":()=>{this.graphManager.limit=t,this.eventBus.emit("updateSetting",{key:"historyLimit",value:t})},"basic-info-btn":()=>this.graphManager.metric.basicInfo(),"lies-on-cycle-btn":()=>this.graphManager.metric.liesOnCycle(),"list-degrees-btn":()=>this.graphManager.metric.degreeSequesnce(),"components-btn":()=>this.graphManager.metric.countComponents(),"neighbors-btn":()=>this.graphManager.metric.neighbors(),"shortest-path-btn":()=>this.graphManager.metric.shortestPath(),"density-btn":()=>this.graphManager.metric.density(),"diameter-btn":()=>this.graphManager.metric.diameter(),"eccentricity-btn":()=>this.graphManager.metric.eccentricity(),"simmelian-strength-btn":()=>this.graphManager.metric.simmelianStrength(),"betweenness-centrality-btn":()=>this.graphManager.metric.betweennessCentrality(),"closeness-centrality-btn":()=>this.graphManager.metric.closenessCentrality(),"degree-centrality-btn":()=>this.graphManager.metric.degreeCentrality(),"eigenvector-centrality-btn":()=>this.graphManager.metric.eigenvectorCentrality(),"pagerank-btn":()=>this.graphManager.metric.pagerank(),"edge-uniformity-btn":()=>this.graphManager.metric.edgeUniformity(),"neighborhood-preservation-btn":()=>this.graphManager.metric.neighborhoodPreservation(),"stress-btn":()=>this.graphManager.metric.stress(),"disparity-btn":()=>this.graphManager.metric.disparity(),"clear-info-panel-btn":()=>qe.querySelector("#floating-panel .body-info").innerHTML="","all-node-info-btn":()=>this.graphManager.metric.allNodeInfo(),"all-edge-info-btn":()=>this.graphManager.metric.allEdgeInfo(),"all-face-info-btn":()=>this.graphManager.metric.allFaceInfo(),"all-graph-info-btn":()=>this.graphManager.metric.allGraphInfo(),empty:()=>this.graphManager.generator.empty(qe.getElementById("g-empty-1").value),"g-empty-1":()=>this.graphManager.generator.empty(t),cycle:()=>this.graphManager.generator.cycle(qe.getElementById("g-cycle-1").value),"g-cycle-1":()=>this.graphManager.generator.cycle(t),path:()=>this.graphManager.generator.path(qe.getElementById("g-path-1").value),"g-path-1":()=>this.graphManager.generator.path(t),ladder:()=>this.graphManager.generator.ladder(qe.getElementById("g-ladder-1").value),"g-ladder-1":()=>this.graphManager.generator.ladder(t),complete:()=>this.graphManager.generator.complete(qe.getElementById("g-complete-1").value),"g-complete-1":()=>this.graphManager.generator.complete(t),"complete-bipartite":()=>this.graphManager.generator.completeBipartite(qe.getElementById("g-complete-bipartite-1").value,qe.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-1":()=>this.graphManager.generator.completeBipartite(t,qe.getElementById("g-complete-bipartite-2").value),"g-complete-bipartite-2":()=>this.graphManager.generator.completeBipartite(qe.getElementById("g-complete-bipartite-1").value,t),caveman:()=>this.graphManager.generator.caveman(qe.getElementById("g-caveman-1").value,qe.getElementById("g-caveman-2").value),"g-caveman-1":()=>this.graphManager.generator.caveman(t,qe.getElementById("g-caveman-2").value),"g-caveman-2":()=>this.graphManager.generator.caveman(qe.getElementById("g-caveman-1").value,t),"connected-caveman":()=>this.graphManager.generator.connectedCaveman(qe.getElementById("g-connected-caveman-1").value,qe.getElementById("g-connected-caveman-2").value),"g-connected-caveman-1":()=>this.graphManager.generator.connectedCaveman(t,qe.getElementById("g-connected-caveman-2").value),"g-connected-caveman-2":()=>this.graphManager.generator.connectedCaveman(qe.getElementById("g-connected-caveman-1").value,t),clusters:()=>this.graphManager.generator.clusters(qe.getElementById("g-clusters-1").value,qe.getElementById("g-clusters-2").value,qe.getElementById("g-clusters-3").value),"g-clusters-1":()=>this.graphManager.generator.clusters(t,qe.getElementById("g-clusters-2").value,qe.getElementById("g-clusters-3").value),"g-clusters-2":()=>this.graphManager.generator.clusters(qe.getElementById("g-clusters-1").value,t,qe.getElementById("g-clusters-3").value),"g-clusters-3":()=>this.graphManager.generator.clusters(qe.getElementById("g-clusters-1").value,qe.getElementById("g-clusters-2").value,t),"erdos-renyi":()=>this.graphManager.generator.erdosRenyi(qe.getElementById("g-erdos-renyi-1").value,qe.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-1":()=>this.graphManager.generator.erdosRenyi(t,qe.getElementById("g-erdos-renyi-2").value),"g-erdos-renyi-2":()=>this.graphManager.generator.erdosRenyi(qe.getElementById("g-erdos-renyi-1").value,t),"griven-newmn":()=>this.graphManager.generator.girvanNewman(qe.getElementById("g-girvan-newman-1").value),"g-girvan-newman-1":()=>this.graphManager.generator.girvanNewman(t),"krackhardt-kite":()=>this.graphManager.generator.krackhardtkite(),"florentine-families":()=>this.graphManager.generator.florentineFamilies(),"karate-club":()=>this.graphManager.generator.karateClub(),aries:()=>this.graphManager.generator.zodiac.aries(),taurus:()=>this.graphManager.generator.zodiac.taurus(),gemini:()=>this.graphManager.generator.zodiac.gemini(),cancer:()=>this.graphManager.generator.zodiac.cancer(),leo:()=>this.graphManager.generator.zodiac.leo(),virgo:()=>this.graphManager.generator.zodiac.virgo(),libra:()=>this.graphManager.generator.zodiac.libra(),scorpius:()=>this.graphManager.generator.zodiac.scorpius(),ophiuchus:()=>this.graphManager.generator.zodiac.ophiuchus(),sagittarius:()=>this.graphManager.generator.zodiac.sagittarius(),capricornus:()=>this.graphManager.generator.zodiac.capricornus(),aquarius:()=>this.graphManager.generator.zodiac.aquarius(),pisces:()=>this.graphManager.generator.zodiac.pisces(),"organize-circle":()=>this.layout.applyLayout("circle"),"center-layout":()=>this.layout.applyLayout("center"),"random-layout":()=>this.layout.applyLayout("random"),"rotate-layout-1":()=>this.layout.applyLayout("rotate",t),"rotate-layout":()=>{const i=qe.getElementById("rotate-layout-1").value;return this.layout.applyLayout("rotate",i)},"hflip-layout":()=>this.layout.applyLayout("h-flip"),"vflip-layout":()=>this.layout.applyLayout("v-flip"),"force-layout":()=>this.layout.applyLayout("force",{itteration:qe.getElementById("force-itteration").value,gravity:qe.getElementById("force-gravity").value}),"froce-itteration":()=>this.layout.applyLayout("force",{val:t,gravity:qe.getElementById("force-gravity").value}),"force-gravity":()=>this.layout.applyLayout("force",{itteration:qe.getElementById("force-itteration").value,gravity:t}),"noverlap-layout":()=>this.layout.applyLayout("noverlap"),"reverse-direction":()=>this.graphManager.reverseGraph(),"to-undirected":()=>this.graphManager.toUndirectedGraph(),"to-directed":()=>this.graphManager.toDirectedGraph(),"to-mixed":()=>this.graphManager.toMixedGraph(),"to-weighted":()=>this.graphManager.toWeighted(),"to-unweighted":()=>this.graphManager.toUnweighted(),"subgraph-btn":()=>this.graphManager.subgraph(),graphs:()=>this.graphManager.graphsPanel.selectLis(t),faces:()=>this.graphManager.facePanel.selectLis(t),"how-to-use":()=>window.open("https://www.youtube.com/playlist?list=PLaa8UNGS4QED9DUhAZt7O963qkScAWah3","_blank"),command:()=>{qe.querySelector(".modal").style.display="flex",qe.querySelector(".modal .help-panel").style.display="block"},about:()=>window.open("http://picinfiniti.net/","_blank"),"select-all-node":()=>this.graphManager.selectAllNode(),"deselect-all-node":()=>this.graphManager.deselectAllNode(),"select-next-node":()=>this.graphManager.selectNextNode(),"select-pervious-node":()=>this.graphManager.selectPerviousNode(),"select-all-edge":()=>this.graphManager.selectAllEdge(),"deselect-all-edge":()=>this.graphManager.deselectAllEdge(),"select-next-edge":()=>this.graphManager.selectNextEdge(),"select-pervious-edge":()=>this.graphManager.selectPerviousEdge(),"copy-subgraph":()=>this.graphManager.copySubgraph(),"cut-subgraph":()=>this.graphManager.cutSubgraph(),"paste-subgraph":()=>this.graphManager.pasteSubgraph(),"paste-subgraph-seprate":()=>this.graphManager.pasteSubgraph(!0),"update-node-color":()=>this.graphManager.updateSelectedColor(!0,!1,!1,!1,!1),"update-stroke-color":()=>this.graphManager.updateSelectedColor(!1,!0,!1,!1,!1),"update-edge-color":()=>this.graphManager.updateSelectedColor(!1,!1,!0,!1,!1),"update-face-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!0,!1),"update-label-color":()=>this.graphManager.updateSelectedColor(!1,!1,!1,!1,!0)};r[e]?r[e]():console.log(`No action defined for: ${e}`)}attachEventListeners(){qe.addEventListener("click",e=>{if(e.target.tagName==="INPUT")return;const t=e.target.closest("li");if(!t)return;const r=t.getAttribute("name")||t.id;r&&this.handleMenuAction(r,t.id)}),qe.addEventListener("input",e=>{const t=e.target;if(!t||t.name=="rename"||t.name=="desc"||t.name=="weight")return;const r=t.id||t.getAttribute("name");if(r){const i=t.value||1;this.handleMenuAction(r,i)}})}}const fi=document;class Ow{constructor(e){this.app=e,this.eventBus=e.eventBus}init(){this.app.eventBus.on("import",e=>{fi.getElementById("file-input").click()}),this.app.eventBus.on("export",async e=>{const t=document;if(e.detail.type==="json")try{const r=[];r.push("[");let i=!0;await Nt.history.orderBy("id").each(f=>{i||r.push(`,
`),r.push(JSON.stringify(f,null,2)),i=!1}),r.push("]");const a=new Blob(r,{type:"application/json"}),s=URL.createObjectURL(a),c=t.createElement("a");c.href=s,c.download="graph-history.json",t.body.appendChild(c),c.click(),t.body.removeChild(c),URL.revokeObjectURL(s),console.log("Efficient history export completed.")}catch(r){console.error("Failed to stream-export history:",r)}e.detail.type==="png"&&this.exportGraphAsImage()}),fi.getElementById("file-input").addEventListener("change",async e=>{const t=e.target.files[0];if(t){try{const r=new FileReader;r.onload=async i=>{try{const a=JSON.parse(i.target.result);if(!Array.isArray(a)){alert("Invalid file format. Expected an array of snapshots.");return}if(a.length===0){alert("The file contains no history snapshots.");return}if(!confirm("Importing will erase your current history. Continue?"))return;a.sort((f,h)=>f.id-h.id),await Nt.history.clear(),await Nt.history.bulkAdd(a);const c=await this.app.graphManager.getLastSnapshot();c?(this.app.graphManager.loadSnapshot(c),this.app.graphManager.refresh(),console.log(`Imported ${a.length} snapshots into history.`)):alert("Import succeeded, but no usable snapshot was found.")}catch(a){console.error("Failed to import history:",a),alert("Import failed. The file may be corrupted or not valid JSON.")}},r.readAsText(t)}catch(r){console.error("File reading error:",r),alert("Failed to read the selected file.")}e.target.value=""}})}exportGraphAsImage(){const e=this.app.canvas.width,t=this.app.canvas.height,r=fi.createElement("canvas");r.width=e,r.height=t;const i=r.getContext("2d");i.drawImage(this.app._canvas._canvas.face.canvas,0,0),i.drawImage(this.app._canvas._canvas.edge.canvas,0,0),i.drawImage(this.app._canvas._canvas.node.canvas,0,0),r.toBlob(a=>{if(!a){console.error("Export failed: canvas may be empty or tainted.");return}const s=fi.createElement("a");s.href=URL.createObjectURL(a),s.download="graph-studio-export.png",fi.body.appendChild(s),s.click(),fi.body.removeChild(s)},"image/png")}}const Tw=[{title:"File",id:"file",submenu:[{title:"🆕 New Graph",id:"new-mixed-btn",shortcut:"(n)"},{title:"📂 Import",id:"import-graph",shortcut:"(o)",input:[{type:"file",id:"file-input",hidden:!0}]},{title:"💾 Export",id:"export-graph",shortcut:"(Ctrl+s)"},{title:"🖼️ Export to PNG",id:"export-png",shortcut:"(P)"},{type:"divider"},{title:"⚙️ Default Setting",id:"default-settings-btn"},{title:"🌙 Sky Night",id:"sky-night-theme-btn"},{type:"divider"},{title:"🔄 Reload",id:"reload",shortcut:"(F5)"}]},{title:"Edit",id:"edit",submenu:[{title:"Delete",name:"remove-selection-btn",shortcut:"(d)"},{title:"Assign Color",name:"color-selection-btn",shortcut:"(c)"},{title:"Add Edge",name:"add-edge-btn",shortcut:"(alt-e)"},{title:"Add Directed Edge",name:"add-directed-edge-btn",shortcut:"(alt-E)"},{title:"Add Face",name:"add-face-btn",shortcut:"(ctrl+f)"},{type:"divider"},{title:"Copy",name:"copy-subgraph",shortcut:"(y)"},{title:"Cut",name:"cut-subgraph",shortcut:"(x)"},{title:"Paste",name:"paste-subgraph",shortcut:"(p)"},{type:"divider"},{title:"Rename",name:"rename-btn",shortcut:"(r)"},{title:"Edit Info",name:"desc-btn",shortcut:"(i)"},{title:"Edit Weight",name:"weight-btn",shortcut:"(w)"},{type:"divider"},{title:"Undo",name:"undo-btn",shortcut:"(u)"},{title:"Redo",name:"redo-btn",shortcut:"(Ctrl+r)"}]},{title:"Settings",id:"settings",submenu:[{title:"Graph",id:"graph-settings",shortcut:">",submenu:[{title:"Vertex",id:"vertex-label",check:!0},{title:"Edge",id:"edge-label",check:!0},{title:"Face",id:"face-label",check:!0},{title:"Weight",id:"weight-label",check:!0},{type:"divider"},{title:"Grid",id:"gride-size",input:[{type:"range",id:"grid-size-1",min:0,max:100,value:20}]},{title:"Node",id:"vertex-size",input:[{type:"range",id:"vertex-size-1",min:0,max:200,value:10,step:.1}]},{title:"Edge",id:"edge-size",input:[{type:"range",id:"edge-size-1",min:1,max:100,value:2}]},{title:"Label",id:"label-size",input:[{type:"range",id:"label-size-1",min:0,max:100,value:15}]},{title:"Stroke",id:"stroke-size",input:[{type:"range",id:"stroke-size-1",min:0,max:50,value:5,step:.1}]}]},{title:"View",id:"view",shortcut:">",submenu:[{title:"Info Panel",id:"panel-btn",check:!0},{title:"Tools Panel",id:"tools-btn",check:!0},{title:"Graphs Panel",id:"graphs-btn",check:!0},{title:"Face Panel",id:"faces-btn",check:!0},{type:"divider"},{title:"Key Chord",id:"shortcut-chord-btn",shortcut:"⎵"}]},{type:"divider"},{title:"Performance",id:"performance",check:!0},{title:"History",id:"History",shortcut:">",submenu:[{title:"History Limit",id:"history-limit",input:[{type:"number",id:"history-limit-1",min:5,max:1e4,value:5}]},{title:"Save History",id:"save-history",check:!0},{title:"Clear History",id:"clear-histoory-btn"}]}]},{title:"Tools",id:"tools",submenu:[{title:"Scale",id:"scale-btn",check:!1,shortcut:"(s)"},{title:"Panning",id:"panning-btn",check:!1,shortcut:"Ctrl"},{title:"Selecting",id:"select-btn",check:!1,shortcut:"Shift"},{title:"Component",id:"component-btn",check:!1,shortcut:"Alt"},{type:"divider"},{title:"Tree",id:"tree-btn",check:!1,shortcut:"(t)"},{title:"Force Simulation",id:"force-btn",check:!1,shortcut:"(f)"},{type:"divider"},{title:"Color Picker",id:"color-picker-btn",check:!1,shortcut:"⎵ cc"}]},{title:"Generator",id:"generator",submenu:[{title:"Classic",id:"classic",shortcut:">",submenu:[{title:"Empty",id:"empty",input:[{type:"number",id:"g-empty-1",min:1,max:500,value:5}]},{title:"Kₙ",id:"complete",link:"https://en.wikipedia.org/wiki/Complete_graph",input:[{type:"number",id:"g-complete-1",min:1,max:500,value:5}]},{title:"Kₙ,ₙ",id:"complete-bipartite",link:"https://en.wikipedia.org/wiki/Complete_bipartite_graph",input:[{type:"number",id:"g-complete-bipartite-1",min:1,max:500,value:5},{type:"number",id:"g-complete-bipartite-2",min:1,max:500,value:5}]},{title:"Pₙ",id:"path",link:"https://en.wikipedia.org/wiki/Path_graph",input:[{type:"number",id:"g-path-1",min:2,max:500,value:5}]},{title:"Cₙ",id:"cycle",link:"https://en.wikipedia.org/wiki/Cycle_graph",input:[{type:"number",id:"g-cycle-1",min:3,max:500,value:5}]},{title:"Lₙ",id:"ladder",link:"https://en.wikipedia.org/wiki/Ladder_graph",input:[{type:"number",id:"g-ladder-1",min:2,max:500,value:5}]}]},{title:"Community",id:"community",shortcut:">",submenu:[{title:"Cₙ,ₙ",id:"caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-caveman-2",min:1,max:500,value:5}]},{title:"Qₙ,ₙ",id:"connected-caveman",link:"https://mathworld.wolfram.com/CavemanGraph.html",input:[{type:"number",id:"g-connected-caveman-1",min:1,max:500,value:5},{type:"number",id:"g-connected-caveman-2",min:1,max:500,value:5}]}]},{title:"Random",id:"random",shortcut:">",submenu:[{title:"Clusters",id:"clusters",input:[{type:"number",id:"g-clusters-1",min:2,max:500,value:20},{type:"number",id:"g-clusters-2",min:2,max:500,value:20},{type:"number",id:"g-clusters-3",min:2,max:500,value:10}]},{title:"erdos Renyi",id:"erdos-renyi",link:"https://en.wikipedia.org/wiki/Erd%C5%91s%E2%80%93R%C3%A9nyi_model",input:[{type:"number",id:"g-erdos-renyi-1",min:1,max:500,value:10},{type:"number",id:"g-erdos-renyi-2",min:0,max:1,step:.1,value:.5}]},{title:"Girvan Newman",id:"griven-newmn",link:"https://www.pnas.org/doi/pdf/10.1073/pnas.122653799",input:[{type:"number",id:"g-girvan-newman-1",min:1,max:500,value:5}]}]},{title:"Small",id:"small",shortcut:">",submenu:[{title:"Krackhardt kite",id:"krackhardt-kite",link:"https://en.wikipedia.org/wiki/Krackhardt_kite_graph"}]},{title:"Social",id:"social",shortcut:">",submenu:[{title:"Florentine families",id:"florentine-families"},{title:"Zachary’s karate club",id:"karate-club",link:"https://en.wikipedia.org/wiki/Zachary%27s_karate_club"}]},{type:"divider"},{title:"Zodiac",id:"zodiac",shortcut:">",submenu:[{title:"Aries",id:"aries",label:"♈",link:"https://en.wikipedia.org/wiki/Aries_(astrology)"},{title:"Taurus",id:"taurus",label:"♉",link:"https://en.wikipedia.org/wiki/Taurus_(astrology)"},{title:"Gemini",id:"gemini",label:"♊",link:"https://en.wikipedia.org/wiki/Gemini_(astrology)"},{title:"Cancer",id:"cancer",label:"♋",link:"https://en.wikipedia.org/wiki/Cancer_(astrology)"},{title:"Leo",id:"leo",label:"♌",link:"https://en.wikipedia.org/wiki/Leo_(astrology)"},{title:"Virgo",id:"virgo",label:"♍",link:"https://en.wikipedia.org/wiki/Virgo_(astrology)"},{title:"Libra",id:"libra",label:"♎",link:"https://en.wikipedia.org/wiki/Libra_(astrology)"},{title:"Scorpius",id:"scorpius",label:"♏",link:"https://en.wikipedia.org/wiki/Scorpio_(astrology)"},{title:"Ophiuchus",id:"ophiuchus",label:"⛎",link:"https://en.wikipedia.org/wiki/Ophiuchus_(astrology)"},{title:"Sagittarius",id:"sagittarius",label:"♐",link:"https://en.wikipedia.org/wiki/Sagittarius_(astrology)"},{title:"Capricornus",id:"capricornus",label:"♑",link:"https://en.wikipedia.org/wiki/Capricorn_(astrology)"},{title:"Aquarius",id:"aquarius",label:"♒",link:"https://en.wikipedia.org/wiki/Aquarius_(astrology)"},{title:"Pisces",id:"pisces",label:"♓",link:"https://en.wikipedia.org/wiki/Pisces_(astrology)"}]}]},{title:"Metrics",id:"metrics",submenu:[{title:"Basic",id:"basic",shortcut:">",submenu:[{title:"Basic Information",id:"basic-info-btn"},{title:"Components",id:"components-btn"},{title:"Lies On Cycle",id:"lies-on-cycle-btn"},{title:"Degree Sequence",id:"list-degrees-btn"},{title:"Density",id:"density-btn"},{title:"Diameter",id:"diameter-btn"}]},{title:"Centrality",id:"centrality",shortcut:">",submenu:[{title:"Betweenness Centrality",id:"betweenness-centrality-btn"},{title:"Closeness Centrality",id:"closeness-centrality-btn"},{title:"Degree Centrality",id:"degree-centrality-btn"},{title:"Eccentricity",id:"eccentricity-btn"},{title:"Eigenvector Centrality",id:"eigenvector-centrality-btn"},{title:"PageRank",id:"pagerank-btn"}]},{title:"Layout Quality",id:"layout-quality",shortcut:">",submenu:[{title:"Edge Uniformity",id:"edge-uniformity-btn"},{title:"Neighborhood Preservation",id:"neighborhood-preservation-btn"},{title:"Stress",id:"stress-btn"}]},{title:"Other",shortcut:">",id:"other",submenu:[{title:"Simmelian Strength",id:"simmelian-strength-btn"},{title:"Disparity",id:"disparity-btn"}]},{type:"divider"},{title:"Neighbors",id:"neighbors-btn"},{title:"Shortest Path",id:"shortest-path-btn"},{title:"Selected Nodes Info",id:"all-node-info-btn",shortcut:"(a)"},{title:"Selected Edges Info",id:"all-edge-info-btn",shortcut:"(Alt+a)"},{title:"Selected Faces Info",id:"all-face-info-btn"},{title:"Selected Graphs Info",id:"all-graph-info-btn"},{type:"divider"},{title:"Clear Panel",id:"clear-info-panel-btn",shortcut:"(q)"}]},{title:"Operators",id:"help",submenu:[{title:"Layout",id:"layout",shortcut:">",submenu:[{title:"Center Nodes",name:"center-layout"},{title:"Organize Nodes",name:"organize-circle",shortcut:"(O)"},{title:"Random",name:"random-layout"},{title:"Vertical Flip",name:"vflip-layout"},{title:"Horizontal Flip",name:"hflip-layout"},{title:"Rotate",name:"rotate-layout",input:[{type:"number",id:"rotate-layout-1",min:-180,max:180,value:45}]},{type:"divider"},{title:"Force Atlas",name:"force-layout",input:[{type:"number",id:"force-itteration",min:0,max:500,value:50},{type:"number",id:"force-gravity",min:0,max:1,value:25}],link:"https://graphology.github.io/standard-library/layout-forceatlas2.html"}]},{title:"Converter",id:"converter",shortcut:">",submenu:[{title:"To Mixed",id:"to-mixed"},{title:"To Undirected",id:"to-undirected"},{title:"To Directed",id:"to-directed"},{title:"To Weighted",id:"to-weighted"},{title:"To Unweighted",id:"to-unweighted"}]},{title:"Reverse Direction",id:"reverse-direction"},{title:"Subgraph",id:"subgraph-btn"},{title:"Complete Graph",name:"complete-btn",shortcut:"(alt-C)"}]},{title:"Help",id:"help",submenu:[{title:"Mouse Commnads",id:"command",name:"command-btn"},{title:"How to use",id:"how-to-use"},{title:"About",id:"about",shortcut:"version: 1.9.8"}]}];var pi={},oh;function Rw(){if(oh)return pi;oh=1;var n=$e();function e(c){return typeof c=="number"&&!isNaN(c)}var t=["x","y"];function r(c,f){if(!n(c))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.exhaustive!==!1;h||(h=t);var v={},w=h.length;return c.forEachNode(function(E,D){var k=0,I={},P;for(P=0;P<w;P++){var C=h[P],R=D[C];e(R)&&(I[C]=R,k++)}y?k===w&&(v[E]=I):k&&(v[E]=I)}),v}function i(c,f,h){if(!n(c))throw new Error("graphology-layout/utils.assignLayout: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions||t,v=y.length,w;c.updateEachNodeAttributes(function(E,D){var k=f[E];if(!k)return D;for(var I=0;I<v;I++)w=y[I],D[w]=k[w];return D},{attributes:y})}function a(c,f){if(!n(c))throw new Error("graphology-layout/utils.collectLayout: the given graph is not a valid graphology instance.");f=f||{};var h=f.dimensions,y=f.type||Float64Array;h||(h=t);var v=h.length,w=new y(c.order*v),E=0;return c.forEachNode(function(D,k){var I;for(I=0;I<v;I++){var P=h[I],C=k[P];e(C)||(C=0),w[E++]=C}}),w}function s(c,f,h){if(!n(c))throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: the given graph is not a valid graphology instance.");h=h||{};var y=h.dimensions;y||(y=t);var v=y.length;if(f.length!==c.order*v)throw new Error("graphology-layout/utils.assignLayoutAsFlatArray: given layout has an incorrect length wrt number of nodes & dimenions.");var w=0;c.updateEachNodeAttributes(function(E,D){for(var k=0;k<v;k++)D[y[k]]=f[w++];return D},{attributes:y})}return pi.collectLayout=r,pi.assignLayout=i,pi.collectLayoutAsFlatArray=a,pi.assignLayoutAsFlatArray=s,pi}var Lr=Rw();let gi=null;const Hu=[];let io=!1;const Yu=new Map,Lw=5e3;function zw(n,e,t,r={}){const i=e.export(),a=JSON.stringify({type:n,graph:i,payload:r});if(Yu.has(a)){t(Yu.get(a));return}Hu.push({type:n,graph:i,payload:r,callback:t,key:a}),Xu()}function Xu(){if(io||Hu.length===0)return;const n=Hu.shift(),{type:e,graph:t,payload:r,callback:i,key:a}=n;io=!0,gi||(gi=new Worker(new URL("/assets/graph-algorithms.worker-B1dODl_i.js",import.meta.url),{type:"module"}));const s=setTimeout(()=>{console.warn(`[${e}] timed out. Restarting worker...`),gi.terminate(),gi=null,io=!1,Xu()},Lw);gi.onmessage=({data:c})=>{clearTimeout(s),io=!1,c.error?console.error(`[Worker Error] ${e}:`,c.error):(Yu.set(a,c.result),i(c.result)),Xu()},gi.postMessage({type:e,graph:t,payload:r})}var yi={},wu,sh;function $w(){if(sh)return wu;sh=1;function n(t){return function(r,i){return r+Math.floor(t()*(i-r+1))}}var e=n(Math.random);return e.createRandom=n,wu=e,wu}var Eu,uh;function Gw(){if(uh)return Eu;uh=1;var n=$w().createRandom;function e(r){var i=n(r);return function(a){for(var s=a.length,c=s-1,f=-1;++f<s;){var h=i(f,c),y=a[h];a[h]=a[f],a[f]=y}}}var t=e(Math.random);return t.createShuffleInPlace=e,Eu=t,Eu}var xu,ch;function qw(){if(ch)return xu;ch=1;var n=Et(),e=$e(),t=Gw(),r={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function i(S,z,G,F,U){this.wrappedCircle=U||null,this.children={},this.countChildren=0,this.id=S||null,this.next=null,this.previous=null,this.x=z||null,this.y=G||null,U?this.r=1010101:this.r=F||999}i.prototype.hasChildren=function(){return this.countChildren>0},i.prototype.addChild=function(S,z){this.children[S]=z,++this.countChildren},i.prototype.getChild=function(S){if(!this.children.hasOwnProperty(S)){var z=new i;this.children[S]=z,++this.countChildren}return this.children[S]},i.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var S=this;for(var z in S.children){var G=S.children[z];G.x+=S.x,G.y+=S.y,G.applyPositionToChildren()}}};function a(S,z,G){for(var F in z.children){var U=z.children[F];U.hasChildren()?a(S,U,G):G[U.id]={x:U.x,y:U.y}}}function s(S,z){var G=S.r-z.r,F=z.x-S.x,U=z.y-S.y;return G<0||G*G<F*F+U*U}function c(S,z){var G=S.r-z.r+1e-6,F=z.x-S.x,U=z.y-S.y;return G>0&&G*G>F*F+U*U}function f(S,z){for(var G=0;G<z.length;++G)if(!c(S,z[G]))return!1;return!0}function h(S){return new i(null,S.x,S.y,S.r)}function y(S,z){var G=S.x,F=S.y,U=S.r,V=z.x,j=z.y,ye=z.r,fe=V-G,Y=j-F,O=ye-U,J=Math.sqrt(fe*fe+Y*Y);return new i(null,(G+V+fe/J*O)/2,(F+j+Y/J*O)/2,(J+U+ye)/2)}function v(S,z,G){var F=S.x,U=S.y,V=S.r,j=z.x,ye=z.y,fe=z.r,Y=G.x,O=G.y,J=G.r,ee=F-j,ce=F-Y,oe=U-ye,le=U-O,se=fe-V,me=J-V,_e=F*F+U*U-V*V,Me=_e-j*j-ye*ye+fe*fe,Oe=_e-Y*Y-O*O+J*J,Fe=ce*oe-ee*le,de=(oe*Oe-le*Me)/(Fe*2)-F,Ne=(le*se-oe*me)/Fe,Re=(ce*Me-ee*Oe)/(Fe*2)-U,ke=(ee*me-ce*se)/Fe,Ke=Ne*Ne+ke*ke-1,Le=2*(V+de*Ne+Re*ke),Ee=de*de+Re*Re-V*V,pe=-(Ke?(Le+Math.sqrt(Le*Le-4*Ke*Ee))/(2*Ke):Ee/Le);return new i(null,F+de+Ne*pe,U+Re+ke*pe,pe)}function w(S){switch(S.length){case 1:return h(S[0]);case 2:return y(S[0],S[1]);case 3:return v(S[0],S[1],S[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+S.length)}}function E(S,z){var G,F;if(f(z,S))return[z];for(G=0;G<S.length;++G)if(s(z,S[G])&&f(y(S[G],z),S))return[S[G],z];for(G=0;G<S.length-1;++G)for(F=G+1;F<S.length;++F)if(s(y(S[G],S[F]),z)&&s(y(S[G],z),S[F])&&s(y(S[F],z),S[G])&&f(v(S[G],S[F],z),S))return[S[G],S[F],z];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function D(S){var z=S.wrappedCircle,G=S.next.wrappedCircle,F=z.r+G.r,U=(z.x*G.r+G.x*z.r)/F,V=(z.y*G.r+G.y*z.r)/F;return U*U+V*V}function k(S,z){var G=0,F=S.slice(),U=S.length,V=[],j,ye;for(z(F);G<U;)j=F[G],ye&&c(ye,j)?++G:(V=E(V,j),ye=w(V),G=0);return ye}function I(S,z,G){var F=S.x-z.x,U,V,j=S.y-z.y,ye,fe,Y=F*F+j*j;Y?(V=z.r+G.r,V*=V,fe=S.r+G.r,fe*=fe,V>fe?(U=(Y+fe-V)/(2*Y),ye=Math.sqrt(Math.max(0,fe/Y-U*U)),G.x=S.x-U*F-ye*j,G.y=S.y-U*j+ye*F):(U=(Y+V-fe)/(2*Y),ye=Math.sqrt(Math.max(0,V/Y-U*U)),G.x=z.x+U*F-ye*j,G.y=z.y+U*j+ye*F)):(G.x=z.x+G.r,G.y=z.y)}function P(S,z){var G=S.r+z.r-1e-6,F=z.x-S.x,U=z.y-S.y;return G>0&&G*G>F*F+U*U}function C(S,z){var G=S.length;if(G===0)return 0;var F,U,V,j,ye,fe,Y,O,J,ee;if(F=S[0],F.x=0,F.y=0,G<=1)return F.r;if(U=S[1],F.x=-U.r,U.x=F.r,U.y=0,G<=2)return F.r+U.r;V=S[2],I(U,F,V),F=new i(null,null,null,null,F),U=new i(null,null,null,null,U),V=new i(null,null,null,null,V),F.next=V.previous=U,U.next=F.previous=V,V.next=U.previous=F;e:for(fe=3;fe<G;++fe){V=S[fe],I(F.wrappedCircle,U.wrappedCircle,V),V=new i(null,null,null,null,V),Y=U.next,O=F.previous,J=U.wrappedCircle.r,ee=F.wrappedCircle.r;do if(J<=ee){if(P(Y.wrappedCircle,V.wrappedCircle)){U=Y,F.next=U,U.previous=F,--fe;continue e}J+=Y.wrappedCircle.r,Y=Y.next}else{if(P(O.wrappedCircle,V.wrappedCircle)){F=O,F.next=U,U.previous=F,--fe;continue e}ee+=O.wrappedCircle.r,O=O.previous}while(Y!==O.next);for(V.previous=F,V.next=U,F.next=U.previous=U=V,j=D(F);(V=V.next)!==U;)(ye=D(V))<j&&(F=V,j=ye);U=F.next}F=[U.wrappedCircle],V=U;for(var ce=1e4;(V=V.next)!==U&&--ce!==0;)F.push(V.wrappedCircle);for(V=k(F,z),fe=0;fe<G;++fe)F=S[fe],F.x-=V.x,F.y-=V.y;return V.r}function R(S,z){var G=0;if(S.hasChildren()){for(var F in S.children){var U=S.children[F];U.hasChildren()&&(U.r=R(U,z))}G=C(Object.values(S.children),z)}return G}function _(S,z){R(S,z);for(var G in S.children){var F=S.children[G];F.applyPositionToChildren()}}function T(S,z,G){if(!e(z))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");G=n(G,r);var F={},U={},V=z.nodes(),j=G.center,ye=G.hierarchyAttributes,fe=t.createShuffleInPlace(G.rng),Y=G.scale,O=new i;z.forEachNode(function(se,me){var _e=me.size?me.size:1,Me=new i(se,null,null,_e),Oe=O;ye.forEach(function(Fe){var de=me[Fe];Oe=Oe.getChild(de)}),Oe.addChild(se,Me)}),_(O,fe),a(z,O,F);var J=V.length,ee,ce,oe;for(oe=0;oe<J;oe++){var le=V[oe];ee=j+Y*F[le].x,ce=j+Y*F[le].y,U[le]={x:ee,y:ce},S&&(z.setNodeAttribute(le,G.attributes.x,ee),z.setNodeAttribute(le,G.attributes.y,ce))}return U}var B=T.bind(null,!1);return B.assign=T.bind(null,!0),xu=B,xu}var _u,lh;function Fw(){if(lh)return _u;lh=1;var n=Et(),e=$e(),t={dimensions:["x","y"],center:.5,scale:1};function r(a,s,c){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");c=n(c,t);var f=c.dimensions;if(!Array.isArray(f)||f.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=c.center,y=c.scale,v=Math.PI*2,w=(h-.5)*y,E=s.order,D=f[0],k=f[1];function I(R,_){return _[D]=y*Math.cos(R*v/E)+w,_[k]=y*Math.sin(R*v/E)+w,_}var P=0;if(!a){var C={};return s.forEachNode(function(R){C[R]=I(P++,{})}),C}s.updateEachNodeAttributes(function(R,_){return I(P++,_),_},{attributes:f})}var i=r.bind(null,!1);return i.assign=r.bind(null,!0),_u=i,_u}var Su,dh;function jw(){if(dh)return Su;dh=1;var n=Et(),e=$e(),t={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function r(a,s,c){if(!e(s))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");c=n(c,t);var f=c.dimensions;if(!Array.isArray(f)||f.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var h=f.length,y=c.center,v=c.rng,w=c.scale,E=(y-.5)*w;function D(I){for(var P=0;P<h;P++)I[f[P]]=v()*w+E;return I}if(!a){var k={};return s.forEachNode(function(I){k[I]=D({})}),k}s.updateEachNodeAttributes(function(I,P){return D(P),P},{attributes:f})}var i=r.bind(null,!1);return i.assign=r.bind(null,!0),Su=i,Su}var Au,hh;function Bw(){if(hh)return Au;hh=1;var n=Et(),e=$e(),t=Math.PI/180,r={dimensions:["x","y"],centeredOnZero:!1,degrees:!1};function i(s,c,f,h){if(!e(c))throw new Error("graphology-layout/rotation: the given graph is not a valid graphology instance.");h=n(h,r),h.degrees&&(f*=t);var y=h.dimensions;if(!Array.isArray(y)||y.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");if(c.order===0)return s?void 0:{};var v=y[0],w=y[1],E=0,D=0;if(!h.centeredOnZero){var k=1/0,I=-1/0,P=1/0,C=-1/0;c.forEachNode(function(S,z){var G=z[v],F=z[w];G<k&&(k=G),G>I&&(I=G),F<P&&(P=F),F>C&&(C=F)}),E=(k+I)/2,D=(P+C)/2}var R=Math.cos(f),_=Math.sin(f);function T(S){var z=S[v],G=S[w];return S[v]=E+(z-E)*R-(G-D)*_,S[w]=D+(z-E)*_+(G-D)*R,S}if(!s){var B={};return c.forEachNode(function(S,z){var G={};G[v]=z[v],G[w]=z[w],B[S]=T(G)}),B}c.updateEachNodeAttributes(function(S,z){return T(z),z},{attributes:y})}var a=i.bind(null,!1);return a.assign=i.bind(null,!0),Au=a,Au}var fh;function Uw(){return fh||(fh=1,yi.circlepack=qw(),yi.circular=Fw(),yi.random=jw(),yi.rotation=Bw()),yi}var ku,ph;function Kw(){return ph||(ph=1,ku=Uw()),ku}var Du=Kw(),Cu,gh;function Ww(){if(gh)return Cu;gh=1;var n=0,e=1,t=2,r=3,i=4,a=5,s=6,c=7,f=8,h=9,y=0,v=1,w=2,E=0,D=1,k=2,I=3,P=4,C=5,R=6,_=7,T=8,B=3,S=10,z=3,G=9,F=10;return Cu=function(V,j,ye){var fe,Y,O,J,ee,ce,oe,le,se,me,_e=j.length,Me=ye.length,Oe=V.adjustSizes,Fe=V.barnesHutTheta*V.barnesHutTheta,de,Ne,Re,ke,Ke,Le,Ee,pe=[];for(O=0;O<_e;O+=S)j[O+i]=j[O+t],j[O+a]=j[O+r],j[O+t]=0,j[O+r]=0;if(V.outboundAttractionDistribution){for(de=0,O=0;O<_e;O+=S)de+=j[O+s];de/=_e/S}if(V.barnesHutOptimize){var vt=1/0,it=-1/0,xt=1/0,at=-1/0,Ve,ht,ot;for(O=0;O<_e;O+=S)vt=Math.min(vt,j[O+n]),it=Math.max(it,j[O+n]),xt=Math.min(xt,j[O+e]),at=Math.max(at,j[O+e]);var gt=it-vt,_t=at-xt;for(gt>_t?(xt-=(gt-_t)/2,at=xt+gt):(vt-=(_t-gt)/2,it=vt+_t),pe[0+E]=-1,pe[0+D]=(vt+it)/2,pe[0+k]=(xt+at)/2,pe[0+I]=Math.max(it-vt,at-xt),pe[0+P]=-1,pe[0+C]=-1,pe[0+R]=0,pe[0+_]=0,pe[0+T]=0,fe=1,O=0;O<_e;O+=S)for(Y=0,ot=B;;)if(pe[Y+C]>=0){j[O+n]<pe[Y+D]?j[O+e]<pe[Y+k]?Ve=pe[Y+C]:Ve=pe[Y+C]+G:j[O+e]<pe[Y+k]?Ve=pe[Y+C]+G*2:Ve=pe[Y+C]+G*3,pe[Y+_]=(pe[Y+_]*pe[Y+R]+j[O+n]*j[O+s])/(pe[Y+R]+j[O+s]),pe[Y+T]=(pe[Y+T]*pe[Y+R]+j[O+e]*j[O+s])/(pe[Y+R]+j[O+s]),pe[Y+R]+=j[O+s],Y=Ve;continue}else if(pe[Y+E]<0){pe[Y+E]=O;break}else{if(pe[Y+C]=fe*G,le=pe[Y+I]/2,se=pe[Y+C],pe[se+E]=-1,pe[se+D]=pe[Y+D]-le,pe[se+k]=pe[Y+k]-le,pe[se+I]=le,pe[se+P]=se+G,pe[se+C]=-1,pe[se+R]=0,pe[se+_]=0,pe[se+T]=0,se+=G,pe[se+E]=-1,pe[se+D]=pe[Y+D]-le,pe[se+k]=pe[Y+k]+le,pe[se+I]=le,pe[se+P]=se+G,pe[se+C]=-1,pe[se+R]=0,pe[se+_]=0,pe[se+T]=0,se+=G,pe[se+E]=-1,pe[se+D]=pe[Y+D]+le,pe[se+k]=pe[Y+k]-le,pe[se+I]=le,pe[se+P]=se+G,pe[se+C]=-1,pe[se+R]=0,pe[se+_]=0,pe[se+T]=0,se+=G,pe[se+E]=-1,pe[se+D]=pe[Y+D]+le,pe[se+k]=pe[Y+k]+le,pe[se+I]=le,pe[se+P]=pe[Y+P],pe[se+C]=-1,pe[se+R]=0,pe[se+_]=0,pe[se+T]=0,fe+=4,j[pe[Y+E]+n]<pe[Y+D]?j[pe[Y+E]+e]<pe[Y+k]?Ve=pe[Y+C]:Ve=pe[Y+C]+G:j[pe[Y+E]+e]<pe[Y+k]?Ve=pe[Y+C]+G*2:Ve=pe[Y+C]+G*3,pe[Y+R]=j[pe[Y+E]+s],pe[Y+_]=j[pe[Y+E]+n],pe[Y+T]=j[pe[Y+E]+e],pe[Ve+E]=pe[Y+E],pe[Y+E]=-1,j[O+n]<pe[Y+D]?j[O+e]<pe[Y+k]?ht=pe[Y+C]:ht=pe[Y+C]+G:j[O+e]<pe[Y+k]?ht=pe[Y+C]+G*2:ht=pe[Y+C]+G*3,Ve===ht)if(ot--){Y=Ve;continue}else{ot=B;break}pe[ht+E]=O;break}}if(V.barnesHutOptimize)for(Ne=V.scalingRatio,O=0;O<_e;O+=S)for(Y=0;;)if(pe[Y+C]>=0)if(Le=Math.pow(j[O+n]-pe[Y+_],2)+Math.pow(j[O+e]-pe[Y+T],2),me=pe[Y+I],4*me*me/Le<Fe){if(Re=j[O+n]-pe[Y+_],ke=j[O+e]-pe[Y+T],Oe===!0?Le>0?(Ee=Ne*j[O+s]*pe[Y+R]/Le,j[O+t]+=Re*Ee,j[O+r]+=ke*Ee):Le<0&&(Ee=-Ne*j[O+s]*pe[Y+R]/Math.sqrt(Le),j[O+t]+=Re*Ee,j[O+r]+=ke*Ee):Le>0&&(Ee=Ne*j[O+s]*pe[Y+R]/Le,j[O+t]+=Re*Ee,j[O+r]+=ke*Ee),Y=pe[Y+P],Y<0)break;continue}else{Y=pe[Y+C];continue}else{if(ce=pe[Y+E],ce>=0&&ce!==O&&(Re=j[O+n]-j[ce+n],ke=j[O+e]-j[ce+e],Le=Re*Re+ke*ke,Oe===!0?Le>0?(Ee=Ne*j[O+s]*j[ce+s]/Le,j[O+t]+=Re*Ee,j[O+r]+=ke*Ee):Le<0&&(Ee=-Ne*j[O+s]*j[ce+s]/Math.sqrt(Le),j[O+t]+=Re*Ee,j[O+r]+=ke*Ee):Le>0&&(Ee=Ne*j[O+s]*j[ce+s]/Le,j[O+t]+=Re*Ee,j[O+r]+=ke*Ee)),Y=pe[Y+P],Y<0)break;continue}else for(Ne=V.scalingRatio,J=0;J<_e;J+=S)for(ee=0;ee<J;ee+=S)Re=j[J+n]-j[ee+n],ke=j[J+e]-j[ee+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-j[J+f]-j[ee+f],Le>0?(Ee=Ne*j[J+s]*j[ee+s]/Le/Le,j[J+t]+=Re*Ee,j[J+r]+=ke*Ee,j[ee+t]-=Re*Ee,j[ee+r]-=ke*Ee):Le<0&&(Ee=100*Ne*j[J+s]*j[ee+s],j[J+t]+=Re*Ee,j[J+r]+=ke*Ee,j[ee+t]-=Re*Ee,j[ee+r]-=ke*Ee)):(Le=Math.sqrt(Re*Re+ke*ke),Le>0&&(Ee=Ne*j[J+s]*j[ee+s]/Le/Le,j[J+t]+=Re*Ee,j[J+r]+=ke*Ee,j[ee+t]-=Re*Ee,j[ee+r]-=ke*Ee));for(se=V.gravity/V.scalingRatio,Ne=V.scalingRatio,O=0;O<_e;O+=S)Ee=0,Re=j[O+n],ke=j[O+e],Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),V.strongGravityMode?Le>0&&(Ee=Ne*j[O+s]*se):Le>0&&(Ee=Ne*j[O+s]*se/Le),j[O+t]-=Re*Ee,j[O+r]-=ke*Ee;for(Ne=1*(V.outboundAttractionDistribution?de:1),oe=0;oe<Me;oe+=z)J=ye[oe+y],ee=ye[oe+v],le=ye[oe+w],Ke=Math.pow(le,V.edgeWeightInfluence),Re=j[J+n]-j[ee+n],ke=j[J+e]-j[ee+e],Oe===!0?(Le=Math.sqrt(Re*Re+ke*ke)-j[J+f]-j[ee+f],V.linLogMode?V.outboundAttractionDistribution?Le>0&&(Ee=-Ne*Ke*Math.log(1+Le)/Le/j[J+s]):Le>0&&(Ee=-Ne*Ke*Math.log(1+Le)/Le):V.outboundAttractionDistribution?Le>0&&(Ee=-Ne*Ke/j[J+s]):Le>0&&(Ee=-Ne*Ke)):(Le=Math.sqrt(Math.pow(Re,2)+Math.pow(ke,2)),V.linLogMode?V.outboundAttractionDistribution?Le>0&&(Ee=-Ne*Ke*Math.log(1+Le)/Le/j[J+s]):Le>0&&(Ee=-Ne*Ke*Math.log(1+Le)/Le):V.outboundAttractionDistribution?(Le=1,Ee=-Ne*Ke/j[J+s]):(Le=1,Ee=-Ne*Ke)),Le>0&&(j[J+t]+=Re*Ee,j[J+r]+=ke*Ee,j[ee+t]-=Re*Ee,j[ee+r]-=ke*Ee);var st,ut,ft,rt,St,mt;if(Oe===!0)for(O=0;O<_e;O+=S)j[O+h]!==1&&(st=Math.sqrt(Math.pow(j[O+t],2)+Math.pow(j[O+r],2)),st>F&&(j[O+t]=j[O+t]*F/st,j[O+r]=j[O+r]*F/st),ut=j[O+s]*Math.sqrt((j[O+i]-j[O+t])*(j[O+i]-j[O+t])+(j[O+a]-j[O+r])*(j[O+a]-j[O+r])),ft=Math.sqrt((j[O+i]+j[O+t])*(j[O+i]+j[O+t])+(j[O+a]+j[O+r])*(j[O+a]+j[O+r]))/2,rt=.1*Math.log(1+ft)/(1+Math.sqrt(ut)),St=j[O+n]+j[O+t]*(rt/V.slowDown),j[O+n]=St,mt=j[O+e]+j[O+r]*(rt/V.slowDown),j[O+e]=mt);else for(O=0;O<_e;O+=S)j[O+h]!==1&&(ut=j[O+s]*Math.sqrt((j[O+i]-j[O+t])*(j[O+i]-j[O+t])+(j[O+a]-j[O+r])*(j[O+a]-j[O+r])),ft=Math.sqrt((j[O+i]+j[O+t])*(j[O+i]+j[O+t])+(j[O+a]+j[O+r])*(j[O+a]+j[O+r]))/2,rt=j[O+c]*Math.log(1+ft)/(1+Math.sqrt(ut)),j[O+c]=Math.min(1,Math.sqrt(rt*(Math.pow(j[O+t],2)+Math.pow(j[O+r],2))/(1+Math.sqrt(ut)))),St=j[O+n]+j[O+t]*(rt/V.slowDown),j[O+n]=St,mt=j[O+e]+j[O+r]*(rt/V.slowDown),j[O+e]=mt);return{}},Cu}var Hr={},yh;function Hw(){if(yh)return Hr;yh=1;var n=10,e=3;return Hr.assign=function(t){t=t||{};var r=Array.prototype.slice.call(arguments).slice(1),i,a,s;for(i=0,s=r.length;i<s;i++)if(r[i])for(a in r[i])t[a]=r[i][a];return t},Hr.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Hr.graphToByteArrays=function(t,r){var i=t.order,a=t.size,s={},c,f=new Float32Array(i*n),h=new Float32Array(a*e);return c=0,t.forEachNode(function(y,v){s[y]=c,f[c]=v.x,f[c+1]=v.y,f[c+2]=0,f[c+3]=0,f[c+4]=0,f[c+5]=0,f[c+6]=1,f[c+7]=1,f[c+8]=v.size||1,f[c+9]=v.fixed?1:0,c+=n}),c=0,t.forEachEdge(function(y,v,w,E,D,k,I){var P=s[w],C=s[E],R=r(y,v,w,E,D,k,I);f[P+6]+=R,f[C+6]+=R,h[c]=P,h[c+1]=C,h[c+2]=R,c+=e}),{nodes:f,edges:h}},Hr.assignLayoutChanges=function(t,r,i){var a=0;t.updateEachNodeAttributes(function(s,c){return c.x=r[a],c.y=r[a+1],a+=n,i?i(s,c):c})},Hr.readGraphPositions=function(t,r){var i=0;t.forEachNode(function(a,s){r[i]=s.x,r[i+1]=s.y,i+=n})},Hr.collectLayoutChanges=function(t,r,i){for(var a=t.nodes(),s={},c=0,f=0,h=r.length;c<h;c+=n){if(i){var y=Object.assign({},t.getNodeAttributes(a[f]));y.x=r[c],y.y=r[c+1],y=i(a[f],y),s[a[f]]={x:y.x,y:y.y}}else s[a[f]]={x:r[c],y:r[c+1]};f++}return s},Hr.createWorker=function(r){var i=window.URL||window.webkitURL,a=r.toString(),s=i.createObjectURL(new Blob(["("+a+").call(this);"],{type:"text/javascript"})),c=new Worker(s);return i.revokeObjectURL(s),c},Hr}var Iu,vh;function Yw(){return vh||(vh=1,Iu={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),Iu}var Mu,mh;function Xw(){if(mh)return Mu;mh=1;var n=$e(),e=Gr().createEdgeWeightGetter,t=Ww(),r=Hw(),i=Yw();function a(f,h,y){if(!n(h))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof y=="number"&&(y={iterations:y});var v=y.iterations;if(typeof v!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(v<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var w=e("getEdgeWeight"in y?y.getEdgeWeight:"weight").fromEntry,E=typeof y.outputReducer=="function"?y.outputReducer:null,D=r.assign({},i,y.settings),k=r.validateSettings(D);if(k)throw new Error("graphology-layout-forceatlas2: "+k.message);var I=r.graphToByteArrays(h,w),P;for(P=0;P<v;P++)t(D,I.nodes,I.edges);if(f){r.assignLayoutChanges(h,I.nodes,E);return}return r.collectLayoutChanges(h,I.nodes)}function s(f){var h=typeof f=="number"?f:f.order;return{barnesHutOptimize:h>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(h)}}var c=a.bind(null,!1);return c.assign=a.bind(null,!0),c.inferSettings=s,Mu=c,Mu}var Vw=Xw();const Qw=Pt(Vw);var Nu,bh;function Zw(){if(bh)return Nu;bh=1;var n=0,e=1,t=2,r=3;function i(s,c){return s+"§"+c}function a(){return .01*(.5-Math.random())}return Nu=function(c,f){var h=c.margin,y=c.ratio,v=c.expansion,w=c.gridSize,E=c.speed,D,k,I,P,C,R,_=!0,T=f.length,B=T/r|0,S=new Float32Array(B),z=new Float32Array(B),G=1/0,F=1/0,U=-1/0,V=-1/0;for(D=0;D<T;D+=r)I=f[D+n],P=f[D+e],R=f[D+t]*y+h,G=Math.min(G,I-R),U=Math.max(U,I+R),F=Math.min(F,P-R),V=Math.max(V,P+R);var j=U-G,ye=V-F,fe=(G+U)/2,Y=(F+V)/2;G=fe-v*j/2,U=fe+v*j/2,F=Y-v*ye/2,V=Y+v*ye/2;var O=new Array(w*w),J=O.length,ee;for(ee=0;ee<J;ee++)O[ee]=[];var ce,oe,le,se,me,_e,Me,Oe,Fe,de;for(D=0;D<T;D+=r)for(I=f[D+n],P=f[D+e],R=f[D+t]*y+h,ce=I-R,oe=I+R,le=P-R,se=P+R,me=Math.floor(w*(ce-G)/(U-G)),_e=Math.floor(w*(oe-G)/(U-G)),Me=Math.floor(w*(le-F)/(V-F)),Oe=Math.floor(w*(se-F)/(V-F)),Fe=me;Fe<=_e;Fe++)for(de=Me;de<=Oe;de++)O[Fe*w+de].push(D);var Ne,Re=new Set,ke,Ke,Le,Ee,pe,vt,it,xt,at,Ve,ht,ot,gt;for(ee=0;ee<J;ee++)for(Ne=O[ee],D=0,C=Ne.length;D<C;D++)for(ke=Ne[D],Le=f[ke+n],pe=f[ke+e],it=f[ke+t],k=D+1;k<C;k++)Ke=Ne[k],at=i(ke,Ke),!(J>1&&Re.has(at))&&(J>1&&Re.add(at),Ee=f[Ke+n],vt=f[Ke+e],xt=f[Ke+t],Ve=Ee-Le,ht=vt-pe,ot=Math.sqrt(Ve*Ve+ht*ht),gt=ot<it*y+h+(xt*y+h),gt&&(_=!1,Ke=Ke/r|0,ot>0?(S[Ke]+=Ve/ot*(1+it),z[Ke]+=ht/ot*(1+it)):(S[Ke]+=j*a(),z[Ke]+=ye*a())));for(D=0,k=0;D<T;D+=r,k++)f[D+n]+=S[k]*.1*E,f[D+e]+=z[k]*.1*E;return{converged:_}},Nu}var zn={},wh;function Jw(){if(wh)return zn;wh=1;var n=3;return zn.validateSettings=function(e){return"gridSize"in e&&typeof e.gridSize!="number"||e.gridSize<=0?{message:"the `gridSize` setting should be a positive number."}:"margin"in e&&typeof e.margin!="number"||e.margin<0?{message:"the `margin` setting should be 0 or a positive number."}:"expansion"in e&&typeof e.expansion!="number"||e.expansion<=0?{message:"the `expansion` setting should be a positive number."}:"ratio"in e&&typeof e.ratio!="number"||e.ratio<=0?{message:"the `ratio` setting should be a positive number."}:"speed"in e&&typeof e.speed!="number"||e.speed<=0?{message:"the `speed` setting should be a positive number."}:null},zn.graphToByteArray=function(e,t){var r=e.order,i=new Float32Array(r*n),a=0;return e.forEachNode(function(s,c){typeof t=="function"&&(c=t(s,c)),i[a]=c.x,i[a+1]=c.y,i[a+2]=c.size||1,a+=n}),i},zn.assignLayoutChanges=function(e,t,r){var i=0;e.forEachNode(function(a){var s={x:t[i],y:t[i+1]};typeof r=="function"&&(s=r(a,s)),e.mergeNodeAttributes(a,s),i+=n})},zn.collectLayoutChanges=function(e,t,r){var i={},a=0;return e.forEachNode(function(s){var c={x:t[a],y:t[a+1]};typeof r=="function"&&(c=r(s,c)),i[s]=c,a+=n}),i},zn.createWorker=function(t){var r=window.URL||window.webkitURL,i=t.toString(),a=r.createObjectURL(new Blob(["("+i+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return r.revokeObjectURL(a),s},zn}var Pu,Eh;function e1(){return Eh||(Eh=1,Pu={gridSize:20,margin:5,expansion:1.1,ratio:1,speed:3}),Pu}var Ou,xh;function t1(){if(xh)return Ou;xh=1;var n=$e(),e=Zw(),t=Jw(),r=e1(),i=500;function a(c,f,h){if(!n(f))throw new Error("graphology-layout-noverlap: the given graph is not a valid graphology instance.");typeof h=="number"?h={maxIterations:h}:h=h||{};var y=h.maxIterations||i;if(typeof y!="number"||y<=0)throw new Error("graphology-layout-force: you should provide a positive number of maximum iterations.");var v=Object.assign({},r,h.settings),w=t.validateSettings(v);if(w)throw new Error("graphology-layout-noverlap: "+w.message);var E=t.graphToByteArray(f,h.inputReducer),D=!1,k;for(k=0;k<y&&!D;k++)D=e(v,E).converged;if(c){t.assignLayoutChanges(f,E,h.outputReducer);return}return t.collectLayoutChanges(f,E,h.outputReducer)}var s=a.bind(null,!1);return s.assign=a.bind(null,!0),Ou=s,Ou}var r1=t1();const n1=Pt(r1);class i1{constructor(e){this.app=e,this.eventBus=e.eventBus,this.canvas=e.canvas}init(){}applyLayout(e,t){let r=!0;switch(e){case"force":this.force(t.itteration,t.gravity);break;case"noverlap":this.noverlap();break;case"rotate180":this.rotate180();break;case"rotate":this.rotate(t);break;case"h-flip":this.hFlip();break;case"v-flip":this.vFlip();break;case"center":this.center();break;case"random":this.random();break;case"circle":this.organizeNodesInCircle();break;case"oneLine":this.organizeNodesInLine();break;case"twoLine":this.organizeNodesInTwoLines(t.line1Count,t.Y);break;default:r=!1;break}r&&this.app.graphManager.saveGraphState()}noverlap(){const e=this.app.graphManager.graph,t=n1(e,{maxIterations:50,settings:{ratio:100,expansion:1.5,gridSize:5}});this.center(t)}force(e=50,t=25){const r=this.app.graphManager.graph;if(r.order<250){const i=Qw(r,{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}});this.center(i)}else zw("force",r,i=>{this.center(i)},{iterations:parseInt(e),settings:{gravity:parseInt(t),scalingRatio:100}})}hFlip(){const e=this.canvas.width/2,t=this.app.graphManager.graph,r=Lr.collectLayout(t);Object.values(r).forEach(i=>{const a=e-i.x;i.x+=2*a}),Lr.assignLayout(t,r)}vFlip(){const e=this.canvas.height/2,t=this.app.graphManager.graph,r=Lr.collectLayout(t);Object.values(r).forEach(i=>{const a=e-i.y;i.y+=2*a}),Lr.assignLayout(t,r)}rotate(e=90){const t=this.app.graphManager.graph,r=e*Math.PI/-180,i=Du.rotation(t,r);this.center(i)}center(e=void 0){const t=this.canvas.width/2,r=this.canvas.height/2,i=this.app.graphManager.graph;e||(e=Lr.collectLayout(i));const a={x:lo(Object.values(e),f=>f.x),y:lo(Object.values(e),f=>f.y)},s=t-a.x,c=r-a.y;Object.values(e).forEach(f=>{f.x+=s,f.y+=c}),Lr.assignLayout(i,e)}random(){const e=this.canvas.width/2,t=this.canvas.height/2,r=this.app.graphManager.graph,i=Du.random(r,{scale:Math.max(e,t)-200});this.center(i)}organizeNodesInCircle(){const e=this.canvas.width/2,t=this.canvas.height/2,r=this.app.graphManager.graph,i=Math.min(e*.5,t*.5),a=Du.circular(r,{scale:i,dimensions:["x","y"]});Object.values(a).forEach(s=>{s.x+=e,s.y+=t}),Lr.assignLayout(r,a)}organizeNodesInLine(){const e=this.canvas.width/2,t=this.canvas.height/2,r=e*.1,i=this.app.graphManager.graph,a=this.app.graphManager.graph.nodes(),s={};if(i.order===0)return;const c=(this.canvas.width-2*r)/Math.max(1,i.order-1);a.forEach((f,h)=>{s[f]={x:r+h*c,y:t}}),Lr.assignLayout(i,s)}organizeNodesInTwoLines(e,t=50){const r=this.canvas.width/2,i=this.canvas.height/2,a=r*.1,s=t,c=this.app.graphManager.graph,f=this.app.graphManager.graph.nodes(),h={};if(c.order===0)return;if(e>c.order){console.error("Line1 count exceeds total nodes.");return}const y=f.slice(0,e),v=f.slice(e),w=y.length,E=v.length,D=w>1?(this.canvas.width-2*a)/(w-1):0,k=E>1?(this.canvas.width-2*a)/(E-1):0,I=i-s,P=i+s;y.forEach((C,R)=>{h[C]={x:a+R*D,y:I}}),v.forEach((C,R)=>{h[C]={x:a+R*k,y:P}}),Lr.assignLayout(c,h)}rotate180(){const e=this.canvas.width,t=this.canvas.height,r=e*.15,i=this.app.graphManager.graph,a=i.nodes(),s={};if(i.order===0)return;let c=1/0,f=1/0,h=-1/0,y=-1/0;a.forEach(C=>{const{x:R,y:_}=i.getNodeAttributes(C);R<c&&(c=R),_<f&&(f=_),R>h&&(h=R),_>y&&(y=_)});const v=h-c,w=y-f,E=(e-2*r)/v,D=(t-2*r)/w,k=Math.min(E,D),I=(e-v*k)/2,P=(t-w*k)/2;i.forEachNode((C,R)=>{const _=e-((R.x-c)*k+I),T=t-((R.y-f)*k+P);s[C]={x:_,y:T}}),Lr.assignLayout(i,s)}}var ia={exports:{}},a1=ia.exports,_h;function o1(){return _h||(_h=1,function(n,e){(function(t,r){n.exports=r()})(a1,function(){function t(d,l){var p=Object.keys(d);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);l&&(m=m.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),p.push.apply(p,m)}return p}function r(d){for(var l=1;l<arguments.length;l++){var p=arguments[l]!=null?arguments[l]:{};l%2?t(Object(p),!0).forEach(function(m){f(d,m,p[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(p)):t(Object(p)).forEach(function(m){Object.defineProperty(d,m,Object.getOwnPropertyDescriptor(p,m))})}return d}function i(d){return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},i(d)}function a(d,l){if(!(d instanceof l))throw new TypeError("Cannot call a class as a function")}function s(d,l){for(var p=0;p<l.length;p++){var m=l[p];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(d,k(m.key),m)}}function c(d,l,p){return l&&s(d.prototype,l),Object.defineProperty(d,"prototype",{writable:!1}),d}function f(d,l,p){return(l=k(l))in d?Object.defineProperty(d,l,{value:p,enumerable:!0,configurable:!0,writable:!0}):d[l]=p,d}function h(d,l){if(typeof l!="function"&&l!==null)throw new TypeError("Super expression must either be null or a function");d.prototype=Object.create(l&&l.prototype,{constructor:{value:d,writable:!0,configurable:!0}}),Object.defineProperty(d,"prototype",{writable:!1}),l&&v(d,l)}function y(d){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},y(d)}function v(d,l){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(p,m){return p.__proto__=m,p},v(d,l)}function w(d){if(d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return d}function E(d){var l=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var p,m=y(d);if(l){var x=y(this).constructor;p=Reflect.construct(m,arguments,x)}else p=m.apply(this,arguments);return function(N,L){if(L&&(typeof L=="object"||typeof L=="function"))return L;if(L!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return w(N)}(this,p)}}function D(){return D=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(d,l,p){var m=function(N,L){for(;!Object.prototype.hasOwnProperty.call(N,L)&&(N=y(N))!==null;);return N}(d,l);if(m){var x=Object.getOwnPropertyDescriptor(m,l);return x.get?x.get.call(arguments.length<3?d:p):x.value}},D.apply(this,arguments)}function k(d){var l=function(p,m){if(typeof p!="object"||p===null)return p;var x=p[Symbol.toPrimitive];if(x!==void 0){var N=x.call(p,m);if(typeof N!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(p)}(d,"string");return typeof l=="symbol"?l:l+""}var I=function(d){return!(!d||!d.Window)&&d instanceof d.Window},P=void 0,C=void 0;function R(d){P=d;var l=d.document.createTextNode("");l.ownerDocument!==d.document&&typeof d.wrap=="function"&&d.wrap(l)===l&&(d=d.wrap(d)),C=d}function _(d){return I(d)?d:(d.ownerDocument||d).defaultView||C.window}typeof window<"u"&&window&&R(window);var T=function(d){return!!d&&i(d)==="object"},B=function(d){return typeof d=="function"},S={window:function(d){return d===C||I(d)},docFrag:function(d){return T(d)&&d.nodeType===11},object:T,func:B,number:function(d){return typeof d=="number"},bool:function(d){return typeof d=="boolean"},string:function(d){return typeof d=="string"},element:function(d){if(!d||i(d)!=="object")return!1;var l=_(d)||C;return/object|function/.test(typeof Element>"u"?"undefined":i(Element))?d instanceof Element||d instanceof l.Element:d.nodeType===1&&typeof d.nodeName=="string"},plainObject:function(d){return T(d)&&!!d.constructor&&/function Object\b/.test(d.constructor.toString())},array:function(d){return T(d)&&d.length!==void 0&&B(d.splice)}};function z(d){var l=d.interaction;if(l.prepared.name==="drag"){var p=l.prepared.axis;p==="x"?(l.coords.cur.page.y=l.coords.start.page.y,l.coords.cur.client.y=l.coords.start.client.y,l.coords.velocity.client.y=0,l.coords.velocity.page.y=0):p==="y"&&(l.coords.cur.page.x=l.coords.start.page.x,l.coords.cur.client.x=l.coords.start.client.x,l.coords.velocity.client.x=0,l.coords.velocity.page.x=0)}}function G(d){var l=d.iEvent,p=d.interaction;if(p.prepared.name==="drag"){var m=p.prepared.axis;if(m==="x"||m==="y"){var x=m==="x"?"y":"x";l.page[x]=p.coords.start.page[x],l.client[x]=p.coords.start.client[x],l.delta[x]=0}}}var F={id:"actions/drag",install:function(d){var l=d.actions,p=d.Interactable,m=d.defaults;p.prototype.draggable=F.draggable,l.map.drag=F,l.methodDict.drag="draggable",m.actions.drag=F.defaults},listeners:{"interactions:before-action-move":z,"interactions:action-resume":z,"interactions:action-move":G,"auto-start:check":function(d){var l=d.interaction,p=d.interactable,m=d.buttons,x=p.options.drag;if(x&&x.enabled&&(!l.pointerIsDown||!/mouse|pointer/.test(l.pointerType)||m&p.options.drag.mouseButtons))return d.action={name:"drag",axis:x.lockAxis==="start"?x.startAxis:x.lockAxis},!1}},draggable:function(d){return S.object(d)?(this.options.drag.enabled=d.enabled!==!1,this.setPerAction("drag",d),this.setOnEvents("drag",d),/^(xy|x|y|start)$/.test(d.lockAxis)&&(this.options.drag.lockAxis=d.lockAxis),/^(xy|x|y)$/.test(d.startAxis)&&(this.options.drag.startAxis=d.startAxis),this):S.bool(d)?(this.options.drag.enabled=d,this):this.options.drag},beforeMove:z,move:G,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(d){return d.search("drag")===0}},U=F,V={init:function(d){var l=d;V.document=l.document,V.DocumentFragment=l.DocumentFragment||j,V.SVGElement=l.SVGElement||j,V.SVGSVGElement=l.SVGSVGElement||j,V.SVGElementInstance=l.SVGElementInstance||j,V.Element=l.Element||j,V.HTMLElement=l.HTMLElement||V.Element,V.Event=l.Event,V.Touch=l.Touch||j,V.PointerEvent=l.PointerEvent||l.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function j(){}var ye=V,fe={init:function(d){var l=ye.Element,p=d.navigator||{};fe.supportsTouch="ontouchstart"in d||S.func(d.DocumentTouch)&&ye.document instanceof d.DocumentTouch,fe.supportsPointerEvent=p.pointerEnabled!==!1&&!!ye.PointerEvent,fe.isIOS=/iP(hone|od|ad)/.test(p.platform),fe.isIOS7=/iP(hone|od|ad)/.test(p.platform)&&/OS 7[^\d]/.test(p.appVersion),fe.isIe9=/MSIE 9/.test(p.userAgent),fe.isOperaMobile=p.appName==="Opera"&&fe.supportsTouch&&/Presto/.test(p.userAgent),fe.prefixedMatchesSelector="matches"in l.prototype?"matches":"webkitMatchesSelector"in l.prototype?"webkitMatchesSelector":"mozMatchesSelector"in l.prototype?"mozMatchesSelector":"oMatchesSelector"in l.prototype?"oMatchesSelector":"msMatchesSelector",fe.pEventTypes=fe.supportsPointerEvent?ye.PointerEvent===d.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,fe.wheelEvent=ye.document&&"onmousewheel"in ye.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},Y=fe;function O(d,l){if(d.contains)return d.contains(l);for(;l;){if(l===d)return!0;l=l.parentNode}return!1}function J(d,l){for(;S.element(d);){if(ce(d,l))return d;d=ee(d)}return null}function ee(d){var l=d.parentNode;if(S.docFrag(l)){for(;(l=l.host)&&S.docFrag(l););return l}return l}function ce(d,l){return C!==P&&(l=l.replace(/\/deep\//g," ")),d[Y.prefixedMatchesSelector](l)}var oe=function(d){return d.parentNode||d.host};function le(d,l){for(var p,m=[],x=d;(p=oe(x))&&x!==l&&p!==x.ownerDocument;)m.unshift(x),x=p;return m}function se(d,l,p){for(;S.element(d);){if(ce(d,l))return!0;if((d=ee(d))===p)return ce(d,l)}return!1}function me(d){return d.correspondingUseElement||d}function _e(d){var l=d instanceof ye.SVGElement?d.getBoundingClientRect():d.getClientRects()[0];return l&&{left:l.left,right:l.right,top:l.top,bottom:l.bottom,width:l.width||l.right-l.left,height:l.height||l.bottom-l.top}}function Me(d){var l,p=_e(d);if(!Y.isIOS7&&p){var m={x:(l=(l=_(d))||C).scrollX||l.document.documentElement.scrollLeft,y:l.scrollY||l.document.documentElement.scrollTop};p.left+=m.x,p.right+=m.x,p.top+=m.y,p.bottom+=m.y}return p}function Oe(d){for(var l=[];d;)l.push(d),d=ee(d);return l}function Fe(d){return!!S.string(d)&&(ye.document.querySelector(d),!0)}function de(d,l){for(var p in l)d[p]=l[p];return d}function Ne(d,l,p){return d==="parent"?ee(p):d==="self"?l.getRect(p):J(p,d)}function Re(d,l,p,m){var x=d;return S.string(x)?x=Ne(x,l,p):S.func(x)&&(x=x.apply(void 0,m)),S.element(x)&&(x=Me(x)),x}function ke(d){return d&&{x:"x"in d?d.x:d.left,y:"y"in d?d.y:d.top}}function Ke(d){return!d||"x"in d&&"y"in d||((d=de({},d)).x=d.left||0,d.y=d.top||0,d.width=d.width||(d.right||0)-d.x,d.height=d.height||(d.bottom||0)-d.y),d}function Le(d,l,p){d.left&&(l.left+=p.x),d.right&&(l.right+=p.x),d.top&&(l.top+=p.y),d.bottom&&(l.bottom+=p.y),l.width=l.right-l.left,l.height=l.bottom-l.top}function Ee(d,l,p){var m=p&&d.options[p];return ke(Re(m&&m.origin||d.options.origin,d,l,[d&&l]))||{x:0,y:0}}function pe(d,l){var p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(W){return!0},m=arguments.length>3?arguments[3]:void 0;if(m=m||{},S.string(d)&&d.search(" ")!==-1&&(d=vt(d)),S.array(d))return d.forEach(function(W){return pe(W,l,p,m)}),m;if(S.object(d)&&(l=d,d=""),S.func(l)&&p(d))m[d]=m[d]||[],m[d].push(l);else if(S.array(l))for(var x=0,N=l;x<N.length;x++){var L=N[x];pe(d,L,p,m)}else if(S.object(l))for(var q in l)pe(vt(q).map(function(W){return"".concat(d).concat(W)}),l[q],p,m);return m}function vt(d){return d.trim().split(/ +/)}var it=function(d,l){return Math.sqrt(d*d+l*l)},xt=["webkit","moz"];function at(d,l){d.__set||(d.__set={});var p=function(x){if(xt.some(function(N){return x.indexOf(N)===0}))return 1;typeof d[x]!="function"&&x!=="__set"&&Object.defineProperty(d,x,{get:function(){return x in d.__set?d.__set[x]:d.__set[x]=l[x]},set:function(N){d.__set[x]=N},configurable:!0})};for(var m in l)p(m);return d}function Ve(d,l){d.page=d.page||{},d.page.x=l.page.x,d.page.y=l.page.y,d.client=d.client||{},d.client.x=l.client.x,d.client.y=l.client.y,d.timeStamp=l.timeStamp}function ht(d){d.page.x=0,d.page.y=0,d.client.x=0,d.client.y=0}function ot(d){return d instanceof ye.Event||d instanceof ye.Touch}function gt(d,l,p){return d=d||"page",(p=p||{}).x=l[d+"X"],p.y=l[d+"Y"],p}function _t(d,l){return l=l||{x:0,y:0},Y.isOperaMobile&&ot(d)?(gt("screen",d,l),l.x+=window.scrollX,l.y+=window.scrollY):gt("page",d,l),l}function st(d){return S.number(d.pointerId)?d.pointerId:d.identifier}function ut(d,l,p){var m=l.length>1?rt(l):l[0];_t(m,d.page),function(x,N){N=N||{},Y.isOperaMobile&&ot(x)?gt("screen",x,N):gt("client",x,N)}(m,d.client),d.timeStamp=p}function ft(d){var l=[];return S.array(d)?(l[0]=d[0],l[1]=d[1]):d.type==="touchend"?d.touches.length===1?(l[0]=d.touches[0],l[1]=d.changedTouches[0]):d.touches.length===0&&(l[0]=d.changedTouches[0],l[1]=d.changedTouches[1]):(l[0]=d.touches[0],l[1]=d.touches[1]),l}function rt(d){for(var l={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},p=0;p<d.length;p++){var m=d[p];for(var x in l)l[x]+=m[x]}for(var N in l)l[N]/=d.length;return l}function St(d){if(!d.length)return null;var l=ft(d),p=Math.min(l[0].pageX,l[1].pageX),m=Math.min(l[0].pageY,l[1].pageY),x=Math.max(l[0].pageX,l[1].pageX),N=Math.max(l[0].pageY,l[1].pageY);return{x:p,y:m,left:p,top:m,right:x,bottom:N,width:x-p,height:N-m}}function mt(d,l){var p=l+"X",m=l+"Y",x=ft(d),N=x[0][p]-x[1][p],L=x[0][m]-x[1][m];return it(N,L)}function Ot(d,l){var p=l+"X",m=l+"Y",x=ft(d),N=x[1][p]-x[0][p],L=x[1][m]-x[0][m];return 180*Math.atan2(L,N)/Math.PI}function or(d){return S.string(d.pointerType)?d.pointerType:S.number(d.pointerType)?[void 0,void 0,"touch","pen","mouse"][d.pointerType]:/touch/.test(d.type||"")||d instanceof ye.Touch?"touch":"mouse"}function Jr(d){var l=S.func(d.composedPath)?d.composedPath():d.path;return[me(l?l[0]:d.target),me(d.currentTarget)]}var Tt=function(){function d(l){a(this,d),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=l}return c(d,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),d}();Object.defineProperty(Tt.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var ze=function(d,l){for(var p=0;p<l.length;p++){var m=l[p];d.push(m)}return d},xr=function(d){return ze([],d)},bt=function(d,l){for(var p=0;p<d.length;p++)if(l(d[p],p,d))return p;return-1},At=function(d,l){return d[bt(d,l)]},Se=function(d){h(p,d);var l=E(p);function p(m,x,N){var L;a(this,p),(L=l.call(this,x._interaction)).dropzone=void 0,L.dragEvent=void 0,L.relatedTarget=void 0,L.draggable=void 0,L.propagationStopped=!1,L.immediatePropagationStopped=!1;var q=N==="dragleave"?m.prev:m.cur,W=q.element,o=q.dropzone;return L.type=N,L.target=W,L.currentTarget=W,L.dropzone=o,L.dragEvent=x,L.relatedTarget=x.target,L.draggable=x.interactable,L.timeStamp=x.timeStamp,L}return c(p,[{key:"reject",value:function(){var m=this,x=this._interaction.dropState;if(this.type==="dropactivate"||this.dropzone&&x.cur.dropzone===this.dropzone&&x.cur.element===this.target)if(x.prev.dropzone=this.dropzone,x.prev.element=this.target,x.rejected=!0,x.events.enter=null,this.stopImmediatePropagation(),this.type==="dropactivate"){var N=x.activeDrops,L=bt(N,function(W){var o=W.dropzone,u=W.element;return o===m.dropzone&&u===m.target});x.activeDrops.splice(L,1);var q=new p(x,this.dragEvent,"dropdeactivate");q.dropzone=this.dropzone,q.target=this.target,this.dropzone.fire(q)}else this.dropzone.fire(new p(x,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),p}(Tt);function sr(d,l){for(var p=0,m=d.slice();p<m.length;p++){var x=m[p],N=x.dropzone,L=x.element;l.dropzone=N,l.target=L,N.fire(l),l.propagationStopped=l.immediatePropagationStopped=!1}}function qr(d,l){for(var p=function(N,L){for(var q=[],W=0,o=N.interactables.list;W<o.length;W++){var u=o[W];if(u.options.drop.enabled){var g=u.options.drop.accept;if(!(S.element(g)&&g!==L||S.string(g)&&!ce(L,g)||S.func(g)&&!g({dropzone:u,draggableElement:L})))for(var b=0,A=u.getAllElements();b<A.length;b++){var M=A[b];M!==L&&q.push({dropzone:u,element:M,rect:u.getRect(M)})}}}return q}(d,l),m=0;m<p.length;m++){var x=p[m];x.rect=x.dropzone.getRect(x.element)}return p}function en(d,l,p){for(var m=d.dropState,x=d.interactable,N=d.element,L=[],q=0,W=m.activeDrops;q<W.length;q++){var o=W[q],u=o.dropzone,g=o.element,b=o.rect,A=u.dropCheck(l,p,x,N,g,b);L.push(A?g:null)}var M=function($){for(var K,H,Q,te=[],X=0;X<$.length;X++){var re=$[X],Z=$[K];if(re&&X!==K)if(Z){var ie=oe(re),ae=oe(Z);if(ie!==re.ownerDocument)if(ae!==re.ownerDocument)if(ie!==ae){te=te.length?te:le(Z);var ne=void 0;if(Z instanceof ye.HTMLElement&&re instanceof ye.SVGElement&&!(re instanceof ye.SVGSVGElement)){if(re===ae)continue;ne=re.ownerSVGElement}else ne=re;for(var ue=le(ne,Z.ownerDocument),he=0;ue[he]&&ue[he]===te[he];)he++;var ge=[ue[he-1],ue[he],te[he]];if(ge[0])for(var ve=ge[0].lastChild;ve;){if(ve===ge[1]){K=X,te=ue;break}if(ve===ge[2])break;ve=ve.previousSibling}}else Q=Z,(parseInt(_(H=re).getComputedStyle(H).zIndex,10)||0)>=(parseInt(_(Q).getComputedStyle(Q).zIndex,10)||0)&&(K=X);else K=X}else K=X}return K}(L);return m.activeDrops[M]||null}function tn(d,l,p){var m=d.dropState,x={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return p.type==="dragstart"&&(x.activate=new Se(m,p,"dropactivate"),x.activate.target=null,x.activate.dropzone=null),p.type==="dragend"&&(x.deactivate=new Se(m,p,"dropdeactivate"),x.deactivate.target=null,x.deactivate.dropzone=null),m.rejected||(m.cur.element!==m.prev.element&&(m.prev.dropzone&&(x.leave=new Se(m,p,"dragleave"),p.dragLeave=x.leave.target=m.prev.element,p.prevDropzone=x.leave.dropzone=m.prev.dropzone),m.cur.dropzone&&(x.enter=new Se(m,p,"dragenter"),p.dragEnter=m.cur.element,p.dropzone=m.cur.dropzone)),p.type==="dragend"&&m.cur.dropzone&&(x.drop=new Se(m,p,"drop"),p.dropzone=m.cur.dropzone,p.relatedTarget=m.cur.element),p.type==="dragmove"&&m.cur.dropzone&&(x.move=new Se(m,p,"dropmove"),p.dropzone=m.cur.dropzone)),x}function yn(d,l){var p=d.dropState,m=p.activeDrops,x=p.cur,N=p.prev;l.leave&&N.dropzone.fire(l.leave),l.enter&&x.dropzone.fire(l.enter),l.move&&x.dropzone.fire(l.move),l.drop&&x.dropzone.fire(l.drop),l.deactivate&&sr(m,l.deactivate),p.prev.dropzone=x.dropzone,p.prev.element=x.element}function ya(d,l){var p=d.interaction,m=d.iEvent,x=d.event;if(m.type==="dragmove"||m.type==="dragend"){var N=p.dropState;l.dynamicDrop&&(N.activeDrops=qr(l,p.element));var L=m,q=en(p,L,x);N.rejected=N.rejected&&!!q&&q.dropzone===N.cur.dropzone&&q.element===N.cur.element,N.cur.dropzone=q&&q.dropzone,N.cur.element=q&&q.element,N.events=tn(p,0,L)}}var va={id:"actions/drop",install:function(d){var l=d.actions,p=d.interactStatic,m=d.Interactable,x=d.defaults;d.usePlugin(U),m.prototype.dropzone=function(N){return function(L,q){if(S.object(q)){if(L.options.drop.enabled=q.enabled!==!1,q.listeners){var W=pe(q.listeners),o=Object.keys(W).reduce(function(g,b){return g[/^(enter|leave)/.test(b)?"drag".concat(b):/^(activate|deactivate|move)/.test(b)?"drop".concat(b):b]=W[b],g},{}),u=L.options.drop.listeners;u&&L.off(u),L.on(o),L.options.drop.listeners=o}return S.func(q.ondrop)&&L.on("drop",q.ondrop),S.func(q.ondropactivate)&&L.on("dropactivate",q.ondropactivate),S.func(q.ondropdeactivate)&&L.on("dropdeactivate",q.ondropdeactivate),S.func(q.ondragenter)&&L.on("dragenter",q.ondragenter),S.func(q.ondragleave)&&L.on("dragleave",q.ondragleave),S.func(q.ondropmove)&&L.on("dropmove",q.ondropmove),/^(pointer|center)$/.test(q.overlap)?L.options.drop.overlap=q.overlap:S.number(q.overlap)&&(L.options.drop.overlap=Math.max(Math.min(1,q.overlap),0)),"accept"in q&&(L.options.drop.accept=q.accept),"checker"in q&&(L.options.drop.checker=q.checker),L}return S.bool(q)?(L.options.drop.enabled=q,L):L.options.drop}(this,N)},m.prototype.dropCheck=function(N,L,q,W,o,u){return function(g,b,A,M,$,K,H){var Q=!1;if(!(H=H||g.getRect(K)))return!!g.options.drop.checker&&g.options.drop.checker(b,A,Q,g,K,M,$);var te=g.options.drop.overlap;if(te==="pointer"){var X=Ee(M,$,"drag"),re=_t(b);re.x+=X.x,re.y+=X.y;var Z=re.x>H.left&&re.x<H.right,ie=re.y>H.top&&re.y<H.bottom;Q=Z&&ie}var ae=M.getRect($);if(ae&&te==="center"){var ne=ae.left+ae.width/2,ue=ae.top+ae.height/2;Q=ne>=H.left&&ne<=H.right&&ue>=H.top&&ue<=H.bottom}return ae&&S.number(te)&&(Q=Math.max(0,Math.min(H.right,ae.right)-Math.max(H.left,ae.left))*Math.max(0,Math.min(H.bottom,ae.bottom)-Math.max(H.top,ae.top))/(ae.width*ae.height)>=te),g.options.drop.checker&&(Q=g.options.drop.checker(b,A,Q,g,K,M,$)),Q}(this,N,L,q,W,o,u)},p.dynamicDrop=function(N){return S.bool(N)?(d.dynamicDrop=N,p):d.dynamicDrop},de(l.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),l.methodDict.drop="dropzone",d.dynamicDrop=!1,x.actions.drop=va.defaults},listeners:{"interactions:before-action-start":function(d){var l=d.interaction;l.prepared.name==="drag"&&(l.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(d,l){var p=d.interaction,m=(d.event,d.iEvent);if(p.prepared.name==="drag"){var x=p.dropState;x.activeDrops=[],x.events={},x.activeDrops=qr(l,p.element),x.events=tn(p,0,m),x.events.activate&&(sr(x.activeDrops,x.events.activate),l.fire("actions/drop:start",{interaction:p,dragEvent:m}))}},"interactions:action-move":ya,"interactions:after-action-move":function(d,l){var p=d.interaction,m=d.iEvent;if(p.prepared.name==="drag"){var x=p.dropState;yn(p,x.events),l.fire("actions/drop:move",{interaction:p,dragEvent:m}),x.events={}}},"interactions:action-end":function(d,l){if(d.interaction.prepared.name==="drag"){var p=d.interaction,m=d.iEvent;ya(d,l),yn(p,p.dropState.events),l.fire("actions/drop:end",{interaction:p,dragEvent:m})}},"interactions:stop":function(d){var l=d.interaction;if(l.prepared.name==="drag"){var p=l.dropState;p&&(p.activeDrops=null,p.events=null,p.cur.dropzone=null,p.cur.element=null,p.prev.dropzone=null,p.prev.element=null,p.rejected=!1)}}},getActiveDrops:qr,getDrop:en,getDropEvents:tn,fireDropEvents:yn,filterEventType:function(d){return d.search("drag")===0||d.search("drop")===0},defaults:{enabled:!1,accept:null,overlap:"pointer"}},rn=va;function _r(d){var l=d.interaction,p=d.iEvent,m=d.phase;if(l.prepared.name==="gesture"){var x=l.pointers.map(function(o){return o.pointer}),N=m==="start",L=m==="end",q=l.interactable.options.deltaSource;if(p.touches=[x[0],x[1]],N)p.distance=mt(x,q),p.box=St(x),p.scale=1,p.ds=0,p.angle=Ot(x,q),p.da=0,l.gesture.startDistance=p.distance,l.gesture.startAngle=p.angle;else if(L||l.pointers.length<2){var W=l.prevEvent;p.distance=W.distance,p.box=W.box,p.scale=W.scale,p.ds=0,p.angle=W.angle,p.da=0}else p.distance=mt(x,q),p.box=St(x),p.scale=p.distance/l.gesture.startDistance,p.angle=Ot(x,q),p.ds=p.scale-l.gesture.scale,p.da=p.angle-l.gesture.angle;l.gesture.distance=p.distance,l.gesture.angle=p.angle,S.number(p.scale)&&p.scale!==1/0&&!isNaN(p.scale)&&(l.gesture.scale=p.scale)}}var vn={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(d){var l=d.actions,p=d.Interactable,m=d.defaults;p.prototype.gesturable=function(x){return S.object(x)?(this.options.gesture.enabled=x.enabled!==!1,this.setPerAction("gesture",x),this.setOnEvents("gesture",x),this):S.bool(x)?(this.options.gesture.enabled=x,this):this.options.gesture},l.map.gesture=vn,l.methodDict.gesture="gesturable",m.actions.gesture=vn.defaults},listeners:{"interactions:action-start":_r,"interactions:action-move":_r,"interactions:action-end":_r,"interactions:new":function(d){d.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(d){if(!(d.interaction.pointers.length<2)){var l=d.interactable.options.gesture;if(l&&l.enabled)return d.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(d){return d.search("gesture")===0}},Un=vn;function Je(d,l,p,m,x,N,L){if(!l)return!1;if(l===!0){var q=S.number(N.width)?N.width:N.right-N.left,W=S.number(N.height)?N.height:N.bottom-N.top;if(L=Math.min(L,Math.abs((d==="left"||d==="right"?q:W)/2)),q<0&&(d==="left"?d="right":d==="right"&&(d="left")),W<0&&(d==="top"?d="bottom":d==="bottom"&&(d="top")),d==="left"){var o=q>=0?N.left:N.right;return p.x<o+L}if(d==="top"){var u=W>=0?N.top:N.bottom;return p.y<u+L}if(d==="right")return p.x>(q>=0?N.right:N.left)-L;if(d==="bottom")return p.y>(W>=0?N.bottom:N.top)-L}return!!S.element(m)&&(S.element(l)?l===m:se(m,l,x))}function ct(d){var l=d.iEvent,p=d.interaction;if(p.prepared.name==="resize"&&p.resizeAxes){var m=l;p.interactable.options.resize.square?(p.resizeAxes==="y"?m.delta.x=m.delta.y:m.delta.y=m.delta.x,m.axes="xy"):(m.axes=p.resizeAxes,p.resizeAxes==="x"?m.delta.y=0:p.resizeAxes==="y"&&(m.delta.x=0))}}var ur,Qt,jt={id:"actions/resize",before:["actions/drag"],install:function(d){var l=d.actions,p=d.browser,m=d.Interactable,x=d.defaults;jt.cursors=function(N){return N.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(p),jt.defaultMargin=p.supportsTouch||p.supportsPointerEvent?20:10,m.prototype.resizable=function(N){return function(L,q,W){return S.object(q)?(L.options.resize.enabled=q.enabled!==!1,L.setPerAction("resize",q),L.setOnEvents("resize",q),S.string(q.axis)&&/^x$|^y$|^xy$/.test(q.axis)?L.options.resize.axis=q.axis:q.axis===null&&(L.options.resize.axis=W.defaults.actions.resize.axis),S.bool(q.preserveAspectRatio)?L.options.resize.preserveAspectRatio=q.preserveAspectRatio:S.bool(q.square)&&(L.options.resize.square=q.square),L):S.bool(q)?(L.options.resize.enabled=q,L):L.options.resize}(this,N,d)},l.map.resize=jt,l.methodDict.resize="resizable",x.actions.resize=jt.defaults},listeners:{"interactions:new":function(d){d.interaction.resizeAxes="xy"},"interactions:action-start":function(d){(function(l){var p=l.iEvent,m=l.interaction;if(m.prepared.name==="resize"&&m.prepared.edges){var x=p,N=m.rect;m._rects={start:de({},N),corrected:de({},N),previous:de({},N),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},x.edges=m.prepared.edges,x.rect=m._rects.corrected,x.deltaRect=m._rects.delta}})(d),ct(d)},"interactions:action-move":function(d){(function(l){var p=l.iEvent,m=l.interaction;if(m.prepared.name==="resize"&&m.prepared.edges){var x=p,N=m.interactable.options.resize.invert,L=N==="reposition"||N==="negate",q=m.rect,W=m._rects,o=W.start,u=W.corrected,g=W.delta,b=W.previous;if(de(b,u),L){if(de(u,q),N==="reposition"){if(u.top>u.bottom){var A=u.top;u.top=u.bottom,u.bottom=A}if(u.left>u.right){var M=u.left;u.left=u.right,u.right=M}}}else u.top=Math.min(q.top,o.bottom),u.bottom=Math.max(q.bottom,o.top),u.left=Math.min(q.left,o.right),u.right=Math.max(q.right,o.left);for(var $ in u.width=u.right-u.left,u.height=u.bottom-u.top,u)g[$]=u[$]-b[$];x.edges=m.prepared.edges,x.rect=u,x.deltaRect=g}})(d),ct(d)},"interactions:action-end":function(d){var l=d.iEvent,p=d.interaction;if(p.prepared.name==="resize"&&p.prepared.edges){var m=l;m.edges=p.prepared.edges,m.rect=p._rects.corrected,m.deltaRect=p._rects.delta}},"auto-start:check":function(d){var l=d.interaction,p=d.interactable,m=d.element,x=d.rect,N=d.buttons;if(x){var L=de({},l.coords.cur.page),q=p.options.resize;if(q&&q.enabled&&(!l.pointerIsDown||!/mouse|pointer/.test(l.pointerType)||N&q.mouseButtons)){if(S.object(q.edges)){var W={left:!1,right:!1,top:!1,bottom:!1};for(var o in W)W[o]=Je(o,q.edges[o],L,l._latestPointer.eventTarget,m,x,q.margin||jt.defaultMargin);W.left=W.left&&!W.right,W.top=W.top&&!W.bottom,(W.left||W.right||W.top||W.bottom)&&(d.action={name:"resize",edges:W})}else{var u=q.axis!=="y"&&L.x>x.right-jt.defaultMargin,g=q.axis!=="x"&&L.y>x.bottom-jt.defaultMargin;(u||g)&&(d.action={name:"resize",axes:(u?"x":"")+(g?"y":"")})}return!d.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(d){var l=d.edges,p=d.axis,m=d.name,x=jt.cursors,N=null;if(p)N=x[m+p];else if(l){for(var L="",q=0,W=["top","bottom","left","right"];q<W.length;q++){var o=W[q];l[o]&&(L+=o)}N=x[L]}return N},filterEventType:function(d){return d.search("resize")===0},defaultMargin:null},Kn=jt,ko={id:"actions",install:function(d){d.usePlugin(Un),d.usePlugin(Kn),d.usePlugin(U),d.usePlugin(rn)}},cr=0,Rt={request:function(d){return ur(d)},cancel:function(d){return Qt(d)},init:function(d){if(ur=d.requestAnimationFrame,Qt=d.cancelAnimationFrame,!ur)for(var l=["ms","moz","webkit","o"],p=0;p<l.length;p++){var m=l[p];ur=d["".concat(m,"RequestAnimationFrame")],Qt=d["".concat(m,"CancelAnimationFrame")]||d["".concat(m,"CancelRequestAnimationFrame")]}ur=ur&&ur.bind(d),Qt=Qt&&Qt.bind(d),ur||(ur=function(x){var N=Date.now(),L=Math.max(0,16-(N-cr)),q=d.setTimeout(function(){x(N+L)},L);return cr=N+L,q},Qt=function(x){return clearTimeout(x)})}},Ge={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(d){Ge.isScrolling=!0,Rt.cancel(Ge.i),d.autoScroll=Ge,Ge.interaction=d,Ge.prevTime=Ge.now(),Ge.i=Rt.request(Ge.scroll)},stop:function(){Ge.isScrolling=!1,Ge.interaction&&(Ge.interaction.autoScroll=null),Rt.cancel(Ge.i)},scroll:function(){var d=Ge.interaction,l=d.interactable,p=d.element,m=d.prepared.name,x=l.options[m].autoScroll,N=mn(x.container,l,p),L=Ge.now(),q=(L-Ge.prevTime)/1e3,W=x.speed*q;if(W>=1){var o={x:Ge.x*W,y:Ge.y*W};if(o.x||o.y){var u=ma(N);S.window(N)?N.scrollBy(o.x,o.y):N&&(N.scrollLeft+=o.x,N.scrollTop+=o.y);var g=ma(N),b={x:g.x-u.x,y:g.y-u.y};(b.x||b.y)&&l.fire({type:"autoscroll",target:p,interactable:l,delta:b,interaction:d,container:N})}Ge.prevTime=L}Ge.isScrolling&&(Rt.cancel(Ge.i),Ge.i=Rt.request(Ge.scroll))},check:function(d,l){var p;return(p=d.options[l].autoScroll)==null?void 0:p.enabled},onInteractionMove:function(d){var l=d.interaction,p=d.pointer;if(l.interacting()&&Ge.check(l.interactable,l.prepared.name))if(l.simulation)Ge.x=Ge.y=0;else{var m,x,N,L,q=l.interactable,W=l.element,o=l.prepared.name,u=q.options[o].autoScroll,g=mn(u.container,q,W);if(S.window(g))L=p.clientX<Ge.margin,m=p.clientY<Ge.margin,x=p.clientX>g.innerWidth-Ge.margin,N=p.clientY>g.innerHeight-Ge.margin;else{var b=_e(g);L=p.clientX<b.left+Ge.margin,m=p.clientY<b.top+Ge.margin,x=p.clientX>b.right-Ge.margin,N=p.clientY>b.bottom-Ge.margin}Ge.x=x?1:L?-1:0,Ge.y=N?1:m?-1:0,Ge.isScrolling||(Ge.margin=u.margin,Ge.speed=u.speed,Ge.start(l))}}};function mn(d,l,p){return(S.string(d)?Ne(d,l,p):d)||_(p)}function ma(d){return S.window(d)&&(d=window.document.body),{x:d.scrollLeft,y:d.scrollTop}}var Sr={id:"auto-scroll",install:function(d){var l=d.defaults,p=d.actions;d.autoScroll=Ge,Ge.now=function(){return d.now()},p.phaselessTypes.autoscroll=!0,l.perAction.autoScroll=Ge.defaults},listeners:{"interactions:new":function(d){d.interaction.autoScroll=null},"interactions:destroy":function(d){d.interaction.autoScroll=null,Ge.stop(),Ge.interaction&&(Ge.interaction=null)},"interactions:stop":Ge.stop,"interactions:action-move":function(d){return Ge.onInteractionMove(d)}}},ba=Sr;function Kt(d,l){var p=!1;return function(){return p||(C.console.warn(l),p=!0),d.apply(this,arguments)}}function Wn(d,l){return d.name=l.name,d.axis=l.axis,d.edges=l.edges,d}function Ai(d){return S.bool(d)?(this.options.styleCursor=d,this):d===null?(delete this.options.styleCursor,this):this.options.styleCursor}function et(d){return S.func(d)?(this.options.actionChecker=d,this):d===null?(delete this.options.actionChecker,this):this.options.actionChecker}var Fr={id:"auto-start/interactableMethods",install:function(d){var l=d.Interactable;l.prototype.getAction=function(p,m,x,N){var L=function(q,W,o,u,g){var b=q.getRect(u),A=W.buttons||{0:1,1:4,3:8,4:16}[W.button],M={action:null,interactable:q,interaction:o,element:u,rect:b,buttons:A};return g.fire("auto-start:check",M),M.action}(this,m,x,N,d);return this.options.actionChecker?this.options.actionChecker(p,m,L,this,N,x):L},l.prototype.ignoreFrom=Kt(function(p){return this._backCompatOption("ignoreFrom",p)},"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),l.prototype.allowFrom=Kt(function(p){return this._backCompatOption("allowFrom",p)},"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),l.prototype.actionChecker=et,l.prototype.styleCursor=Ai}};function Zt(d,l,p,m,x){return l.testIgnoreAllow(l.options[d.name],p,m)&&l.options[d.name].enabled&&nn(l,p,d,x)?d:null}function wa(d,l,p,m,x,N,L){for(var q=0,W=m.length;q<W;q++){var o=m[q],u=x[q],g=o.getAction(l,p,d,u);if(g){var b=Zt(g,o,u,N,L);if(b)return{action:b,interactable:o,element:u}}}return{action:null,interactable:null,element:null}}function jr(d,l,p,m,x){var N=[],L=[],q=m;function W(u){N.push(u),L.push(q)}for(;S.element(q);){N=[],L=[],x.interactables.forEachMatch(q,W);var o=wa(d,l,p,N,L,m,x);if(o.action&&!o.interactable.options[o.action.name].manualStart)return o;q=ee(q)}return{action:null,interactable:null,element:null}}function bn(d,l,p){var m=l.action,x=l.interactable,N=l.element;m=m||{name:null},d.interactable=x,d.element=N,Wn(d.prepared,m),d.rect=x&&m.name?x.getRect(N):null,ki(d,p),p.fire("autoStart:prepared",{interaction:d})}function nn(d,l,p,m){var x=d.options,N=x[p.name].max,L=x[p.name].maxPerElement,q=m.autoStart.maxInteractions,W=0,o=0,u=0;if(!(N&&L&&q))return!1;for(var g=0,b=m.interactions.list;g<b.length;g++){var A=b[g],M=A.prepared.name;if(A.interacting()&&(++W>=q||A.interactable===d&&((o+=M===p.name?1:0)>=N||A.element===l&&(u++,M===p.name&&u>=L))))return!1}return q>0}function Hn(d,l){return S.number(d)?(l.autoStart.maxInteractions=d,this):l.autoStart.maxInteractions}function lr(d,l,p){var m=p.autoStart.cursorElement;m&&m!==d&&(m.style.cursor=""),d.ownerDocument.documentElement.style.cursor=l,d.style.cursor=l,p.autoStart.cursorElement=l?d:null}function ki(d,l){var p=d.interactable,m=d.element,x=d.prepared;if(d.pointerType==="mouse"&&p&&p.options.styleCursor){var N="";if(x.name){var L=p.options[x.name].cursorChecker;N=S.func(L)?L(x,p,m,d._interacting):l.actions.map[x.name].getCursor(x)}lr(d.element,N||"",l)}else l.autoStart.cursorElement&&lr(l.autoStart.cursorElement,"",l)}var Yn={id:"auto-start/base",before:["actions"],install:function(d){var l=d.interactStatic,p=d.defaults;d.usePlugin(Fr),p.base.actionChecker=null,p.base.styleCursor=!0,de(p.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),l.maxInteractions=function(m){return Hn(m,d)},d.autoStart={maxInteractions:1/0,withinInteractionLimit:nn,cursorElement:null}},listeners:{"interactions:down":function(d,l){var p=d.interaction,m=d.pointer,x=d.event,N=d.eventTarget;p.interacting()||bn(p,jr(p,m,x,N,l),l)},"interactions:move":function(d,l){(function(p,m){var x=p.interaction,N=p.pointer,L=p.event,q=p.eventTarget;x.pointerType!=="mouse"||x.pointerIsDown||x.interacting()||bn(x,jr(x,N,L,q,m),m)})(d,l),function(p,m){var x=p.interaction;if(x.pointerIsDown&&!x.interacting()&&x.pointerWasMoved&&x.prepared.name){m.fire("autoStart:before-start",p);var N=x.interactable,L=x.prepared.name;L&&N&&(N.options[L].manualStart||!nn(N,x.element,x.prepared,m)?x.stop():(x.start(x.prepared,N,x.element),ki(x,m)))}}(d,l)},"interactions:stop":function(d,l){var p=d.interaction,m=p.interactable;m&&m.options.styleCursor&&lr(p.element,"",l)}},maxInteractions:Hn,withinInteractionLimit:nn,validateAction:Zt},Xn=Yn,Ye={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(d,l){var p=d.interaction,m=d.eventTarget,x=d.dx,N=d.dy;if(p.prepared.name==="drag"){var L=Math.abs(x),q=Math.abs(N),W=p.interactable.options.drag,o=W.startAxis,u=L>q?"x":L<q?"y":"xy";if(p.prepared.axis=W.lockAxis==="start"?u[0]:W.lockAxis,u!=="xy"&&o!=="xy"&&o!==u){p.prepared.name=null;for(var g=m,b=function(M){if(M!==p.interactable){var $=p.interactable.options.drag;if(!$.manualStart&&M.testIgnoreAllow($,g,m)){var K=M.getAction(p.downPointer,p.downEvent,p,g);if(K&&K.name==="drag"&&function(H,Q){if(!Q)return!1;var te=Q.options.drag.startAxis;return H==="xy"||te==="xy"||te===H}(u,M)&&Xn.validateAction(K,M,g,m,l))return M}}};S.element(g);){var A=l.interactables.forEachMatch(g,b);if(A){p.prepared.name="drag",p.interactable=A,p.element=g;break}g=ee(g)}}}}}};function Vn(d){var l=d.prepared&&d.prepared.name;if(!l)return null;var p=d.interactable.options;return p[l].hold||p[l].delay}var Ea={id:"auto-start/hold",install:function(d){var l=d.defaults;d.usePlugin(Xn),l.perAction.hold=0,l.perAction.delay=0},listeners:{"interactions:new":function(d){d.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(d){var l=d.interaction,p=Vn(l);p>0&&(l.autoStartHoldTimer=setTimeout(function(){l.start(l.prepared,l.interactable,l.element)},p))},"interactions:move":function(d){var l=d.interaction,p=d.duplicate;l.autoStartHoldTimer&&l.pointerWasMoved&&!p&&(clearTimeout(l.autoStartHoldTimer),l.autoStartHoldTimer=null)},"autoStart:before-start":function(d){var l=d.interaction;Vn(l)>0&&(l.prepared.name=null)}},getHoldDuration:Vn},xa=Ea,Ze={id:"auto-start",install:function(d){d.usePlugin(Xn),d.usePlugin(xa),d.usePlugin(Ye)}},wn=function(d){return/^(always|never|auto)$/.test(d)?(this.options.preventDefault=d,this):S.bool(d)?(this.options.preventDefault=d?"always":"never",this):this.options.preventDefault};function En(d){var l=d.interaction,p=d.event;l.interactable&&l.interactable.checkAndPreventDefault(p)}var Br={id:"core/interactablePreventDefault",install:function(d){var l=d.Interactable;l.prototype.preventDefault=wn,l.prototype.checkAndPreventDefault=function(p){return function(m,x,N){var L=m.options.preventDefault;if(L!=="never")if(L!=="always"){if(x.events.supportsPassive&&/^touch(start|move)$/.test(N.type)){var q=_(N.target).document,W=x.getDocOptions(q);if(!W||!W.events||W.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(N.type)||S.element(N.target)&&ce(N.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||N.preventDefault()}else N.preventDefault()}(this,d,p)},d.interactions.docEvents.push({type:"dragstart",listener:function(p){for(var m=0,x=d.interactions.list;m<x.length;m++){var N=x[m];if(N.element&&(N.element===p.target||O(N.element,p.target)))return void N.interactable.checkAndPreventDefault(p)}}})},listeners:["down","move","up","cancel"].reduce(function(d,l){return d["interactions:".concat(l)]=En,d},{})};function an(d,l){if(l.phaselessTypes[d])return!0;for(var p in l.map)if(d.indexOf(p)===0&&d.substr(p.length)in l.phases)return!0;return!1}function Ar(d){var l={};for(var p in d){var m=d[p];S.plainObject(m)?l[p]=Ar(m):S.array(m)?l[p]=xr(m):l[p]=m}return l}var on=function(){function d(l){a(this,d),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=l,this.result=xn(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return c(d,[{key:"start",value:function(l,p){var m,x,N=l.phase,L=this.interaction,q=function(o){var u=o.interactable.options[o.prepared.name],g=u.modifiers;return g&&g.length?g:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map(function(b){var A=u[b];return A&&A.enabled&&{options:A,methods:A._methods}}).filter(function(b){return!!b})}(L);this.prepareStates(q),this.startEdges=de({},L.edges),this.edges=de({},this.startEdges),this.startOffset=(m=L.rect,x=p,m?{left:x.x-m.left,top:x.y-m.top,right:m.right-x.x,bottom:m.bottom-x.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var W=this.fillArg({phase:N,pageCoords:p,preEnd:!1});return this.result=xn(),this.startAll(W),this.result=this.setAll(W)}},{key:"fillArg",value:function(l){var p=this.interaction;return l.interaction=p,l.interactable=p.interactable,l.element=p.element,l.rect||(l.rect=p.rect),l.edges||(l.edges=this.startEdges),l.startOffset=this.startOffset,l}},{key:"startAll",value:function(l){for(var p=0,m=this.states;p<m.length;p++){var x=m[p];x.methods.start&&(l.state=x,x.methods.start(l))}}},{key:"setAll",value:function(l){var p=l.phase,m=l.preEnd,x=l.skipModifiers,N=l.rect,L=l.edges;l.coords=de({},l.pageCoords),l.rect=de({},N),l.edges=de({},L);for(var q=x?this.states.slice(x):this.states,W=xn(l.coords,l.rect),o=0;o<q.length;o++){var u,g=q[o],b=g.options,A=de({},l.coords),M=null;(u=g.methods)!=null&&u.set&&this.shouldDo(b,m,p)&&(l.state=g,M=g.methods.set(l),Le(l.edges,l.rect,{x:l.coords.x-A.x,y:l.coords.y-A.y})),W.eventProps.push(M)}de(this.edges,l.edges),W.delta.x=l.coords.x-l.pageCoords.x,W.delta.y=l.coords.y-l.pageCoords.y,W.rectDelta.left=l.rect.left-N.left,W.rectDelta.right=l.rect.right-N.right,W.rectDelta.top=l.rect.top-N.top,W.rectDelta.bottom=l.rect.bottom-N.bottom;var $=this.result.coords,K=this.result.rect;if($&&K){var H=W.rect.left!==K.left||W.rect.right!==K.right||W.rect.top!==K.top||W.rect.bottom!==K.bottom;W.changed=H||$.x!==W.coords.x||$.y!==W.coords.y}return W}},{key:"applyToInteraction",value:function(l){var p=this.interaction,m=l.phase,x=p.coords.cur,N=p.coords.start,L=this.result,q=this.startDelta,W=L.delta;m==="start"&&de(this.startDelta,L.delta);for(var o=0,u=[[N,q],[x,W]];o<u.length;o++){var g=u[o],b=g[0],A=g[1];b.page.x+=A.x,b.page.y+=A.y,b.client.x+=A.x,b.client.y+=A.y}var M=this.result.rectDelta,$=l.rect||p.rect;$.left+=M.left,$.right+=M.right,$.top+=M.top,$.bottom+=M.bottom,$.width=$.right-$.left,$.height=$.bottom-$.top}},{key:"setAndApply",value:function(l){var p=this.interaction,m=l.phase,x=l.preEnd,N=l.skipModifiers,L=this.setAll(this.fillArg({preEnd:x,phase:m,pageCoords:l.modifiedCoords||p.coords.cur.page}));if(this.result=L,!L.changed&&(!N||N<this.states.length)&&p.interacting())return!1;if(l.modifiedCoords){var q=p.coords.cur.page,W={x:l.modifiedCoords.x-q.x,y:l.modifiedCoords.y-q.y};L.coords.x+=W.x,L.coords.y+=W.y,L.delta.x+=W.x,L.delta.y+=W.y}this.applyToInteraction(l)}},{key:"beforeEnd",value:function(l){var p=l.interaction,m=l.event,x=this.states;if(x&&x.length){for(var N=!1,L=0;L<x.length;L++){var q=x[L];l.state=q;var W=q.options,o=q.methods,u=o.beforeEnd&&o.beforeEnd(l);if(u)return this.endResult=u,!1;N=N||!N&&this.shouldDo(W,!0,l.phase,!0)}N&&p.move({event:m,preEnd:!0})}}},{key:"stop",value:function(l){var p=l.interaction;if(this.states&&this.states.length){var m=de({states:this.states,interactable:p.interactable,element:p.element,rect:null},l);this.fillArg(m);for(var x=0,N=this.states;x<N.length;x++){var L=N[x];m.state=L,L.methods.stop&&L.methods.stop(m)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(l){this.states=[];for(var p=0;p<l.length;p++){var m=l[p],x=m.options,N=m.methods,L=m.name;this.states.push({options:x,methods:N,index:p,name:L})}return this.states}},{key:"restoreInteractionCoords",value:function(l){var p=l.interaction,m=p.coords,x=p.rect,N=p.modification;if(N.result){for(var L=N.startDelta,q=N.result,W=q.delta,o=q.rectDelta,u=0,g=[[m.start,L],[m.cur,W]];u<g.length;u++){var b=g[u],A=b[0],M=b[1];A.page.x-=M.x,A.page.y-=M.y,A.client.x-=M.x,A.client.y-=M.y}x.left-=o.left,x.right-=o.right,x.top-=o.top,x.bottom-=o.bottom}}},{key:"shouldDo",value:function(l,p,m,x){return!(!l||l.enabled===!1||x&&!l.endOnly||l.endOnly&&!p||m==="start"&&!l.setStart)}},{key:"copyFrom",value:function(l){this.startOffset=l.startOffset,this.startDelta=l.startDelta,this.startEdges=l.startEdges,this.edges=l.edges,this.states=l.states.map(function(p){return Ar(p)}),this.result=xn(de({},l.result.coords),de({},l.result.rect))}},{key:"destroy",value:function(){for(var l in this)this[l]=null}}]),d}();function xn(d,l){return{rect:l,coords:d,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Wt(d,l){var p=d.defaults,m={start:d.start,set:d.set,beforeEnd:d.beforeEnd,stop:d.stop},x=function(N){var L=N||{};for(var q in L.enabled=L.enabled!==!1,p)q in L||(L[q]=p[q]);var W={options:L,methods:m,name:l,enable:function(){return L.enabled=!0,W},disable:function(){return L.enabled=!1,W}};return W};return l&&typeof l=="string"&&(x._defaults=p,x._methods=m),x}function sn(d){var l=d.iEvent,p=d.interaction.modification.result;p&&(l.modifiers=p.eventProps)}var _n={id:"modifiers/base",before:["actions"],install:function(d){d.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(d){var l=d.interaction;l.modification=new on(l)},"interactions:before-action-start":function(d){var l=d.interaction,p=d.interaction.modification;p.start(d,l.coords.start.page),l.edges=p.edges,p.applyToInteraction(d)},"interactions:before-action-move":function(d){var l=d.interaction,p=l.modification,m=p.setAndApply(d);return l.edges=p.edges,m},"interactions:before-action-end":function(d){var l=d.interaction,p=l.modification,m=p.beforeEnd(d);return l.edges=p.startEdges,m},"interactions:action-start":sn,"interactions:action-move":sn,"interactions:action-end":sn,"interactions:after-action-start":function(d){return d.interaction.modification.restoreInteractionCoords(d)},"interactions:after-action-move":function(d){return d.interaction.modification.restoreInteractionCoords(d)},"interactions:stop":function(d){return d.interaction.modification.stop(d)}}},Di=_n,_a={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},Xe=function(d){h(p,d);var l=E(p);function p(m,x,N,L,q,W,o){var u;a(this,p),(u=l.call(this,m)).relatedTarget=null,u.screenX=void 0,u.screenY=void 0,u.button=void 0,u.buttons=void 0,u.ctrlKey=void 0,u.shiftKey=void 0,u.altKey=void 0,u.metaKey=void 0,u.page=void 0,u.client=void 0,u.delta=void 0,u.rect=void 0,u.x0=void 0,u.y0=void 0,u.t0=void 0,u.dt=void 0,u.duration=void 0,u.clientX0=void 0,u.clientY0=void 0,u.velocity=void 0,u.speed=void 0,u.swipe=void 0,u.axes=void 0,u.preEnd=void 0,q=q||m.element;var g=m.interactable,b=(g&&g.options||_a).deltaSource,A=Ee(g,q,N),M=L==="start",$=L==="end",K=M?w(u):m.prevEvent,H=M?m.coords.start:$?{page:K.page,client:K.client,timeStamp:m.coords.cur.timeStamp}:m.coords.cur;return u.page=de({},H.page),u.client=de({},H.client),u.rect=de({},m.rect),u.timeStamp=H.timeStamp,$||(u.page.x-=A.x,u.page.y-=A.y,u.client.x-=A.x,u.client.y-=A.y),u.ctrlKey=x.ctrlKey,u.altKey=x.altKey,u.shiftKey=x.shiftKey,u.metaKey=x.metaKey,u.button=x.button,u.buttons=x.buttons,u.target=q,u.currentTarget=q,u.preEnd=W,u.type=o||N+(L||""),u.interactable=g,u.t0=M?m.pointers[m.pointers.length-1].downTime:K.t0,u.x0=m.coords.start.page.x-A.x,u.y0=m.coords.start.page.y-A.y,u.clientX0=m.coords.start.client.x-A.x,u.clientY0=m.coords.start.client.y-A.y,u.delta=M||$?{x:0,y:0}:{x:u[b].x-K[b].x,y:u[b].y-K[b].y},u.dt=m.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=de({},m.coords.velocity[b]),u.speed=it(u.velocity.x,u.velocity.y),u.swipe=$||L==="inertiastart"?u.getSwipe():null,u}return c(p,[{key:"getSwipe",value:function(){var m=this._interaction;if(m.prevEvent.speed<600||this.timeStamp-m.prevEvent.timeStamp>150)return null;var x=180*Math.atan2(m.prevEvent.velocityY,m.prevEvent.velocityX)/Math.PI;x<0&&(x+=360);var N=112.5<=x&&x<247.5,L=202.5<=x&&x<337.5;return{up:L,down:!L&&22.5<=x&&x<157.5,left:N,right:!N&&(292.5<=x||x<67.5),angle:x,speed:m.prevEvent.speed,velocity:{x:m.prevEvent.velocityX,y:m.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),p}(Tt);Object.defineProperties(Xe.prototype,{pageX:{get:function(){return this.page.x},set:function(d){this.page.x=d}},pageY:{get:function(){return this.page.y},set:function(d){this.page.y=d}},clientX:{get:function(){return this.client.x},set:function(d){this.client.x=d}},clientY:{get:function(){return this.client.y},set:function(d){this.client.y=d}},dx:{get:function(){return this.delta.x},set:function(d){this.delta.x=d}},dy:{get:function(){return this.delta.y},set:function(d){this.delta.y=d}},velocityX:{get:function(){return this.velocity.x},set:function(d){this.velocity.x=d}},velocityY:{get:function(){return this.velocity.y},set:function(d){this.velocity.y=d}}});var Ci=c(function d(l,p,m,x,N){a(this,d),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=l,this.pointer=p,this.event=m,this.downTime=x,this.downTarget=N}),Do=function(d){return d.interactable="",d.element="",d.prepared="",d.pointerIsDown="",d.pointerWasMoved="",d._proxy="",d}({}),Sa=function(d){return d.start="",d.move="",d.end="",d.stop="",d.interacting="",d}({}),Lt=0,un=function(){function d(l){var p=this,m=l.pointerType,x=l.scopeFire;a(this,d),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=Kt(function(u){this.move(u)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=Lt++,this._scopeFire=x,this.pointerType=m;var N=this;this._proxy={};var L=function(u){Object.defineProperty(p._proxy,u,{get:function(){return N[u]}})};for(var q in Do)L(q);var W=function(u){Object.defineProperty(p._proxy,u,{value:function(){return N[u].apply(N,arguments)}})};for(var o in Sa)W(o);this._scopeFire("interactions:new",{interaction:this})}return c(d,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(l,p,m){var x=this.updatePointer(l,p,m,!0),N=this.pointers[x];this._scopeFire("interactions:down",{pointer:l,event:p,eventTarget:m,pointerIndex:x,pointerInfo:N,type:"down",interaction:this})}},{key:"start",value:function(l,p,m){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<(l.name==="gesture"?2:1)||!p.options[l.name].enabled)&&(Wn(this.prepared,l),this.interactable=p,this.element=m,this.rect=p.getRect(m),this.edges=this.prepared.edges?de({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(l,p,m){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(l,p,m,!1);var x,N,L=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(x=this.coords.cur.client.x-this.coords.start.client.x,N=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=it(x,N)>this.pointerMoveTolerance);var q,W,o,u=this.getPointerIndex(l),g={pointer:l,pointerIndex:u,pointerInfo:this.pointers[u],event:p,type:"move",eventTarget:m,dx:x,dy:N,duplicate:L,interaction:this};L||(q=this.coords.velocity,W=this.coords.delta,o=Math.max(W.timeStamp/1e3,.001),q.page.x=W.page.x/o,q.page.y=W.page.y/o,q.client.x=W.client.x/o,q.client.y=W.client.y/o,q.timeStamp=o),this._scopeFire("interactions:move",g),L||this.simulation||(this.interacting()&&(g.type=null,this.move(g)),this.pointerWasMoved&&Ve(this.coords.prev,this.coords.cur))}},{key:"move",value:function(l){l&&l.event||ht(this.coords.delta),(l=de({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},l||{})).phase="move",this._doPhase(l)}},{key:"pointerUp",value:function(l,p,m,x){var N=this.getPointerIndex(l);N===-1&&(N=this.updatePointer(l,p,m,!1));var L=/cancel$/i.test(p.type)?"cancel":"up";this._scopeFire("interactions:".concat(L),{pointer:l,pointerIndex:N,pointerInfo:this.pointers[N],event:p,eventTarget:m,type:L,curEventTarget:x,interaction:this}),this.simulation||this.end(p),this.removePointer(l,p)}},{key:"documentBlur",value:function(l){this.end(l),this._scopeFire("interactions:blur",{event:l,type:"blur",interaction:this})}},{key:"end",value:function(l){var p;this._ending=!0,l=l||this._latestPointer.event,this.interacting()&&(p=this._doPhase({event:l,interaction:this,phase:"end"})),this._ending=!1,p===!0&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(l){var p=st(l);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:bt(this.pointers,function(m){return m.id===p})}},{key:"getPointerInfo",value:function(l){return this.pointers[this.getPointerIndex(l)]}},{key:"updatePointer",value:function(l,p,m,x){var N,L,q,W=st(l),o=this.getPointerIndex(l),u=this.pointers[o];return x=x!==!1&&(x||/(down|start)$/i.test(p.type)),u?u.pointer=l:(u=new Ci(W,l,p,null,null),o=this.pointers.length,this.pointers.push(u)),ut(this.coords.cur,this.pointers.map(function(g){return g.pointer}),this._now()),N=this.coords.delta,L=this.coords.prev,q=this.coords.cur,N.page.x=q.page.x-L.page.x,N.page.y=q.page.y-L.page.y,N.client.x=q.client.x-L.client.x,N.client.y=q.client.y-L.client.y,N.timeStamp=q.timeStamp-L.timeStamp,x&&(this.pointerIsDown=!0,u.downTime=this.coords.cur.timeStamp,u.downTarget=m,at(this.downPointer,l),this.interacting()||(Ve(this.coords.start,this.coords.cur),Ve(this.coords.prev,this.coords.cur),this.downEvent=p,this.pointerWasMoved=!1)),this._updateLatestPointer(l,p,m),this._scopeFire("interactions:update-pointer",{pointer:l,event:p,eventTarget:m,down:x,pointerInfo:u,pointerIndex:o,interaction:this}),o}},{key:"removePointer",value:function(l,p){var m=this.getPointerIndex(l);if(m!==-1){var x=this.pointers[m];this._scopeFire("interactions:remove-pointer",{pointer:l,event:p,eventTarget:null,pointerIndex:m,pointerInfo:x,interaction:this}),this.pointers.splice(m,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(l,p,m){this._latestPointer.pointer=l,this._latestPointer.event=p,this._latestPointer.eventTarget=m}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(l,p,m,x){return new Xe(this,l,this.prepared.name,p,this.element,m,x)}},{key:"_fireEvent",value:function(l){var p;(p=this.interactable)==null||p.fire(l),(!this.prevEvent||l.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=l)}},{key:"_doPhase",value:function(l){var p=l.event,m=l.phase,x=l.preEnd,N=l.type,L=this.rect;if(L&&m==="move"&&(Le(this.edges,L,this.coords.delta[this.interactable.options.deltaSource]),L.width=L.right-L.left,L.height=L.bottom-L.top),this._scopeFire("interactions:before-action-".concat(m),l)===!1)return!1;var q=l.iEvent=this._createPreparedEvent(p,m,x,N);return this._scopeFire("interactions:action-".concat(m),l),m==="start"&&(this.prevEvent=q),this._fireEvent(q),this._scopeFire("interactions:after-action-".concat(m),l),!0}},{key:"_now",value:function(){return Date.now()}}]),d}();function Sn(d){dr(d.interaction)}function dr(d){if(!function(p){return!(!p.offset.pending.x&&!p.offset.pending.y)}(d))return!1;var l=d.offset.pending;return Qn(d.coords.cur,l),Qn(d.coords.delta,l),Le(d.edges,d.rect,l),l.x=0,l.y=0,!0}function Aa(d){var l=d.x,p=d.y;this.offset.pending.x+=l,this.offset.pending.y+=p,this.offset.total.x+=l,this.offset.total.y+=p}function Qn(d,l){var p=d.page,m=d.client,x=l.x,N=l.y;p.x+=x,p.y+=N,m.x+=x,m.y+=N}Sa.offsetBy="";var lt={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(d){d.Interaction.prototype.offsetBy=Aa},listeners:{"interactions:new":function(d){d.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(d){return function(l){l.pointerIsDown&&(Qn(l.coords.cur,l.offset.total),l.offset.pending.x=0,l.offset.pending.y=0)}(d.interaction)},"interactions:before-action-start":Sn,"interactions:before-action-move":Sn,"interactions:before-action-end":function(d){var l=d.interaction;if(dr(l))return l.move({offset:!0}),l.end(),!1},"interactions:stop":function(d){var l=d.interaction;l.offset.total.x=0,l.offset.total.y=0,l.offset.pending.x=0,l.offset.pending.y=0}}},Ht=lt,An=function(){function d(l){a(this,d),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=l}return c(d,[{key:"start",value:function(l){var p=this.interaction,m=kr(p);if(!m||!m.enabled)return!1;var x=p.coords.velocity.client,N=it(x.x,x.y),L=this.modification||(this.modification=new on(p));if(L.copyFrom(p.modification),this.t0=p._now(),this.allowResume=m.allowResume,this.v0=N,this.currentOffset={x:0,y:0},this.startCoords=p.coords.cur.page,this.modifierArg=L.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-p.coords.cur.timeStamp<50&&N>m.minSpeed&&N>m.endSpeed)this.startInertia();else{if(L.result=L.setAll(this.modifierArg),!L.result.changed)return!1;this.startSmoothEnd()}return p.modification.result.rect=null,p.offsetBy(this.targetOffset),p._doPhase({interaction:p,event:l,phase:"inertiastart"}),p.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),p.modification.result.rect=null,this.active=!0,p.simulation=this,!0}},{key:"startInertia",value:function(){var l=this,p=this.interaction.coords.velocity.client,m=kr(this.interaction),x=m.resistance,N=-Math.log(m.endSpeed/this.v0)/x;this.targetOffset={x:(p.x-N)/x,y:(p.y-N)/x},this.te=N,this.lambda_v0=x/this.v0,this.one_ve_v0=1-m.endSpeed/this.v0;var L=this.modification,q=this.modifierArg;q.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},L.result=L.setAll(q),L.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+L.result.delta.x,y:this.targetOffset.y+L.result.delta.y}),this.onNextFrame(function(){return l.inertiaTick()})}},{key:"startSmoothEnd",value:function(){var l=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame(function(){return l.smoothEndTick()})}},{key:"onNextFrame",value:function(l){var p=this;this.timeout=Rt.request(function(){p.active&&l()})}},{key:"inertiaTick",value:function(){var l,p,m,x,N,L,q,W=this,o=this.interaction,u=kr(o).resistance,g=(o._now()-this.t0)/1e3;if(g<this.te){var b,A=1-(Math.exp(-u*g)-this.lambda_v0)/this.one_ve_v0;this.isModified?(l=0,p=0,m=this.targetOffset.x,x=this.targetOffset.y,N=this.modifiedOffset.x,L=this.modifiedOffset.y,b={x:hr(q=A,l,m,N),y:hr(q,p,x,L)}):b={x:this.targetOffset.x*A,y:this.targetOffset.y*A};var M={x:b.x-this.currentOffset.x,y:b.y-this.currentOffset.y};this.currentOffset.x+=M.x,this.currentOffset.y+=M.y,o.offsetBy(M),o.move(),this.onNextFrame(function(){return W.inertiaTick()})}else o.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var l=this,p=this.interaction,m=p._now()-this.t0,x=kr(p).smoothEndDuration;if(m<x){var N={x:ka(m,0,this.targetOffset.x,x),y:ka(m,0,this.targetOffset.y,x)},L={x:N.x-this.currentOffset.x,y:N.y-this.currentOffset.y};this.currentOffset.x+=L.x,this.currentOffset.y+=L.y,p.offsetBy(L),p.move({skipModifiers:this.modifierCount}),this.onNextFrame(function(){return l.smoothEndTick()})}else p.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(l){var p=l.pointer,m=l.event,x=l.eventTarget,N=this.interaction;N.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),N.updatePointer(p,m,x,!0),N._doPhase({interaction:N,event:m,phase:"resume"}),Ve(N.coords.prev,N.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Rt.cancel(this.timeout)}}]),d}();function kr(d){var l=d.interactable,p=d.prepared;return l&&l.options&&p.name&&l.options[p.name].inertia}var Ii={id:"inertia",before:["modifiers","actions"],install:function(d){var l=d.defaults;d.usePlugin(Ht),d.usePlugin(Di),d.actions.phases.inertiastart=!0,d.actions.phases.resume=!0,l.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(d){var l=d.interaction;l.inertia=new An(l)},"interactions:before-action-end":function(d){var l=d.interaction,p=d.event;return(!l._interacting||l.simulation||!l.inertia.start(p))&&null},"interactions:down":function(d){var l=d.interaction,p=d.eventTarget,m=l.inertia;if(m.active)for(var x=p;S.element(x);){if(x===l.element){m.resume(d);break}x=ee(x)}},"interactions:stop":function(d){var l=d.interaction.inertia;l.active&&l.stop()},"interactions:before-action-resume":function(d){var l=d.interaction.modification;l.stop(d),l.start(d,d.interaction.coords.cur.page),l.applyToInteraction(d)},"interactions:before-action-inertiastart":function(d){return d.interaction.modification.setAndApply(d)},"interactions:action-resume":sn,"interactions:action-inertiastart":sn,"interactions:after-action-inertiastart":function(d){return d.interaction.modification.restoreInteractionCoords(d)},"interactions:after-action-resume":function(d){return d.interaction.modification.restoreInteractionCoords(d)}}};function hr(d,l,p,m){var x=1-d;return x*x*l+2*x*d*p+d*d*m}function ka(d,l,p,m){return-p*(d/=m)*(d-2)+l}var Jt=Ii;function Zn(d,l){for(var p=0;p<l.length;p++){var m=l[p];if(d.immediatePropagationStopped)break;m(d)}}var Mi=function(){function d(l){a(this,d),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=de({},l||{})}return c(d,[{key:"fire",value:function(l){var p,m=this.global;(p=this.types[l.type])&&Zn(l,p),!l.propagationStopped&&m&&(p=m[l.type])&&Zn(l,p)}},{key:"on",value:function(l,p){var m=pe(l,p);for(l in m)this.types[l]=ze(this.types[l]||[],m[l])}},{key:"off",value:function(l,p){var m=pe(l,p);for(l in m){var x=this.types[l];if(x&&x.length)for(var N=0,L=m[l];N<L.length;N++){var q=L[N],W=x.indexOf(q);W!==-1&&x.splice(W,1)}}}},{key:"getRect",value:function(l){return null}}]),d}(),Ni=function(){function d(l){a(this,d),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=l,at(this,l)}return c(d,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),d}();function fr(d){return S.object(d)?{capture:!!d.capture,passive:!!d.passive}:{capture:!!d,passive:!1}}function cn(d,l){return d===l||(typeof d=="boolean"?!!l.capture===d&&!l.passive:!!d.capture==!!l.capture&&!!d.passive==!!l.passive)}var Da={id:"events",install:function(d){var l,p=[],m={},x=[],N={add:L,remove:q,addDelegate:function(u,g,b,A,M){var $=fr(M);if(!m[b]){m[b]=[];for(var K=0;K<x.length;K++){var H=x[K];L(H,b,W),L(H,b,o,!0)}}var Q=m[b],te=At(Q,function(X){return X.selector===u&&X.context===g});te||(te={selector:u,context:g,listeners:[]},Q.push(te)),te.listeners.push({func:A,options:$})},removeDelegate:function(u,g,b,A,M){var $,K=fr(M),H=m[b],Q=!1;if(H)for($=H.length-1;$>=0;$--){var te=H[$];if(te.selector===u&&te.context===g){for(var X=te.listeners,re=X.length-1;re>=0;re--){var Z=X[re];if(Z.func===A&&cn(Z.options,K)){X.splice(re,1),X.length||(H.splice($,1),q(g,b,W),q(g,b,o,!0)),Q=!0;break}}if(Q)break}}},delegateListener:W,delegateUseCapture:o,delegatedEvents:m,documents:x,targets:p,supportsOptions:!1,supportsPassive:!1};function L(u,g,b,A){if(u.addEventListener){var M=fr(A),$=At(p,function(K){return K.eventTarget===u});$||($={eventTarget:u,events:{}},p.push($)),$.events[g]||($.events[g]=[]),At($.events[g],function(K){return K.func===b&&cn(K.options,M)})||(u.addEventListener(g,b,N.supportsOptions?M:M.capture),$.events[g].push({func:b,options:M}))}}function q(u,g,b,A){if(u.addEventListener&&u.removeEventListener){var M=bt(p,function(ie){return ie.eventTarget===u}),$=p[M];if($&&$.events)if(g!=="all"){var K=!1,H=$.events[g];if(H){if(b==="all"){for(var Q=H.length-1;Q>=0;Q--){var te=H[Q];q(u,g,te.func,te.options)}return}for(var X=fr(A),re=0;re<H.length;re++){var Z=H[re];if(Z.func===b&&cn(Z.options,X)){u.removeEventListener(g,b,N.supportsOptions?X:X.capture),H.splice(re,1),H.length===0&&(delete $.events[g],K=!0);break}}}K&&!Object.keys($.events).length&&p.splice(M,1)}else for(g in $.events)$.events.hasOwnProperty(g)&&q(u,g,"all")}}function W(u,g){for(var b=fr(g),A=new Ni(u),M=m[u.type],$=Jr(u)[0],K=$;S.element(K);){for(var H=0;H<M.length;H++){var Q=M[H],te=Q.selector,X=Q.context;if(ce(K,te)&&O(X,$)&&O(X,K)){var re=Q.listeners;A.currentTarget=K;for(var Z=0;Z<re.length;Z++){var ie=re[Z];cn(ie.options,b)&&ie.func(A)}}}K=ee(K)}}function o(u){return W(u,!0)}return(l=d.document)==null||l.createElement("div").addEventListener("test",null,{get capture(){return N.supportsOptions=!0},get passive(){return N.supportsPassive=!0}}),d.events=N,N}},Pi={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(d){for(var l=0,p=Pi.methodOrder;l<p.length;l++){var m=p[l],x=Pi[m](d);if(x)return x}return null},simulationResume:function(d){var l=d.pointerType,p=d.eventType,m=d.eventTarget,x=d.scope;if(!/down|start/i.test(p))return null;for(var N=0,L=x.interactions.list;N<L.length;N++){var q=L[N],W=m;if(q.simulation&&q.simulation.allowResume&&q.pointerType===l)for(;W;){if(W===q.element)return q;W=ee(W)}}return null},mouseOrPen:function(d){var l,p=d.pointerId,m=d.pointerType,x=d.eventType,N=d.scope;if(m!=="mouse"&&m!=="pen")return null;for(var L=0,q=N.interactions.list;L<q.length;L++){var W=q[L];if(W.pointerType===m){if(W.simulation&&!ln(W,p))continue;if(W.interacting())return W;l||(l=W)}}if(l)return l;for(var o=0,u=N.interactions.list;o<u.length;o++){var g=u[o];if(!(g.pointerType!==m||/down/i.test(x)&&g.simulation))return g}return null},hasPointer:function(d){for(var l=d.pointerId,p=0,m=d.scope.interactions.list;p<m.length;p++){var x=m[p];if(ln(x,l))return x}return null},idle:function(d){for(var l=d.pointerType,p=0,m=d.scope.interactions.list;p<m.length;p++){var x=m[p];if(x.pointers.length===1){var N=x.interactable;if(N&&(!N.options.gesture||!N.options.gesture.enabled))continue}else if(x.pointers.length>=2)continue;if(!x.interacting()&&l===x.pointerType)return x}return null}};function ln(d,l){return d.pointers.some(function(p){return p.id===l})}var Co=Pi,Oi=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function kn(d,l){return function(p){var m=l.interactions.list,x=or(p),N=Jr(p),L=N[0],q=N[1],W=[];if(/^touch/.test(p.type)){l.prevTouchTime=l.now();for(var o=0,u=p.changedTouches;o<u.length;o++){var g=u[o],b={pointer:g,pointerId:st(g),pointerType:x,eventType:p.type,eventTarget:L,curEventTarget:q,scope:l},A=Dn(b);W.push([b.pointer,b.eventTarget,b.curEventTarget,A])}}else{var M=!1;if(!Y.supportsPointerEvent&&/mouse/.test(p.type)){for(var $=0;$<m.length&&!M;$++)M=m[$].pointerType!=="mouse"&&m[$].pointerIsDown;M=M||l.now()-l.prevTouchTime<500||p.timeStamp===0}if(!M){var K={pointer:p,pointerId:st(p),pointerType:x,eventType:p.type,curEventTarget:q,eventTarget:L,scope:l},H=Dn(K);W.push([K.pointer,K.eventTarget,K.curEventTarget,H])}}for(var Q=0;Q<W.length;Q++){var te=W[Q],X=te[0],re=te[1],Z=te[2];te[3][d](X,p,re,Z)}}}function Dn(d){var l=d.pointerType,p=d.scope,m={interaction:Co.search(d),searchDetails:d};return p.fire("interactions:find",m),m.interaction||p.interactions.new({pointerType:l})}function Cn(d,l){var p=d.doc,m=d.scope,x=d.options,N=m.interactions.docEvents,L=m.events,q=L[l];for(var W in m.browser.isIOS&&!x.events&&(x.events={passive:!1}),L.delegatedEvents)q(p,W,L.delegateListener),q(p,W,L.delegateUseCapture,!0);for(var o=x&&x.events,u=0;u<N.length;u++){var g=N[u];q(p,g.type,g.listener,o)}}var Io={id:"core/interactions",install:function(d){for(var l={},p=0;p<Oi.length;p++){var m=Oi[p];l[m]=kn(m,d)}var x,N=Y.pEventTypes;function L(){for(var q=0,W=d.interactions.list;q<W.length;q++){var o=W[q];if(o.pointerIsDown&&o.pointerType==="touch"&&!o._interacting)for(var u=function(){var A=b[g];d.documents.some(function(M){return O(M.doc,A.downTarget)})||o.removePointer(A.pointer,A.event)},g=0,b=o.pointers;g<b.length;g++)u()}}(x=ye.PointerEvent?[{type:N.down,listener:L},{type:N.down,listener:l.pointerDown},{type:N.move,listener:l.pointerMove},{type:N.up,listener:l.pointerUp},{type:N.cancel,listener:l.pointerUp}]:[{type:"mousedown",listener:l.pointerDown},{type:"mousemove",listener:l.pointerMove},{type:"mouseup",listener:l.pointerUp},{type:"touchstart",listener:L},{type:"touchstart",listener:l.pointerDown},{type:"touchmove",listener:l.pointerMove},{type:"touchend",listener:l.pointerUp},{type:"touchcancel",listener:l.pointerUp}]).push({type:"blur",listener:function(q){for(var W=0,o=d.interactions.list;W<o.length;W++)o[W].documentBlur(q)}}),d.prevTouchTime=0,d.Interaction=function(q){h(o,q);var W=E(o);function o(){return a(this,o),W.apply(this,arguments)}return c(o,[{key:"pointerMoveTolerance",get:function(){return d.interactions.pointerMoveTolerance},set:function(u){d.interactions.pointerMoveTolerance=u}},{key:"_now",value:function(){return d.now()}}]),o}(un),d.interactions={list:[],new:function(q){q.scopeFire=function(o,u){return d.fire(o,u)};var W=new d.Interaction(q);return d.interactions.list.push(W),W},listeners:l,docEvents:x,pointerMoveTolerance:1},d.usePlugin(Br)},listeners:{"scope:add-document":function(d){return Cn(d,"add")},"scope:remove-document":function(d){return Cn(d,"remove")},"interactable:unset":function(d,l){for(var p=d.interactable,m=l.interactions.list.length-1;m>=0;m--){var x=l.interactions.list[m];x.interactable===p&&(x.stop(),l.fire("interactions:destroy",{interaction:x}),x.destroy(),l.interactions.list.length>2&&l.interactions.list.splice(m,1))}}},onDocSignal:Cn,doOnInteractions:kn,methodNames:Oi},Mo=Io,Dr=function(d){return d[d.On=0]="On",d[d.Off=1]="Off",d}(Dr||{}),Ti=function(){function d(l,p,m,x){a(this,d),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new Mi,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=p.actions,this.target=l,this._context=p.context||m,this._win=_(Fe(l)?this._context:l),this._doc=this._win.document,this._scopeEvents=x,this.set(p)}return c(d,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(l,p){return S.func(p.onstart)&&this.on("".concat(l,"start"),p.onstart),S.func(p.onmove)&&this.on("".concat(l,"move"),p.onmove),S.func(p.onend)&&this.on("".concat(l,"end"),p.onend),S.func(p.oninertiastart)&&this.on("".concat(l,"inertiastart"),p.oninertiastart),this}},{key:"updatePerActionListeners",value:function(l,p,m){var x,N=this,L=(x=this._actions.map[l])==null?void 0:x.filterEventType,q=function(W){return(L==null||L(W))&&an(W,N._actions)};(S.array(p)||S.object(p))&&this._onOff(Dr.Off,l,p,void 0,q),(S.array(m)||S.object(m))&&this._onOff(Dr.On,l,m,void 0,q)}},{key:"setPerAction",value:function(l,p){var m=this._defaults;for(var x in p){var N=x,L=this.options[l],q=p[N];N==="listeners"&&this.updatePerActionListeners(l,L.listeners,q),S.array(q)?L[N]=xr(q):S.plainObject(q)?(L[N]=de(L[N]||{},Ar(q)),S.object(m.perAction[N])&&"enabled"in m.perAction[N]&&(L[N].enabled=q.enabled!==!1)):S.bool(q)&&S.object(m.perAction[N])?L[N].enabled=q:L[N]=q}}},{key:"getRect",value:function(l){return l=l||(S.element(this.target)?this.target:null),S.string(this.target)&&(l=l||this._context.querySelector(this.target)),Me(l)}},{key:"rectChecker",value:function(l){var p=this;return S.func(l)?(this.getRect=function(m){var x=de({},l.apply(p,m));return"width"in x||(x.width=x.right-x.left,x.height=x.bottom-x.top),x},this):l===null?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(l,p){if(Fe(p)||S.object(p)){for(var m in this.options[l]=p,this._actions.map)this.options[m][l]=p;return this}return this.options[l]}},{key:"origin",value:function(l){return this._backCompatOption("origin",l)}},{key:"deltaSource",value:function(l){return l==="page"||l==="client"?(this.options.deltaSource=l,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var l=this.target;return S.string(l)?Array.from(this._context.querySelectorAll(l)):S.func(l)&&l.getAllElements?l.getAllElements():S.element(l)?[l]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(l){return this._context===l.ownerDocument||O(this._context,l)}},{key:"testIgnoreAllow",value:function(l,p,m){return!this.testIgnore(l.ignoreFrom,p,m)&&this.testAllow(l.allowFrom,p,m)}},{key:"testAllow",value:function(l,p,m){return!l||!!S.element(m)&&(S.string(l)?se(m,l,p):!!S.element(l)&&O(l,m))}},{key:"testIgnore",value:function(l,p,m){return!(!l||!S.element(m))&&(S.string(l)?se(m,l,p):!!S.element(l)&&O(l,m))}},{key:"fire",value:function(l){return this.events.fire(l),this}},{key:"_onOff",value:function(l,p,m,x,N){S.object(p)&&!S.array(p)&&(x=m,m=null);var L=pe(p,m,N);for(var q in L){q==="wheel"&&(q=Y.wheelEvent);for(var W=0,o=L[q];W<o.length;W++){var u=o[W];an(q,this._actions)?this.events[l===Dr.On?"on":"off"](q,u):S.string(this.target)?this._scopeEvents[l===Dr.On?"addDelegate":"removeDelegate"](this.target,this._context,q,u,x):this._scopeEvents[l===Dr.On?"add":"remove"](this.target,q,u,x)}}return this}},{key:"on",value:function(l,p,m){return this._onOff(Dr.On,l,p,m)}},{key:"off",value:function(l,p,m){return this._onOff(Dr.Off,l,p,m)}},{key:"set",value:function(l){var p=this._defaults;for(var m in S.object(l)||(l={}),this.options=Ar(p.base),this._actions.methodDict){var x=m,N=this._actions.methodDict[x];this.options[x]={},this.setPerAction(x,de(de({},p.perAction),p.actions[x])),this[N](l[x])}for(var L in l)L!=="getRect"?S.func(this[L])&&this[L](l[L]):this.rectChecker(l.getRect);return this}},{key:"unset",value:function(){if(S.string(this.target))for(var l in this._scopeEvents.delegatedEvents)for(var p=this._scopeEvents.delegatedEvents[l],m=p.length-1;m>=0;m--){var x=p[m],N=x.selector,L=x.context,q=x.listeners;N===this.target&&L===this._context&&p.splice(m,1);for(var W=q.length-1;W>=0;W--)this._scopeEvents.removeDelegate(this.target,this._context,l,q[W][0],q[W][1])}else this._scopeEvents.remove(this.target,"all")}}]),d}(),Ri=function(){function d(l){var p=this;a(this,d),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=l,l.addListeners({"interactable:unset":function(m){var x=m.interactable,N=x.target,L=S.string(N)?p.selectorMap[N]:N[p.scope.id],q=bt(L,function(W){return W===x});L.splice(q,1)}})}return c(d,[{key:"new",value:function(l,p){p=de(p||{},{actions:this.scope.actions});var m=new this.scope.Interactable(l,p,this.scope.document,this.scope.events);return this.scope.addDocument(m._doc),this.list.push(m),S.string(l)?(this.selectorMap[l]||(this.selectorMap[l]=[]),this.selectorMap[l].push(m)):(m.target[this.scope.id]||Object.defineProperty(l,this.scope.id,{value:[],configurable:!0}),l[this.scope.id].push(m)),this.scope.fire("interactable:new",{target:l,options:p,interactable:m,win:this.scope._win}),m}},{key:"getExisting",value:function(l,p){var m=p&&p.context||this.scope.document,x=S.string(l),N=x?this.selectorMap[l]:l[this.scope.id];if(N)return At(N,function(L){return L._context===m&&(x||L.inContext(l))})}},{key:"forEachMatch",value:function(l,p){for(var m=0,x=this.list;m<x.length;m++){var N=x[m],L=void 0;if((S.string(N.target)?S.element(l)&&ce(l,N.target):l===N.target)&&N.inContext(l)&&(L=p(N)),L!==void 0)return L}}}]),d}(),Ca=function(){function d(){var l=this;a(this,d),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=Y,this.defaults=Ar(_a),this.Eventable=Mi,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(m){var x=function N(L,q){var W=m.interactables.getExisting(L,q);return W||((W=m.interactables.new(L,q)).events.global=N.globalEvents),W};return x.getPointerAverage=rt,x.getTouchBBox=St,x.getTouchDistance=mt,x.getTouchAngle=Ot,x.getElementRect=Me,x.getElementClientRect=_e,x.matchesSelector=ce,x.closest=J,x.globalEvents={},x.version="1.10.27",x.scope=m,x.use=function(N,L){return this.scope.usePlugin(N,L),this},x.isSet=function(N,L){return!!this.scope.interactables.get(N,L&&L.context)},x.on=Kt(function(N,L,q){if(S.string(N)&&N.search(" ")!==-1&&(N=N.trim().split(/ +/)),S.array(N)){for(var W=0,o=N;W<o.length;W++){var u=o[W];this.on(u,L,q)}return this}if(S.object(N)){for(var g in N)this.on(g,N[g],L);return this}return an(N,this.scope.actions)?this.globalEvents[N]?this.globalEvents[N].push(L):this.globalEvents[N]=[L]:this.scope.events.add(this.scope.document,N,L,{options:q}),this},"The interact.on() method is being deprecated"),x.off=Kt(function(N,L,q){if(S.string(N)&&N.search(" ")!==-1&&(N=N.trim().split(/ +/)),S.array(N)){for(var W=0,o=N;W<o.length;W++){var u=o[W];this.off(u,L,q)}return this}if(S.object(N)){for(var g in N)this.off(g,N[g],L);return this}var b;return an(N,this.scope.actions)?N in this.globalEvents&&(b=this.globalEvents[N].indexOf(L))!==-1&&this.globalEvents[N].splice(b,1):this.scope.events.remove(this.scope.document,N,L,q),this},"The interact.off() method is being deprecated"),x.debug=function(){return this.scope},x.supportsTouch=function(){return Y.supportsTouch},x.supportsPointerEvent=function(){return Y.supportsPointerEvent},x.stop=function(){for(var N=0,L=this.scope.interactions.list;N<L.length;N++)L[N].stop();return this},x.pointerMoveTolerance=function(N){return S.number(N)?(this.scope.interactions.pointerMoveTolerance=N,this):this.scope.interactions.pointerMoveTolerance},x.addDocument=function(N,L){this.scope.addDocument(N,L)},x.removeDocument=function(N){this.scope.removeDocument(N)},x}(this),this.InteractEvent=Xe,this.Interactable=void 0,this.interactables=new Ri(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(m){return l.removeDocument(m.target)};var p=this;this.Interactable=function(m){h(N,m);var x=E(N);function N(){return a(this,N),x.apply(this,arguments)}return c(N,[{key:"_defaults",get:function(){return p.defaults}},{key:"set",value:function(L){return D(y(N.prototype),"set",this).call(this,L),p.fire("interactable:set",{options:L,interactable:this}),this}},{key:"unset",value:function(){D(y(N.prototype),"unset",this).call(this);var L=p.interactables.list.indexOf(this);L<0||(p.interactables.list.splice(L,1),p.fire("interactable:unset",{interactable:this}))}}]),N}(Ti)}return c(d,[{key:"addListeners",value:function(l,p){this.listenerMaps.push({id:p,map:l})}},{key:"fire",value:function(l,p){for(var m=0,x=this.listenerMaps;m<x.length;m++){var N=x[m].map[l];if(N&&N(p,this,l)===!1)return!1}}},{key:"init",value:function(l){return this.isInitialized?this:function(p,m){return p.isInitialized=!0,S.window(m)&&R(m),ye.init(m),Y.init(m),Rt.init(m),p.window=m,p.document=m.document,p.usePlugin(Mo),p.usePlugin(Da),p}(this,l)}},{key:"pluginIsInstalled",value:function(l){var p=l.id;return p?!!this._plugins.map[p]:this._plugins.list.indexOf(l)!==-1}},{key:"usePlugin",value:function(l,p){if(!this.isInitialized)return this;if(this.pluginIsInstalled(l))return this;if(l.id&&(this._plugins.map[l.id]=l),this._plugins.list.push(l),l.install&&l.install(this,p),l.listeners&&l.before){for(var m=0,x=this.listenerMaps.length,N=l.before.reduce(function(q,W){return q[W]=!0,q[In(W)]=!0,q},{});m<x;m++){var L=this.listenerMaps[m].id;if(L&&(N[L]||N[In(L)]))break}this.listenerMaps.splice(m,0,{id:l.id,map:l.listeners})}else l.listeners&&this.listenerMaps.push({id:l.id,map:l.listeners});return this}},{key:"addDocument",value:function(l,p){if(this.getDocIndex(l)!==-1)return!1;var m=_(l);p=p?de({},p):{},this.documents.push({doc:l,options:p}),this.events.documents.push(l),l!==this.document&&this.events.add(m,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:l,window:m,scope:this,options:p})}},{key:"removeDocument",value:function(l){var p=this.getDocIndex(l),m=_(l),x=this.documents[p].options;this.events.remove(m,"unload",this.onWindowUnload),this.documents.splice(p,1),this.events.documents.splice(p,1),this.fire("scope:remove-document",{doc:l,window:m,scope:this,options:x})}},{key:"getDocIndex",value:function(l){for(var p=0;p<this.documents.length;p++)if(this.documents[p].doc===l)return p;return-1}},{key:"getDocOptions",value:function(l){var p=this.getDocIndex(l);return p===-1?null:this.documents[p].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),d}();function In(d){return d&&d.replace(/\/.*$/,"")}var Mn=new Ca,dt=Mn.interactStatic,Ia=typeof globalThis<"u"?globalThis:window;Mn.init(Ia);var No=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(d){var l=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter(function(m){var x=m[0],N=m[1];return x in d||N in d}),p=function(m,x){for(var N=d.range,L=d.limits,q=L===void 0?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:L,W=d.offset,o=W===void 0?{x:0,y:0}:W,u={range:N,grid:d,x:null,y:null},g=0;g<l.length;g++){var b=l[g],A=b[0],M=b[1],$=Math.round((m-o.x)/d[A]),K=Math.round((x-o.y)/d[M]);u[A]=Math.max(q.left,Math.min(q.right,$*d[A]+o.x)),u[M]=Math.max(q.top,Math.min(q.bottom,K*d[M]+o.y))}return u};return p.grid=d,p.coordFields=l,p}}),Jn={id:"snappers",install:function(d){var l=d.interactStatic;l.snappers=de(l.snappers||{},No),l.createSnapGrid=l.snappers.grid}},Li=Jn,zi={start:function(d){var l=d.state,p=d.rect,m=d.edges,x=d.pageCoords,N=l.options,L=N.ratio,q=N.enabled,W=l.options,o=W.equalDelta,u=W.modifiers;L==="preserve"&&(L=p.width/p.height),l.startCoords=de({},x),l.startRect=de({},p),l.ratio=L,l.equalDelta=o;var g=l.linkedEdges={top:m.top||m.left&&!m.bottom,left:m.left||m.top&&!m.right,bottom:m.bottom||m.right&&!m.top,right:m.right||m.bottom&&!m.left};if(l.xIsPrimaryAxis=!(!m.left&&!m.right),l.equalDelta){var b=(g.left?1:-1)*(g.top?1:-1);l.edgeSign={x:b,y:b}}else l.edgeSign={x:g.left?-1:1,y:g.top?-1:1};if(q!==!1&&de(m,g),u!=null&&u.length){var A=new on(d.interaction);A.copyFrom(d.interaction.modification),A.prepareStates(u),l.subModification=A,A.startAll(r({},d))}},set:function(d){var l=d.state,p=d.rect,m=d.coords,x=l.linkedEdges,N=de({},m),L=l.equalDelta?$i:Gi;if(de(d.edges,x),L(l,l.xIsPrimaryAxis,m,p),!l.subModification)return null;var q=de({},p);Le(x,q,{x:m.x-N.x,y:m.y-N.y});var W=l.subModification.setAll(r(r({},d),{},{rect:q,edges:x,pageCoords:m,prevCoords:m,prevRect:q})),o=W.delta;return W.changed&&(L(l,Math.abs(o.x)>Math.abs(o.y),W.coords,W.rect),de(m,W.coords)),W.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function $i(d,l,p){var m=d.startCoords,x=d.edgeSign;l?p.y=m.y+(p.x-m.x)*x.y:p.x=m.x+(p.y-m.y)*x.x}function Gi(d,l,p,m){var x=d.startRect,N=d.startCoords,L=d.ratio,q=d.edgeSign;if(l){var W=m.width/L;p.y=N.y+(W-x.height)*q.y}else{var o=m.height*L;p.x=N.x+(o-x.width)*q.x}}var yt=Wt(zi,"aspectRatio"),dn=function(){};dn._defaults={};var Cr=dn;function Ir(d,l,p){return S.func(d)?Re(d,l.interactable,l.element,[p.x,p.y,l]):Re(d,l.interactable,l.element)}var Ur={start:function(d){var l=d.rect,p=d.startOffset,m=d.state,x=d.interaction,N=d.pageCoords,L=m.options,q=L.elementRect,W=de({left:0,top:0,right:0,bottom:0},L.offset||{});if(l&&q){var o=Ir(L.restriction,x,N);if(o){var u=o.right-o.left-l.width,g=o.bottom-o.top-l.height;u<0&&(W.left+=u,W.right+=u),g<0&&(W.top+=g,W.bottom+=g)}W.left+=p.left-l.width*q.left,W.top+=p.top-l.height*q.top,W.right+=p.right-l.width*(1-q.right),W.bottom+=p.bottom-l.height*(1-q.bottom)}m.offset=W},set:function(d){var l=d.coords,p=d.interaction,m=d.state,x=m.options,N=m.offset,L=Ir(x.restriction,p,l);if(L){var q=function(W){return!W||"left"in W&&"top"in W||((W=de({},W)).left=W.x||0,W.top=W.y||0,W.right=W.right||W.left+W.width,W.bottom=W.bottom||W.top+W.height),W}(L);l.x=Math.max(Math.min(q.right-N.right,l.x),q.left+N.left),l.y=Math.max(Math.min(q.bottom-N.bottom,l.y),q.top+N.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},Ma=Wt(Ur,"restrict"),qi={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Nn={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function ei(d,l){for(var p=0,m=["top","left","bottom","right"];p<m.length;p++){var x=m[p];x in d||(d[x]=l[x])}return d}var Yt={noInner:qi,noOuter:Nn,start:function(d){var l,p=d.interaction,m=d.startOffset,x=d.state,N=x.options;N&&(l=ke(Ir(N.offset,p,p.coords.start.page))),l=l||{x:0,y:0},x.offset={top:l.y+m.top,left:l.x+m.left,bottom:l.y-m.bottom,right:l.x-m.right}},set:function(d){var l=d.coords,p=d.edges,m=d.interaction,x=d.state,N=x.offset,L=x.options;if(p){var q=de({},l),W=Ir(L.inner,m,q)||{},o=Ir(L.outer,m,q)||{};ei(W,qi),ei(o,Nn),p.top?l.y=Math.min(Math.max(o.top+N.top,q.y),W.top+N.top):p.bottom&&(l.y=Math.max(Math.min(o.bottom+N.bottom,q.y),W.bottom+N.bottom)),p.left?l.x=Math.min(Math.max(o.left+N.left,q.x),W.left+N.left):p.right&&(l.x=Math.max(Math.min(o.right+N.right,q.x),W.right+N.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},Fi=Wt(Yt,"restrictEdges"),ji=de({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(d){}},Ur.defaults),ti=Wt({start:Ur.start,set:Ur.set,defaults:ji},"restrictRect"),Bi={width:-1/0,height:-1/0},Na={width:1/0,height:1/0},Po=Wt({start:function(d){return Yt.start(d)},set:function(d){var l=d.interaction,p=d.state,m=d.rect,x=d.edges,N=p.options;if(x){var L=Ke(Ir(N.min,l,d.coords))||Bi,q=Ke(Ir(N.max,l,d.coords))||Na;p.options={endOnly:N.endOnly,inner:de({},Yt.noInner),outer:de({},Yt.noOuter)},x.top?(p.options.inner.top=m.bottom-L.height,p.options.outer.top=m.bottom-q.height):x.bottom&&(p.options.inner.bottom=m.top+L.height,p.options.outer.bottom=m.top+q.height),x.left?(p.options.inner.left=m.right-L.width,p.options.outer.left=m.right-q.width):x.right&&(p.options.inner.right=m.left+L.width,p.options.outer.right=m.left+q.width),Yt.set(d),p.options=N}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Pn={start:function(d){var l,p=d.interaction,m=d.interactable,x=d.element,N=d.rect,L=d.state,q=d.startOffset,W=L.options,o=W.offsetWithOrigin?function(b){var A=b.interaction.element,M=ke(Re(b.state.options.origin,null,null,[A])),$=M||Ee(b.interactable,A,b.interaction.prepared.name);return $}(d):{x:0,y:0};if(W.offset==="startCoords")l={x:p.coords.start.page.x,y:p.coords.start.page.y};else{var u=Re(W.offset,m,x,[p]);(l=ke(u)||{x:0,y:0}).x+=o.x,l.y+=o.y}var g=W.relativePoints;L.offsets=N&&g&&g.length?g.map(function(b,A){return{index:A,relativePoint:b,x:q.left-N.width*b.x+l.x,y:q.top-N.height*b.y+l.y}}):[{index:0,relativePoint:null,x:l.x,y:l.y}]},set:function(d){var l=d.interaction,p=d.coords,m=d.state,x=m.options,N=m.offsets,L=Ee(l.interactable,l.element,l.prepared.name),q=de({},p),W=[];x.offsetWithOrigin||(q.x-=L.x,q.y-=L.y);for(var o=0,u=N;o<u.length;o++)for(var g=u[o],b=q.x-g.x,A=q.y-g.y,M=0,$=x.targets.length;M<$;M++){var K=x.targets[M],H=void 0;(H=S.func(K)?K(b,A,l._proxy,g,M):K)&&W.push({x:(S.number(H.x)?H.x:b)+g.x,y:(S.number(H.y)?H.y:A)+g.y,range:S.number(H.range)?H.range:x.range,source:K,index:M,offset:g})}for(var Q={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},te=0;te<W.length;te++){var X=W[te],re=X.range,Z=X.x-q.x,ie=X.y-q.y,ae=it(Z,ie),ne=ae<=re;re===1/0&&Q.inRange&&Q.range!==1/0&&(ne=!1),Q.target&&!(ne?Q.inRange&&re!==1/0?ae/re<Q.distance/Q.range:re===1/0&&Q.range!==1/0||ae<Q.distance:!Q.inRange&&ae<Q.distance)||(Q.target=X,Q.distance=ae,Q.range=re,Q.inRange=ne,Q.delta.x=Z,Q.delta.y=ie)}return Q.inRange&&(p.x=Q.target.x,p.y=Q.target.y),m.closest=Q,Q},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},ri=Wt(Pn,"snap"),ni={start:function(d){var l=d.state,p=d.edges,m=l.options;if(!p)return null;d.state={options:{targets:null,relativePoints:[{x:p.left?0:1,y:p.top?0:1}],offset:m.offset||"self",origin:{x:0,y:0},range:m.range}},l.targetFields=l.targetFields||[["width","height"],["x","y"]],Pn.start(d),l.offsets=d.state.offsets,d.state=l},set:function(d){var l=d.interaction,p=d.state,m=d.coords,x=p.options,N=p.offsets,L={x:m.x-N[0].x,y:m.y-N[0].y};p.options=de({},x),p.options.targets=[];for(var q=0,W=x.targets||[];q<W.length;q++){var o=W[q],u=void 0;if(u=S.func(o)?o(L.x,L.y,l):o){for(var g=0,b=p.targetFields;g<b.length;g++){var A=b[g],M=A[0],$=A[1];if(M in u||$ in u){u.x=u[M],u.y=u[$];break}}p.options.targets.push(u)}}var K=Pn.set(d);return p.options=x,K},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},Ui=Wt(ni,"snapSize"),On={aspectRatio:yt,restrictEdges:Fi,restrict:Ma,restrictRect:ti,restrictSize:Po,snapEdges:Wt({start:function(d){var l=d.edges;return l?(d.state.targetFields=d.state.targetFields||[[l.left?"left":"right",l.top?"top":"bottom"]],ni.start(d)):null},set:ni.set,defaults:de(Ar(ni.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:ri,snapSize:Ui,spring:Cr,avoid:Cr,transform:Cr,rubberband:Cr},Oo={id:"modifiers",install:function(d){var l=d.interactStatic;for(var p in d.usePlugin(Di),d.usePlugin(Li),l.modifiers=On,On){var m=On[p],x=m._defaults,N=m._methods;x._methods=N,d.defaults.perAction[p]=x}}},Pa=Oo,Oa=function(d){h(p,d);var l=E(p);function p(m,x,N,L,q,W){var o;if(a(this,p),at(w(o=l.call(this,q)),N),N!==x&&at(w(o),x),o.timeStamp=W,o.originalEvent=N,o.type=m,o.pointerId=st(x),o.pointerType=or(x),o.target=L,o.currentTarget=null,m==="tap"){var u=q.getPointerIndex(x);o.dt=o.timeStamp-q.pointers[u].downTime;var g=o.timeStamp-q.tapTime;o.double=!!q.prevTap&&q.prevTap.type!=="doubletap"&&q.prevTap.target===o.target&&g<500}else m==="doubletap"&&(o.dt=x.timeStamp-q.tapTime,o.double=!0);return o}return c(p,[{key:"_subtractOrigin",value:function(m){var x=m.x,N=m.y;return this.pageX-=x,this.pageY-=N,this.clientX-=x,this.clientY-=N,this}},{key:"_addOrigin",value:function(m){var x=m.x,N=m.y;return this.pageX+=x,this.pageY+=N,this.clientX+=x,this.clientY+=N,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),p}(Tt),hn={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(d){d.pointerEvents=hn,d.defaults.actions.pointerEvents=hn.defaults,de(d.actions.phaselessTypes,hn.types)},listeners:{"interactions:new":function(d){var l=d.interaction;l.prevTap=null,l.tapTime=0},"interactions:update-pointer":function(d){var l=d.down,p=d.pointerInfo;!l&&p.hold||(p.hold={duration:1/0,timeout:null})},"interactions:move":function(d,l){var p=d.interaction,m=d.pointer,x=d.event,N=d.eventTarget;d.duplicate||p.pointerIsDown&&!p.pointerWasMoved||(p.pointerIsDown&&ii(d),pr({interaction:p,pointer:m,event:x,eventTarget:N,type:"move"},l))},"interactions:down":function(d,l){(function(p,m){for(var x=p.interaction,N=p.pointer,L=p.event,q=p.eventTarget,W=p.pointerIndex,o=x.pointers[W].hold,u=Oe(q),g={interaction:x,pointer:N,event:L,eventTarget:q,type:"hold",targets:[],path:u,node:null},b=0;b<u.length;b++){var A=u[b];g.node=A,m.fire("pointerEvents:collect-targets",g)}if(g.targets.length){for(var M=1/0,$=0,K=g.targets;$<K.length;$++){var H=K[$].eventable.options.holdDuration;H<M&&(M=H)}o.duration=M,o.timeout=setTimeout(function(){pr({interaction:x,eventTarget:q,pointer:N,event:L,type:"hold"},m)},M)}})(d,l),pr(d,l)},"interactions:up":function(d,l){ii(d),pr(d,l),function(p,m){var x=p.interaction,N=p.pointer,L=p.event,q=p.eventTarget;x.pointerWasMoved||pr({interaction:x,eventTarget:q,pointer:N,event:L,type:"tap"},m)}(d,l)},"interactions:cancel":function(d,l){ii(d),pr(d,l)}},PointerEvent:Oa,fire:pr,collectEventTargets:Ta,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function pr(d,l){var p=d.interaction,m=d.pointer,x=d.event,N=d.eventTarget,L=d.type,q=d.targets,W=q===void 0?Ta(d,l):q,o=new Oa(L,m,x,N,p,l.now());l.fire("pointerEvents:new",{pointerEvent:o});for(var u={interaction:p,pointer:m,event:x,eventTarget:N,targets:W,type:L,pointerEvent:o},g=0;g<W.length;g++){var b=W[g];for(var A in b.props||{})o[A]=b.props[A];var M=Ee(b.eventable,b.node);if(o._subtractOrigin(M),o.eventable=b.eventable,o.currentTarget=b.node,b.eventable.fire(o),o._addOrigin(M),o.immediatePropagationStopped||o.propagationStopped&&g+1<W.length&&W[g+1].node!==o.currentTarget)break}if(l.fire("pointerEvents:fired",u),L==="tap"){var $=o.double?pr({interaction:p,pointer:m,event:x,eventTarget:N,type:"doubletap"},l):o;p.prevTap=$,p.tapTime=$.timeStamp}return o}function Ta(d,l){var p=d.interaction,m=d.pointer,x=d.event,N=d.eventTarget,L=d.type,q=p.getPointerIndex(m),W=p.pointers[q];if(L==="tap"&&(p.pointerWasMoved||!W||W.downTarget!==N))return[];for(var o=Oe(N),u={interaction:p,pointer:m,event:x,eventTarget:N,type:L,path:o,targets:[],node:null},g=0;g<o.length;g++){var b=o[g];u.node=b,l.fire("pointerEvents:collect-targets",u)}return L==="hold"&&(u.targets=u.targets.filter(function(A){var M,$;return A.eventable.options.holdDuration===((M=p.pointers[q])==null||($=M.hold)==null?void 0:$.duration)})),u.targets}function ii(d){var l=d.interaction,p=d.pointerIndex,m=l.pointers[p].hold;m&&m.timeout&&(clearTimeout(m.timeout),m.timeout=null)}var Ki=Object.freeze({__proto__:null,default:hn});function Ra(d){var l=d.interaction;l.holdIntervalHandle&&(clearInterval(l.holdIntervalHandle),l.holdIntervalHandle=null)}var La={id:"pointer-events/holdRepeat",install:function(d){d.usePlugin(hn);var l=d.pointerEvents;l.defaults.holdRepeatInterval=0,l.types.holdrepeat=d.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce(function(d,l){return d["pointerEvents:".concat(l)]=Ra,d},{"pointerEvents:new":function(d){var l=d.pointerEvent;l.type==="hold"&&(l.count=(l.count||0)+1)},"pointerEvents:fired":function(d,l){var p=d.interaction,m=d.pointerEvent,x=d.eventTarget,N=d.targets;if(m.type==="hold"&&N.length){var L=N[0].eventable.options.holdRepeatInterval;L<=0||(p.holdIntervalHandle=setTimeout(function(){l.pointerEvents.fire({interaction:p,eventTarget:x,type:"hold",pointer:m,event:m},l)},L))}}})},To=La,Ro={id:"pointer-events/interactableTargets",install:function(d){var l=d.Interactable;l.prototype.pointerEvents=function(m){return de(this.events.options,m),this};var p=l.prototype._backCompatOption;l.prototype._backCompatOption=function(m,x){var N=p.call(this,m,x);return N===this&&(this.events.options[m]=x),N}},listeners:{"pointerEvents:collect-targets":function(d,l){var p=d.targets,m=d.node,x=d.type,N=d.eventTarget;l.interactables.forEachMatch(m,function(L){var q=L.events,W=q.options;q.types[x]&&q.types[x].length&&L.testIgnoreAllow(W,m,N)&&p.push({node:m,eventable:q,props:{interactable:L}})})},"interactable:new":function(d){var l=d.interactable;l.events.getRect=function(p){return l.getRect(p)}},"interactable:set":function(d,l){var p=d.interactable,m=d.options;de(p.events.options,l.pointerEvents.defaults),de(p.events.options,m.pointerEvents||{})}}},Lo=Ro,ai={id:"pointer-events",install:function(d){d.usePlugin(Ki),d.usePlugin(To),d.usePlugin(Lo)}},gr=ai,tt={id:"reflow",install:function(d){var l=d.Interactable;d.actions.phases.reflow=!0,l.prototype.reflow=function(p){return function(m,x,N){for(var L=m.getAllElements(),q=N.window.Promise,W=q?[]:null,o=function(){var g=L[u],b=m.getRect(g);if(!b)return 1;var A,M=At(N.interactions.list,function(H){return H.interacting()&&H.interactable===m&&H.element===g&&H.prepared.name===x.name});if(M)M.move(),W&&(A=M._reflowPromise||new q(function(H){M._reflowResolve=H}));else{var $=Ke(b),K=function(H){return{coords:H,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:$.x,y:$.y},client:{x:$.x,y:$.y},timeStamp:N.now()});A=function(H,Q,te,X,re){var Z=H.interactions.new({pointerType:"reflow"}),ie={interaction:Z,event:re,pointer:re,eventTarget:te,phase:"reflow"};Z.interactable=Q,Z.element=te,Z.prevEvent=re,Z.updatePointer(re,re,te,!0),ht(Z.coords.delta),Wn(Z.prepared,X),Z._doPhase(ie);var ae=H.window,ne=ae.Promise,ue=ne?new ne(function(he){Z._reflowResolve=he}):void 0;return Z._reflowPromise=ue,Z.start(X,Q,te),Z._interacting?(Z.move(ie),Z.end(re)):(Z.stop(),Z._reflowResolve()),Z.removePointer(re,re),ue}(N,m,g,x,K)}W&&W.push(A)},u=0;u<L.length&&!o();u++);return W&&q.all(W).then(function(){return m})}(this,p,d)}},listeners:{"interactions:stop":function(d,l){var p=d.interaction;p.pointerType==="reflow"&&(p._reflowResolve&&p._reflowResolve(),function(m,x){m.splice(m.indexOf(x),1)}(l.interactions.list,p))}}},oi=tt;if(dt.use(Br),dt.use(Ht),dt.use(gr),dt.use(Jt),dt.use(Pa),dt.use(Ze),dt.use(ko),dt.use(ba),dt.use(oi),dt.default=dt,i(n)==="object"&&n)try{n.exports=dt}catch{}return dt.default=dt,dt})}(ia,ia.exports)),ia.exports}var s1=o1();const u1=Pt(s1),rr=document;class c1{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.metric=new kf(e),this.panels={info:rr.getElementById("floating-panel"),tools:rr.getElementById("tools-panel"),graphs:rr.getElementById("graphs-panel"),faces:rr.getElementById("face-panel")},this.handles={info:"#info",tools:"#tools",graphs:"#graphs",faces:"#faces"},this.addEventListeners(),this.makePanelsDraggable(),this.registerToolListeners(),this.setupContextMenu()}init(){this.togglePanel("info","#panel-btn .check",this.settings.info_panel),this.togglePanel("tools","#tools-btn .check",this.settings.tools_panel),this.togglePanel("graphs","#graphs-btn .check",this.settings.graphs_panel),this.togglePanel("faces","#faces-btn .check",this.settings.face_panel)}setupContextMenu(){const e=rr.getElementById("custom-context-menu");rr.addEventListener("contextmenu",t=>{t.preventDefault();const{offsetWidth:r,offsetHeight:i}=e,{innerWidth:a,innerHeight:s}=window;let{pageX:c,pageY:f}=t;c+r>a&&(c-=r),f+i>s&&(f-=i),Object.assign(e.style,{left:`${c}px`,top:`${f}px`,display:"block"})}),rr.addEventListener("click",()=>{e.style.display="none"})}togglePanel(e,t,r){const i=this.panels[e],a=rr.querySelector(t);a==null||a.classList.toggle("hidden",!r),i&&(i.style.display=r?"flex":"none",r||this.resetPanel(i))}resetPanel(e){e.style.transform="translate(0px, 0px)",e.setAttribute("data-x",0),e.setAttribute("data-y",0)}addEventListeners(){const e=(r,i)=>{var a;(a=rr.querySelector(r))==null||a.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:i})})};e("#floating-panel .close","info_panel"),e("#tools-panel .close","tools_panel"),e("#graphs-panel .close","graphs_panel"),e("#face-panel .close","face_panel");const t=rr.querySelector("#floating-panel .max");t==null||t.addEventListener("click",()=>{var r;this.resetPanel(this.panels.info),(r=rr.getElementById("floating-panel"))==null||r.classList.toggle("MAX")})}makePanelsDraggable(){Object.entries(this.panels).forEach(([e,t])=>{const r=this.handles[e];t&&r&&this.makeDraggable(t,r)})}makeDraggable(e,t){u1(e).draggable({allowFrom:t,listeners:{move(r){const i=r.target,a=(parseFloat(i.getAttribute("data-x"))||0)+r.dx,s=(parseFloat(i.getAttribute("data-y"))||0)+r.dy;i.style.transform=`translate(${a}px, ${s}px)`,i.setAttribute("data-x",a),i.setAttribute("data-y",s)}}})}registerToolListeners(){Object.entries({scale:"scale",tree:"tree",force:"forceSimulation",panning:"panning",select:"select",component:"component","color-picker":"colorPicker"}).forEach(([t,r])=>{var i;(i=rr.querySelector(`widgets #tools-panel .${t}`))==null||i.addEventListener("click",()=>{this.eventBus.emit("toggleSetting",{key:r})})})}}class l1{constructor(e,t){this.app=e,this.settings=e.settings,this.canvas=e.canvas,this.ctx=e._canvas.ctx,this.selection={x:0,y:0,width:0,height:0,active:!1},this.mouseDown=!1,this.scale={isDragging:!1,active:!1,activeHandle:null,scaleData:{},rect:{x:100,y:100,width:200,height:150},prevMouse:{x:0,y:0},offsetX:0,offsetY:0,handleSize:10,handles:["nw","n","ne","e","se","s","sw","w"],cursorMap:{nw:"nwse-resize",n:"ns-resize",ne:"nesw-resize",e:"ew-resize",se:"nwse-resize",s:"ns-resize",sw:"nesw-resize",w:"ew-resize"}}}init(){this.canvas.addEventListener("mousedown",this.startSelection.bind(this)),this.canvas.addEventListener("mousemove",this.updateSelection.bind(this)),this.canvas.addEventListener("mouseup",this.endSelection.bind(this))}draw(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),(this.settings.select||this.settings.scale)&&(this.selection.active&&this.drawSelect(this.selection),this.settings.scale&&this.drawScale())}drawSelect(e){if(!e)return;const t=this.ctx;t.fillStyle="rgba(0, 0, 0, 0.1)",t.fillRect(e.x,e.y,e.width,e.height),t.strokeStyle="rgba(0, 0, 255, 0.7)",t.lineWidth=2,t.setLineDash([5,5]),t.strokeRect(e.x,e.y,e.width,e.height),t.setLineDash([])}drawScale(){this.scale.active&&this.drawScaleBox(this.scale.rect,this.ctx)}startSelection(e){if(this.mouseDown=!0,this.settings.performance?this.app.graphManager.needsRedraw={rect:!0,node:!0}:this.app.graphManager.needsRedraw={rect:!0,node:!0,edge:!0,face:!0},this.settings.select||this.settings.scale){const[t,r]=nr(e,this.canvas);if(this.selection.x=t,this.selection.y=r,this.selection.width=0,this.selection.height=0,this.selection.active=!this.scale.active,this.settings.scale&&this.scale.active){const[i,a]=nr(e);if(this.scale.prevMouse={x:i,y:a},this.scale.activeHandle=this.hitTestHandle(i,a),this.scale.activeHandle)return;i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height&&(this.scale.isDragging=!0,this.scale.offsetX=i-this.scale.rect.x,this.scale.offsetY=a-this.scale.rect.y)}}else this.selection.active=!1,this.scale.active=!1}updateSelection(e){if(this.selection.active&&!this.scale.active){const[t,r]=nr(e,this.canvas);this.selection.width=t-this.selection.x,this.selection.height=r-this.selection.y;return}if(this.scale.active){const t=this.scale.rect,r=this.app.graphManager.graph.getSelectedNodes(),[i,a]=nr(e);if(this.scale.activeHandle){this.resizeRect(this.scale.activeHandle,i,a);for(let c of r)this.app.graphManager.graph.updateNodeAttributes(c,f=>({...f,x:t.x+t.width*this.scale.scaleData[c].x,y:t.y+t.height*this.scale.scaleData[c].y}));return}if(this.scale.isDragging){this.scale.rect.x=i-this.scale.offsetX,this.scale.rect.y=a-this.scale.offsetY;const c=i-this.scale.prevMouse.x,f=a-this.scale.prevMouse.y;for(let h of r)this.app.graphManager.graph.updateNodeAttributes(h,y=>({...y,x:y.x+c,y:y.y+f}));this.scale.prevMouse={x:i,y:a};return}const s=this.hitTestHandle(i,a);s?this.canvas.style.cursor=this.scale.cursorMap[s]:i>=this.scale.rect.x&&i<=this.scale.rect.x+this.scale.rect.width&&a>=this.scale.rect.y&&a<=this.scale.rect.y+this.scale.rect.height?this.canvas.style.cursor="move":this.canvas.style.cursor="default"}}endSelection(e){this.mouseDown=!1,this.selection.active=!1,this.scale.isDragging=!1,this.scale.activeHandle=null,this.pointsInRect(this.selection).forEach(i=>{this.app.graphManager.graph.toggleNodeSelection(i)}),this.settings.scale||this.linesInRect(this.selection).forEach(a=>{this.app.graphManager.graph.toggleEdgeSelection(a)});const r=this.app.graphManager.graph.getSelectedNodes();this.settings.scale&&r.length>0&&!this.scale.active&&(this.scale.active=!0,this.scale.rect=d1(this.app.graphManager.graph,r,this.settings.node_radius),this.scaleData={},r.forEach(i=>{const a=this.app.graphManager.graph.getNodeAttributes(i);this.scale.scaleData[i]={id:i,x:(a.x-this.scale.rect.x)/this.scale.rect.width,y:(a.y-this.scale.rect.y)/this.scale.rect.height}})),this.app.graphManager.redraw()}pointsInRect(e){const[t,r,i,a]=Sh(e);return this.app.graphManager.graph.filterNodes((s,c)=>Tu(c.x,c.y,t,r,i,a))}linesInRect(e){const t=Sh(e);return this.app.graphManager.graph.filterEdges((r,i,a,s,c,f)=>this.lineIntersectsRect([c.x,c.y,f.x,f.y],t))}lineIntersectsRect(e,t){let[r,i,a,s]=e,[c,f,h,y]=t;const v=this.settings.node_radius/2+20;return!!(Ah([r,i,a,s],[c,f,h,y])||Ah([r,i,a,s],[c,y,h,f])||Tu(r,i,c+v,f+v,h-v,y-v)||Tu(a,s,c+v,f+v,h-v,y-v))}drawScaleBox(e,t){e&&(t.fillStyle="#cce5ff20",t.strokeStyle="#3399ff",t.lineWidth=2,t.fillRect(e.x,e.y,e.width,e.height),t.strokeRect(e.x,e.y,e.width,e.height),t.fillStyle="#fff",t.strokeStyle="#000",this.scale.handles.forEach(r=>{const[i,a]=this.getHandlePosition(r);t.fillRect(i,a,this.scale.handleSize,this.scale.handleSize),t.strokeRect(i,a,this.scale.handleSize,this.scale.handleSize)}))}getHandlePosition(e){const{x:t,y:r,width:i,height:a}=this.scale.rect,s=this.scale.handleSize/2;switch(e){case"nw":return[t-s,r-s];case"n":return[t+i/2-s,r-s];case"ne":return[t+i-s,r-s];case"e":return[t+i-s,r+a/2-s];case"se":return[t+i-s,r+a-s];case"s":return[t+i/2-s,r+a-s];case"sw":return[t-s,r+a-s];case"w":return[t-s,r+a/2-s]}}hitTestHandle(e,t){return this.scale.handles.find(r=>{const[i,a]=this.getHandlePosition(r);return e>=i&&e<=i+this.scale.handleSize&&t>=a&&t<=a+this.scale.handleSize})}resizeRect(e,t,r){const a=t-this.scale.prevMouse.x,s=r-this.scale.prevMouse.y;let{x:c,y:f,width:h,height:y}=this.scale.rect;switch(e){case"nw":c+=a,f+=s,h-=a,y-=s;break;case"n":f+=s,y-=s;break;case"ne":f+=s,h+=a,y-=s;break;case"e":h+=a;break;case"se":h+=a,y+=s;break;case"s":y+=s;break;case"sw":c+=a,h-=a,y+=s;break;case"w":c+=a,h-=a;break}if(h<20){const v=20-h;e.includes("w")&&(c-=v),h=20}if(y<20){const v=20-y;e.includes("n")&&(f-=v),y=20}this.scale.rect.x=c,this.scale.rect.y=f,this.scale.rect.width=h,this.scale.rect.height=y,this.scale.prevMouse={x:t,y:r}}}function Tu(n,e,t,r,i,a){return n>=t&&n<=i&&e>=r&&e<=a}function Sh(n){const e=Math.min(n.x,n.x+n.width),t=Math.min(n.y,n.y+n.height),r=Math.max(n.x,n.x+n.width),i=Math.max(n.y,n.y+n.height);return[e,t,r,i]}function Ah(n,e){var t,r,i;const[a,s,c,f]=n,[h,y,v,w]=e;return t=(c-a)*(w-y)-(v-h)*(f-s),t===0?!1:(i=((w-y)*(v-a)+(h-v)*(w-s))/t,r=((s-f)*(v-a)+(c-a)*(w-s))/t,0<i&&i<1&&0<r&&r<1)}function d1(n,e,t){if(!e.length)return null;let r=1/0,i=1/0,a=-1/0,s=-1/0;e.forEach(f=>{const h=n.getNodeAttributes(f);h.x<r&&(r=h.x),h.y<i&&(i=h.y),h.x>a&&(a=h.x),h.y>s&&(s=h.y)});const c=t*1.5;return{x:r-c,y:i-c,width:a-r+2*c,height:s-i+2*c}}var Ru={exports:{}};/*! Pickr 1.9.1 MIT | https://github.com/Simonwep/pickr */var kh;function h1(){return kh||(kh=1,function(n,e){(function(t,r){n.exports=r()})(self,()=>(()=>{var t={d:(Y,O)=>{for(var J in O)t.o(O,J)&&!t.o(Y,J)&&Object.defineProperty(Y,J,{enumerable:!0,get:O[J]})},o:(Y,O)=>Object.prototype.hasOwnProperty.call(Y,O),r:Y=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(Y,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Y,"__esModule",{value:!0})}},r={};t.d(r,{default:()=>ye});var i={};function a(Y,O,J,ee,ce={}){O instanceof HTMLCollection||O instanceof NodeList?O=Array.from(O):Array.isArray(O)||(O=[O]),Array.isArray(J)||(J=[J]);for(const oe of O)for(const le of J)oe[Y](le,ee,{capture:!1,...ce});return Array.prototype.slice.call(arguments,1)}t.r(i),t.d(i,{adjustableInputNumbers:()=>w,createElementFromString:()=>f,createFromTemplate:()=>h,eventPath:()=>y,off:()=>c,on:()=>s,resolveElement:()=>v});const s=a.bind(null,"addEventListener"),c=a.bind(null,"removeEventListener");function f(Y){const O=document.createElement("div");return O.innerHTML=Y.trim(),O.firstElementChild}function h(Y){const O=(ee,ce)=>{const oe=ee.getAttribute(ce);return ee.removeAttribute(ce),oe},J=(ee,ce={})=>{const oe=O(ee,":obj"),le=O(ee,":ref"),se=oe?ce[oe]={}:ce;le&&(ce[le]=ee);for(const me of Array.from(ee.children)){const _e=O(me,":arr"),Me=J(me,_e?{}:se);_e&&(se[_e]||(se[_e]=[])).push(Object.keys(Me).length?Me:me)}return ce};return J(f(Y))}function y(Y){let O=Y.path||Y.composedPath&&Y.composedPath();if(O)return O;let J=Y.target.parentElement;for(O=[Y.target,J];J=J.parentElement;)O.push(J);return O.push(document,window),O}function v(Y){return Y instanceof Element?Y:typeof Y=="string"?Y.split(/>>/g).reduce((O,J,ee,ce)=>(O=O.querySelector(J),ee<ce.length-1?O.shadowRoot:O),document):null}function w(Y,O=J=>J){function J(ee){const ce=[.001,.01,.1][Number(ee.shiftKey||2*ee.ctrlKey)]*(ee.deltaY<0?1:-1);let oe=0,le=Y.selectionStart;Y.value=Y.value.replace(/[\d.]+/g,(se,me)=>me<=le&&me+se.length>=le?(le=me,O(Number(se),ce,oe)):(oe++,se)),Y.focus(),Y.setSelectionRange(le,le),ee.preventDefault(),Y.dispatchEvent(new Event("input"))}s(Y,"focus",()=>s(window,"wheel",J,{passive:!1})),s(Y,"blur",()=>c(window,"wheel",J))}const{min:E,max:D,floor:k,round:I}=Math;function P(Y,O,J){O/=100,J/=100;const ee=k(Y=Y/360*6),ce=Y-ee,oe=J*(1-O),le=J*(1-ce*O),se=J*(1-(1-ce)*O),me=ee%6;return[255*[J,le,oe,oe,se,J][me],255*[se,J,J,le,oe,oe][me],255*[oe,oe,se,J,J,le][me]]}function C(Y,O,J){const ee=(2-(O/=100))*(J/=100)/2;return ee!==0&&(O=ee===1?0:ee<.5?O*J/(2*ee):O*J/(2-2*ee)),[Y,100*O,100*ee]}function R(Y,O,J){const ee=E(Y/=255,O/=255,J/=255),ce=D(Y,O,J),oe=ce-ee;let le,se;if(oe===0)le=se=0;else{se=oe/ce;const me=((ce-Y)/6+oe/2)/oe,_e=((ce-O)/6+oe/2)/oe,Me=((ce-J)/6+oe/2)/oe;Y===ce?le=Me-_e:O===ce?le=1/3+me-Me:J===ce&&(le=2/3+_e-me),le<0?le+=1:le>1&&(le-=1)}return[360*le,100*se,100*ce]}function _(Y,O,J,ee){return O/=100,J/=100,[...R(255*(1-E(1,(Y/=100)*(1-(ee/=100))+ee)),255*(1-E(1,O*(1-ee)+ee)),255*(1-E(1,J*(1-ee)+ee)))]}function T(Y,O,J){O/=100;const ee=2*(O*=(J/=100)<.5?J:1-J)/(J+O)*100,ce=100*(J+O);return[Y,isNaN(ee)?0:ee,ce]}function B(Y){return R(...Y.match(/.{2}/g).map(O=>parseInt(O,16)))}function S(Y){Y=Y.match(/^[a-zA-Z]+$/)?function(ce){if(ce.toLowerCase()==="black")return"#000";const oe=document.createElement("canvas").getContext("2d");return oe.fillStyle=ce,oe.fillStyle==="#000"?null:oe.fillStyle}(Y):Y;const O={cmyk:/^cmyk\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)/i,rgba:/^rgba?\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D+([\d.]+)(%?)\D*?(([\d.]+)(%?)|$)/i,hsla:/^hsla?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hsva:/^hsva?\D+([\d.]+)\D+([\d.]+)\D+([\d.]+)\D*?(([\d.]+)(%?)|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},J=ce=>ce.map(oe=>/^(|\d+)\.\d+|\d+$/.test(oe)?Number(oe):void 0);let ee;e:for(const ce in O)if(ee=O[ce].exec(Y))switch(ce){case"cmyk":{const[,oe,le,se,me]=J(ee);if(oe>100||le>100||se>100||me>100)break e;return{values:_(oe,le,se,me),type:ce}}case"rgba":{let[,oe,,le,,se,,,me]=J(ee);if(oe=ee[2]==="%"?oe/100*255:oe,le=ee[4]==="%"?le/100*255:le,se=ee[6]==="%"?se/100*255:se,me=ee[9]==="%"?me/100:me,oe>255||le>255||se>255||me<0||me>1)break e;return{values:[...R(oe,le,se),me],a:me,type:ce}}case"hexa":{let[,oe]=ee;oe.length!==4&&oe.length!==3||(oe=oe.split("").map(me=>me+me).join(""));const le=oe.substring(0,6);let se=oe.substring(6);return se=se?parseInt(se,16)/255:void 0,{values:[...B(le),se],a:se,type:ce}}case"hsla":{let[,oe,le,se,,me]=J(ee);if(me=ee[6]==="%"?me/100:me,oe>360||le>100||se>100||me<0||me>1)break e;return{values:[...T(oe,le,se),me],a:me,type:ce}}case"hsva":{let[,oe,le,se,,me]=J(ee);if(me=ee[6]==="%"?me/100:me,oe>360||le>100||se>100||me<0||me>1)break e;return{values:[oe,le,se,me],a:me,type:ce}}}return{values:null,type:null}}function z(Y=0,O=0,J=0,ee=1){const ce=(le,se)=>(me=-1)=>se(~me?le.map(_e=>Number(_e.toFixed(me))):le),oe={h:Y,s:O,v:J,a:ee,toHSVA(){const le=[oe.h,oe.s,oe.v,oe.a];return le.toString=ce(le,se=>`hsva(${se[0]}, ${se[1]}%, ${se[2]}%, ${oe.a})`),le},toHSLA(){const le=[...C(oe.h,oe.s,oe.v),oe.a];return le.toString=ce(le,se=>`hsla(${se[0]}, ${se[1]}%, ${se[2]}%, ${oe.a})`),le},toRGBA(){const le=[...P(oe.h,oe.s,oe.v),oe.a];return le.toString=ce(le,se=>`rgba(${se[0]}, ${se[1]}, ${se[2]}, ${oe.a})`),le},toCMYK(){const le=function(se,me,_e){const Me=P(se,me,_e),Oe=Me[0]/255,Fe=Me[1]/255,de=Me[2]/255,Ne=E(1-Oe,1-Fe,1-de);return[100*(Ne===1?0:(1-Oe-Ne)/(1-Ne)),100*(Ne===1?0:(1-Fe-Ne)/(1-Ne)),100*(Ne===1?0:(1-de-Ne)/(1-Ne)),100*Ne]}(oe.h,oe.s,oe.v);return le.toString=ce(le,se=>`cmyk(${se[0]}%, ${se[1]}%, ${se[2]}%, ${se[3]}%)`),le},toHEXA(){const le=function(me,_e,Me){return P(me,_e,Me).map(Oe=>I(Oe).toString(16).padStart(2,"0"))}(oe.h,oe.s,oe.v),se=oe.a>=1?"":Number((255*oe.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return se&&le.push(se),le.toString=()=>`#${le.join("").toUpperCase()}`,le},clone:()=>z(oe.h,oe.s,oe.v,oe.a)};return oe}const G=Y=>Math.max(Math.min(Y,1),0);function F(Y){const O={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},Y),_keyboard(oe){const{options:le}=O,{type:se,key:me}=oe;if(document.activeElement===le.wrapper){const{lock:_e}=O.options,Me=me==="ArrowUp",Oe=me==="ArrowRight",Fe=me==="ArrowDown",de=me==="ArrowLeft";if(se==="keydown"&&(Me||Oe||Fe||de)){let Ne=0,Re=0;_e==="v"?Ne=Me||Oe?1:-1:_e==="h"?Ne=Me||Oe?-1:1:(Re=Me?-1:Fe?1:0,Ne=de?-1:Oe?1:0),O.update(G(O.cache.x+.01*Ne),G(O.cache.y+.01*Re)),oe.preventDefault()}else me.startsWith("Arrow")&&(O.options.onstop(),oe.preventDefault())}},_tapstart(oe){s(document,["mouseup","touchend","touchcancel"],O._tapstop),s(document,["mousemove","touchmove"],O._tapmove),oe.cancelable&&oe.preventDefault(),O._tapmove(oe)},_tapmove(oe){const{options:le,cache:se}=O,{lock:me,element:_e,wrapper:Me}=le,Oe=Me.getBoundingClientRect();let Fe=0,de=0;if(oe){const ke=oe&&oe.touches&&oe.touches[0];Fe=oe?(ke||oe).clientX:0,de=oe?(ke||oe).clientY:0,Fe<Oe.left?Fe=Oe.left:Fe>Oe.left+Oe.width&&(Fe=Oe.left+Oe.width),de<Oe.top?de=Oe.top:de>Oe.top+Oe.height&&(de=Oe.top+Oe.height),Fe-=Oe.left,de-=Oe.top}else se&&(Fe=se.x*Oe.width,de=se.y*Oe.height);me!=="h"&&(_e.style.left=`calc(${Fe/Oe.width*100}% - ${_e.offsetWidth/2}px)`),me!=="v"&&(_e.style.top=`calc(${de/Oe.height*100}% - ${_e.offsetHeight/2}px)`),O.cache={x:Fe/Oe.width,y:de/Oe.height};const Ne=G(Fe/Oe.width),Re=G(de/Oe.height);switch(me){case"v":return le.onchange(Ne);case"h":return le.onchange(Re);default:return le.onchange(Ne,Re)}},_tapstop(){O.options.onstop(),c(document,["mouseup","touchend","touchcancel"],O._tapstop),c(document,["mousemove","touchmove"],O._tapmove)},trigger(){O._tapmove()},update(oe=0,le=0){const{left:se,top:me,width:_e,height:Me}=O.options.wrapper.getBoundingClientRect();O.options.lock==="h"&&(le=oe),O._tapmove({clientX:se+_e*oe,clientY:me+Me*le})},destroy(){const{options:oe,_tapstart:le,_keyboard:se}=O;c(document,["keydown","keyup"],se),c([oe.wrapper,oe.element],"mousedown",le),c([oe.wrapper,oe.element],"touchstart",le,{passive:!1})}},{options:J,_tapstart:ee,_keyboard:ce}=O;return s([J.wrapper,J.element],"mousedown",ee),s([J.wrapper,J.element],"touchstart",ee,{passive:!1}),s(document,["keydown","keyup"],ce),O}function U(Y={}){Y=Object.assign({onchange:()=>0,className:"",elements:[]},Y);const O=s(Y.elements,"click",J=>{Y.elements.forEach(ee=>ee.classList[J.target===ee?"add":"remove"](Y.className)),Y.onchange(J),J.stopPropagation()});return{destroy:()=>c(...O)}}const V={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8,padding:0},j=(Y,O,J)=>{const ee=typeof Y!="object"||Y instanceof HTMLElement?{reference:Y,popper:O,...J}:Y;return{update(ce=ee){const{reference:oe,popper:le}=Object.assign(ee,ce);if(!le||!oe)throw new Error("Popper- or reference-element missing.");return((se,me,_e)=>{const{container:Me,arrow:Oe,margin:Fe,padding:de,position:Ne,variantFlipOrder:Re,positionFlipOrder:ke}={container:document.documentElement.getBoundingClientRect(),...V,..._e},{left:Ke,top:Le}=me.style;me.style.left="0",me.style.top="0";const Ee=se.getBoundingClientRect(),pe=me.getBoundingClientRect(),vt={t:Ee.top-pe.height-Fe,b:Ee.bottom+Fe,r:Ee.right+Fe,l:Ee.left-pe.width-Fe},it={vs:Ee.left,vm:Ee.left+Ee.width/2-pe.width/2,ve:Ee.left+Ee.width-pe.width,hs:Ee.top,hm:Ee.bottom-Ee.height/2-pe.height/2,he:Ee.bottom-pe.height},[xt,at="middle"]=Ne.split("-"),Ve=ke[xt],ht=Re[at],{top:ot,left:gt,bottom:_t,right:st}=Me;for(const ut of Ve){const ft=ut==="t"||ut==="b";let rt=vt[ut];const[St,mt]=ft?["top","left"]:["left","top"],[Ot,or]=ft?[pe.height,pe.width]:[pe.width,pe.height],[Jr,Tt]=ft?[_t,st]:[st,_t],[ze,xr]=ft?[ot,gt]:[gt,ot];if(!(rt<ze||rt+Ot+de>Jr))for(const bt of ht){let At=it[(ft?"v":"h")+bt];if(!(At<xr||At+or+de>Tt)){if(At-=pe[mt],rt-=pe[St],me.style[mt]=`${At}px`,me.style[St]=`${rt}px`,Oe){const Se=ft?Ee.width/2:Ee.height/2,sr=or/2,qr=Se>sr,en=At+{s:qr?sr:Se,m:sr,e:qr?sr:or-Se}[bt],tn=rt+{t:Ot,b:0,r:0,l:Ot}[ut];Oe.style[mt]=`${en}px`,Oe.style[St]=`${tn}px`}return ut+bt}}}return me.style.left=Ke,me.style.top=Le,null})(oe,le,ee)}}},fe=class fe{constructor(O){Ct(this,"_initializingActive",!0);Ct(this,"_recalc",!0);Ct(this,"_nanopop",null);Ct(this,"_root",null);Ct(this,"_color",z());Ct(this,"_lastColor",z());Ct(this,"_swatchColors",[]);Ct(this,"_setupAnimationFrame",null);Ct(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]});this.options=O=Object.assign({...fe.DEFAULT_OPTIONS},O);const{swatches:J,components:ee,theme:ce,sliders:oe,lockOpacity:le,padding:se}=O;["nano","monolith"].includes(ce)&&!oe&&(O.sliders="h"),ee.interaction||(ee.interaction={});const{preview:me,opacity:_e,hue:Me,palette:Oe}=ee;ee.opacity=!le&&_e,ee.palette=Oe||me||_e||Me,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),J&&J.length&&J.forEach(Re=>this.addSwatch(Re));const{button:Fe,app:de}=this._root;this._nanopop=j(Fe,de,{margin:se}),Fe.setAttribute("role","button"),Fe.setAttribute("aria-label",this._t("btn:toggle"));const Ne=this;this._setupAnimationFrame=requestAnimationFrame(function Re(){if(!de.offsetWidth)return requestAnimationFrame(Re);Ne.setColor(O.default),Ne._rePositioningPicker(),O.defaultRepresentation&&(Ne._representation=O.defaultRepresentation,Ne.setColorRepresentation(Ne._representation)),O.showAlways&&Ne.show(),Ne._initializingActive=!1,Ne._emit("init")})}_preBuild(){const{options:O}=this;for(const J of["el","container"])O[J]=v(O[J]);this._root=(J=>{const{components:ee,useAsButton:ce,inline:oe,appClass:le,theme:se,lockOpacity:me}=J.options,_e=de=>de?"":'style="display:none" hidden',Me=de=>J._t(de),Oe=h(`
      <div :ref="root" class="pickr">

        ${ce?"":'<button type="button" :ref="button" class="pcr-button"></button>'}

        <div :ref="app" class="pcr-app ${le||""}" data-theme="${se}" ${oe?'style="position: unset"':""} aria-label="${Me("ui:dialog")}" role="window">
          <div class="pcr-selection" ${_e(ee.palette)}>
            <div :obj="preview" class="pcr-color-preview" ${_e(ee.preview)}>
              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${Me("btn:last-color")}"></button>
              <div :ref="currentColor" class="pcr-current-color"></div>
            </div>

            <div :obj="palette" class="pcr-color-palette">
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${Me("aria:palette")}" role="listbox"></div>
            </div>

            <div :obj="hue" class="pcr-color-chooser" ${_e(ee.hue)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${Me("aria:hue")}" role="slider"></div>
            </div>

            <div :obj="opacity" class="pcr-color-opacity" ${_e(ee.opacity)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${Me("aria:opacity")}" role="slider"></div>
            </div>
          </div>

          <div class="pcr-swatches ${ee.palette?"":"pcr-last"}" :ref="swatches"></div>

          <div :obj="interaction" class="pcr-interaction" ${_e(Object.keys(ee.interaction).length)}>
            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${_e(ee.interaction.input)} aria-label="${Me("aria:input")}">

            <input :arr="options" class="pcr-type" data-type="HEXA" value="${me?"HEX":"HEXA"}" type="button" ${_e(ee.interaction.hex)}>
            <input :arr="options" class="pcr-type" data-type="RGBA" value="${me?"RGB":"RGBA"}" type="button" ${_e(ee.interaction.rgba)}>
            <input :arr="options" class="pcr-type" data-type="HSLA" value="${me?"HSL":"HSLA"}" type="button" ${_e(ee.interaction.hsla)}>
            <input :arr="options" class="pcr-type" data-type="HSVA" value="${me?"HSV":"HSVA"}" type="button" ${_e(ee.interaction.hsva)}>
            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${_e(ee.interaction.cmyk)}>

            <input :ref="save" class="pcr-save" value="${Me("btn:save")}" type="button" ${_e(ee.interaction.save)} aria-label="${Me("aria:btn:save")}">
            <input :ref="cancel" class="pcr-cancel" value="${Me("btn:cancel")}" type="button" ${_e(ee.interaction.cancel)} aria-label="${Me("aria:btn:cancel")}">
            <input :ref="clear" class="pcr-clear" value="${Me("btn:clear")}" type="button" ${_e(ee.interaction.clear)} aria-label="${Me("aria:btn:clear")}">
          </div>
        </div>
      </div>
    `),Fe=Oe.interaction;return Fe.options.find(de=>!de.hidden&&!de.classList.add("active")),Fe.type=()=>Fe.options.find(de=>de.classList.contains("active")),Oe})(this),O.useAsButton&&(this._root.button=O.el),O.container.appendChild(this._root.root)}_finalBuild(){const O=this.options,J=this._root;if(O.container.removeChild(J.root),O.inline){const ee=O.el.parentElement;O.el.nextSibling?ee.insertBefore(J.app,O.el.nextSibling):ee.appendChild(J.app)}else O.container.appendChild(J.app);O.useAsButton?O.inline&&O.el.remove():O.el.parentNode.replaceChild(J.root,O.el),O.disabled&&this.disable(),O.comparison||(J.button.style.transition="none",O.useAsButton||(J.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const O=this,J=this.options.components,ee=(O.options.sliders||"v").repeat(2),[ce,oe]=ee.match(/^[vh]+$/g)?ee:[],le=()=>this._color||(this._color=this._lastColor.clone()),se={palette:F({element:O._root.palette.picker,wrapper:O._root.palette.palette,onstop:()=>O._emit("changestop","slider",O),onchange(me,_e){if(!J.palette)return;const Me=le(),{_root:Oe,options:Fe}=O,{lastColor:de,currentColor:Ne}=Oe.preview;O._recalc&&(Me.s=100*me,Me.v=100-100*_e,Me.v<0&&(Me.v=0),O._updateOutput("slider"));const Re=Me.toRGBA().toString(0);this.element.style.background=Re,this.wrapper.style.background=`
                        linear-gradient(to top, rgba(0, 0, 0, ${Me.a}), transparent),
                        linear-gradient(to left, hsla(${Me.h}, 100%, 50%, ${Me.a}), rgba(255, 255, 255, ${Me.a}))
                    `,Fe.comparison?Fe.useAsButton||O._lastColor||de.style.setProperty("--pcr-color",Re):(Oe.button.style.setProperty("--pcr-color",Re),Oe.button.classList.remove("clear"));const ke=Me.toHEXA().toString();for(const{el:Ke,color:Le}of O._swatchColors)Ke.classList[ke===Le.toHEXA().toString()?"add":"remove"]("pcr-active");Ne.style.setProperty("--pcr-color",Re)}}),hue:F({lock:oe==="v"?"h":"v",element:O._root.hue.picker,wrapper:O._root.hue.slider,onstop:()=>O._emit("changestop","slider",O),onchange(me){if(!J.hue||!J.palette)return;const _e=le();O._recalc&&(_e.h=360*me),this.element.style.backgroundColor=`hsl(${_e.h}, 100%, 50%)`,se.palette.trigger()}}),opacity:F({lock:ce==="v"?"h":"v",element:O._root.opacity.picker,wrapper:O._root.opacity.slider,onstop:()=>O._emit("changestop","slider",O),onchange(me){if(!J.opacity||!J.palette)return;const _e=le();O._recalc&&(_e.a=Math.round(100*me)/100),this.element.style.background=`rgba(0, 0, 0, ${_e.a})`,se.palette.trigger()}}),selectable:U({elements:O._root.interaction.options,className:"active",onchange(me){O._representation=me.target.getAttribute("data-type").toUpperCase(),O._recalc&&O._updateOutput("swatch")}})};this._components=se}_bindEvents(){const{_root:O,options:J}=this,ee=[s(O.interaction.clear,"click",()=>this._clearColor()),s([O.interaction.cancel,O.preview.lastColor],"click",()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")}),s(O.interaction.save,"click",()=>{!this.applyColor()&&!J.showAlways&&this.hide()}),s(O.interaction.result,["keyup","input"],ce=>{this.setColor(ce.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),ce.stopImmediatePropagation()}),s(O.interaction.result,["focus","blur"],ce=>{this._recalc=ce.type==="blur",this._recalc&&this._updateOutput(null)}),s([O.palette.palette,O.palette.picker,O.hue.slider,O.hue.picker,O.opacity.slider,O.opacity.picker],["mousedown","touchstart"],()=>this._recalc=!0,{passive:!0})];if(!J.showAlways){const ce=J.closeWithKey;ee.push(s(O.button,"click",()=>this.isOpen()?this.hide():this.show()),s(document,"keyup",oe=>this.isOpen()&&(oe.key===ce||oe.code===ce)&&this.hide()),s(document,["touchstart","mousedown"],oe=>{this.isOpen()&&!y(oe).some(le=>le===O.app||le===O.button)&&this.hide()},{capture:!0}))}if(J.adjustableNumbers){const ce={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};w(O.interaction.result,(oe,le,se)=>{const me=ce[this.getColorRepresentation().toLowerCase()];if(me){const _e=me[se],Me=oe+(_e>=100?1e3*le:le);return Me<=0?0:Number((Me<_e?Me:_e).toPrecision(3))}return oe})}if(J.autoReposition&&!J.inline){let ce=null;const oe=this;ee.push(s(window,["scroll","resize"],()=>{oe.isOpen()&&(J.closeOnScroll&&oe.hide(),ce===null?(ce=setTimeout(()=>ce=null,100),requestAnimationFrame(function le(){oe._rePositioningPicker(),ce!==null&&requestAnimationFrame(le)})):(clearTimeout(ce),ce=setTimeout(()=>ce=null,100)))},{capture:!0}))}this._eventBindings=ee}_rePositioningPicker(){const{options:O}=this;if(!O.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:O.position})){const J=this._root.app,ee=J.getBoundingClientRect();J.style.top=(window.innerHeight-ee.height)/2+"px",J.style.left=(window.innerWidth-ee.width)/2+"px"}}_updateOutput(O){const{_root:J,_color:ee,options:ce}=this;if(J.interaction.type()){const oe=`to${J.interaction.type().getAttribute("data-type")}`;J.interaction.result.value=typeof ee[oe]=="function"?ee[oe]().toString(ce.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",ee,O,this)}_clearColor(O=!1){const{_root:J,options:ee}=this;ee.useAsButton||J.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),J.button.classList.add("clear"),ee.showAlways||this.hide(),this._lastColor=null,this._initializingActive||O||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(O){const{values:J,type:ee,a:ce}=S(O),{lockOpacity:oe}=this.options,le=ce!==void 0&&ce!==1;return J&&J.length===3&&(J[3]=void 0),{values:!J||oe&&le?null:J,type:ee}}_t(O){return this.options.i18n[O]||fe.I18N_DEFAULTS[O]}_emit(O,...J){this._eventListener[O].forEach(ee=>ee(...J,this))}on(O,J){return this._eventListener[O].push(J),this}off(O,J){const ee=this._eventListener[O]||[],ce=ee.indexOf(J);return~ce&&ee.splice(ce,1),this}addSwatch(O){const{values:J}=this._parseLocalColor(O);if(J){const{_swatchColors:ee,_root:ce}=this,oe=z(...J),le=f(`<button type="button" style="--pcr-color: ${oe.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return ce.swatches.appendChild(le),ee.push({el:le,color:oe}),this._eventBindings.push(s(le,"click",()=>{this.setHSVA(...oe.toHSVA(),!0),this._emit("swatchselect",oe),this._emit("change",oe,"swatch",this)})),!0}return!1}removeSwatch(O){const J=this._swatchColors[O];if(J){const{el:ee}=J;return this._root.swatches.removeChild(ee),this._swatchColors.splice(O,1),!0}return!1}applyColor(O=!1){const{preview:J,button:ee}=this._root,ce=this._color.toRGBA().toString(0);return J.lastColor.style.setProperty("--pcr-color",ce),this.options.useAsButton||ee.style.setProperty("--pcr-color",ce),ee.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||O||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach(O=>c(...O)),Object.keys(this._components).forEach(O=>this._components[O].destroy())}destroyAndRemove(){this.destroy();const{root:O,app:J}=this._root;O.parentElement&&O.parentElement.removeChild(O),J.parentElement.removeChild(J),Object.keys(this).forEach(ee=>this[ee]=null)}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(O=360,J=0,ee=0,ce=1,oe=!1){const le=this._recalc;if(this._recalc=!1,O<0||O>360||J<0||J>100||ee<0||ee>100||ce<0||ce>1)return!1;this._color=z(O,J,ee,ce);const{hue:se,opacity:me,palette:_e}=this._components;return se.update(O/360),me.update(ce),_e.update(J/100,1-ee/100),oe||this.applyColor(),le&&this._updateOutput(),this._recalc=le,!0}setColor(O,J=!1){if(O===null)return this._clearColor(J),!0;const{values:ee,type:ce}=this._parseLocalColor(O);if(ee){const oe=ce.toUpperCase(),{options:le}=this._root.interaction,se=le.find(me=>me.getAttribute("data-type")===oe);if(se&&!se.hidden)for(const me of le)me.classList[me===se?"add":"remove"]("active");return!!this.setHSVA(...ee,J)&&this.setColorRepresentation(oe)}return!1}setColorRepresentation(O){return O=O.toUpperCase(),!!this._root.interaction.options.find(J=>J.getAttribute("data-type").startsWith(O)&&!J.click())}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}};Ct(fe,"utils",i),Ct(fe,"version","1.9.1"),Ct(fe,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),Ct(fe,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),Ct(fe,"create",O=>new fe(O));let ye=fe;return r=r.default})())}(Ru)),Ru.exports}var f1=h1();const p1=Pt(f1);class g1{constructor(e){this.app=e,this.eventBus=e.eventBus,this.settings=e.settings,this.pickrs={},["node","stroke","edge","face","label","background","grid"].forEach(r=>{const i=`#${r}-color`;this.pickrs[r]=p1.create({el:i,theme:"nano",default:this.settings[`${r}_color`],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,input:!0,save:!0}}})})}init(){for(const e in this.pickrs){const t=this.pickrs[e];t.on("change",r=>{const i=r.toHEXA().toString().toLowerCase();t.setColor(i),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:i})})}}setColor(e,t){const r=this.pickrs[e];r&&(r.setColor(this.ToHex(t)),this.eventBus.emit("updateSetting",{key:`${e}_color`,value:this.ToHex(t)}))}getColor(e){const t=this.pickrs[e];return t?t.getColor().toHEXA().toString().toLowerCase():null}resetColors(){for(const e in this.pickrs)this.setColor(e,this.settings[`${e}_color`])}ToHex(e){if(typeof e!="string")return null;const t=e.trim().toLowerCase();if(/^#([0-9a-f]{3,8})$/i.test(t))return t.length===4?"#"+[...t.slice(1)].map(v=>v+v).join(""):t;const r=document.createElement("canvas").getContext("2d");r.fillStyle=t;const i=r.fillStyle.match(/\d+(\.\d+)?/g).map(Number),[a,s,c,f=1]=i,h=v=>Math.round(v).toString(16).padStart(2,"0"),y=Math.round(f*255).toString(16).padStart(2,"0");return"#"+h(a)+h(s)+h(c)+(f<1?y:"")}}class y1{constructor(e){this.app=e,this.graphManager=e.graphManager,this.mainCanvas=e._canvas._canvas.main,this.nodeCanvas=e._canvas._canvas.node,this.edgeCanvas=e._canvas._canvas.edge,this.faceCanvas=e._canvas._canvas.face,this.settings=e.settings,this.rect=e.rect}drawGraph(e={node:!0,edge:!0,face:!0,rect:!0}){if(!e.node&&!e.edge&&!e.face&&!e.rect)return;const t=this.graphManager.graph,r=this.settings,i=+r.edge_size,s=`${r.label_size}px sans-serif`,c=r.label_pos.x,f=r.label_pos.y,h=r.node_radius,y=r.stroke_size;e.face&&this.drawFaces(this.faceCanvas,t,r,s,c,f),e.edge&&this.drawEdges(this.edgeCanvas,t,r,i,h,s,c,f),e.node&&this.drawNodes(this.nodeCanvas,t,r,h,y,s,c,f),e.rect&&this.rect.draw()}drawArrowhead(e,t,r,i,a,s){s.beginPath(),s.moveTo(e,t),s.lineTo(e-i*Math.cos(r-Math.PI/6),t-i*Math.sin(r-Math.PI/6)),s.lineTo(e-i*Math.cos(r+Math.PI/6),t-i*Math.sin(r+Math.PI/6)),s.closePath(),s.fillStyle=a,s.fill()}drawLabel(e,t,r,i,a,s){t!=null&&t.trim()&&(e.fillStyle=a||"#000",e.font=s,e.textAlign="center",e.textBaseline="middle",e.fillText(t,r,i))}drawFaces(e,t,r,i,a,s){const c=e.ctx,f=e.canvas.width,h=e.canvas.height;c.clearRect(0,0,f,h);let y=!1;t.forEachFace((v,w)=>{const E=w.nodes.map(D=>{const k=t.getNodeAttributes(D);return[k.x,k.y]});for(const D of E)if(this.check(D[0],D[1],f,h)){y=!0;break}if(y){y=!1;const D={x:lo(E,k=>k[0]),y:lo(E,k=>k[1])};if(E){c.fillStyle=w.selected?"#FFA50055":w.color,c.beginPath(),c.moveTo(E[0][0],E[0][1]);for(let k=1;k<E.length;k++)c.lineTo(E[k][0],E[k][1]);c.closePath(),c.fill()}r.faceLabel&&this.drawLabel(c,w.label,D.x,D.y,w.labelColor,i)}})}drawEdges(e,t,r,i,a,s,c,f){const h=e.ctx,y=e.canvas.width,v=e.canvas.height;h.clearRect(0,0,y,v),t.forEachEdge((w,E,D,k,I,P)=>{if(!this.check(I.x,I.y,y,v)&&!this.check(P.x,P.y,y,v))return;const C=P.x-I.x,R=P.y-I.y,_=Math.hypot(C,R),T=C/_*(12+i),B=R/_*(12+i),S=t.hasEdge(k,D),z=S?I.x+T:I.x,G=S?I.y+B:I.y,F=P.x-T,U=P.y-B;h.beginPath(),h.moveTo(z,G),h.lineTo(F,U);let V;if(E.selected?this.graphManager.cut?V=jo(E.color,.5):V="orange":V=E.color,h.strokeStyle=V,h.lineWidth=i,h.stroke(),h.closePath(),t.isDirected(w)){const j=Math.atan2(R,C),ye=P.x-Math.cos(j)*a/4,fe=P.y-Math.sin(j)*a/4;this.drawArrowhead(ye,fe,j,14+i,V,h)}if((r.edgeLabel||r.weightLabel)&&(E.label||E.weight!=null)){const j=(I.x+P.x)/2,ye=(I.y+P.y)/2,fe=-R/_,Y=C/_,O=j+fe*10+c,J=ye+Y*10+f,ee=[];r.edgeLabel&&E.label&&ee.push(E.label),r.weightLabel&&E.weight!=null&&ee.push(E.weight),ee.length&&this.drawLabel(h,ee.join(", "),O,J,E.labelColor,s)}})}drawNodes(e,t,r,i,a,s,c,f){const h=e.ctx,y=e.canvas.width,v=e.canvas.height;h.clearRect(0,0,y,v),t.forEachNode((w,E)=>{this.check(E.x,E.y,y,v)&&(h.beginPath(),h.arc(E.x,E.y,i*E.size,0,2*Math.PI),E.selected?this.graphManager.cut?h.fillStyle=jo(E.color,.5):h.fillStyle="orange":h.fillStyle=E.color,h.fill(),a!==0&&(h.lineWidth=a,E.selected?this.graphManager.cut?h.strokeStyle=jo(E.stroke,.4):h.strokeStyle="orange":h.strokeStyle=E.stroke,h.stroke()),h.closePath(),r.vertexLabel&&this.drawLabel(h,E.label,E.x+c,E.y+f,E.labelColor,s))})}check(e,t,r,i){return e>=0&&e<=r&&t>=0&&t<=i}}class v1{constructor(){this.eventBus=Tv,this.appSettings=new Wu(this),this._canvas=null,this.layout=null,this.graphManager=null,this.rect=null,this.graphRenderer=null,this.menu=null,this.widget=null,this.keyHandler=null,this.eventHanders=null,this.colorPicker=null,this.simulation=null,this.nodes=[],this.links=[],this.init()}async init(){this.settings=await this.appSettings.init(),this._canvas=new Lv(this),this.canvas=this._canvas.canvas,this.layout=new i1(this),this.graphManager=new iw(this,this.settings.type),this.rect=new l1(this),this.graphRenderer=new y1(this),this.menu=new Pw(this,Tw),this.widget=new c1(this),this.keyHandler=new sw(this),this.eventHanders=new Ow(this),this.colorPicker=new g1(this),this.menu.init(),co(this.settings,this.canvas),this.widget.init(),this._canvas.init(),this.rect.init(),this.keyHandler.init(),this.eventHanders.init(),this.initSimulation(),this.loadInitialGraph(),this.colorPicker.init(),this.startAnimationLoop()}initSimulation(){this.nodes.length=0,this.nodes=this.graphManager.graph.getNodesForD3(),this.links.length=0,this.settings.force_edge&&(this.links=this.graphManager.graph.getEdgesForD3()),this.simulation=Mv(this.nodes).force("link",xv(this.links).id(e=>e.id).distance(10).strength(.5)).force("charge",Nv().strength(-300)).force("collide",wv(20)).force("center",tv(this.canvas.width/2,this.canvas.height/2)).force("x",Pv(this.canvas.width/2).strength(.05)).force("y",Ov(this.canvas.height/1).strength(.05)).velocityDecay(.3).alphaDecay(.02),this.appSettings.settings.forceSimulation||this.simulation.stop()}async loadInitialGraph(){const e=await this.graphManager.getLastSnapshot();e?(this.graphManager.loadSnapshot(e),await this.graphManager.updateIndex()):this.graphManager.generator.clusters(20,20,10)}ticked(){this.nodes.forEach(e=>{this.graphManager.graph.hasNode(e.id)&&this.graphManager.graph.updateNodeAttributes(e.id,t=>({...t,x:e.x,y:e.y}))})}startSimulation(){this.simulation.alpha(.3).restart()}stopSimulation(){this.simulation.stop()}updateSimulation(){this.nodes.length=0,this.nodes=this.graphManager.graph.getNodesForD3(),this.links.length=0,this.settings.force_edge&&(this.links=this.graphManager.graph.getEdgesForD3()),this.simulation.nodes(this.nodes),this.simulation.force("link").links(this.links),this.settings.forceSimulation?this.startSimulation():this.stopSimulation()}startAnimationLoop(){const e=()=>{this.settings.forceSimulation?(this.simulation.tick(),this.ticked(),this.graphRenderer.drawGraph({node:!0,edge:!0,face:!0})):this.graphRenderer.drawGraph(this.graphManager.needsRedraw),requestAnimationFrame(e)};requestAnimationFrame(e)}}document.addEventListener("DOMContentLoaded",()=>{const n=new v1;window.graphStudio=n,window.addEventListener("resize",()=>{n._canvas.updateCanvasSize(window.innerWidth,window.innerHeight)}),document.querySelectorAll("img").forEach(e=>{e.setAttribute("draggable","false")})});
